{"_attachments":{"js/phonegap.0.9.5.1.js":{"data":"LyoKICogUGhvbmVHYXAgaXMgYXZhaWxhYmxlIHVuZGVyICplaXRoZXIqIHRoZSB0ZXJtcyBvZiB0aGUgbW9kaWZpZWQgQlNEIGxpY2Vuc2UgKm9yKiB0aGUKICogTUlUIExpY2Vuc2UgKDIwMDgpLiBTZWUgaHR0cDovL29wZW5zb3VyY2Uub3JnL2xpY2Vuc2VzL2FscGhhYmV0aWNhbCBmb3IgZnVsbCB0ZXh0LgogKiAKICogQ29weXJpZ2h0IChjKSAyMDA1LTIwMTAsIE5pdG9iaSBTb2Z0d2FyZSBJbmMuCiAqIENvcHlyaWdodCAoYykgMjAxMC0yMDExLCBJQk0gQ29ycG9yYXRpb24KICogQ29weXJpZ2h0IChjKSAyMDExLCBDb2RldmlzZSBTb2x1dGlvbnMgTHRkLgogKiBDb3B5cmlnaHQgKGMpIDIwMTEsIFByb3llY3RvcyBFcXVpcyBLYSwgUy5MLgogKiAKICovCgovKiBIZWxwZXIgY29kZSB0byByZXNvbHZlIGFub255bW91cyBjYWxsYmFjayBmdW5jdGlvbnMsCgpJZiB0aGUgZnVuY3Rpb24gY2FsbGJhY2sgY2FuIGJlIHJlc29sdmVkIGJ5IG5hbWUgaXQgaXMgcmV0dXJuZWQgdW5hbHRlcmVkLgpJZiB0aGUgZnVuY3Rpb24gaXMgZGVmaW5lZCBpbiBhbiB1bmtub3duIHNjb3BlIGFuZCBjYW4ndCBiZSByZXNvbHZlZCwgYW4gaW50ZXJuYWwgcmVmZXJlbmNlIHRvIHRoZSBmdW5jdGlvbiBpcyBhZGRlZCB0byB0aGUgaW50ZXJuYWwgbWFwLgoKQ2FsbGJhY2tzIGFkZGVkIHRvIHRoZSBtYXAgYXJlIG9uZSB0aW1lIHVzZSBvbmx5LCB0aGV5IHdpbGwgYmUgZGVsZXRlZCBvbmNlIGNhbGxlZC4gIAoKZXhhbXBsZSAxOgoKZnVuY3Rpb24gbXlDYWxsYmFjaygpe307CgpmU3RyaW5nID0gR2V0RnVuY3Rpb25OYW1lKG15Q2FsbGJhY2spOwoKLSByZXN1bHQsIHRoZSBmdW5jdGlvbiBpcyBkZWZpbmVkIGluIHRoZSBnbG9iYWwgc2NvcGUsIGFuZCB3aWxsIGJlIHJldHVybmVkIGFzIGlzIGJlY2F1c2UgaXQgY2FuIGJlIHJlc29sdmVkIGJ5IG5hbWUuCgpleGFtcGxlIDI6CgpmU3RyaW5nID0gR2V0RnVuY3Rpb25OYW1lKGZ1bmN0aW9uKCl7fTspOwoKLSByZXN1bHQsIHRoZSBmdW5jdGlvbiBpcyBkZWZpbmVkIGluIHBsYWNlLCBzbyBpdCB3aWxsIGJlIHJldHVybmVkIHVuY2hhbmdlZC4KCmV4YW1wbGUgMzoKCmZ1bmN0aW9uIG15TWV0aG9kKCkKewogICAgdmFyIGZ1bmsgPSBmdW5jdGlvbigpe307CiAgICBmU3RyaW5nID0gR2V0RnVuY3Rpb25OYW1lKGZ1bmspOwp9CgotIHJlc3VsdCwgdGhlIGZ1bmN0aW9uIENBTk5PVCBiZSByZXNvbHZlZCBieSBuYW1lLCBzbyBhbiBpbnRlcm5hbCByZWZlcmVuY2Ugd3JhcHBlciBpcyBjcmVhdGVkIGFuZCByZXR1cm5lZC4KCgoqLwoKCnZhciBfYW5vbUZ1bmtNYXAgPSB7fTsKdmFyIF9hbm9tRnVua01hcE5leHRJZCA9IDA7IAoKZnVuY3Rpb24gYW5vbVRvTmFtZUZ1bmsoZnVuKQp7Cgl2YXIgZnVua0lkID0gImYiICsgX2Fub21GdW5rTWFwTmV4dElkKys7Cgl2YXIgZnVuayA9IGZ1bmN0aW9uKCkKCXsKCQlmdW4uYXBwbHkodGhpcyxhcmd1bWVudHMpOwoJCV9hbm9tRnVua01hcFtmdW5rSWRdID0gbnVsbDsKCQlkZWxldGUgX2Fub21GdW5rTWFwW2Z1bmtJZF07CQoJfQoJX2Fub21GdW5rTWFwW2Z1bmtJZF0gPSBmdW5rOwoKCXJldHVybiAiX2Fub21GdW5rTWFwLiIgKyBmdW5rSWQ7Cn0KCmZ1bmN0aW9uIEdldEZ1bmN0aW9uTmFtZShmbikKewogIGlmICh0eXBlb2YgZm4gPT09ICJmdW5jdGlvbiIpIHsKICAgIHZhciBuYW1lPSBmbi5uYW1lOwkKCWlmICghbmFtZSkgewogICAgICB2YXIgbSA9IGZuLnRvU3RyaW5nKCkubWF0Y2goL15ccypmdW5jdGlvblxzKyhbXlxzXChdKykvKTsKICAgICAgbmFtZT0gbSAmJiBtWzFdOwkKCX0KCWlmIChuYW1lICYmICh3aW5kb3dbbmFtZV0gPT09IGZuKSkgewoJCXJldHVybiBuYW1lOwoJfSBlbHNlIHsKCQlyZXR1cm4gYW5vbVRvTmFtZUZ1bmsoZm4pOwoJfSAKICB9ZWxzZSB7CiAgCXJldHVybiBudWxsOwogIH0KfQppZiAodHlwZW9mIFBob25lR2FwID09PSAidW5kZWZpbmVkIikgewoKaWYgKHR5cGVvZihEZXZpY2VJbmZvKSAhPT0gJ29iamVjdCcpewogICAgRGV2aWNlSW5mbyA9IHt9Owp9Ci8qKgogKiBUaGlzIHJlcHJlc2VudHMgdGhlIFBob25lR2FwIEFQSSBpdHNlbGYsIGFuZCBwcm92aWRlcyBhIGdsb2JhbCBuYW1lc3BhY2UgZm9yIGFjY2Vzc2luZwogKiBpbmZvcm1hdGlvbiBhYm91dCB0aGUgc3RhdGUgb2YgUGhvbmVHYXAuCiAqIEBjbGFzcwogKi8KUGhvbmVHYXAgPSB7CiAgICBxdWV1ZTogewogICAgICAgIHJlYWR5OiB0cnVlLAogICAgICAgIGNvbW1hbmRzOiBbXSwKICAgICAgICB0aW1lcjogbnVsbAogICAgfSwKICAgIF9jb25zdHJ1Y3RvcnM6IFtdCn07CgovKioKICogTGlzdCBvZiByZXNvdXJjZSBmaWxlcyBsb2FkZWQgYnkgUGhvbmVHYXAuCiAqIFRoaXMgaXMgdXNlZCB0byBlbnN1cmUgSlMgYW5kIG90aGVyIGZpbGVzIGFyZSBsb2FkZWQgb25seSBvbmNlLgogKi8KUGhvbmVHYXAucmVzb3VyY2VzID0ge2Jhc2U6IHRydWV9OwoKLyoqCiAqIERldGVybWluZSBpZiByZXNvdXJjZSBoYXMgYmVlbiBsb2FkZWQgYnkgUGhvbmVHYXAKICoKICogQHBhcmFtIG5hbWUKICogQHJldHVybgogKi8KUGhvbmVHYXAuaGFzUmVzb3VyY2UgPSBmdW5jdGlvbihuYW1lKSB7CiAgICByZXR1cm4gUGhvbmVHYXAucmVzb3VyY2VzW25hbWVdOwp9OwoKLyoqCiAqIEFkZCBhIHJlc291cmNlIHRvIGxpc3Qgb2YgbG9hZGVkIHJlc291cmNlcyBieSBQaG9uZUdhcAogKgogKiBAcGFyYW0gbmFtZQogKi8KUGhvbmVHYXAuYWRkUmVzb3VyY2UgPSBmdW5jdGlvbihuYW1lKSB7CiAgICBQaG9uZUdhcC5yZXNvdXJjZXNbbmFtZV0gPSB0cnVlOwp9OwoKLyoqCiAqIEJvb2xlYW4gZmxhZyBpbmRpY2F0aW5nIGlmIHRoZSBQaG9uZUdhcCBBUEkgaXMgYXZhaWxhYmxlIGFuZCBpbml0aWFsaXplZC4KICovIC8vIFRPRE86IFJlbW92ZSB0aGlzLCBpdCBpcyB1bnVzZWQgaGVyZSAuLi4gLWptClBob25lR2FwLmF2YWlsYWJsZSA9IERldmljZUluZm8udXVpZCAhPSB1bmRlZmluZWQ7CgovKioKICogQWRkIGFuIGluaXRpYWxpemF0aW9uIGZ1bmN0aW9uIHRvIGEgcXVldWUgdGhhdCBlbnN1cmVzIGl0IHdpbGwgcnVuIGFuZCBpbml0aWFsaXplCiAqIGFwcGxpY2F0aW9uIGNvbnN0cnVjdG9ycyBvbmx5IG9uY2UgUGhvbmVHYXAgaGFzIGJlZW4gaW5pdGlhbGl6ZWQuCiAqIEBwYXJhbSB7RnVuY3Rpb259IGZ1bmMgVGhlIGZ1bmN0aW9uIGNhbGxiYWNrIHlvdSB3YW50IHJ1biBvbmNlIFBob25lR2FwIGlzIGluaXRpYWxpemVkCiAqLwpQaG9uZUdhcC5hZGRDb25zdHJ1Y3RvciA9IGZ1bmN0aW9uKGZ1bmMpIHsKICAgIHZhciBzdGF0ZSA9IGRvY3VtZW50LnJlYWR5U3RhdGU7CiAgICBpZiAoICggc3RhdGUgPT0gJ2xvYWRlZCcgfHwgc3RhdGUgPT0gJ2NvbXBsZXRlJyApICYmIERldmljZUluZm8udXVpZCAhPSBudWxsICkKCXsKCQlmdW5jKCk7Cgl9CiAgICBlbHNlCgl7CiAgICAgICAgUGhvbmVHYXAuX2NvbnN0cnVjdG9ycy5wdXNoKGZ1bmMpOwoJfQp9OwoKKGZ1bmN0aW9uKCkgCiB7CiAgICB2YXIgdGltZXIgPSBzZXRJbnRlcnZhbChmdW5jdGlvbigpCgl7CgkJCQkJCQkKCQl2YXIgc3RhdGUgPSBkb2N1bWVudC5yZWFkeVN0YXRlOwoJCQkJCQkJCiAgICAgICAgaWYgKCAoIHN0YXRlID09ICdsb2FkZWQnIHx8IHN0YXRlID09ICdjb21wbGV0ZScgKSAmJiBEZXZpY2VJbmZvLnV1aWQgIT0gbnVsbCApCgkJewoJCQljbGVhckludGVydmFsKHRpbWVyKTsgLy8gc3RvcCBsb29raW5nCgkJCS8vIHJ1biBvdXIgY29uc3RydWN0b3JzIGxpc3QKCQkJd2hpbGUgKFBob25lR2FwLl9jb25zdHJ1Y3RvcnMubGVuZ3RoID4gMCkgCgkJCXsKCQkJCXZhciBjb25zdHJ1Y3RvciA9IFBob25lR2FwLl9jb25zdHJ1Y3RvcnMuc2hpZnQoKTsKCQkJCXRyeSAKCQkJCXsKCQkJCQljb25zdHJ1Y3RvcigpOwoJCQkJfSAKCQkJCWNhdGNoKGUpIAoJCQkJewoJCQkJCWlmICh0eXBlb2YoZGVidWdbJ2xvZyddKSA9PSAnZnVuY3Rpb24nKQoJCQkJCXsKCQkJCQkJZGVidWcubG9nKCJGYWlsZWQgdG8gcnVuIGNvbnN0cnVjdG9yOiAiICsgZGVidWcucHJvY2Vzc01lc3NhZ2UoZSkpOwoJCQkJCX0KCQkJCQllbHNlCgkJCQkJewoJCQkJCQlhbGVydCgiRmFpbGVkIHRvIHJ1biBjb25zdHJ1Y3RvcjogIiArIGUubWVzc2FnZSk7CgkJCQkJfQoJCQkJfQogICAgICAgICAgICB9CgkJCS8vIGFsbCBjb25zdHJ1Y3RvcnMgcnVuLCBub3cgZmlyZSB0aGUgZGV2aWNlcmVhZHkgZXZlbnQKCQkJdmFyIGUgPSBkb2N1bWVudC5jcmVhdGVFdmVudCgnRXZlbnRzJyk7IAoJCQllLmluaXRFdmVudCgnZGV2aWNlcmVhZHknKTsKCQkJZG9jdW1lbnQuZGlzcGF0Y2hFdmVudChlKTsKCQl9CiAgICB9LCAxKTsKfSkoKTsKCgovLyBjZW50cmFsaXplZCBjYWxsYmFja3MKUGhvbmVHYXAuY2FsbGJhY2tJZCA9IDA7ClBob25lR2FwLmNhbGxiYWNrcyA9IHt9OwpQaG9uZUdhcC5jYWxsYmFja1N0YXR1cyA9IHsKICAgIE5PX1JFU1VMVDogMCwKICAgIE9LOiAxLAogICAgQ0xBU1NfTk9UX0ZPVU5EX0VYQ0VQVElPTjogMiwKICAgIElMTEVHQUxfQUNDRVNTX0VYQ0VQVElPTjogMywKICAgIElOU1RBTlRJQVRJT05fRVhDRVBUSU9OOiA0LAogICAgTUFMRk9STUVEX1VSTF9FWENFUFRJT046IDUsCiAgICBJT19FWENFUFRJT046IDYsCiAgICBJTlZBTElEX0FDVElPTjogNywKICAgIEpTT05fRVhDRVBUSU9OOiA4LAogICAgRVJST1I6IDkKICAgIH07CgovKioKICogRXhlY3V0ZSBhIFBob25lR2FwIGNvbW1hbmQgaW4gYSBxdWV1ZWQgZmFzaGlvbiwgdG8gZW5zdXJlIGNvbW1hbmRzIGRvIG5vdAogKiBleGVjdXRlIHdpdGggYW55IHJhY2UgY29uZGl0aW9ucywgYW5kIG9ubHkgcnVuIHdoZW4gUGhvbmVHYXAgaXMgcmVhZHkgdG8KICogcmVjZWl2ZSB0aGVtLgogKgogKi8KUGhvbmVHYXAuZXhlYyA9IGZ1bmN0aW9uKCkgeyAKCQogICAgUGhvbmVHYXAucXVldWUuY29tbWFuZHMucHVzaChhcmd1bWVudHMpOwogICAgaWYgKFBob25lR2FwLnF1ZXVlLnRpbWVyID09IG51bGwpCiAgICAgICAgUGhvbmVHYXAucXVldWUudGltZXIgPSBzZXRJbnRlcnZhbChQaG9uZUdhcC5ydW5fY29tbWFuZCwgMTApOwp9OwoKLyoqCiAqIEludGVybmFsIGZ1bmN0aW9uIHVzZWQgdG8gZGlzcGF0Y2ggdGhlIHJlcXVlc3QgdG8gUGhvbmVHYXAuICBJdCBwcm9jZXNzZXMgdGhlCiAqIGNvbW1hbmQgcXVldWUgYW5kIGV4ZWN1dGVzIHRoZSBuZXh0IGNvbW1hbmQgb24gdGhlIGxpc3QuICBTaW1wbGUgcGFyYW1ldGVycyBhcmUgcGFzc2VkCiAqIGFzIGFyZ3VtZW50cyBvbiB0aGUgdXJsLiAgSmF2YVNjcmlwdCBvYmplY3RzIGNvbnZlcnRlZCBpbnRvIGEgSlNPTiBzdHJpbmcgYW5kIHBhc3NlZCBhcyBhCiAqIHF1ZXJ5IHN0cmluZyBhcmd1bWVudCBvZiB0aGUgdXJsLgogKiBBcmd1bWVudHMgbWF5IGJlIGluIG9uZSBvZiB0d28gZm9ybWF0czoKICogICBGT1JNQVQgT05FIChwcmVmZXJhYmxlKQogKiBUaGUgbmF0aXZlIHNpZGUgd2lsbCBjYWxsIFBob25lR2FwLmNhbGxiYWNrU3VjY2VzcyBvciBQaG9uZUdhcC5jYWxsYmFja0Vycm9yLAogKiBkZXBlbmRpbmcgdXBvbiB0aGUgcmVzdWx0IG9mIHRoZSBhY3Rpb24uCiAqCiAqIEBwYXJhbSB7RnVuY3Rpb259IHN1Y2Nlc3MgICAgVGhlIHN1Y2Nlc3MgY2FsbGJhY2sKICogQHBhcmFtIHtGdW5jdGlvbn0gZmFpbCAgICAgICBUaGUgZmFpbCBjYWxsYmFjawogKiBAcGFyYW0ge1N0cmluZ30gc2VydmljZSAgICAgIFRoZSBuYW1lIG9mIHRoZSBzZXJ2aWNlIHRvIHVzZQogKiBAcGFyYW0ge1N0cmluZ30gYWN0aW9uCQlUaGUgbmFtZSBvZiB0aGUgYWN0aW9uIHRvIHVzZQogKiBAcGFyYW0ge1N0cmluZ1tdfSBbYXJnc10gICAgIFplcm8gb3IgbW9yZSBhcmd1bWVudHMgdG8gcGFzcyB0byB0aGUgbWV0aG9kCiAqICAJCiAqIEZPUk1BVCBUV08KICogQHBhcmFtIHtTdHJpbmd9IGNvbW1hbmQgQ29tbWFuZCB0byBiZSBydW4gaW4gUGhvbmVHYXAsIGUuZy4gIkNsYXNzTmFtZS5tZXRob2QiCiAqIEBwYXJhbSB7U3RyaW5nW119IFthcmdzXSBaZXJvIG9yIG1vcmUgYXJndW1lbnRzIHRvIHBhc3MgdG8gdGhlIG1ldGhvZAogKiBvYmplY3QgcGFyYW1ldGVycyBhcmUgcGFzc2VkIGFzIGFuIGFycmF5IG9iamVjdCBbb2JqZWN0MSwgb2JqZWN0Ml0gZWFjaCBvYmplY3Qgd2lsbCBiZSBwYXNzZWQgYXMgSlNPTiBzdHJpbmdzIAogKiBAcHJpdmF0ZQogKi8KUGhvbmVHYXAucnVuX2NvbW1hbmQgPSBmdW5jdGlvbigpIHsKICAgIGlmICghUGhvbmVHYXAuYXZhaWxhYmxlIHx8ICFQaG9uZUdhcC5xdWV1ZS5yZWFkeSkKICAgICAgICByZXR1cm47CgogICAgUGhvbmVHYXAucXVldWUucmVhZHkgPSBmYWxzZTsKCiAgICBpZighdGhpcy5nYXBCcmlkZ2UpewogICAgICAgIHRoaXMuZ2FwQnJpZGdlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiSUZSQU1FIik7Cgl0aGlzLmdhcEJyaWRnZS5zZXRBdHRyaWJ1dGUoImhlaWdodCIsIjBweCIpOwoJdGhpcy5nYXBCcmlkZ2Uuc2V0QXR0cmlidXRlKCJ3aWR0aCIsIjBweCIpOwoJdGhpcy5nYXBCcmlkZ2Uuc2V0QXR0cmlidXRlKCJmcmFtZWJvcmRlciIsIjAiKTsKCWRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5hcHBlbmRDaGlsZCh0aGlzLmdhcEJyaWRnZSk7CiAgICB9CgogICAgdmFyIGFyZ3MgPSBQaG9uZUdhcC5xdWV1ZS5jb21tYW5kcy5zaGlmdCgpOwogICAgaWYgKFBob25lR2FwLnF1ZXVlLmNvbW1hbmRzLmxlbmd0aCA9PSAwKSB7CiAgICAgICAgY2xlYXJJbnRlcnZhbChQaG9uZUdhcC5xdWV1ZS50aW1lcik7CiAgICAgICAgUGhvbmVHYXAucXVldWUudGltZXIgPSBudWxsOwogICAgfQoJCgl2YXIgc2VydmljZTsKCXZhciBjYWxsYmFja0lkID0gbnVsbDsKCXZhciBzdGFydD0wOwogICAgdHJ5IHsKIAkJaWYgKGFyZ3NbMF0gPT0gbnVsbCB8fCB0eXBlb2YgYXJnc1swXSA9PT0gImZ1bmN0aW9uIikgewogCQkJdmFyIHN1Y2Nlc3MgPSBhcmdzWzBdOwogCQkJdmFyIGZhaWwgPSBhcmdzWzFdOwogCQkJc2VydmljZSA9IGFyZ3NbMl0gKyAiLiIgKyBhcmdzWzNdOwoJCQlhcmdzID0gYXJnc1s0XTsgIC8vYXJyYXkgb2YgYXJndW1lbnRzIHRvIAogCQkJY2FsbGJhY2tJZCA9IHNlcnZpY2UgKyBQaG9uZUdhcC5jYWxsYmFja0lkKys7CiAgICAgICAgCWlmIChzdWNjZXNzIHx8IGZhaWwpIHsKICAgICAgICAgICAgCVBob25lR2FwLmNhbGxiYWNrc1tjYWxsYmFja0lkXSA9IHtzdWNjZXNzOnN1Y2Nlc3MsIGZhaWw6ZmFpbH07CiAgICAgICAgCX0KIAkJfSBlbHNlIHsgCiAJCQlzZXJ2aWNlID0gYXJnc1swXTsgCiAJCQlzdGFydCA9IDE7CiAJCX0KICAgICAgICAKICAgICAgICB2YXIgdXJpID0gW107CiAgICAJdmFyIGRpY3QgPSBudWxsOwogICAgCiAgICAJZm9yICh2YXIgaSA9IHN0YXJ0OyBpIDwgYXJncy5sZW5ndGg7IGkrKykgewogICAgICAgIAl2YXIgYXJnID0gYXJnc1tpXTsKICAgICAgICAJaWYgKGFyZyA9PSB1bmRlZmluZWQgfHwgYXJnID09IG51bGwpCiAgICAgICAgICAgIAljb250aW51ZTsKICAgICAgICAJaWYgKHR5cGVvZihhcmcpID09ICdvYmplY3QnKQogICAgICAgICAgICAJZGljdCA9IGFyZzsKICAgICAgICAJZWxzZQogICAgICAgICAgICAJdXJpLnB1c2goZW5jb2RlVVJJQ29tcG9uZW50KGFyZykpOwogICAgCX0KICAgIAl2YXIgbmV4dCA9IGNhbGxiYWNrSWQgIT0gbnVsbCAgPyAgKCIvIiArIGNhbGxiYWNrSWQgKyAiLyIpIDogIi8iOwogICAgCXZhciB1cmwgPSAiZ2FwOi8vIiArIHNlcnZpY2UgKyBuZXh0ICsgdXJpLmpvaW4oIi8iKTsKCiAgICAJaWYgKGRpY3QgIT0gbnVsbCkgewogICAgICAgIAl1cmwgKz0gIj8iICsgZW5jb2RlVVJJQ29tcG9uZW50KEpTT04uc3RyaW5naWZ5KGRpY3QpKTsKICAgIAl9CgogICAgICAgIHRoaXMuZ2FwQnJpZGdlLnNyYyA9IHVybDsKICAgCiAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgY29uc29sZS5sb2coIlBob25lR2FwRXhlYyBFcnJvcjogIitlKTsKICAgIH0KICAgIAoKfTsKLyoqCiAqIENhbGxlZCBieSBuYXRpdmUgY29kZSB3aGVuIHJldHVybmluZyBzdWNjZXNzZnVsIHJlc3VsdCBmcm9tIGFuIGFjdGlvbi4KICoKICogQHBhcmFtIGNhbGxiYWNrSWQKICogQHBhcmFtIGFyZ3MKICoJCWFyZ3Muc3RhdHVzIC0gUGhvbmVHYXAuY2FsbGJhY2tTdGF0dXMKICoJCWFyZ3MubWVzc2FnZSAtIHJldHVybiB2YWx1ZQogKgkJYXJncy5rZWVwQ2FsbGJhY2sgLSAwIHRvIHJlbW92ZSBjYWxsYmFjaywgMSB0byBrZWVwIGNhbGxiYWNrIGluIFBob25lR2FwLmNhbGxiYWNrc1tdCiAqLwpQaG9uZUdhcC5jYWxsYmFja1N1Y2Nlc3MgPSBmdW5jdGlvbihjYWxsYmFja0lkLCBhcmdzKSB7CiAgICBpZiAoUGhvbmVHYXAuY2FsbGJhY2tzW2NhbGxiYWNrSWRdKSB7CgogICAgICAgIC8vIElmIHJlc3VsdCBpcyB0byBiZSBzZW50IHRvIGNhbGxiYWNrCiAgICAgICAgaWYgKGFyZ3Muc3RhdHVzID09IFBob25lR2FwLmNhbGxiYWNrU3RhdHVzLk9LKSB7CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICBpZiAoUGhvbmVHYXAuY2FsbGJhY2tzW2NhbGxiYWNrSWRdLnN1Y2Nlc3MpIHsKICAgICAgICAgICAgICAgCQlQaG9uZUdhcC5jYWxsYmFja3NbY2FsbGJhY2tJZF0uc3VjY2VzcyhhcmdzLm1lc3NhZ2UpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhdGNoIChlKSB7CiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygiRXJyb3IgaW4gc3VjY2VzcyBjYWxsYmFjazogIitjYWxsYmFja0lkKyIgPSAiK2UpOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgCiAgICAgICAgLy8gQ2xlYXIgY2FsbGJhY2sgaWYgbm90IGV4cGVjdGluZyBhbnkgbW9yZSByZXN1bHRzCiAgICAgICAgaWYgKCFhcmdzLmtlZXBDYWxsYmFjaykgewogICAgICAgICAgICBkZWxldGUgUGhvbmVHYXAuY2FsbGJhY2tzW2NhbGxiYWNrSWRdOwogICAgICAgIH0KICAgIH0KfTsKCi8qKgogKiBDYWxsZWQgYnkgbmF0aXZlIGNvZGUgd2hlbiByZXR1cm5pbmcgZXJyb3IgcmVzdWx0IGZyb20gYW4gYWN0aW9uLgogKgogKiBAcGFyYW0gY2FsbGJhY2tJZAogKiBAcGFyYW0gYXJncwogKi8KUGhvbmVHYXAuY2FsbGJhY2tFcnJvciA9IGZ1bmN0aW9uKGNhbGxiYWNrSWQsIGFyZ3MpIHsKICAgIGlmIChQaG9uZUdhcC5jYWxsYmFja3NbY2FsbGJhY2tJZF0pIHsKICAgICAgICB0cnkgewogICAgICAgICAgICBpZiAoUGhvbmVHYXAuY2FsbGJhY2tzW2NhbGxiYWNrSWRdLmZhaWwpIHsKICAgICAgICAgICAgICAgIFBob25lR2FwLmNhbGxiYWNrc1tjYWxsYmFja0lkXS5mYWlsKGFyZ3MubWVzc2FnZSk7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgY2F0Y2ggKGUpIHsKICAgICAgICAgICAgY29uc29sZS5sb2coIkVycm9yIGluIGVycm9yIGNhbGxiYWNrOiAiK2NhbGxiYWNrSWQrIiA9ICIrZSk7CiAgICAgICAgfQogICAgICAgIAogICAgICAgIC8vIENsZWFyIGNhbGxiYWNrIGlmIG5vdCBleHBlY3RpbmcgYW55IG1vcmUgcmVzdWx0cwogICAgICAgIGlmICghYXJncy5rZWVwQ2FsbGJhY2spIHsKICAgICAgICAgICAgZGVsZXRlIFBob25lR2FwLmNhbGxiYWNrc1tjYWxsYmFja0lkXTsKICAgICAgICB9CiAgICB9Cn07CgoKLyoqCiAqIERvZXMgYSBkZWVwIGNsb25lIG9mIHRoZSBvYmplY3QuCiAqCiAqIEBwYXJhbSBvYmoKICogQHJldHVybgogKi8KUGhvbmVHYXAuY2xvbmUgPSBmdW5jdGlvbihvYmopIHsKCWlmKCFvYmopIHsgCgkJcmV0dXJuIG9iajsKCX0KCglpZihvYmogaW5zdGFuY2VvZiBBcnJheSl7CgkJdmFyIHJldFZhbCA9IG5ldyBBcnJheSgpOwoJCWZvcih2YXIgaSA9IDA7IGkgPCBvYmoubGVuZ3RoOyArK2kpewoJCQlyZXRWYWwucHVzaChQaG9uZUdhcC5jbG9uZShvYmpbaV0pKTsKCQl9CgkJcmV0dXJuIHJldFZhbDsKCX0KCglpZiAob2JqIGluc3RhbmNlb2YgRnVuY3Rpb24pIHsKCQlyZXR1cm4gb2JqOwoJfQoKCWlmKCEob2JqIGluc3RhbmNlb2YgT2JqZWN0KSl7CgkJcmV0dXJuIG9iajsKCX0KCQoJaWYgKG9iaiBpbnN0YW5jZW9mIERhdGUpIHsKCQlyZXR1cm4gb2JqOwoJfQoKCXJldFZhbCA9IG5ldyBPYmplY3QoKTsKCWZvcihpIGluIG9iail7CgkJaWYoIShpIGluIHJldFZhbCkgfHwgcmV0VmFsW2ldICE9IG9ialtpXSkgewoJCQlyZXRWYWxbaV0gPSBQaG9uZUdhcC5jbG9uZShvYmpbaV0pOwoJCX0KCX0KCXJldHVybiByZXRWYWw7Cn07CgovLyBJbnRlcmNlcHQgY2FsbHMgdG8gZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lciBhbmQgd2F0Y2ggZm9yIHVubG9hZAoKUGhvbmVHYXAubV9kb2N1bWVudF9hZGRFdmVudExpc3RlbmVyID0gZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcjsKCmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIgPSBmdW5jdGlvbihldnQsIGhhbmRsZXIsIGNhcHR1cmUpIHsKICAgIHZhciBlID0gZXZ0LnRvTG93ZXJDYXNlKCk7CiAgICBpZiAoZSA9PT0gJ3VubG9hZCcpIAoJewogICAgICAgIFBob25lR2FwLm9uVW5sb2FkID0gZnVuY3Rpb24oZSl7IHJldHVybiBoYW5kbGVyKGUpO307CiAgICB9ICAgICAKICAgIGVsc2UgCiAgICB7ICAgICAgICAKICAgICAgICBQaG9uZUdhcC5tX2RvY3VtZW50X2FkZEV2ZW50TGlzdGVuZXIuY2FsbChkb2N1bWVudCwgZXZ0LCBoYW5kbGVyLCBjYXB0dXJlKTsKICAgIH0KfTsKCi8vIEludGVyY2VwdCBjYWxscyB0byBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyIGFuZCB3YXRjaCBmb3IgZXZlbnRzIHRoYXQgCi8vIGFyZSBnZW5lcmF0ZWQgYnkgUGhvbmVHYXAgbmF0aXZlIGNvZGUKClBob25lR2FwLm1fZG9jdW1lbnRfcmVtb3ZlRXZlbnRMaXN0ZW5lciA9IGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXI7Cgpkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyID0gZnVuY3Rpb24oZXZ0LCBoYW5kbGVyLCBjYXB0dXJlKSAKewogICAgdmFyIGUgPSBldnQudG9Mb3dlckNhc2UoKTsKCiAgICBpZiAoZSA9PT0gJ3VubG9hZCcpIAoJewogICAgICAgIFBob25lR2FwLm9uVW5sb2FkID0gbnVsbDsKICAgIH0gCgogICAgUGhvbmVHYXAubV9kb2N1bWVudF9yZW1vdmVFdmVudExpc3RlbmVyLmNhbGwoZG9jdW1lbnQsIGV2dCwgaGFuZGxlciwgY2FwdHVyZSk7Cn07CgovKioKICogTWV0aG9kIHRvIGZpcmUgZXZlbnQgZnJvbSBuYXRpdmUgY29kZQogKi8KUGhvbmVHYXAuZmlyZUV2ZW50ID0gZnVuY3Rpb24odHlwZSkgewogICAgdmFyIGUgPSBkb2N1bWVudC5jcmVhdGVFdmVudCgnRXZlbnRzJyk7CiAgICBlLmluaXRFdmVudCh0eXBlKTsKICAgIGRvY3VtZW50LmRpc3BhdGNoRXZlbnQoZSk7Cn07Cgp9O2lmICghUGhvbmVHYXAuaGFzUmVzb3VyY2UoImRlYnVnY29uc29sZSIpKSB7CglQaG9uZUdhcC5hZGRSZXNvdXJjZSgiZGVidWdjb25zb2xlIik7CgkKLyoqCiAqIFRoaXMgY2xhc3MgcHJvdmlkZXMgYWNjZXNzIHRvIHRoZSBkZWJ1Z2dpbmcgY29uc29sZS4KICogQGNvbnN0cnVjdG9yCiAqLwpEZWJ1Z0NvbnNvbGUgPSBmdW5jdGlvbihpc0RlcHJlY2F0ZWQpIHsKICAgIHRoaXMubG9nTGV2ZWwgPSBEZWJ1Z0NvbnNvbGUuSU5GT19MRVZFTDsKICAgIHRoaXMuaXNEZXByZWNhdGVkID0gaXNEZXByZWNhdGVkID8gdHJ1ZSA6IGZhbHNlOwp9CgovLyBmcm9tIG1vc3QgdmVyYm9zZSwgdG8gbGVhc3QgdmVyYm9zZQpEZWJ1Z0NvbnNvbGUuQUxMX0xFVkVMICAgID0gMTsgLy8gc2FtZSBhcyBmaXJzdCBsZXZlbApEZWJ1Z0NvbnNvbGUuSU5GT19MRVZFTCAgID0gMTsKRGVidWdDb25zb2xlLldBUk5fTEVWRUwgICA9IDI7CkRlYnVnQ29uc29sZS5FUlJPUl9MRVZFTCAgPSA0OwpEZWJ1Z0NvbnNvbGUuTk9ORV9MRVZFTCAgID0gODsKCQkJCQkJCQkJCQkJCQpEZWJ1Z0NvbnNvbGUucHJvdG90eXBlLnNldExldmVsID0gZnVuY3Rpb24obGV2ZWwpIHsKICAgIHRoaXMubG9nTGV2ZWwgPSBsZXZlbDsKfTsKCi8qKgogKiBVdGlsaXR5IGZ1bmN0aW9uIGZvciByZW5kZXJpbmcgYW5kIGluZGVudGluZyBzdHJpbmdzLCBvciBzZXJpYWxpemluZwogKiBvYmplY3RzIHRvIGEgc3RyaW5nIGNhcGFibGUgb2YgYmVpbmcgcHJpbnRlZCB0byB0aGUgY29uc29sZS4KICogQHBhcmFtIHtPYmplY3R8U3RyaW5nfSBtZXNzYWdlIFRoZSBzdHJpbmcgb3Igb2JqZWN0IHRvIGNvbnZlcnQgdG8gYW4gaW5kZW50ZWQgc3RyaW5nCiAqIEBwcml2YXRlCiAqLwpEZWJ1Z0NvbnNvbGUucHJvdG90eXBlLnByb2Nlc3NNZXNzYWdlID0gZnVuY3Rpb24obWVzc2FnZSwgbWF4RGVwdGgpIHsKCWlmIChtYXhEZXB0aCA9PT0gdW5kZWZpbmVkKSBtYXhEZXB0aCA9IDA7CiAgICBpZiAodHlwZW9mKG1lc3NhZ2UpICE9ICdvYmplY3QnKSB7CiAgICAgICAgcmV0dXJuICh0aGlzLmlzRGVwcmVjYXRlZCA/ICJXQVJOSU5HOiBkZWJ1ZyBvYmplY3QgaXMgZGVwcmVjYXRlZCwgcGxlYXNlIHVzZSBjb25zb2xlIG9iamVjdCBcbiIgKyBtZXNzYWdlIDogbWVzc2FnZSk7CiAgICB9IGVsc2UgewogICAgICAgIC8qKgogICAgICAgICAqIEBmdW5jdGlvbgogICAgICAgICAqIEBpZ25vcmUKICAgICAgICAgKi8KICAgICAgICBmdW5jdGlvbiBpbmRlbnQoc3RyKSB7CiAgICAgICAgICAgIHJldHVybiBzdHIucmVwbGFjZSgvXi9tZywgIiAgICAiKTsKICAgICAgICB9CiAgICAgICAgLyoqCiAgICAgICAgICogQGZ1bmN0aW9uCiAgICAgICAgICogQGlnbm9yZQogICAgICAgICAqLwogICAgICAgIGZ1bmN0aW9uIG1ha2VTdHJ1Y3R1cmVkKG9iaiwgZGVwdGgpIHsKICAgICAgICAgICAgdmFyIHN0ciA9ICIiOwogICAgICAgICAgICBmb3IgKHZhciBpIGluIG9iaikgewogICAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mKG9ialtpXSkgPT0gJ29iamVjdCcgJiYgZGVwdGggPCBtYXhEZXB0aCkgewogICAgICAgICAgICAgICAgICAgICAgICBzdHIgKz0gaSArICI6XG4iICsgaW5kZW50KG1ha2VTdHJ1Y3R1cmVkKG9ialtpXSkpICsgIlxuIjsKICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICBzdHIgKz0gaSArICIgPSAiICsgaW5kZW50KFN0cmluZyhvYmpbaV0pKS5yZXBsYWNlKC9eICAgIC8sICIiKSArICJcbiI7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSBjYXRjaChlKSB7CiAgICAgICAgICAgICAgICAgICAgc3RyICs9IGkgKyAiID0gRVhDRVBUSU9OOiAiICsgZS5tZXNzYWdlICsgIlxuIjsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm4gc3RyOwogICAgICAgIH0KICAgICAgICAKICAgICAgICByZXR1cm4gKCh0aGlzLmlzRGVwcmVjYXRlZCA/ICJXQVJOSU5HOiBkZWJ1ZyBvYmplY3QgaXMgZGVwcmVjYXRlZCwgcGxlYXNlIHVzZSBjb25zb2xlIG9iamVjdFxuIiA6ICAiIikgKyAiT2JqZWN0OlxuIiArIG1ha2VTdHJ1Y3R1cmVkKG1lc3NhZ2UsIG1heERlcHRoKSk7CiAgICB9Cn07CgovKioKICogUHJpbnQgYSBub3JtYWwgbG9nIG1lc3NhZ2UgdG8gdGhlIGNvbnNvbGUKICogQHBhcmFtIHtPYmplY3R8U3RyaW5nfSBtZXNzYWdlIE1lc3NhZ2Ugb3Igb2JqZWN0IHRvIHByaW50IHRvIHRoZSBjb25zb2xlCiAqLwpEZWJ1Z0NvbnNvbGUucHJvdG90eXBlLmxvZyA9IGZ1bmN0aW9uKG1lc3NhZ2UsIG1heERlcHRoKSB7CiAgICBpZiAoUGhvbmVHYXAuYXZhaWxhYmxlICYmIHRoaXMubG9nTGV2ZWwgPD0gRGVidWdDb25zb2xlLklORk9fTEVWRUwpCiAgICAgICAgUGhvbmVHYXAuZXhlYygnRGVidWdDb25zb2xlLmxvZycsCiAgICAgICAgICAgIHRoaXMucHJvY2Vzc01lc3NhZ2UobWVzc2FnZSwgbWF4RGVwdGgpLAogICAgICAgICAgICB7IGxvZ0xldmVsOiAnSU5GTycgfQogICAgICAgICk7CiAgICBlbHNlCiAgICAgICAgY29uc29sZS5sb2cobWVzc2FnZSk7Cn07CgovKioKICogUHJpbnQgYSB3YXJuaW5nIG1lc3NhZ2UgdG8gdGhlIGNvbnNvbGUKICogQHBhcmFtIHtPYmplY3R8U3RyaW5nfSBtZXNzYWdlIE1lc3NhZ2Ugb3Igb2JqZWN0IHRvIHByaW50IHRvIHRoZSBjb25zb2xlCiAqLwpEZWJ1Z0NvbnNvbGUucHJvdG90eXBlLndhcm4gPSBmdW5jdGlvbihtZXNzYWdlLCBtYXhEZXB0aCkgewogICAgaWYgKFBob25lR2FwLmF2YWlsYWJsZSAmJiB0aGlzLmxvZ0xldmVsIDw9IERlYnVnQ29uc29sZS5XQVJOX0xFVkVMKQogICAgICAgIFBob25lR2FwLmV4ZWMoJ0RlYnVnQ29uc29sZS5sb2cnLAogICAgICAgICAgICB0aGlzLnByb2Nlc3NNZXNzYWdlKG1lc3NhZ2UsIG1heERlcHRoKSwKICAgICAgICAgICAgeyBsb2dMZXZlbDogJ1dBUk4nIH0KICAgICAgICApOwogICAgZWxzZQogICAgICAgIGNvbnNvbGUuZXJyb3IobWVzc2FnZSk7Cn07CgovKioKICogUHJpbnQgYW4gZXJyb3IgbWVzc2FnZSB0byB0aGUgY29uc29sZQogKiBAcGFyYW0ge09iamVjdHxTdHJpbmd9IG1lc3NhZ2UgTWVzc2FnZSBvciBvYmplY3QgdG8gcHJpbnQgdG8gdGhlIGNvbnNvbGUKICovCkRlYnVnQ29uc29sZS5wcm90b3R5cGUuZXJyb3IgPSBmdW5jdGlvbihtZXNzYWdlLCBtYXhEZXB0aCkgewogICAgaWYgKFBob25lR2FwLmF2YWlsYWJsZSAmJiB0aGlzLmxvZ0xldmVsIDw9IERlYnVnQ29uc29sZS5FUlJPUl9MRVZFTCkKICAgICAgICBQaG9uZUdhcC5leGVjKCdEZWJ1Z0NvbnNvbGUubG9nJywKICAgICAgICAgICAgdGhpcy5wcm9jZXNzTWVzc2FnZShtZXNzYWdlLCBtYXhEZXB0aCksCiAgICAgICAgICAgIHsgbG9nTGV2ZWw6ICdFUlJPUicgfQogICAgICAgICk7CiAgICBlbHNlCiAgICAgICAgY29uc29sZS5lcnJvcihtZXNzYWdlKTsKfTsKClBob25lR2FwLmFkZENvbnN0cnVjdG9yKGZ1bmN0aW9uKCkgewogICAgd2luZG93LmNvbnNvbGUgPSBuZXcgRGVidWdDb25zb2xlKCk7CiAgICB3aW5kb3cuZGVidWcgPSBuZXcgRGVidWdDb25zb2xlKHRydWUpOwp9KTsKfTsKaWYgKCFQaG9uZUdhcC5oYXNSZXNvdXJjZSgicG9zaXRpb24iKSkgewoJUGhvbmVHYXAuYWRkUmVzb3VyY2UoInBvc2l0aW9uIik7CgovKioKICogVGhpcyBjbGFzcyBjb250YWlucyBwb3NpdGlvbiBpbmZvcm1hdGlvbi4KICogQHBhcmFtIHtPYmplY3R9IGxhdAogKiBAcGFyYW0ge09iamVjdH0gbG5nCiAqIEBwYXJhbSB7T2JqZWN0fSBhY2MKICogQHBhcmFtIHtPYmplY3R9IGFsdAogKiBAcGFyYW0ge09iamVjdH0gYWx0QWNjCiAqIEBwYXJhbSB7T2JqZWN0fSBoZWFkCiAqIEBwYXJhbSB7T2JqZWN0fSB2ZWwKICogQGNvbnN0cnVjdG9yCiAqLwpQb3NpdGlvbiA9IGZ1bmN0aW9uKGNvb3JkcywgdGltZXN0YW1wKSB7Cgl0aGlzLmNvb3JkcyA9IENvb3JkaW5hdGVzLmNsb25lRnJvbShjb29yZHMpOwogICAgdGhpcy50aW1lc3RhbXAgPSB0aW1lc3RhbXAgfHwgbmV3IERhdGUoKS5nZXRUaW1lKCk7Cn07CgpQb3NpdGlvbi5wcm90b3R5cGUuZXF1YWxzID0gZnVuY3Rpb24ob3RoZXIpIHsKICAgIHJldHVybiAodGhpcy5jb29yZHMgJiYgb3RoZXIgJiYgb3RoZXIuY29vcmRzICYmCiAgICAgICAgICAgIHRoaXMuY29vcmRzLmxhdGl0dWRlID09IG90aGVyLmNvb3Jkcy5sYXRpdHVkZSAmJgogICAgICAgICAgICB0aGlzLmNvb3Jkcy5sb25naXR1ZGUgPT0gb3RoZXIuY29vcmRzLmxvbmdpdHVkZSk7Cn07CgpQb3NpdGlvbi5wcm90b3R5cGUuY2xvbmUgPSBmdW5jdGlvbigpCnsKICAgIHJldHVybiBuZXcgUG9zaXRpb24oCiAgICAgICAgdGhpcy5jb29yZHM/IHRoaXMuY29vcmRzLmNsb25lKCkgOiBudWxsLAogICAgICAgIHRoaXMudGltZXN0YW1wPyB0aGlzLnRpbWVzdGFtcCA6IG5ldyBEYXRlKCkuZ2V0VGltZSgpCiAgICApOwp9CgpDb29yZGluYXRlcyA9IGZ1bmN0aW9uKGxhdCwgbG5nLCBhbHQsIGFjYywgaGVhZCwgdmVsLCBhbHRBY2MpIHsKCS8qKgoJICogVGhlIGxhdGl0dWRlIG9mIHRoZSBwb3NpdGlvbi4KCSAqLwoJdGhpcy5sYXRpdHVkZSA9IGxhdDsKCS8qKgoJICogVGhlIGxvbmdpdHVkZSBvZiB0aGUgcG9zaXRpb24sCgkgKi8KCXRoaXMubG9uZ2l0dWRlID0gbG5nOwoJLyoqCgkgKiBUaGUgYWx0aXR1ZGUgb2YgdGhlIHBvc2l0aW9uLgoJICovCgl0aGlzLmFsdGl0dWRlID0gYWx0OwoJLyoqCgkgKiBUaGUgYWNjdXJhY3kgb2YgdGhlIHBvc2l0aW9uLgoJICovCgl0aGlzLmFjY3VyYWN5ID0gYWNjOwoJLyoqCgkgKiBUaGUgZGlyZWN0aW9uIHRoZSBkZXZpY2UgaXMgbW92aW5nIGF0IHRoZSBwb3NpdGlvbi4KCSAqLwoJdGhpcy5oZWFkaW5nID0gaGVhZDsKCS8qKgoJICogVGhlIHZlbG9jaXR5IHdpdGggd2hpY2ggdGhlIGRldmljZSBpcyBtb3ZpbmcgYXQgdGhlIHBvc2l0aW9uLgoJICovCgl0aGlzLnNwZWVkID0gdmVsOwoJLyoqCgkgKiBUaGUgYWx0aXR1ZGUgYWNjdXJhY3kgb2YgdGhlIHBvc2l0aW9uLgoJICovCgl0aGlzLmFsdGl0dWRlQWNjdXJhY3kgPSAoYWx0QWNjICE9ICd1bmRlZmluZWQnKSA/IGFsdEFjYyA6IG51bGw7IAp9OwoKQ29vcmRpbmF0ZXMucHJvdG90eXBlLmNsb25lID0gZnVuY3Rpb24oKQp7CiAgICByZXR1cm4gbmV3IENvb3JkaW5hdGVzKAogICAgICAgIHRoaXMubGF0aXR1ZGUsCiAgICAgICAgdGhpcy5sb25naXR1ZGUsCiAgICAgICAgdGhpcy5hbHRpdHVkZSwKICAgICAgICB0aGlzLmFjY3VyYWN5LAogICAgICAgIHRoaXMuaGVhZGluZywKICAgICAgICB0aGlzLnNwZWVkLAogICAgICAgIHRoaXMuYWx0aXR1ZGVBY2N1cmFjeQogICAgKTsKfTsKCkNvb3JkaW5hdGVzLmNsb25lRnJvbSA9IGZ1bmN0aW9uKG9iaikKewogICAgcmV0dXJuIG5ldyBDb29yZGluYXRlcygKICAgICAgICBvYmoubGF0aXR1ZGUsCiAgICAgICAgb2JqLmxvbmdpdHVkZSwKICAgICAgICBvYmouYWx0aXR1ZGUsCiAgICAgICAgb2JqLmFjY3VyYWN5LAogICAgICAgIG9iai5oZWFkaW5nLAogICAgICAgIG9iai5zcGVlZCwKICAgICAgICBvYmouYWx0aXR1ZGVBY2N1cmFjeQogICAgKTsKfTsKCi8qKgogKiBUaGlzIGNsYXNzIHNwZWNpZmllcyB0aGUgb3B0aW9ucyBmb3IgcmVxdWVzdGluZyBwb3NpdGlvbiBkYXRhLgogKiBAY29uc3RydWN0b3IKICovClBvc2l0aW9uT3B0aW9ucyA9IGZ1bmN0aW9uKGVuYWJsZUhpZ2hBY2N1cmFjeSwgdGltZW91dCwgbWF4aW11bUFnZSkgewoJLyoqCgkgKiBTcGVjaWZpZXMgdGhlIGRlc2lyZWQgcG9zaXRpb24gYWNjdXJhY3kuCgkgKi8KCXRoaXMuZW5hYmxlSGlnaEFjY3VyYWN5ID0gZW5hYmxlSGlnaEFjY3VyYWN5IHx8IGZhbHNlOwoJLyoqCgkgKiBUaGUgdGltZW91dCBhZnRlciB3aGljaCBpZiBwb3NpdGlvbiBkYXRhIGNhbm5vdCBiZSBvYnRhaW5lZCB0aGUgZXJyb3JDYWxsYmFjawoJICogaXMgY2FsbGVkLgoJICovCgl0aGlzLnRpbWVvdXQgPSB0aW1lb3V0IHx8IDEwMDAwOwoJLyoqCiAgICAgKiBUaGUgYWdlIG9mIGEgY2FjaGVkIHBvc2l0aW9uIHdob3NlIGFnZSBpcyBubyBncmVhdGVyIHRoYW4gdGhlIHNwZWNpZmllZCB0aW1lIAogICAgICogaW4gbWlsbGlzZWNvbmRzLiAKICAgICAqLwoJdGhpcy5tYXhpbXVtQWdlID0gbWF4aW11bUFnZSB8fCAwOwp9OwoKLyoqCiAqIFRoaXMgY2xhc3MgY29udGFpbnMgaW5mb3JtYXRpb24gYWJvdXQgYW55IEdQUyBlcnJvcnMuCiAqIEBjb25zdHJ1Y3RvcgogKi8KUG9zaXRpb25FcnJvciA9IGZ1bmN0aW9uKGNvZGUsIG1lc3NhZ2UpIHsKCXRoaXMuY29kZSA9IGNvZGUgfHwgMDsKCXRoaXMubWVzc2FnZSA9IG1lc3NhZ2UgfHwgIiI7Cn07CgpQb3NpdGlvbkVycm9yLlVOS05PV05fRVJST1IgPSAwOwpQb3NpdGlvbkVycm9yLlBFUk1JU1NJT05fREVOSUVEID0gMTsKUG9zaXRpb25FcnJvci5QT1NJVElPTl9VTkFWQUlMQUJMRSA9IDI7ClBvc2l0aW9uRXJyb3IuVElNRU9VVCA9IDM7Cgp9O2lmICghUGhvbmVHYXAuaGFzUmVzb3VyY2UoImFjY2VsZXJhdGlvbiIpKSB7CglQaG9uZUdhcC5hZGRSZXNvdXJjZSgiYWNjZWxlcmF0aW9uIik7CiAJCgovKioKICogVGhpcyBjbGFzcyBjb250YWlucyBhY2NlbGVyYXRpb24gaW5mb3JtYXRpb24KICogQGNvbnN0cnVjdG9yCiAqIEBwYXJhbSB7TnVtYmVyfSB4IFRoZSBmb3JjZSBhcHBsaWVkIGJ5IHRoZSBkZXZpY2UgaW4gdGhlIHgtYXhpcy4KICogQHBhcmFtIHtOdW1iZXJ9IHkgVGhlIGZvcmNlIGFwcGxpZWQgYnkgdGhlIGRldmljZSBpbiB0aGUgeS1heGlzLgogKiBAcGFyYW0ge051bWJlcn0geiBUaGUgZm9yY2UgYXBwbGllZCBieSB0aGUgZGV2aWNlIGluIHRoZSB6LWF4aXMuCiAqLwpBY2NlbGVyYXRpb24gPSBmdW5jdGlvbih4LCB5LCB6KSB7CgkvKioKCSAqIFRoZSBmb3JjZSBhcHBsaWVkIGJ5IHRoZSBkZXZpY2UgaW4gdGhlIHgtYXhpcy4KCSAqLwoJdGhpcy54ID0geDsKCS8qKgoJICogVGhlIGZvcmNlIGFwcGxpZWQgYnkgdGhlIGRldmljZSBpbiB0aGUgeS1heGlzLgoJICovCgl0aGlzLnkgPSB5OwoJLyoqCgkgKiBUaGUgZm9yY2UgYXBwbGllZCBieSB0aGUgZGV2aWNlIGluIHRoZSB6LWF4aXMuCgkgKi8KCXRoaXMueiA9IHo7CgkvKioKCSAqIFRoZSB0aW1lIHRoYXQgdGhlIGFjY2VsZXJhdGlvbiB3YXMgb2J0YWluZWQuCgkgKi8KCXRoaXMudGltZXN0YW1wID0gbmV3IERhdGUoKS5nZXRUaW1lKCk7Cn0KCi8qKgogKiBUaGlzIGNsYXNzIHNwZWNpZmllcyB0aGUgb3B0aW9ucyBmb3IgcmVxdWVzdGluZyBhY2NlbGVyYXRpb24gZGF0YS4KICogQGNvbnN0cnVjdG9yCiAqLwpBY2NlbGVyYXRpb25PcHRpb25zID0gZnVuY3Rpb24oKSB7CgkvKioKCSAqIFRoZSB0aW1lb3V0IGFmdGVyIHdoaWNoIGlmIGFjY2VsZXJhdGlvbiBkYXRhIGNhbm5vdCBiZSBvYnRhaW5lZCB0aGUgZXJyb3JDYWxsYmFjawoJICogaXMgY2FsbGVkLgoJICovCgl0aGlzLnRpbWVvdXQgPSAxMDAwMDsKfQp9O2lmICghUGhvbmVHYXAuaGFzUmVzb3VyY2UoImFjY2VsZXJvbWV0ZXIiKSkgewoJUGhvbmVHYXAuYWRkUmVzb3VyY2UoImFjY2VsZXJvbWV0ZXIiKTsKCi8qKgogKiBUaGlzIGNsYXNzIHByb3ZpZGVzIGFjY2VzcyB0byBkZXZpY2UgYWNjZWxlcm9tZXRlciBkYXRhLgogKiBAY29uc3RydWN0b3IKICovCkFjY2VsZXJvbWV0ZXIgPSBmdW5jdGlvbigpIAp7CgkvKioKCSAqIFRoZSBsYXN0IGtub3duIGFjY2VsZXJhdGlvbi4KCSAqLwoJdGhpcy5sYXN0QWNjZWxlcmF0aW9uID0gbmV3IEFjY2VsZXJhdGlvbigwLDAsMCk7Cn0KCi8qKgogKiBBc3luY2hyb25vdXNseSBhcXVpcmVzIHRoZSBjdXJyZW50IGFjY2VsZXJhdGlvbi4KICogQHBhcmFtIHtGdW5jdGlvbn0gc3VjY2Vzc0NhbGxiYWNrIFRoZSBmdW5jdGlvbiB0byBjYWxsIHdoZW4gdGhlIGFjY2VsZXJhdGlvbgogKiBkYXRhIGlzIGF2YWlsYWJsZQogKiBAcGFyYW0ge0Z1bmN0aW9ufSBlcnJvckNhbGxiYWNrIFRoZSBmdW5jdGlvbiB0byBjYWxsIHdoZW4gdGhlcmUgaXMgYW4gZXJyb3IgCiAqIGdldHRpbmcgdGhlIGFjY2VsZXJhdGlvbiBkYXRhLgogKiBAcGFyYW0ge0FjY2VsZXJhdGlvbk9wdGlvbnN9IG9wdGlvbnMgVGhlIG9wdGlvbnMgZm9yIGdldHRpbmcgdGhlIGFjY2VsZXJvbWV0ZXIgZGF0YQogKiBzdWNoIGFzIHRpbWVvdXQuCiAqLwpBY2NlbGVyb21ldGVyLnByb3RvdHlwZS5nZXRDdXJyZW50QWNjZWxlcmF0aW9uID0gZnVuY3Rpb24oc3VjY2Vzc0NhbGxiYWNrLCBlcnJvckNhbGxiYWNrLCBvcHRpb25zKSB7CgkvLyBJZiB0aGUgYWNjZWxlcmF0aW9uIGlzIGF2YWlsYWJsZSB0aGVuIGNhbGwgc3VjY2VzcwoJLy8gSWYgdGhlIGFjY2VsZXJhdGlvbiBpcyBub3QgYXZhaWxhYmxlIHRoZW4gY2FsbCBlcnJvcgoJCgkvLyBDcmVhdGVkIGZvciBpUGhvbmUsIElwaG9uZSBwYXNzZXMgYmFjayBfYWNjZWwgb2JqIGxpdHRlcmFsCglpZiAodHlwZW9mIHN1Y2Nlc3NDYWxsYmFjayA9PSAiZnVuY3Rpb24iKSB7CgkJc3VjY2Vzc0NhbGxiYWNrKHRoaXMubGFzdEFjY2VsZXJhdGlvbik7Cgl9Cn07CgovLyBwcml2YXRlIGNhbGxiYWNrIGNhbGxlZCBmcm9tIE9iai1DIGJ5IG5hbWUKQWNjZWxlcm9tZXRlci5wcm90b3R5cGUuX29uQWNjZWxVcGRhdGUgPSBmdW5jdGlvbih4LHkseikKewogICB0aGlzLmxhc3RBY2NlbGVyYXRpb24gPSBuZXcgQWNjZWxlcmF0aW9uKHgseSx6KTsKfTsKCi8qKgogKiBBc3luY2hyb25vdXNseSBhcXVpcmVzIHRoZSBhY2NlbGVyYXRpb24gcmVwZWF0ZWRseSBhdCBhIGdpdmVuIGludGVydmFsLgogKiBAcGFyYW0ge0Z1bmN0aW9ufSBzdWNjZXNzQ2FsbGJhY2sgVGhlIGZ1bmN0aW9uIHRvIGNhbGwgZWFjaCB0aW1lIHRoZSBhY2NlbGVyYXRpb24KICogZGF0YSBpcyBhdmFpbGFibGUKICogQHBhcmFtIHtGdW5jdGlvbn0gZXJyb3JDYWxsYmFjayBUaGUgZnVuY3Rpb24gdG8gY2FsbCB3aGVuIHRoZXJlIGlzIGFuIGVycm9yIAogKiBnZXR0aW5nIHRoZSBhY2NlbGVyYXRpb24gZGF0YS4KICogQHBhcmFtIHtBY2NlbGVyYXRpb25PcHRpb25zfSBvcHRpb25zIFRoZSBvcHRpb25zIGZvciBnZXR0aW5nIHRoZSBhY2NlbGVyb21ldGVyIGRhdGEKICogc3VjaCBhcyB0aW1lb3V0LgogKi8KCkFjY2VsZXJvbWV0ZXIucHJvdG90eXBlLndhdGNoQWNjZWxlcmF0aW9uID0gZnVuY3Rpb24oc3VjY2Vzc0NhbGxiYWNrLCBlcnJvckNhbGxiYWNrLCBvcHRpb25zKSB7CgkvL3RoaXMuZ2V0Q3VycmVudEFjY2VsZXJhdGlvbihzdWNjZXNzQ2FsbGJhY2ssIGVycm9yQ2FsbGJhY2ssIG9wdGlvbnMpOwoJLy8gVE9ETzogYWRkIHRoZSBpbnRlcnZhbCBpZCB0byBhIGxpc3Qgc28gd2UgY2FuIGNsZWFyIGFsbCB3YXRjaGVzCiAJdmFyIGZyZXF1ZW5jeSA9IChvcHRpb25zICE9IHVuZGVmaW5lZCAmJiBvcHRpb25zLmZyZXF1ZW5jeSAhPSB1bmRlZmluZWQpID8gb3B0aW9ucy5mcmVxdWVuY3kgOiAxMDAwMDsKCXZhciB1cGRhdGVkT3B0aW9ucyA9IHsKCQlkZXNpcmVkRnJlcXVlbmN5OmZyZXF1ZW5jeSAKCX0KCVBob25lR2FwLmV4ZWMoIkFjY2VsZXJvbWV0ZXIuc3RhcnQiLG9wdGlvbnMpOwoKCXJldHVybiBzZXRJbnRlcnZhbChmdW5jdGlvbigpIHsKCQluYXZpZ2F0b3IuYWNjZWxlcm9tZXRlci5nZXRDdXJyZW50QWNjZWxlcmF0aW9uKHN1Y2Nlc3NDYWxsYmFjaywgZXJyb3JDYWxsYmFjaywgb3B0aW9ucyk7Cgl9LCBmcmVxdWVuY3kpOwp9OwoKLyoqCiAqIENsZWFycyB0aGUgc3BlY2lmaWVkIGFjY2VsZXJvbWV0ZXIgd2F0Y2guCiAqIEBwYXJhbSB7U3RyaW5nfSB3YXRjaElkIFRoZSBJRCBvZiB0aGUgd2F0Y2ggcmV0dXJuZWQgZnJvbSAjd2F0Y2hBY2NlbGVyYXRpb24uCiAqLwpBY2NlbGVyb21ldGVyLnByb3RvdHlwZS5jbGVhcldhdGNoID0gZnVuY3Rpb24od2F0Y2hJZCkgewoJUGhvbmVHYXAuZXhlYygiQWNjZWxlcm9tZXRlci5zdG9wIik7CgljbGVhckludGVydmFsKHdhdGNoSWQpOwp9OwoKUGhvbmVHYXAuYWRkQ29uc3RydWN0b3IoZnVuY3Rpb24oKSB7CiAgICBpZiAodHlwZW9mIG5hdmlnYXRvci5hY2NlbGVyb21ldGVyID09ICJ1bmRlZmluZWQiKSBuYXZpZ2F0b3IuYWNjZWxlcm9tZXRlciA9IG5ldyBBY2NlbGVyb21ldGVyKCk7Cn0pOwp9O2lmICghUGhvbmVHYXAuaGFzUmVzb3VyY2UoImNhbWVyYSIpKSB7CglQaG9uZUdhcC5hZGRSZXNvdXJjZSgiY2FtZXJhIik7CgkKLy8gYWRkaW5nIGluIHByZXBhcmF0aW9uIHRvIHN3aXRjaCB0byBNZWRpYSBjYXB0dXJlIEFQSQpDYXB0dXJlRXJyb3IgPSBmdW5jdGlvbigpIHsKICAgdGhpcy5jb2RlID0gbnVsbDsKfQoKLy8gY2FwdHVyZSBlcnJvciBjb2RlcwpDYXB0dXJlRXJyb3IuQ0FQVFVSRV9JTlRFUk5BTF9FUlIgPSAwOwpDYXB0dXJlRXJyb3IuQ0FQVFVSRV9BUFBMSUNBVElPTl9CVVNZID0gMTsKQ2FwdHVyZUVycm9yLkNBUFRVUkVfSU5WQUxJRF9BUkdVTUVOVCA9IDI7CkNhcHR1cmVFcnJvci5DQVBUVVJFX05PX01FRElBX0ZJTEVTID0gMzsKCi8qKgogKiBUaGlzIGNsYXNzIHByb3ZpZGVzIGFjY2VzcyB0byB0aGUgZGV2aWNlIGNhbWVyYS4KICogQGNvbnN0cnVjdG9yCiAqLwpDYW1lcmEgPSBmdW5jdGlvbigpIHsKCQp9CgovKioKICogRm9ybWF0IG9mIGltYWdlIHRoYXQgcmV0dXJuZWQgZnJvbSBnZXRQaWN0dXJlLgogKgogKiBFeGFtcGxlOiBuYXZpZ2F0b3IuY2FtZXJhLmdldFBpY3R1cmUoc3VjY2VzcywgZmFpbCwKICogICAgICAgICAgICAgIHsgcXVhbGl0eTogODAsCiAqICAgICAgICAgICAgICAgIGRlc3RpbmF0aW9uVHlwZTogQ2FtZXJhLkRlc3RpbmF0aW9uVHlwZS5EQVRBX1VSTCwKICogICAgICAgICAgICAgICAgc291cmNlVHlwZTogQ2FtZXJhLlBpY3R1cmVTb3VyY2VUeXBlLlBIT1RPTElCUkFSWX0pCiAqLwpDYW1lcmEuRGVzdGluYXRpb25UeXBlID0gewogICAgREFUQV9VUkw6IDAsICAgICAgICAgICAgICAgIC8vIFJldHVybiBiYXNlNjQgZW5jb2RlZCBzdHJpbmcKICAgIEZJTEVfVVJJOiAxICAgICAgICAgICAgICAgICAvLyBSZXR1cm4gZmlsZSB1cmkgKGNvbnRlbnQ6Ly9tZWRpYS9leHRlcm5hbC9pbWFnZXMvbWVkaWEvMiBmb3IgQW5kcm9pZCkKfTsKQ2FtZXJhLnByb3RvdHlwZS5EZXN0aW5hdGlvblR5cGUgPSBDYW1lcmEuRGVzdGluYXRpb25UeXBlOwoKLyoqCiAqIFNvdXJjZSB0byBnZXRQaWN0dXJlIGZyb20uCiAqCiAqIEV4YW1wbGU6IG5hdmlnYXRvci5jYW1lcmEuZ2V0UGljdHVyZShzdWNjZXNzLCBmYWlsLAogKiAgICAgICAgICAgICAgeyBxdWFsaXR5OiA4MCwKICogICAgICAgICAgICAgICAgZGVzdGluYXRpb25UeXBlOiBDYW1lcmEuRGVzdGluYXRpb25UeXBlLkRBVEFfVVJMLAogKiAgICAgICAgICAgICAgICBzb3VyY2VUeXBlOiBDYW1lcmEuUGljdHVyZVNvdXJjZVR5cGUuUEhPVE9MSUJSQVJZfSkKICovCkNhbWVyYS5QaWN0dXJlU291cmNlVHlwZSA9IHsKICAgIFBIT1RPTElCUkFSWSA6IDAsICAgICAgICAgICAvLyBDaG9vc2UgaW1hZ2UgZnJvbSBwaWN0dXJlIGxpYnJhcnkgCiAgICBDQU1FUkEgOiAxLCAgICAgICAgICAgICAgICAgLy8gVGFrZSBwaWN0dXJlIGZyb20gY2FtZXJhCiAgICBTQVZFRFBIT1RPQUxCVU0gOiAyICAgICAgICAgLy8gQ2hvb3NlIGltYWdlIGZyb20gcGljdHVyZSBsaWJyYXJ5IAp9OwpDYW1lcmEucHJvdG90eXBlLlBpY3R1cmVTb3VyY2VUeXBlID0gQ2FtZXJhLlBpY3R1cmVTb3VyY2VUeXBlOwoKLyoqCiAqIEdldHMgYSBwaWN0dXJlIGZyb20gc291cmNlIGRlZmluZWQgYnkgIm9wdGlvbnMuc291cmNlVHlwZSIsIGFuZCByZXR1cm5zIHRoZQogKiBpbWFnZSBhcyBkZWZpbmVkIGJ5IHRoZSAib3B0aW9ucy5kZXN0aW5hdGlvblR5cGUiIG9wdGlvbi4KCiAqIFRoZSBkZWZhdWx0cyBhcmUgc291cmNlVHlwZT1DQU1FUkEgYW5kIGRlc3RpbmF0aW9uVHlwZT1EQVRBX1VSTC4KICoKICogQHBhcmFtIHtGdW5jdGlvbn0gc3VjY2Vzc0NhbGxiYWNrCiAqIEBwYXJhbSB7RnVuY3Rpb259IGVycm9yQ2FsbGJhY2sKICogQHBhcmFtIHtPYmplY3R9IG9wdGlvbnMKICovCkNhbWVyYS5wcm90b3R5cGUuZ2V0UGljdHVyZSA9IGZ1bmN0aW9uKHN1Y2Nlc3NDYWxsYmFjaywgZXJyb3JDYWxsYmFjaywgb3B0aW9ucykgewoJLy8gc3VjY2Vzc0NhbGxiYWNrIHJlcXVpcmVkCglpZiAodHlwZW9mIHN1Y2Nlc3NDYWxsYmFjayAhPSAiZnVuY3Rpb24iKSB7CiAgICAgICAgY29uc29sZS5sb2coIkNhbWVyYSBFcnJvcjogc3VjY2Vzc0NhbGxiYWNrIGlzIG5vdCBhIGZ1bmN0aW9uIik7CiAgICAgICAgcmV0dXJuOwogICAgfQoKICAgIC8vIGVycm9yQ2FsbGJhY2sgb3B0aW9uYWwKICAgIGlmIChlcnJvckNhbGxiYWNrICYmICh0eXBlb2YgZXJyb3JDYWxsYmFjayAhPSAiZnVuY3Rpb24iKSkgewogICAgICAgIGNvbnNvbGUubG9nKCJDYW1lcmEgRXJyb3I6IGVycm9yQ2FsbGJhY2sgaXMgbm90IGEgZnVuY3Rpb24iKTsKICAgICAgICByZXR1cm47CiAgICB9CgkKCVBob25lR2FwLmV4ZWMoc3VjY2Vzc0NhbGxiYWNrLCBlcnJvckNhbGxiYWNrLCAiQ2FtZXJhIiwiZ2V0UGljdHVyZSIsW29wdGlvbnNdKTsKfTsKCgoKUGhvbmVHYXAuYWRkQ29uc3RydWN0b3IoZnVuY3Rpb24oKSB7CiAgICBpZiAodHlwZW9mIG5hdmlnYXRvci5jYW1lcmEgPT0gInVuZGVmaW5lZCIpIG5hdmlnYXRvci5jYW1lcmEgPSBuZXcgQ2FtZXJhKCk7Cn0pOwp9OwppZiAoIVBob25lR2FwLmhhc1Jlc291cmNlKCJjb250YWN0IikpIHsKCVBob25lR2FwLmFkZFJlc291cmNlKCJjb250YWN0Iik7CgoKLyoqCiogQ29udGFpbnMgaW5mb3JtYXRpb24gYWJvdXQgYSBzaW5nbGUgY29udGFjdC4KKiBAcGFyYW0ge0RPTVN0cmluZ30gaWQgdW5pcXVlIGlkZW50aWZpZXIKKiBAcGFyYW0ge0RPTVN0cmluZ30gZGlzcGxheU5hbWUKKiBAcGFyYW0ge0NvbnRhY3ROYW1lfSBuYW1lCiogQHBhcmFtIHtET01TdHJpbmd9IG5pY2tuYW1lCiogQHBhcmFtIHtDb250YWN0RmllbGRbXX0gcGhvbmVOdW1iZXJzIGFycmF5IG9mIHBob25lIG51bWJlcnMKKiBAcGFyYW0ge0NvbnRhY3RGaWVsZFtdfSBlbWFpbHMgYXJyYXkgb2YgZW1haWwgYWRkcmVzc2VzCiogQHBhcmFtIHtDb250YWN0QWRkcmVzc1tdfSBhZGRyZXNzZXMgYXJyYXkgb2YgYWRkcmVzc2VzCiogQHBhcmFtIHtDb250YWN0RmllbGRbXX0gaW1zIGluc3RhbnQgbWVzc2FnaW5nIHVzZXIgaWRzCiogQHBhcmFtIHtDb250YWN0T3JnYW5pemF0aW9uW119IG9yZ2FuaXphdGlvbnMKKiBAcGFyYW0ge0RPTVN0cmluZ30gcmV2aXNpb24gZGF0ZSBjb250YWN0IHdhcyBsYXN0IHVwZGF0ZWQKKiBAcGFyYW0ge0RPTVN0cmluZ30gYmlydGhkYXkgY29udGFjdCdzIGJpcnRoZGF5CiogQHBhcmFtIHtET01TdHJpbmd9IGdlbmRlciBjb250YWN0J3MgZ2VuZGVyCiogQHBhcmFtIHtET01TdHJpbmd9IG5vdGUgdXNlciBub3RlcyBhYm91dCBjb250YWN0CiogQHBhcmFtIHtDb250YWN0RmllbGRbXX0gcGhvdG9zCiogQHBhcmFtIHtDb250YWN0RmllbGRbXX0gdXJscyBjb250YWN0J3Mgd2ViIHNpdGVzCiogQHBhcmFtIHtET01TdHJpbmd9IHRpbWV6b25lIFVUQyB0aW1lIHpvbmUgb2Zmc2V0CiovCnZhciBDb250YWN0ID0gZnVuY3Rpb24oaWQsIGRpc3BsYXlOYW1lLCBuYW1lLCBuaWNrbmFtZSwgcGhvbmVOdW1iZXJzLCBlbWFpbHMsIGFkZHJlc3NlcywKICAgIGltcywgb3JnYW5pemF0aW9ucywgcmV2aXNpb24sIGJpcnRoZGF5LCBnZW5kZXIsIG5vdGUsIHBob3RvcywgY2F0ZWdvcmllcywgdXJscywgdGltZXpvbmUpIHsKICAgIHRoaXMuaWQgPSBpZCB8fCBudWxsOwogICAgdGhpcy5kaXNwbGF5TmFtZSA9IGRpc3BsYXlOYW1lIHx8IG51bGw7CiAgICB0aGlzLm5hbWUgPSBuYW1lIHx8IG51bGw7IC8vIENvbnRhY3ROYW1lCiAgICB0aGlzLm5pY2tuYW1lID0gbmlja25hbWUgfHwgbnVsbDsKICAgIHRoaXMucGhvbmVOdW1iZXJzID0gcGhvbmVOdW1iZXJzIHx8IG51bGw7IC8vIENvbnRhY3RGaWVsZFtdCiAgICB0aGlzLmVtYWlscyA9IGVtYWlscyB8fCBudWxsOyAvLyBDb250YWN0RmllbGRbXQogICAgdGhpcy5hZGRyZXNzZXMgPSBhZGRyZXNzZXMgfHwgbnVsbDsgLy8gQ29udGFjdEFkZHJlc3NbXQogICAgdGhpcy5pbXMgPSBpbXMgfHwgbnVsbDsgLy8gQ29udGFjdEZpZWxkW10KICAgIHRoaXMub3JnYW5pemF0aW9ucyA9IG9yZ2FuaXphdGlvbnMgfHwgbnVsbDsgLy8gQ29udGFjdE9yZ2FuaXphdGlvbltdCiAgICB0aGlzLnJldmlzaW9uID0gcmV2aXNpb24gfHwgbnVsbDsgLy8gSlMgRGF0ZQogICAgdGhpcy5iaXJ0aGRheSA9IGJpcnRoZGF5IHx8IG51bGw7IC8vIEpTIERhdGUKICAgIHRoaXMuZ2VuZGVyID0gZ2VuZGVyIHx8IG51bGw7CiAgICB0aGlzLm5vdGUgPSBub3RlIHx8IG51bGw7CiAgICB0aGlzLnBob3RvcyA9IHBob3RvcyB8fCBudWxsOyAvLyBDb250YWN0RmllbGRbXQogICAgdGhpcy5jYXRlZ29yaWVzID0gY2F0ZWdvcmllcyB8fCBudWxsOyAKICAgIHRoaXMudXJscyA9IHVybHMgfHwgbnVsbDsgLy8gQ29udGFjdEZpZWxkW10KICAgIHRoaXMudGltZXpvbmUgPSB0aW1lem9uZSB8fCBudWxsOwp9OwoKLyoqCiogQ29udmVydHMgRGF0ZXMgdG8gbWlsbGlzZWNvbmRzIGJlZm9yZSBzZW5kaW5nIHRvIGlPUwoqLwpDb250YWN0LnByb3RvdHlwZS5jb252ZXJ0RGF0ZXNPdXQgPSBmdW5jdGlvbigpCnsKCXZhciBkYXRlcyA9IG5ldyBBcnJheSgicmV2aXNpb24iLCAiYmlydGhkYXkiKTsKCWZvciAodmFyIGk9MDsgaTxkYXRlcy5sZW5ndGg7IGkrKyl7CgkJdmFyIHZhbHVlID0gdGhpc1tkYXRlc1tpXV07CgkJaWYgKHZhbHVlKXsKCQkJaWYgKCF2YWx1ZSBpbnN0YW5jZW9mIERhdGUpewoJCQkJdHJ5IHsKCQkJCQl2YWx1ZSA9IG5ldyBEYXRlKHZhbHVlKTsKCQkJCX0gY2F0Y2goZXhjZXB0aW9uKXsKCQkJCQl2YWx1ZSA9IG51bGw7CgkJCQl9CgkJCX0KCQkJaWYgKHZhbHVlIGluc3RhbmNlb2YgRGF0ZSl7CgkJCQl2YWx1ZSA9IHZhbHVlLnZhbHVlT2YoKTsKCQkJfQoJCQl0aGlzW2RhdGVzW2ldXSA9IHZhbHVlOwoJCX0KCX0KCQp9OwovKioKKiBDb252ZXJ0cyBtaWxsaXNlY29uZHMgdG8gSlMgRGF0ZSB3aGVuIHJldHVybmluZyBmcm9tIGlPUwoqLwpDb250YWN0LnByb3RvdHlwZS5jb252ZXJ0RGF0ZXNJbiA9IGZ1bmN0aW9uKCkKewoJdmFyIGRhdGVzID0gbmV3IEFycmF5KCJyZXZpc2lvbiIsICJiaXJ0aGRheSIpOwoJZm9yICh2YXIgaT0wOyBpPGRhdGVzLmxlbmd0aDsgaSsrKXsKCQl2YXIgdmFsdWUgPSB0aGlzW2RhdGVzW2ldXTsKCQlpZiAodmFsdWUpewoJCQl0cnkgewoJCQkJdGhpc1tkYXRlc1tpXV0gPSBuZXcgRGF0ZShwYXJzZUZsb2F0KHZhbHVlKSk7CgkJCX0gY2F0Y2ggKGV4Y2VwdGlvbil7CgkJCQljb25zb2xlLmxvZygiZXhjZXB0aW9uIGNyZWF0aW5nIGRhdGUiKTsKCQkJfQoJCX0KCX0KfTsKLyoqCiogUmVtb3ZlcyBjb250YWN0IGZyb20gZGV2aWNlIHN0b3JhZ2UuCiogQHBhcmFtIHN1Y2Nlc3NDQiBzdWNjZXNzIGNhbGxiYWNrCiogQHBhcmFtIGVycm9yQ0IgZXJyb3IgY2FsbGJhY2sgKG9wdGlvbmFsKQoqLwpDb250YWN0LnByb3RvdHlwZS5yZW1vdmUgPSBmdW5jdGlvbihzdWNjZXNzQ0IsIGVycm9yQ0IpIHsKCWlmICh0aGlzLmlkID09IG51bGwpIHsKICAgICAgICB2YXIgZXJyb3JPYmogPSBuZXcgQ29udGFjdEVycm9yKCk7CiAgICAgICAgZXJyb3JPYmouY29kZSA9IENvbnRhY3RFcnJvci5OT1RfRk9VTkRfRVJST1I7CiAgICAgICAgZXJyb3JDQihlcnJvck9iaik7CiAgICB9CiAgICBlbHNlIHsKICAgICAgICBQaG9uZUdhcC5leGVjKHN1Y2Nlc3NDQiwgZXJyb3JDQiwgIkNvbnRhY3RzIiwgInJlbW92ZSIsIFt7ICJjb250YWN0IjogdGhpc31dKTsKICAgIH0KfTsKLyoqCiogaU9TIE9OTFkKKiBkaXNwbGF5cyBjb250YWN0IHZpYSBpT1MgVUkKKgoqIEBwYXJhbSBlcnJvckNCIGVycm9yIGNhbGxiYWNrCiovCkNvbnRhY3QucHJvdG90eXBlLmRpc3BsYXkgPSBmdW5jdGlvbihzdWNjZXNzQ0IsIGVycm9yQ0IsIG9wdGlvbnMpIHsgCglpZiAodGhpcy5pZCA9PSBudWxsKSB7CiAgICAgICAgdmFyIGVycm9yT2JqID0gbmV3IENvbnRhY3RFcnJvcigpOwogICAgICAgIGVycm9yT2JqLmNvZGUgPSBDb250YWN0RXJyb3IuTk9UX0ZPVU5EX0VSUk9SOwogICAgICAgIGVycm9yQ0IoZXJyb3JPYmopOwogICAgfQogICAgZWxzZSB7CiAgICAgICAgUGhvbmVHYXAuZXhlYyhzdWNjZXNzQ0IsIGVycm9yQ0IsICJDb250YWN0cyIsImRpc3BsYXlDb250YWN0IiwgW3RoaXMuaWQsIG9wdGlvbnNdKTsKICAgIH0KfTsKCi8qKgoqIENyZWF0ZXMgYSBkZWVwIGNvcHkgb2YgdGhpcyBDb250YWN0LgoqIFdpdGggdGhlIGNvbnRhY3QgSUQgc2V0IHRvIG51bGwuCiogQHJldHVybiBjb3B5IG9mIHRoaXMgQ29udGFjdAoqLwpDb250YWN0LnByb3RvdHlwZS5jbG9uZSA9IGZ1bmN0aW9uKCkgewogICAgdmFyIGNsb25lZENvbnRhY3QgPSBQaG9uZUdhcC5jbG9uZSh0aGlzKTsKICAgIGNsb25lZENvbnRhY3QuaWQgPSBudWxsOwogICAgLy8gTG9vcCB0aHJvdWdoIGFuZCBjbGVhciBvdXQgYW55IGlkJ3MgaW4gcGhvbmVzLCBlbWFpbHMsIGV0Yy4KICAgIGlmIChjbG9uZWRDb250YWN0LnBob25lTnVtYmVycykgewogICAgCWZvciAoaT0wOyBpPGNsb25lZENvbnRhY3QucGhvbmVOdW1iZXJzLmxlbmd0aDsgaSsrKSB7CiAgICAJCWNsb25lZENvbnRhY3QucGhvbmVOdW1iZXJzW2ldLmlkID0gbnVsbDsKICAgIAl9CiAgICB9CiAgICBpZiAoY2xvbmVkQ29udGFjdC5lbWFpbHMpIHsKICAgIAlmb3IgKGk9MDsgaTxjbG9uZWRDb250YWN0LmVtYWlscy5sZW5ndGg7IGkrKykgewogICAgCQljbG9uZWRDb250YWN0LmVtYWlsc1tpXS5pZCA9IG51bGw7CiAgICAJfQogICAgfQogICAgaWYgKGNsb25lZENvbnRhY3QuYWRkcmVzc2VzKSB7CiAgICAJZm9yIChpPTA7IGk8Y2xvbmVkQ29udGFjdC5hZGRyZXNzZXMubGVuZ3RoOyBpKyspIHsKICAgIAkJY2xvbmVkQ29udGFjdC5hZGRyZXNzZXNbaV0uaWQgPSBudWxsOwogICAgCX0KICAgIH0KICAgIGlmIChjbG9uZWRDb250YWN0LmltcykgewogICAgCWZvciAoaT0wOyBpPGNsb25lZENvbnRhY3QuaW1zLmxlbmd0aDsgaSsrKSB7CiAgICAJCWNsb25lZENvbnRhY3QuaW1zW2ldLmlkID0gbnVsbDsKICAgIAl9CiAgICB9CiAgICBpZiAoY2xvbmVkQ29udGFjdC5vcmdhbml6YXRpb25zKSB7CiAgICAJZm9yIChpPTA7IGk8Y2xvbmVkQ29udGFjdC5vcmdhbml6YXRpb25zLmxlbmd0aDsgaSsrKSB7CiAgICAJCWNsb25lZENvbnRhY3Qub3JnYW5pemF0aW9uc1tpXS5pZCA9IG51bGw7CiAgICAJfQogICAgfQogICAgaWYgKGNsb25lZENvbnRhY3QucGhvdG9zKSB7CiAgICAJZm9yIChpPTA7IGk8Y2xvbmVkQ29udGFjdC5waG90b3MubGVuZ3RoOyBpKyspIHsKICAgIAkJY2xvbmVkQ29udGFjdC5waG90b3NbaV0uaWQgPSBudWxsOwogICAgCX0KICAgIH0KICAgIGlmIChjbG9uZWRDb250YWN0LnVybHMpIHsKICAgIAlmb3IgKGk9MDsgaTxjbG9uZWRDb250YWN0LnVybHMubGVuZ3RoOyBpKyspIHsKICAgIAkJY2xvbmVkQ29udGFjdC51cmxzW2ldLmlkID0gbnVsbDsKICAgIAl9CiAgICB9CiAgICByZXR1cm4gY2xvbmVkQ29udGFjdDsKfTsKCi8qKgoqIFBlcnNpc3RzIGNvbnRhY3QgdG8gZGV2aWNlIHN0b3JhZ2UuCiogQHBhcmFtIHN1Y2Nlc3NDQiBzdWNjZXNzIGNhbGxiYWNrCiogQHBhcmFtIGVycm9yQ0IgZXJyb3IgY2FsbGJhY2sgLSBvcHRpb25hbAoqLwpDb250YWN0LnByb3RvdHlwZS5zYXZlID0gZnVuY3Rpb24oc3VjY2Vzc0NCLCBlcnJvckNCKSB7CgkvLyBkb24ndCBtb2RpZnkgdGhlIG9yaWdpbmFsIGNvbnRhY3QKCXZhciBjbG9uZWQgPSBQaG9uZUdhcC5jbG9uZSh0aGlzKTsKCWNsb25lZC5jb252ZXJ0RGF0ZXNPdXQoKTsgCglQaG9uZUdhcC5leGVjKHN1Y2Nlc3NDQiwgZXJyb3JDQiwgIkNvbnRhY3RzIiwic2F2ZSIsIFt7ImNvbnRhY3QiOiBjbG9uZWR9XSk7Cn07CgovKioKKiBDb250YWN0IG5hbWUuCiogQHBhcmFtIGZvcm1hdHRlZAoqIEBwYXJhbSBmYW1pbHlOYW1lCiogQHBhcmFtIGdpdmVuTmFtZQoqIEBwYXJhbSBtaWRkbGUKKiBAcGFyYW0gcHJlZml4CiogQHBhcmFtIHN1ZmZpeAoqLwp2YXIgQ29udGFjdE5hbWUgPSBmdW5jdGlvbihmb3JtYXR0ZWQsIGZhbWlseU5hbWUsIGdpdmVuTmFtZSwgbWlkZGxlLCBwcmVmaXgsIHN1ZmZpeCkgewogICAgdGhpcy5mb3JtYXR0ZWQgPSBmb3JtYXR0ZWQgIT0gInVuZGVmaW5lZCIgPyBmb3JtYXR0ZWQgOiBudWxsOwogICAgdGhpcy5mYW1pbHlOYW1lID0gZmFtaWx5TmFtZSAhPSAidW5kZWZpbmVkIiA/IGZhbWlseU5hbWUgOiBudWxsOwogICAgdGhpcy5naXZlbk5hbWUgPSBnaXZlbk5hbWUgIT0gInVuZGVmaW5lZCIgPyBnaXZlbk5hbWUgOiBudWxsOwogICAgdGhpcy5taWRkbGVOYW1lID0gbWlkZGxlICE9ICJ1bmRlZmluZWQiID8gbWlkZGxlIDogbnVsbDsKICAgIHRoaXMuaG9ub3JpZmljUHJlZml4ID0gcHJlZml4ICE9ICJ1bmRlZmluZWQiID8gcHJlZml4IDogbnVsbDsKICAgIHRoaXMuaG9ub3JpZmljU3VmZml4ID0gc3VmZml4ICE9ICJ1bmRlZmluZWQiID8gc3VmZml4IDogbnVsbDsKfTsKCi8qKgoqIEdlbmVyaWMgY29udGFjdCBmaWVsZC4KKiBAcGFyYW0gdHlwZQoqIEBwYXJhbSB2YWx1ZQoqIEBwYXJhbSBwcmltYXJ5CiogQHBhcmFtIGlkCiovCnZhciBDb250YWN0RmllbGQgPSBmdW5jdGlvbih0eXBlLCB2YWx1ZSwgcHJlZiwgaWQpIHsKICAgIHRoaXMudHlwZSA9IHR5cGUgIT0gInVuZGVmaW5lZCIgPyB0eXBlIDogbnVsbDsKICAgIHRoaXMudmFsdWUgPSB2YWx1ZSAhPSAidW5kZWZpbmVkIiA/IHZhbHVlIDogbnVsbDsKICAgIHRoaXMucHJlZiA9IHByZWYgIT0gInVuZGVmaW5lZCIgPyBwcmVmIDogbnVsbDsKICAgIHRoaXMuaWQgPSBpZCAhPSAidW5kZWZpbmVkIiA/IGlkIDogbnVsbDsKfTsKCi8qKgoqIENvbnRhY3QgYWRkcmVzcy4KKiBAcGFyYW0gZm9ybWF0dGVkCiogQHBhcmFtIHN0cmVldEFkZHJlc3MKKiBAcGFyYW0gbG9jYWxpdHkKKiBAcGFyYW0gcmVnaW9uCiogQHBhcmFtIHBvc3RhbENvZGUKKiBAcGFyYW0gY291bnRyeQoqLwp2YXIgQ29udGFjdEFkZHJlc3MgPSBmdW5jdGlvbihmb3JtYXR0ZWQsIHN0cmVldEFkZHJlc3MsIGxvY2FsaXR5LCByZWdpb24sIHBvc3RhbENvZGUsIGNvdW50cnksIGlkKSB7CiAgICB0aGlzLmZvcm1hdHRlZCA9IGZvcm1hdHRlZCAhPSAidW5kZWZpbmVkIiA/IGZvcm1hdHRlZCA6IG51bGw7CiAgICB0aGlzLnN0cmVldEFkZHJlc3MgPSBzdHJlZXRBZGRyZXNzICE9ICJ1bmRlZmluZWQiID8gc3RyZWV0QWRkcmVzcyA6IG51bGw7CiAgICB0aGlzLmxvY2FsaXR5ID0gbG9jYWxpdHkgIT0gInVuZGVmaW5lZCIgPyBsb2NhbGl0eSA6IG51bGw7CiAgICB0aGlzLnJlZ2lvbiA9IHJlZ2lvbiAhPSAidW5kZWZpbmVkIiA/IHJlZ2lvbiA6IG51bGw7CiAgICB0aGlzLnBvc3RhbENvZGUgPSBwb3N0YWxDb2RlICE9ICJ1bmRlZmluZWQiID8gcG9zdGFsQ29kZSA6IG51bGw7CiAgICB0aGlzLmNvdW50cnkgPSBjb3VudHJ5ICE9ICJ1bmRlZmluZWQiID8gY291bnRyeSA6IG51bGw7CiAgICB0aGlzLmlkID0gaWQgIT0gInVuZGVmaW5lZCIgPyBpZCA6IG51bGw7Cn07CgovKioKKiBDb250YWN0IG9yZ2FuaXphdGlvbi4KKiBAcGFyYW0gbmFtZQoqIEBwYXJhbSBkZXB0CiogQHBhcmFtIHRpdGxlCiogQHBhcmFtIHN0YXJ0RGF0ZQoqIEBwYXJhbSBlbmREYXRlCiogQHBhcmFtIGxvY2F0aW9uCiogQHBhcmFtIGRlc2MKKi8KdmFyIENvbnRhY3RPcmdhbml6YXRpb24gPSBmdW5jdGlvbihuYW1lLCBkZXB0LCB0aXRsZSwgc3RhcnREYXRlLCBlbmREYXRlLCBsb2NhdGlvbiwgZGVzYykgewogICAgdGhpcy5uYW1lID0gbmFtZSAhPSAidW5kZWZpbmVkIiA/IG5hbWUgOiBudWxsOwogICAgdGhpcy5kZXBhcnRtZW50ID0gZGVwdCAhPSAidW5kZWZpbmVkIiA/IGRlcHQgOiBudWxsOwogICAgdGhpcy50aXRsZSA9IHRpdGxlICE9ICJ1bmRlZmluZWQiID8gdGl0bGUgOiBudWxsOwogICAgdGhpcy5zdGFydERhdGUgPSBzdGFydERhdGUgIT0gInVuZGVmaW5lZCIgPyBzdGFydERhdGUgOiBudWxsOwogICAgdGhpcy5lbmREYXRlID0gZW5kRGF0ZSAhPSAidW5kZWZpbmVkIiA/IGVuZERhdGUgOiBudWxsOwogICAgdGhpcy5sb2NhdGlvbiA9IGxvY2F0aW9uICE9ICJ1bmRlZmluZWQiID8gbG9jYXRpb24gOiBudWxsOwogICAgdGhpcy5kZXNjcmlwdGlvbiA9IGRlc2MgIT0gInVuZGVmaW5lZCIgPyBkZXNjIDogbnVsbDsKfTsKCi8qKgoqIENvbnRhY3QgYWNjb3VudC4KKiBAcGFyYW0gZG9tYWluCiogQHBhcmFtIHVzZXJuYW1lCiogQHBhcmFtIHVzZXJpZAoqLwp2YXIgQ29udGFjdEFjY291bnQgPSBmdW5jdGlvbihkb21haW4sIHVzZXJuYW1lLCB1c2VyaWQpIHsKICAgIHRoaXMuZG9tYWluID0gZG9tYWluICE9ICJ1bmRlZmluZWQiID8gZG9tYWluIDogbnVsbDsKICAgIHRoaXMudXNlcm5hbWUgPSB1c2VybmFtZSAhPSAidW5kZWZpbmVkIiA/IHVzZXJuYW1lIDogbnVsbDsKICAgIHRoaXMudXNlcmlkID0gdXNlcmlkICE9ICJ1bmRlZmluZWQiID8gdXNlcmlkIDogbnVsbDsKfQoKLyoqCiogUmVwcmVzZW50cyBhIGdyb3VwIG9mIENvbnRhY3RzLgoqLwp2YXIgQ29udGFjdHMgPSBmdW5jdGlvbigpIHsKICAgIHRoaXMuaW5Qcm9ncmVzcyA9IGZhbHNlOwogICAgdGhpcy5yZWNvcmRzID0gbmV3IEFycmF5KCk7CiAgICB0aGlzLnJlc3VsdHNDYWxsYmFjayA9IG51bGw7CiAgICB0aGlzLmVycm9yQ2FsbGJhY2sgPSBudWxsOwp9OwovKioKKiBSZXR1cm5zIGFuIGFycmF5IG9mIENvbnRhY3RzIG1hdGNoaW5nIHRoZSBzZWFyY2ggY3JpdGVyaWEuCiogQHBhcmFtIGZpZWxkcyB0aGF0IHNob3VsZCBiZSBzZWFyY2hlZAoqIEBwYXJhbSBzdWNjZXNzQ0Igc3VjY2VzcyBjYWxsYmFjawoqIEBwYXJhbSBlcnJvckNCIGVycm9yIGNhbGxiYWNrIChvcHRpb25hbCkKKiBAcGFyYW0ge0NvbnRhY3RGaW5kT3B0aW9uc30gb3B0aW9ucyB0aGF0IGNhbiBiZSBhcHBsaWVkIHRvIGNvbnRhY3Qgc2VhcmNoaW5nCiogQHJldHVybiBhcnJheSBvZiBDb250YWN0cyBtYXRjaGluZyBzZWFyY2ggY3JpdGVyaWEKKi8KQ29udGFjdHMucHJvdG90eXBlLmZpbmQgPSBmdW5jdGlvbihmaWVsZHMsIHN1Y2Nlc3NDQiwgZXJyb3JDQiwgb3B0aW9ucykgewoJdmFyIHRoZU9wdGlvbnMgPSBvcHRpb25zIHx8IG51bGw7CglpZiAodGhlT3B0aW9ucyAhPSBudWxsKXsKCQkvLyBjb252ZXJ0IHVwZGF0ZWRTaW5jZSB0byBtcwoJCXZhciB2YWx1ZSA9IHRoZU9wdGlvbnMudXBkYXRlZFNpbmNlCgkJaWYgKHZhbHVlICE9ICcnKXsKCQkJaWYgKCF2YWx1ZSBpbnN0YW5jZW9mIERhdGUpewoJCQkJdHJ5IHsKCQkJCQl2YWx1ZSA9IG5ldyBEYXRlKHZhbHVlKTsKCQkJCX0gY2F0Y2goZXhjZXB0aW9uKXsKCQkJCQl2YWx1ZSA9IG51bGw7CgkJCQl9CgkJCX0KCQkJaWYgKHZhbHVlIGluc3RhbmNlb2YgRGF0ZSl7CgkJCQl0aGVPcHRpb25zLnVwZGF0ZWRTaW5jZSA9IHZhbHVlLnZhbHVlT2YoKTsKCQkJfQoJCX0KCX0KCglQaG9uZUdhcC5leGVjKHN1Y2Nlc3NDQiwgZXJyb3JDQiwgIkNvbnRhY3RzIiwic2VhcmNoIiwgW3siZmllbGRzIjpmaWVsZHMsICJmaW5kT3B0aW9ucyI6dGhlT3B0aW9uc31dKTsKCQp9OwovKioKKiBuZWVkIHRvIHR1cm4gdGhlIGFycmF5IG9mIEpTT04gc3RyaW5ncyByZXByZXNlbnRpbmcgY29udGFjdCBvYmplY3RzIGludG8gYWN0dWFsIG9iamVjdHMKKiBAcGFyYW0gYXJyYXkgb2YgSlNPTiBzdHJpbmdzIHdpdGggY29udGFjdCBkYXRhCiogQHJldHVybiBjYWxsIHJlc3VsdHMgY2FsbGJhY2sgd2l0aCBhcnJheSBvZiBDb250YWN0IG9iamVjdHMKKiAgVGhpcyBmdW5jdGlvbiBpcyBjYWxsZWQgZnJvbSBvYmplY3RpdmUgQyBDb250YWN0cy5zZWFyY2goKSBtZXRob2QuCiovCkNvbnRhY3RzLnByb3RvdHlwZS5fZmluZENhbGxiYWNrID0gZnVuY3Rpb24ocGx1Z2luUmVzdWx0KSB7Cgl2YXIgY29udGFjdHMgPSBuZXcgQXJyYXkoKTsKCXRyeSB7CgkJZm9yICh2YXIgaT0wOyBpPHBsdWdpblJlc3VsdC5tZXNzYWdlLmxlbmd0aDsgaSsrKSB7CgkJCXZhciBuZXdDb250YWN0ID0gbmF2aWdhdG9yLnNlcnZpY2UuY29udGFjdHMuY3JlYXRlKHBsdWdpblJlc3VsdC5tZXNzYWdlW2ldKTsgCgkJCW5ld0NvbnRhY3QuY29udmVydERhdGVzSW4oKTsKCQkJY29udGFjdHMucHVzaChuZXdDb250YWN0KTsKCQl9CgkJcGx1Z2luUmVzdWx0Lm1lc3NhZ2UgPSBjb250YWN0czsKCX0gY2F0Y2goZSl7CgkJCWNvbnNvbGUubG9nKCJFcnJvciBwYXJzaW5nIGNvbnRhY3RzOiAiICtlKTsKCX0KCXJldHVybiBwbHVnaW5SZXN1bHQ7Cn0KCi8qKgoqIG5lZWQgdG8gdHVybiB0aGUgSlNPTiBzdHJpbmcgcmVwcmVzZW50aW5nIGNvbnRhY3Qgb2JqZWN0IGludG8gYWN0dWFsIG9iamVjdAoqIEBwYXJhbSBKU09OIHN0cmluZyB3aXRoIGNvbnRhY3QgZGF0YQoqIENhbGwgc3RvcmVkIHJlc3VsdHMgZnVuY3Rpb24gd2l0aCAgQ29udGFjdCBvYmplY3QKKiAgVGhpcyBmdW5jdGlvbiBpcyBjYWxsZWQgZnJvbSBvYmplY3RpdmUgQyBDb250YWN0cyByZW1vdmUgYW5kIHNhdmUgbWV0aG9kcwoqLwpDb250YWN0cy5wcm90b3R5cGUuX2NvbnRhY3RDYWxsYmFjayA9IGZ1bmN0aW9uKHBsdWdpblJlc3VsdCkKewoJdmFyIG5ld0NvbnRhY3QgPSBudWxsOwoJaWYgKHBsdWdpblJlc3VsdC5tZXNzYWdlKXsKCQl0cnkgewoJCQluZXdDb250YWN0ID0gbmF2aWdhdG9yLnNlcnZpY2UuY29udGFjdHMuY3JlYXRlKHBsdWdpblJlc3VsdC5tZXNzYWdlKTsKCQkJbmV3Q29udGFjdC5jb252ZXJ0RGF0ZXNJbigpOwoJCX0gY2F0Y2goZSl7CgkJCWNvbnNvbGUubG9nKCJFcnJvciBwYXJzaW5nIGNvbnRhY3QiKTsKCQl9Cgl9CglwbHVnaW5SZXN1bHQubWVzc2FnZSA9IG5ld0NvbnRhY3Q7CglyZXR1cm4gcGx1Z2luUmVzdWx0OwoJCn07Ci8qKiAKKiBOZWVkIHRvIHJldHVybiBhbiBlcnJvciBvYmplY3QgcmF0aGVyIHRoYW4ganVzdCBhIHNpbmdsZSBlcnJvciBjb2RlCiogQHBhcmFtIGVycm9yIGNvZGUKKiBDYWxsIG9wdGlvbmFsIGVycm9yIGNhbGxiYWNrIGlmIGZvdW5kLgoqIENhbGxlZCBmcm9tIG9iamVjdGl2ZSBjIGZpbmQsIHJlbW92ZSwgYW5kIHNhdmUgbWV0aG9kcyBvbiBlcnJvci4KKi8KQ29udGFjdHMucHJvdG90eXBlLl9lcnJDYWxsYmFjayA9IGZ1bmN0aW9uKHBsdWdpblJlc3VsdCkKewoJdmFyIGVycm9yT2JqID0gbmV3IENvbnRhY3RFcnJvcigpOwogICAJZXJyb3JPYmouY29kZSA9IHBsdWdpblJlc3VsdC5tZXNzYWdlOwoJcGx1Z2luUmVzdWx0Lm1lc3NhZ2UgPSBlcnJvck9iajsKCXJldHVybiBwbHVnaW5SZXN1bHQ7Cn07Ci8vIGlQaG9uZSBvbmx5IGFwaSB0byBjcmVhdGUgYSBuZXcgY29udGFjdCB2aWEgdGhlIEdVSQpDb250YWN0cy5wcm90b3R5cGUubmV3Q29udGFjdFVJID0gZnVuY3Rpb24oc3VjY2Vzc0NhbGxiYWNrKSB7IAogICAgUGhvbmVHYXAuZXhlYyhzdWNjZXNzQ2FsbGJhY2ssIG51bGwsICJDb250YWN0cyIsIm5ld0NvbnRhY3QiLCBbXSk7Cn07Ci8vIGlQaG9uZSBvbmx5IGFwaSB0byBzZWxlY3QgYSBjb250YWN0IHZpYSB0aGUgR1VJCkNvbnRhY3RzLnByb3RvdHlwZS5jaG9vc2VDb250YWN0ID0gZnVuY3Rpb24oc3VjY2Vzc0NhbGxiYWNrLCBvcHRpb25zKSB7CiAgICBQaG9uZUdhcC5leGVjKHN1Y2Nlc3NDYWxsYmFjaywgbnVsbCwgIkNvbnRhY3RzIiwiY2hvb3NlQ29udGFjdCIsIG9wdGlvbnMpOwp9OwoKCi8qKgoqIFRoaXMgZnVuY3Rpb24gY3JlYXRlcyBhIG5ldyBjb250YWN0LCBidXQgaXQgZG9lcyBub3QgcGVyc2lzdCB0aGUgY29udGFjdAoqIHRvIGRldmljZSBzdG9yYWdlLiBUbyBwZXJzaXN0IHRoZSBjb250YWN0IHRvIGRldmljZSBzdG9yYWdlLCBpbnZva2UKKiBjb250YWN0LnNhdmUoKS4KKiBAcGFyYW0gcHJvcGVydGllcyBhbiBvYmplY3Qgd2hvJ3MgcHJvcGVydGllcyB3aWxsIGJlIGV4YW1pbmVkIHRvIGNyZWF0ZSBhIG5ldyBDb250YWN0CiogQHJldHVybnMgbmV3IENvbnRhY3Qgb2JqZWN0CiovCkNvbnRhY3RzLnByb3RvdHlwZS5jcmVhdGUgPSBmdW5jdGlvbihwcm9wZXJ0aWVzKSB7CiAgICB2YXIgY29udGFjdCA9IG5ldyBDb250YWN0KCk7CiAgICBmb3IgKGkgaW4gcHJvcGVydGllcykgewogICAgICAgIGlmIChjb250YWN0W2ldIT0ndW5kZWZpbmVkJykgewogICAgICAgICAgICBjb250YWN0W2ldPXByb3BlcnRpZXNbaV07CiAgICAgICAgfQogICAgfQogICAgcmV0dXJuIGNvbnRhY3Q7Cn07CgovKioKICogQ29udGFjdEZpbmRPcHRpb25zLgogKiBAcGFyYW0gZmlsdGVyIHVzZWQgdG8gbWF0Y2ggY29udGFjdHMgYWdhaW5zdAogKiBAcGFyYW0gbXVsdGlwbGUgYm9vbGVhbiB1c2VkIHRvIGRldGVybWluZSBpZiBtb3JlIHRoYW4gb25lIGNvbnRhY3Qgc2hvdWxkIGJlIHJldHVybmVkCiAqIEBwYXJhbSB1cGRhdGVkU2luY2UgcmV0dXJuIG9ubHkgY29udGFjdCByZWNvcmRzIHRoYXQgaGF2ZSBiZWVuIHVwZGF0ZWQgb24gb3IgYWZ0ZXIgdGhlIGdpdmVuIHRpbWUKICovCnZhciBDb250YWN0RmluZE9wdGlvbnMgPSBmdW5jdGlvbihmaWx0ZXIsIG11bHRpcGxlLCB1cGRhdGVkU2luY2UpIHsKICAgIHRoaXMuZmlsdGVyID0gZmlsdGVyIHx8ICcnOwogICAgdGhpcy5tdWx0aXBsZSA9IG11bHRpcGxlIHx8IHRydWU7CiAgICB0aGlzLnVwZGF0ZWRTaW5jZSA9IHVwZGF0ZWRTaW5jZSB8fCAnJzsKfTsKCi8qKgogKiAgQ29udGFjdEVycm9yLgogKiAgQW4gZXJyb3IgY29kZSBhc3NpZ25lZCBieSBhbiBpbXBsZW1lbnRhdGlvbiB3aGVuIGFuIGVycm9yIGhhcyBvY2N1cnJlZAogKi8KdmFyIENvbnRhY3RFcnJvciA9IGZ1bmN0aW9uKCkgewogICAgdGhpcy5jb2RlPW51bGw7Cn07CgovKioKICogRXJyb3IgY29kZXMKICovCkNvbnRhY3RFcnJvci5VTktOT1dOX0VSUk9SID0gMDsKQ29udGFjdEVycm9yLklOVkFMSURfQVJHVU1FTlRfRVJST1IgPSAxOwpDb250YWN0RXJyb3IuTk9UX0ZPVU5EX0VSUk9SID0gMjsKQ29udGFjdEVycm9yLlRJTUVPVVRfRVJST1IgPSAzOwpDb250YWN0RXJyb3IuUEVORElOR19PUEVSQVRJT05fRVJST1IgPSA0OwpDb250YWN0RXJyb3IuSU9fRVJST1IgPSA1OwpDb250YWN0RXJyb3IuTk9UX1NVUFBPUlRFRF9FUlJPUiA9IDY7CkNvbnRhY3RFcnJvci5QRVJNSVNTSU9OX0RFTklFRF9FUlJPUiA9IDIwOwoKLyoqCiAqIEFkZCB0aGUgY29udGFjdCBpbnRlcmZhY2UgaW50byB0aGUgYnJvd3Nlci4KICovClBob25lR2FwLmFkZENvbnN0cnVjdG9yKGZ1bmN0aW9uKCkgeyAKICAgIGlmKHR5cGVvZiBuYXZpZ2F0b3Iuc2VydmljZSA9PSAidW5kZWZpbmVkIikgbmF2aWdhdG9yLnNlcnZpY2UgPSBuZXcgT2JqZWN0KCk7CiAgICBpZih0eXBlb2YgbmF2aWdhdG9yLnNlcnZpY2UuY29udGFjdHMgPT0gInVuZGVmaW5lZCIpIG5hdmlnYXRvci5zZXJ2aWNlLmNvbnRhY3RzID0gbmV3IENvbnRhY3RzKCk7Cn0pOwp9OwppZiAoIVBob25lR2FwLmhhc1Jlc291cmNlKCJkZXZpY2UiKSkgewoJUGhvbmVHYXAuYWRkUmVzb3VyY2UoImRldmljZSIpOwoKLyoqCiAqIHRoaXMgcmVwcmVzZW50cyB0aGUgbW9iaWxlIGRldmljZSwgYW5kIHByb3ZpZGVzIHByb3BlcnRpZXMgZm9yIGluc3BlY3RpbmcgdGhlIG1vZGVsLCB2ZXJzaW9uLCBVVUlEIG9mIHRoZQogKiBwaG9uZSwgZXRjLgogKiBAY29uc3RydWN0b3IKICovCkRldmljZSA9IGZ1bmN0aW9uKCkgCnsKICAgIHRoaXMucGxhdGZvcm0gPSBudWxsOwogICAgdGhpcy52ZXJzaW9uICA9IG51bGw7CiAgICB0aGlzLm5hbWUgICAgID0gbnVsbDsKICAgIHRoaXMucGhvbmVnYXAgICAgICA9IG51bGw7CiAgICB0aGlzLnV1aWQgICAgID0gbnVsbDsKICAgIHRyeSAKCXsgICAgICAKCQl0aGlzLnBsYXRmb3JtID0gRGV2aWNlSW5mby5wbGF0Zm9ybTsKCQl0aGlzLnZlcnNpb24gID0gRGV2aWNlSW5mby52ZXJzaW9uOwoJCXRoaXMubmFtZSAgICAgPSBEZXZpY2VJbmZvLm5hbWU7CgkJdGhpcy5waG9uZWdhcCA9IERldmljZUluZm8uZ2FwOwoJCXRoaXMudXVpZCAgICAgPSBEZXZpY2VJbmZvLnV1aWQ7CgogICAgfSAKCWNhdGNoKGUpIAoJewogICAgICAgIC8vIFRPRE86IAogICAgfQoJdGhpcy5hdmFpbGFibGUgPSBQaG9uZUdhcC5hdmFpbGFibGUgPSB0aGlzLnV1aWQgIT0gbnVsbDsKfQoKUGhvbmVHYXAuYWRkQ29uc3RydWN0b3IoZnVuY3Rpb24oKSB7CiAgICBuYXZpZ2F0b3IuZGV2aWNlID0gd2luZG93LmRldmljZSA9IG5ldyBEZXZpY2UoKTsKfSk7Cn07CmlmICghUGhvbmVHYXAuaGFzUmVzb3VyY2UoImZpbGUiKSkgewoJUGhvbmVHYXAuYWRkUmVzb3VyY2UoImZpbGUiKTsKCi8qKgogKiBUaGlzIGNsYXNzIHByb3ZpZGVzIGdlbmVyaWMgcmVhZCBhbmQgd3JpdGUgYWNjZXNzIHRvIHRoZSBtb2JpbGUgZGV2aWNlIGZpbGUgc3lzdGVtLgogKiBUaGV5IGFyZSBub3QgdXNlZCB0byByZWFkIGZpbGVzIGZyb20gYSBzZXJ2ZXIuCiAqLwoKLyoqCiAqIFRoaXMgY2xhc3MgcHJvdmlkZXMgc29tZSB1c2VmdWwgaW5mb3JtYXRpb24gYWJvdXQgYSBmaWxlLgogKiBUaGlzIGlzIHRoZSBmaWVsZHMgcmV0dXJuZWQgd2hlbiBuYXZpZ2F0b3IuZmlsZU1nci5nZXRGaWxlUHJvcGVydGllcygpIAogKiBpcyBjYWxsZWQuCiAqLwpGaWxlUHJvcGVydGllcyA9IGZ1bmN0aW9uKGZpbGVQYXRoKSB7CiAgICB0aGlzLmZpbGVQYXRoID0gZmlsZVBhdGg7CiAgICB0aGlzLnNpemUgPSAwOwogICAgdGhpcy5sYXN0TW9kaWZpZWREYXRlID0gbnVsbDsKfQovKioKICogUmVwcmVzZW50cyBhIHNpbmdsZSBmaWxlLgogKiAKICogbmFtZSB7RE9NU3RyaW5nfSBuYW1lIG9mIHRoZSBmaWxlLCB3aXRob3V0IHBhdGggaW5mb3JtYXRpb24KICogZnVsbFBhdGgge0RPTVN0cmluZ30gdGhlIGZ1bGwgcGF0aCBvZiB0aGUgZmlsZSwgaW5jbHVkaW5nIHRoZSBuYW1lCiAqIHR5cGUge0RPTVN0cmluZ30gbWltZSB0eXBlCiAqIGxhc3RNb2RpZmllZERhdGUge0RhdGV9IGxhc3QgbW9kaWZpZWQgZGF0ZQogKiBzaXplIHtOdW1iZXJ9IHNpemUgb2YgdGhlIGZpbGUgaW4gYnl0ZXMKICovCkZpbGUgPSBmdW5jdGlvbihuYW1lLCBmdWxsUGF0aCwgdHlwZSwgbGFzdE1vZGlmaWVkRGF0ZSwgc2l6ZSkgewoJdGhpcy5uYW1lID0gbmFtZSB8fCBudWxsOwogICAgdGhpcy5mdWxsUGF0aCA9IGZ1bGxQYXRoIHx8IG51bGw7Cgl0aGlzLnR5cGUgPSB0eXBlIHx8IG51bGw7CiAgICB0aGlzLmxhc3RNb2RpZmllZERhdGUgPSBsYXN0TW9kaWZpZWREYXRlIHx8IG51bGw7CiAgICB0aGlzLnNpemUgPSBzaXplIHx8IDA7Cn0KLyoqCiAqIENyZWF0ZSBhbiBldmVudCBvYmplY3Qgc2luY2Ugd2UgY2FuJ3Qgc2V0IHRhcmdldCBvbiBET00gZXZlbnQuCiAqCiAqIEBwYXJhbSB0eXBlCiAqIEBwYXJhbSB0YXJnZXQKICoKICovCkZpbGUuX2NyZWF0ZUV2ZW50ID0gZnVuY3Rpb24odHlwZSwgdGFyZ2V0KSB7CiAgICAvLyBDYW4ndCBjcmVhdGUgZXZlbnQgb2JqZWN0LCBzaW5jZSB3ZSBjYW4ndCBzZXQgdGFyZ2V0IChpdHMgcmVhZG9ubHkpCiAgICAvL3ZhciBldnQgPSBkb2N1bWVudC5jcmVhdGVFdmVudCgnRXZlbnRzJyk7CiAgICAvL2V2dC5pbml0RXZlbnQoIm9ubG9hZCIsIGZhbHNlLCBmYWxzZSk7CiAgICB2YXIgZXZ0ID0geyJ0eXBlIjogdHlwZX07CiAgICBldnQudGFyZ2V0ID0gdGFyZ2V0OwogICAgcmV0dXJuIGV2dDsKfTsKCkZpbGVFcnJvciA9IGZ1bmN0aW9uKCkgewogICB0aGlzLmNvZGUgPSBudWxsOwp9CgovLyBGaWxlIGVycm9yIGNvZGVzCi8vIEZvdW5kIGluIERPTUV4Y2VwdGlvbgpGaWxlRXJyb3IuTk9UX0ZPVU5EX0VSUiA9IDE7CkZpbGVFcnJvci5TRUNVUklUWV9FUlIgPSAyOwpGaWxlRXJyb3IuQUJPUlRfRVJSID0gMzsKCi8vIEFkZGVkIGJ5IHRoaXMgc3BlY2lmaWNhdGlvbgpGaWxlRXJyb3IuTk9UX1JFQURBQkxFX0VSUiA9IDQ7CkZpbGVFcnJvci5FTkNPRElOR19FUlIgPSA1OwpGaWxlRXJyb3IuTk9fTU9ESUZJQ0FUSU9OX0FMTE9XRURfRVJSID0gNjsKRmlsZUVycm9yLklOVkFMSURfU1RBVEVfRVJSID0gNzsKRmlsZUVycm9yLlNZTlRBWF9FUlIgPSA4OwpGaWxlRXJyb3IuSU5WQUxJRF9NT0RJRklDQVRJT05fRVJSID0gOTsKRmlsZUVycm9yLlFVT1RBX0VYQ0VFREVEX0VSUiA9IDEwOwpGaWxlRXJyb3IuVFlQRV9NSVNNQVRDSF9FUlIgPSAxMTsKRmlsZUVycm9yLlBBVEhfRVhJU1RTX0VSUiA9IDEyOwoKLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQovLyBGaWxlIG1hbmFnZXIKLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQoKRmlsZU1nciA9IGZ1bmN0aW9uKCkgewp9CgpGaWxlTWdyLnByb3RvdHlwZS50ZXN0RmlsZUV4aXN0cyA9IGZ1bmN0aW9uKGZpbGVOYW1lLCBzdWNjZXNzQ2FsbGJhY2ssIGVycm9yQ2FsbGJhY2spIHsKICAgIFBob25lR2FwLmV4ZWMoc3VjY2Vzc0NhbGxiYWNrLCBlcnJvckNhbGxiYWNrLCAiRmlsZSIsICJ0ZXN0RmlsZUV4aXN0cyIsIFtmaWxlTmFtZV0pOwp9OwoKRmlsZU1nci5wcm90b3R5cGUudGVzdERpcmVjdG9yeUV4aXN0cyA9IGZ1bmN0aW9uKGRpck5hbWUsIHN1Y2Nlc3NDYWxsYmFjaywgZXJyb3JDYWxsYmFjaykgewogICAgUGhvbmVHYXAuZXhlYyhzdWNjZXNzQ2FsbGJhY2ssIGVycm9yQ2FsbGJhY2ssICJGaWxlIiwgInRlc3REaXJlY3RvcnlFeGlzdHMiLCBbZGlyTmFtZV0pOwp9OwoKRmlsZU1nci5wcm90b3R5cGUuZ2V0RnJlZURpc2tTcGFjZSA9IGZ1bmN0aW9uKHN1Y2Nlc3NDYWxsYmFjaywgZXJyb3JDYWxsYmFjaykgewogICAgUGhvbmVHYXAuZXhlYyhzdWNjZXNzQ2FsbGJhY2ssIGVycm9yQ2FsbGJhY2ssICJGaWxlIiwgImdldEZyZWVEaXNrU3BhY2UiLCBbXSk7Cn07CgpGaWxlTWdyLnByb3RvdHlwZS53cml0ZUFzVGV4dCA9IGZ1bmN0aW9uKGZpbGVOYW1lLCBkYXRhLCBiQXBwZW5kLCBzdWNjZXNzQ2FsbGJhY2ssIGVycm9yQ2FsbGJhY2spIHsKICAgIFBob25lR2FwLmV4ZWMoc3VjY2Vzc0NhbGxiYWNrLCBlcnJvckNhbGxiYWNrLCAiRmlsZSIsICJ3cml0ZSIsIFtmaWxlTmFtZSwgZGF0YSwgYkFwcGVuZCA/IDEgOiAwXSk7Cn07CgpGaWxlTWdyLnByb3RvdHlwZS53cml0ZSA9IGZ1bmN0aW9uKGZpbGVOYW1lLCBkYXRhLCBwb3NpdGlvbiwgc3VjY2Vzc0NhbGxiYWNrLCBlcnJvckNhbGxiYWNrKSB7CiAgICBQaG9uZUdhcC5leGVjKHN1Y2Nlc3NDYWxsYmFjaywgZXJyb3JDYWxsYmFjaywgIkZpbGUiLCAid3JpdGUiLCBbZmlsZU5hbWUsIGRhdGEsIHBvc2l0aW9uXSk7Cn07CgpGaWxlTWdyLnByb3RvdHlwZS50cnVuY2F0ZSA9IGZ1bmN0aW9uKGZpbGVOYW1lLCBzaXplLCBzdWNjZXNzQ2FsbGJhY2ssIGVycm9yQ2FsbGJhY2spIHsKICAgIFBob25lR2FwLmV4ZWMoc3VjY2Vzc0NhbGxiYWNrLCBlcnJvckNhbGxiYWNrLCAiRmlsZSIsICJ0cnVuY2F0ZUZpbGUiLCBbZmlsZU5hbWUsIHNpemVdKTsKfTsKCkZpbGVNZ3IucHJvdG90eXBlLnJlYWRBc1RleHQgPSBmdW5jdGlvbihmaWxlTmFtZSwgZW5jb2RpbmcsIHN1Y2Nlc3NDYWxsYmFjaywgZXJyb3JDYWxsYmFjaykgewogICAgUGhvbmVHYXAuZXhlYyhzdWNjZXNzQ2FsbGJhY2ssIGVycm9yQ2FsbGJhY2ssICJGaWxlIiwgInJlYWRGaWxlIiwgW2ZpbGVOYW1lLCBlbmNvZGluZ10pOwp9OwoKRmlsZU1nci5wcm90b3R5cGUucmVhZEFzRGF0YVVSTCA9IGZ1bmN0aW9uKGZpbGVOYW1lLCBzdWNjZXNzQ2FsbGJhY2ssIGVycm9yQ2FsbGJhY2spIHsKCVBob25lR2FwLmV4ZWMoc3VjY2Vzc0NhbGxiYWNrLCBlcnJvckNhbGxiYWNrLCAiRmlsZSIsICJyZWFkQXNEYXRhVVJMIiwgW2ZpbGVOYW1lXSk7Cn07CgpQaG9uZUdhcC5hZGRDb25zdHJ1Y3RvcihmdW5jdGlvbigpIHsKICAgIGlmICh0eXBlb2YgbmF2aWdhdG9yLmZpbGVNZ3IgPT09ICJ1bmRlZmluZWQiKSB7CiAgICAgICAgbmF2aWdhdG9yLmZpbGVNZ3IgPSBuZXcgRmlsZU1ncigpOwogICAgfQp9KTsKCgovLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCi8vIEZpbGUgUmVhZGVyCi8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KCi8qKgogKiBUaGlzIGNsYXNzIHJlYWRzIHRoZSBtb2JpbGUgZGV2aWNlIGZpbGUgc3lzdGVtLgogKgogKi8KRmlsZVJlYWRlciA9IGZ1bmN0aW9uKCkgewogICAgdGhpcy5maWxlTmFtZSA9ICIiOwoKICAgIHRoaXMucmVhZHlTdGF0ZSA9IDA7CgogICAgLy8gRmlsZSBkYXRhCiAgICB0aGlzLnJlc3VsdCA9IG51bGw7CgogICAgLy8gRXJyb3IKICAgIHRoaXMuZXJyb3IgPSBudWxsOwoKICAgIC8vIEV2ZW50IGhhbmRsZXJzCiAgICB0aGlzLm9ubG9hZHN0YXJ0ID0gbnVsbDsgICAgLy8gV2hlbiB0aGUgcmVhZCBzdGFydHMuCiAgICB0aGlzLm9ucHJvZ3Jlc3MgPSBudWxsOyAgICAgLy8gV2hpbGUgcmVhZGluZyAoYW5kIGRlY29kaW5nKSBmaWxlIG9yIGZpbGVCbG9iIGRhdGEsIGFuZCByZXBvcnRpbmcgcGFydGlhbCBmaWxlIGRhdGEgKHByb2dlc3MubG9hZGVkL3Byb2dyZXNzLnRvdGFsKQogICAgdGhpcy5vbmxvYWQgPSBudWxsOyAgICAgICAgIC8vIFdoZW4gdGhlIHJlYWQgaGFzIHN1Y2Nlc3NmdWxseSBjb21wbGV0ZWQuCiAgICB0aGlzLm9uZXJyb3IgPSBudWxsOyAgICAgICAgLy8gV2hlbiB0aGUgcmVhZCBoYXMgZmFpbGVkIChzZWUgZXJyb3JzKS4KICAgIHRoaXMub25sb2FkZW5kID0gbnVsbDsgICAgICAvLyBXaGVuIHRoZSByZXF1ZXN0IGhhcyBjb21wbGV0ZWQgKGVpdGhlciBpbiBzdWNjZXNzIG9yIGZhaWx1cmUpLgogICAgdGhpcy5vbmFib3J0ID0gbnVsbDsgICAgICAgIC8vIFdoZW4gdGhlIHJlYWQgaGFzIGJlZW4gYWJvcnRlZC4gRm9yIGluc3RhbmNlLCBieSBpbnZva2luZyB0aGUgYWJvcnQoKSBtZXRob2QuCn0KCi8vIFN0YXRlcwpGaWxlUmVhZGVyLkVNUFRZID0gMDsKRmlsZVJlYWRlci5MT0FESU5HID0gMTsKRmlsZVJlYWRlci5ET05FID0gMjsKCi8qKgogKiBBYm9ydCByZWFkaW5nIGZpbGUuCiAqLwpGaWxlUmVhZGVyLnByb3RvdHlwZS5hYm9ydCA9IGZ1bmN0aW9uKCkgewogICAgdmFyIGV2dDsKICAgIHRoaXMucmVhZHlTdGF0ZSA9IEZpbGVSZWFkZXIuRE9ORTsKICAgIHRoaXMucmVzdWx0ID0gbnVsbDsKCiAgICAvLyBzZXQgZXJyb3IKICAgIHZhciBlcnJvciA9IG5ldyBGaWxlRXJyb3IoKTsKICAgIGVycm9yLmNvZGUgPSBlcnJvci5BQk9SVF9FUlI7CiAgICB0aGlzLmVycm9yID0gZXJyb3I7CiAgIAogICAgLy8gSWYgZXJyb3IgY2FsbGJhY2sKICAgIGlmICh0eXBlb2YgdGhpcy5vbmVycm9yID09PSAiZnVuY3Rpb24iKSB7CiAgICAgICAgZXZ0ID0gRmlsZS5fY3JlYXRlRXZlbnQoImVycm9yIiwgdGhpcyk7CiAgICAgICAgdGhpcy5vbmVycm9yKGV2dCk7CiAgICB9CiAgICAvLyBJZiBhYm9ydCBjYWxsYmFjawogICAgaWYgKHR5cGVvZiB0aGlzLm9uYWJvcnQgPT09ICJmdW5jdGlvbiIpIHsKICAgICAgICBldnQgPSBGaWxlLl9jcmVhdGVFdmVudCgiYWJvcnQiLCB0aGlzKTsKICAgICAgICB0aGlzLm9uYWJvcnQoZXZ0KTsKICAgIH0KICAgIC8vIElmIGxvYWQgZW5kIGNhbGxiYWNrCiAgICBpZiAodHlwZW9mIHRoaXMub25sb2FkZW5kID09PSAiZnVuY3Rpb24iKSB7CiAgICAgICAgZXZ0ID0gRmlsZS5fY3JlYXRlRXZlbnQoImxvYWRlbmQiLCB0aGlzKTsKICAgICAgICB0aGlzLm9ubG9hZGVuZChldnQpOwogICAgfQp9OwoKLyoqCiAqIFJlYWQgdGV4dCBmaWxlLgogKgogKiBAcGFyYW0gZmlsZSAgICAgICAgICBUaGUgbmFtZSBvZiB0aGUgZmlsZQogKiBAcGFyYW0gZW5jb2RpbmcgICAgICBbT3B0aW9uYWxdIChzZWUgaHR0cDovL3d3dy5pYW5hLm9yZy9hc3NpZ25tZW50cy9jaGFyYWN0ZXItc2V0cykKICovCkZpbGVSZWFkZXIucHJvdG90eXBlLnJlYWRBc1RleHQgPSBmdW5jdGlvbihmaWxlLCBlbmNvZGluZykgewogICAgdGhpcy5maWxlTmFtZSA9ICIiOwoJaWYgKHR5cGVvZiBmaWxlLmZ1bGxQYXRoID09PSAidW5kZWZpbmVkIikgewoJCXRoaXMuZmlsZU5hbWUgPSBmaWxlOwoJfSBlbHNlIHsKCQl0aGlzLmZpbGVOYW1lID0gZmlsZS5mdWxsUGF0aDsKCX0KCiAgICAvLyBMT0FESU5HIHN0YXRlCiAgICB0aGlzLnJlYWR5U3RhdGUgPSBGaWxlUmVhZGVyLkxPQURJTkc7CgogICAgLy8gSWYgbG9hZHN0YXJ0IGNhbGxiYWNrCiAgICBpZiAodHlwZW9mIHRoaXMub25sb2Fkc3RhcnQgPT09ICJmdW5jdGlvbiIpIHsKICAgICAgICB2YXIgZXZ0ID0gRmlsZS5fY3JlYXRlRXZlbnQoImxvYWRzdGFydCIsIHRoaXMpOwogICAgICAgIHRoaXMub25sb2Fkc3RhcnQoZXZ0KTsKICAgIH0KCiAgICAvLyBEZWZhdWx0IGVuY29kaW5nIGlzIFVURi04CiAgICB2YXIgZW5jID0gZW5jb2RpbmcgPyBlbmNvZGluZyA6ICJVVEYtOCI7CgogICAgdmFyIG1lID0gdGhpczsKCiAgICAvLyBSZWFkIGZpbGUKICAgIG5hdmlnYXRvci5maWxlTWdyLnJlYWRBc1RleHQodGhpcy5maWxlTmFtZSwgZW5jLAoKICAgICAgICAvLyBTdWNjZXNzIGNhbGxiYWNrCiAgICAgICAgZnVuY3Rpb24ocikgewogICAgICAgICAgICB2YXIgZXZ0OwoKICAgICAgICAgICAgLy8gSWYgRE9ORSAoY2FuY2VsbGVkKSwgdGhlbiBkb24ndCBkbyBhbnl0aGluZwogICAgICAgICAgICBpZiAobWUucmVhZHlTdGF0ZSA9PT0gRmlsZVJlYWRlci5ET05FKSB7CiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIC8vIFNhdmUgcmVzdWx0CiAgICAgICAgICAgIG1lLnJlc3VsdCA9IGRlY29kZVVSSUNvbXBvbmVudChyKTsKCiAgICAgICAgICAgIC8vIElmIG9ubG9hZCBjYWxsYmFjawogICAgICAgICAgICBpZiAodHlwZW9mIG1lLm9ubG9hZCA9PT0gImZ1bmN0aW9uIikgewogICAgICAgICAgICAgICAgZXZ0ID0gRmlsZS5fY3JlYXRlRXZlbnQoImxvYWQiLCBtZSk7CiAgICAgICAgICAgICAgICBtZS5vbmxvYWQoZXZ0KTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgLy8gRE9ORSBzdGF0ZQogICAgICAgICAgICBtZS5yZWFkeVN0YXRlID0gRmlsZVJlYWRlci5ET05FOwoKICAgICAgICAgICAgLy8gSWYgb25sb2FkZW5kIGNhbGxiYWNrCiAgICAgICAgICAgIGlmICh0eXBlb2YgbWUub25sb2FkZW5kID09PSAiZnVuY3Rpb24iKSB7CiAgICAgICAgICAgICAgICBldnQgPSBGaWxlLl9jcmVhdGVFdmVudCgibG9hZGVuZCIsIG1lKTsKICAgICAgICAgICAgICAgIG1lLm9ubG9hZGVuZChldnQpOwogICAgICAgICAgICB9CiAgICAgICAgfSwKCiAgICAgICAgLy8gRXJyb3IgY2FsbGJhY2sKICAgICAgICBmdW5jdGlvbihlKSB7CiAgICAgICAgICAgIHZhciBldnQ7CiAgICAgICAgICAgIC8vIElmIERPTkUgKGNhbmNlbGxlZCksIHRoZW4gZG9uJ3QgZG8gYW55dGhpbmcKICAgICAgICAgICAgaWYgKG1lLnJlYWR5U3RhdGUgPT09IEZpbGVSZWFkZXIuRE9ORSkgewogICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9CgogICAgICAgICAgICAvLyBTYXZlIGVycm9yCiAgICAgICAgICAgIG1lLmVycm9yID0gZTsKCiAgICAgICAgICAgIC8vIElmIG9uZXJyb3IgY2FsbGJhY2sKICAgICAgICAgICAgaWYgKHR5cGVvZiBtZS5vbmVycm9yID09PSAiZnVuY3Rpb24iKSB7CiAgICAgICAgICAgICAgICBldnQgPSBGaWxlLl9jcmVhdGVFdmVudCgiZXJyb3IiLCBtZSk7CiAgICAgICAgICAgICAgICBtZS5vbmVycm9yKGV2dCk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIC8vIERPTkUgc3RhdGUKICAgICAgICAgICAgbWUucmVhZHlTdGF0ZSA9IEZpbGVSZWFkZXIuRE9ORTsKCiAgICAgICAgICAgIC8vIElmIG9ubG9hZGVuZCBjYWxsYmFjawogICAgICAgICAgICBpZiAodHlwZW9mIG1lLm9ubG9hZGVuZCA9PT0gImZ1bmN0aW9uIikgewogICAgICAgICAgICAgICAgZXZ0ID0gRmlsZS5fY3JlYXRlRXZlbnQoImxvYWRlbmQiLCBtZSk7CiAgICAgICAgICAgICAgICBtZS5vbmxvYWRlbmQoZXZ0KTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICApOwp9OwoKCi8qKgogKiBSZWFkIGZpbGUgYW5kIHJldHVybiBkYXRhIGFzIGEgYmFzZTY0IGVuY29kZWQgZGF0YSB1cmwuCiAqIEEgZGF0YSB1cmwgaXMgb2YgdGhlIGZvcm06CiAqICAgICAgZGF0YTpbPG1lZGlhdHlwZT5dWztiYXNlNjRdLDxkYXRhPgogKgogKiBAcGFyYW0gZmlsZSAgICAgICAgICB7RmlsZX0gRmlsZSBvYmplY3QgY29udGFpbmluZyBmaWxlIHByb3BlcnRpZXMKICovCkZpbGVSZWFkZXIucHJvdG90eXBlLnJlYWRBc0RhdGFVUkwgPSBmdW5jdGlvbihmaWxlKSB7CiAgICB0aGlzLmZpbGVOYW1lID0gIiI7CiAgICAKICAgIGlmICh0eXBlb2YgZmlsZS5mdWxsUGF0aCA9PT0gInVuZGVmaW5lZCIpIHsKICAgICAgICB0aGlzLmZpbGVOYW1lID0gZmlsZTsKICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy5maWxlTmFtZSA9IGZpbGUuZnVsbFBhdGg7CiAgICB9CgogICAgLy8gTE9BRElORyBzdGF0ZQogICAgdGhpcy5yZWFkeVN0YXRlID0gRmlsZVJlYWRlci5MT0FESU5HOwoKICAgIC8vIElmIGxvYWRzdGFydCBjYWxsYmFjawogICAgaWYgKHR5cGVvZiB0aGlzLm9ubG9hZHN0YXJ0ID09PSAiZnVuY3Rpb24iKSB7CiAgICAgICAgdmFyIGV2dCA9IEZpbGUuX2NyZWF0ZUV2ZW50KCJsb2Fkc3RhcnQiLCB0aGlzKTsKICAgICAgICB0aGlzLm9ubG9hZHN0YXJ0KGV2dCk7CiAgICB9CgogICAgdmFyIG1lID0gdGhpczsKCiAgICAvLyBSZWFkIGZpbGUKICAgIG5hdmlnYXRvci5maWxlTWdyLnJlYWRBc0RhdGFVUkwodGhpcy5maWxlTmFtZSwKCiAgICAgICAgLy8gU3VjY2VzcyBjYWxsYmFjawogICAgICAgIGZ1bmN0aW9uKHIpIHsKICAgICAgICAgICAgdmFyIGV2dDsKCiAgICAgICAgICAgIC8vIElmIERPTkUgKGNhbmNlbGxlZCksIHRoZW4gZG9uJ3QgZG8gYW55dGhpbmcKICAgICAgICAgICAgaWYgKG1lLnJlYWR5U3RhdGUgPT09IEZpbGVSZWFkZXIuRE9ORSkgewogICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9CgogICAgICAgICAgICAvLyBTYXZlIHJlc3VsdAogICAgICAgICAgICBtZS5yZXN1bHQgPSByOwoKICAgICAgICAgICAgLy8gSWYgb25sb2FkIGNhbGxiYWNrCiAgICAgICAgICAgIGlmICh0eXBlb2YgbWUub25sb2FkID09PSAiZnVuY3Rpb24iKSB7CiAgICAgICAgICAgICAgICBldnQgPSBGaWxlLl9jcmVhdGVFdmVudCgibG9hZCIsIG1lKTsKICAgICAgICAgICAgICAgIG1lLm9ubG9hZChldnQpOwogICAgICAgICAgICB9CgogICAgICAgICAgICAvLyBET05FIHN0YXRlCiAgICAgICAgICAgIG1lLnJlYWR5U3RhdGUgPSBGaWxlUmVhZGVyLkRPTkU7CgogICAgICAgICAgICAvLyBJZiBvbmxvYWRlbmQgY2FsbGJhY2sKICAgICAgICAgICAgaWYgKHR5cGVvZiBtZS5vbmxvYWRlbmQgPT09ICJmdW5jdGlvbiIpIHsKICAgICAgICAgICAgICAgIGV2dCA9IEZpbGUuX2NyZWF0ZUV2ZW50KCJsb2FkZW5kIiwgbWUpOwogICAgICAgICAgICAgICAgbWUub25sb2FkZW5kKGV2dCk7CiAgICAgICAgICAgIH0KICAgICAgICB9LAoKICAgICAgICAvLyBFcnJvciBjYWxsYmFjawogICAgICAgIGZ1bmN0aW9uKGUpIHsKICAgICAgICAgICAgdmFyIGV2dDsKICAgICAgICAgICAgLy8gSWYgRE9ORSAoY2FuY2VsbGVkKSwgdGhlbiBkb24ndCBkbyBhbnl0aGluZwogICAgICAgICAgICBpZiAobWUucmVhZHlTdGF0ZSA9PT0gRmlsZVJlYWRlci5ET05FKSB7CiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIC8vIFNhdmUgZXJyb3IKICAgICAgICAgICAgbWUuZXJyb3IgPSBlOwoKICAgICAgICAgICAgLy8gSWYgb25lcnJvciBjYWxsYmFjawogICAgICAgICAgICBpZiAodHlwZW9mIG1lLm9uZXJyb3IgPT09ICJmdW5jdGlvbiIpIHsKICAgICAgICAgICAgICAgIGV2dCA9IEZpbGUuX2NyZWF0ZUV2ZW50KCJlcnJvciIsIG1lKTsKICAgICAgICAgICAgICAgIG1lLm9uZXJyb3IoZXZ0KTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgLy8gRE9ORSBzdGF0ZQogICAgICAgICAgICBtZS5yZWFkeVN0YXRlID0gRmlsZVJlYWRlci5ET05FOwoKICAgICAgICAgICAgLy8gSWYgb25sb2FkZW5kIGNhbGxiYWNrCiAgICAgICAgICAgIGlmICh0eXBlb2YgbWUub25sb2FkZW5kID09PSAiZnVuY3Rpb24iKSB7CiAgICAgICAgICAgICAgICBldnQgPSBGaWxlLl9jcmVhdGVFdmVudCgibG9hZGVuZCIsIG1lKTsKICAgICAgICAgICAgICAgIG1lLm9ubG9hZGVuZChldnQpOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgICk7Cn07CgovKioKICogUmVhZCBmaWxlIGFuZCByZXR1cm4gZGF0YSBhcyBhIGJpbmFyeSBkYXRhLgogKgogKiBAcGFyYW0gZmlsZSAgICAgICAgICBUaGUgbmFtZSBvZiB0aGUgZmlsZQogKi8KRmlsZVJlYWRlci5wcm90b3R5cGUucmVhZEFzQmluYXJ5U3RyaW5nID0gZnVuY3Rpb24oZmlsZSkgewogICAgLy8gVE9ETyAtIENhbid0IHJldHVybiBiaW5hcnkgZGF0YSB0byBicm93c2VyLgogICAgdGhpcy5maWxlTmFtZSA9IGZpbGU7Cn07CgovKioKICogUmVhZCBmaWxlIGFuZCByZXR1cm4gZGF0YSBhcyBhIGJpbmFyeSBkYXRhLgogKgogKiBAcGFyYW0gZmlsZSAgICAgICAgICBUaGUgbmFtZSBvZiB0aGUgZmlsZQogKi8KRmlsZVJlYWRlci5wcm90b3R5cGUucmVhZEFzQXJyYXlCdWZmZXIgPSBmdW5jdGlvbihmaWxlKSB7CiAgICAvLyBUT0RPIC0gQ2FuJ3QgcmV0dXJuIGJpbmFyeSBkYXRhIHRvIGJyb3dzZXIuCiAgICB0aGlzLmZpbGVOYW1lID0gZmlsZTsKfTsKCi8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KLy8gRmlsZSBXcml0ZXIKLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQoKLyoqCiAqIFRoaXMgY2xhc3Mgd3JpdGVzIHRvIHRoZSBtb2JpbGUgZGV2aWNlIGZpbGUgc3lzdGVtLgogKgogIEBwYXJhbSBmaWxlIHtGaWxlfSBhIEZpbGUgb2JqZWN0IHJlcHJlc2VudGluZyBhIGZpbGUgb24gdGhlIGZpbGUgc3lzdGVtCiovCkZpbGVXcml0ZXIgPSBmdW5jdGlvbihmaWxlKSB7CiAgICB0aGlzLmZpbGVOYW1lID0gIiI7CiAgICB0aGlzLmxlbmd0aCA9IDA7CglpZiAoZmlsZSkgewoJICAgIHRoaXMuZmlsZU5hbWUgPSBmaWxlLmZ1bGxQYXRoIHx8IGZpbGU7CgkgICAgdGhpcy5sZW5ndGggPSBmaWxlLnNpemUgfHwgMDsKCX0KCQoJLy8gZGVmYXVsdCBpcyB0byB3cml0ZSBhdCB0aGUgYmVnaW5uaW5nIG9mIHRoZSBmaWxlCiAgICB0aGlzLnBvc2l0aW9uID0gMDsKICAgIAogICAgdGhpcy5yZWFkeVN0YXRlID0gMDsgLy8gRU1QVFkKCiAgICB0aGlzLnJlc3VsdCA9IG51bGw7CgogICAgLy8gRXJyb3IKICAgIHRoaXMuZXJyb3IgPSBudWxsOwoKICAgIC8vIEV2ZW50IGhhbmRsZXJzCiAgICB0aGlzLm9ud3JpdGVzdGFydCA9IG51bGw7CS8vIFdoZW4gd3JpdGluZyBzdGFydHMKICAgIHRoaXMub25wcm9ncmVzcyA9IG51bGw7CQkvLyBXaGlsZSB3cml0aW5nIHRoZSBmaWxlLCBhbmQgcmVwb3J0aW5nIHBhcnRpYWwgZmlsZSBkYXRhCiAgICB0aGlzLm9ud3JpdGUgPSBudWxsOwkJLy8gV2hlbiB0aGUgd3JpdGUgaGFzIHN1Y2Nlc3NmdWxseSBjb21wbGV0ZWQuCiAgICB0aGlzLm9ud3JpdGVlbmQgPSBudWxsOwkJLy8gV2hlbiB0aGUgcmVxdWVzdCBoYXMgY29tcGxldGVkIChlaXRoZXIgaW4gc3VjY2VzcyBvciBmYWlsdXJlKS4KICAgIHRoaXMub25hYm9ydCA9IG51bGw7CQkvLyBXaGVuIHRoZSB3cml0ZSBoYXMgYmVlbiBhYm9ydGVkLiBGb3IgaW5zdGFuY2UsIGJ5IGludm9raW5nIHRoZSBhYm9ydCgpIG1ldGhvZC4KICAgIHRoaXMub25lcnJvciA9IG51bGw7CQkvLyBXaGVuIHRoZSB3cml0ZSBoYXMgZmFpbGVkIChzZWUgZXJyb3JzKS4KfQoKLy8gU3RhdGVzCkZpbGVXcml0ZXIuSU5JVCA9IDA7CkZpbGVXcml0ZXIuV1JJVElORyA9IDE7CkZpbGVXcml0ZXIuRE9ORSA9IDI7CgovKioKICogQWJvcnQgd3JpdGluZyBmaWxlLgogKi8KRmlsZVdyaXRlci5wcm90b3R5cGUuYWJvcnQgPSBmdW5jdGlvbigpIHsKICAgIC8vIGNoZWNrIGZvciBpbnZhbGlkIHN0YXRlCglpZiAodGhpcy5yZWFkeVN0YXRlID09PSBGaWxlV3JpdGVyLkRPTkUgfHwgdGhpcy5yZWFkeVN0YXRlID09PSBGaWxlV3JpdGVyLklOSVQpIHsKCQl0aHJvdyBGaWxlRXJyb3IuSU5WQUxJRF9TVEFURV9FUlI7Cgl9IAoKICAgIC8vIHNldCBlcnJvcgogICAgdmFyIGVycm9yID0gbmV3IEZpbGVFcnJvcigpLCBldnQ7CiAgICBlcnJvci5jb2RlID0gZXJyb3IuQUJPUlRfRVJSOwogICAgdGhpcy5lcnJvciA9IGVycm9yOwogICAgCiAgICAvLyBJZiBlcnJvciBjYWxsYmFjawogICAgaWYgKHR5cGVvZiB0aGlzLm9uZXJyb3IgPT09ICJmdW5jdGlvbiIpIHsKICAgICAgICBldnQgPSBGaWxlLl9jcmVhdGVFdmVudCgiZXJyb3IiLCB0aGlzKTsKICAgICAgICB0aGlzLm9uZXJyb3IoZXZ0KTsKICAgIH0KICAgIC8vIElmIGFib3J0IGNhbGxiYWNrCiAgICBpZiAodHlwZW9mIHRoaXMub25hYm9ydCA9PT0gImZ1bmN0aW9uIikgewogICAgICAgIGV2dCA9IEZpbGUuX2NyZWF0ZUV2ZW50KCJhYm9ydCIsIHRoaXMpOwogICAgICAgIHRoaXMub25hYm9ydChldnQpOwogICAgfQogICAgCiAgICB0aGlzLnJlYWR5U3RhdGUgPSBGaWxlV3JpdGVyLkRPTkU7CgogICAgLy8gSWYgd3JpdGUgZW5kIGNhbGxiYWNrCiAgICBpZiAodHlwZW9mIHRoaXMub253cml0ZWVuZCA9PSAiZnVuY3Rpb24iKSB7CiAgICAgICAgZXZ0ID0gRmlsZS5fY3JlYXRlRXZlbnQoIndyaXRlZW5kIiwgdGhpcyk7CiAgICAgICAgdGhpcy5vbndyaXRlZW5kKGV2dCk7CiAgICB9Cn07CgovKioKICogQERlcHJlY2F0ZWQ6IHVzZSB3cml0ZSBpbnN0ZWFkCiAqIAogKiBAcGFyYW0gZmlsZSB0byB3cml0ZSB0aGUgZGF0YSB0bwogKiBAcGFyYW0gdGV4dCB0byBiZSB3cml0dGVuCiAqIEBwYXJhbSBiQXBwZW5kIGlmIHRydWUgd3JpdGUgdG8gZW5kIG9mIGZpbGUsIG90aGVyd2lzZSBvdmVyd3JpdGUgdGhlIGZpbGUKICovCkZpbGVXcml0ZXIucHJvdG90eXBlLndyaXRlQXNUZXh0ID0gZnVuY3Rpb24oZmlsZSwgdGV4dCwgYkFwcGVuZCkgewoJLy8gVGhyb3cgYW4gZXhjZXB0aW9uIGlmIHdlIGFyZSBhbHJlYWR5IHdyaXRpbmcgYSBmaWxlCglpZiAodGhpcy5yZWFkeVN0YXRlID09PSBGaWxlV3JpdGVyLldSSVRJTkcpIHsKCQl0aHJvdyBGaWxlRXJyb3IuSU5WQUxJRF9TVEFURV9FUlI7Cgl9CgoJaWYgKGJBcHBlbmQgIT09IHRydWUpIHsKICAgICAgICBiQXBwZW5kID0gZmFsc2U7IC8vIGZvciBudWxsIHZhbHVlcwogICAgfQoKICAgIHRoaXMuZmlsZU5hbWUgPSBmaWxlOwoKICAgIC8vIFdSSVRJTkcgc3RhdGUKICAgIHRoaXMucmVhZHlTdGF0ZSA9IEZpbGVXcml0ZXIuV1JJVElORzsKCiAgICB2YXIgbWUgPSB0aGlzOwoKICAgIC8vIElmIG9ud3JpdGVzdGFydCBjYWxsYmFjawogICAgaWYgKHR5cGVvZiBtZS5vbndyaXRlc3RhcnQgPT09ICJmdW5jdGlvbiIpIHsKICAgICAgICB2YXIgZXZ0ID0gRmlsZS5fY3JlYXRlRXZlbnQoIndyaXRlc3RhcnQiLCBtZSk7CiAgICAgICAgbWUub253cml0ZXN0YXJ0KGV2dCk7CiAgICB9CgkKCQogICAgLy8gV3JpdGUgZmlsZSAKCW5hdmlnYXRvci5maWxlTWdyLndyaXRlQXNUZXh0KGZpbGUsIHRleHQsIGJBcHBlbmQsCiAgICAgICAgLy8gU3VjY2VzcyBjYWxsYmFjawogICAgICAgIGZ1bmN0aW9uKHIpIHsKICAgICAgICAgICAgdmFyIGV2dDsKCiAgICAgICAgICAgIC8vIElmIERPTkUgKGNhbmNlbGxlZCksIHRoZW4gZG9uJ3QgZG8gYW55dGhpbmcKICAgICAgICAgICAgaWYgKG1lLnJlYWR5U3RhdGUgPT09IEZpbGVXcml0ZXIuRE9ORSkgewogICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9CgogICAgICAgICAgICAvLyBTYXZlIHJlc3VsdAogICAgICAgICAgICBtZS5yZXN1bHQgPSByOwoKICAgICAgICAgICAgLy8gSWYgb253cml0ZSBjYWxsYmFjawogICAgICAgICAgICBpZiAodHlwZW9mIG1lLm9ud3JpdGUgPT09ICJmdW5jdGlvbiIpIHsKICAgICAgICAgICAgICAgIGV2dCA9IEZpbGUuX2NyZWF0ZUV2ZW50KCJ3cml0ZSIsIG1lKTsKICAgICAgICAgICAgICAgIG1lLm9ud3JpdGUoZXZ0KTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgLy8gRE9ORSBzdGF0ZQogICAgICAgICAgICBtZS5yZWFkeVN0YXRlID0gRmlsZVdyaXRlci5ET05FOwoKICAgICAgICAgICAgLy8gSWYgb253cml0ZWVuZCBjYWxsYmFjawogICAgICAgICAgICBpZiAodHlwZW9mIG1lLm9ud3JpdGVlbmQgPT09ICJmdW5jdGlvbiIpIHsKICAgICAgICAgICAgICAgIGV2dCA9IEZpbGUuX2NyZWF0ZUV2ZW50KCJ3cml0ZWVuZCIsIG1lKTsKICAgICAgICAgICAgICAgIG1lLm9ud3JpdGVlbmQoZXZ0KTsKICAgICAgICAgICAgfQogICAgICAgIH0sCgogICAgICAgIC8vIEVycm9yIGNhbGxiYWNrCiAgICAgICAgZnVuY3Rpb24oZSkgewogICAgICAgICAgICB2YXIgZXZ0OwoKICAgICAgICAgICAgLy8gSWYgRE9ORSAoY2FuY2VsbGVkKSwgdGhlbiBkb24ndCBkbyBhbnl0aGluZwogICAgICAgICAgICBpZiAobWUucmVhZHlTdGF0ZSA9PT0gRmlsZVdyaXRlci5ET05FKSB7CiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIC8vIFNhdmUgZXJyb3IKICAgICAgICAgICAgbWUuZXJyb3IgPSBlOwoKICAgICAgICAgICAgLy8gSWYgb25lcnJvciBjYWxsYmFjawogICAgICAgICAgICBpZiAodHlwZW9mIG1lLm9uZXJyb3IgPT09ICJmdW5jdGlvbiIpIHsKICAgICAgICAgICAgICAgIGV2dCA9IEZpbGUuX2NyZWF0ZUV2ZW50KCJlcnJvciIsIG1lKTsKICAgICAgICAgICAgICAgIG1lLm9uZXJyb3IoZXZ0KTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgLy8gRE9ORSBzdGF0ZQogICAgICAgICAgICBtZS5yZWFkeVN0YXRlID0gRmlsZVdyaXRlci5ET05FOwoKICAgICAgICAgICAgLy8gSWYgb253cml0ZWVuZCBjYWxsYmFjawogICAgICAgICAgICBpZiAodHlwZW9mIG1lLm9ud3JpdGVlbmQgPT09ICJmdW5jdGlvbiIpIHsKICAgICAgICAgICAgICAgIGV2dCA9IEZpbGUuX2NyZWF0ZUV2ZW50KCJ3cml0ZWVuZCIsIG1lKTsKICAgICAgICAgICAgICAgIG1lLm9ud3JpdGVlbmQoZXZ0KTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICk7Cn07CgovKioKICogV3JpdGVzIGRhdGEgdG8gdGhlIGZpbGUKICogIAogKiBAcGFyYW0gdGV4dCB0byBiZSB3cml0dGVuCiAqLwpGaWxlV3JpdGVyLnByb3RvdHlwZS53cml0ZSA9IGZ1bmN0aW9uKHRleHQpIHsKCS8vIFRocm93IGFuIGV4Y2VwdGlvbiBpZiB3ZSBhcmUgYWxyZWFkeSB3cml0aW5nIGEgZmlsZQoJaWYgKHRoaXMucmVhZHlTdGF0ZSA9PT0gRmlsZVdyaXRlci5XUklUSU5HKSB7CgkJdGhyb3cgRmlsZUVycm9yLklOVkFMSURfU1RBVEVfRVJSOwoJfQoKICAgIC8vIFdSSVRJTkcgc3RhdGUKICAgIHRoaXMucmVhZHlTdGF0ZSA9IEZpbGVXcml0ZXIuV1JJVElORzsKCiAgICB2YXIgbWUgPSB0aGlzOwoKICAgIC8vIElmIG9ud3JpdGVzdGFydCBjYWxsYmFjawogICAgaWYgKHR5cGVvZiBtZS5vbndyaXRlc3RhcnQgPT09ICJmdW5jdGlvbiIpIHsKICAgICAgICB2YXIgZXZ0ID0gRmlsZS5fY3JlYXRlRXZlbnQoIndyaXRlc3RhcnQiLCBtZSk7CiAgICAgICAgbWUub253cml0ZXN0YXJ0KGV2dCk7CiAgICB9CgogICAgLy8gV3JpdGUgZmlsZQogICAgbmF2aWdhdG9yLmZpbGVNZ3Iud3JpdGUodGhpcy5maWxlTmFtZSwgdGV4dCwgdGhpcy5wb3NpdGlvbiwKCiAgICAgICAgLy8gU3VjY2VzcyBjYWxsYmFjawogICAgICAgIGZ1bmN0aW9uKHIpIHsKICAgICAgICAgICAgdmFyIGV2dDsKICAgICAgICAgICAgLy8gSWYgRE9ORSAoY2FuY2VsbGVkKSwgdGhlbiBkb24ndCBkbyBhbnl0aGluZwogICAgICAgICAgICBpZiAobWUucmVhZHlTdGF0ZSA9PT0gRmlsZVdyaXRlci5ET05FKSB7CiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIAogICAgICAgICAgICAvLyBwb3NpdGlvbiBhbHdheXMgaW5jcmVhc2VzIGJ5IGJ5dGVzIHdyaXR0ZW4gYmVjYXVzZSBmaWxlIHdvdWxkIGJlIGV4dGVuZGVkCiAgICAgICAgICAgIG1lLnBvc2l0aW9uICs9IHI7CgkJCS8vIFRoZSBsZW5ndGggb2YgdGhlIGZpbGUgaXMgbm93IHdoZXJlIHdlIGFyZSBkb25lIHdyaXRpbmcuCgkJCW1lLmxlbmd0aCA9IG1lLnBvc2l0aW9uOwogICAgICAgICAgICAKICAgICAgICAgICAgLy8gSWYgb253cml0ZSBjYWxsYmFjawogICAgICAgICAgICBpZiAodHlwZW9mIG1lLm9ud3JpdGUgPT09ICJmdW5jdGlvbiIpIHsKICAgICAgICAgICAgICAgIGV2dCA9IEZpbGUuX2NyZWF0ZUV2ZW50KCJ3cml0ZSIsIG1lKTsKICAgICAgICAgICAgICAgIG1lLm9ud3JpdGUoZXZ0KTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgLy8gRE9ORSBzdGF0ZQogICAgICAgICAgICBtZS5yZWFkeVN0YXRlID0gRmlsZVdyaXRlci5ET05FOwoKICAgICAgICAgICAgLy8gSWYgb253cml0ZWVuZCBjYWxsYmFjawogICAgICAgICAgICBpZiAodHlwZW9mIG1lLm9ud3JpdGVlbmQgPT09ICJmdW5jdGlvbiIpIHsKICAgICAgICAgICAgICAgIGV2dCA9IEZpbGUuX2NyZWF0ZUV2ZW50KCJ3cml0ZWVuZCIsIG1lKTsKICAgICAgICAgICAgICAgIG1lLm9ud3JpdGVlbmQoZXZ0KTsKICAgICAgICAgICAgfQogICAgICAgIH0sCgogICAgICAgIC8vIEVycm9yIGNhbGxiYWNrCiAgICAgICAgZnVuY3Rpb24oZSkgewogICAgICAgICAgICB2YXIgZXZ0OwoKICAgICAgICAgICAgLy8gSWYgRE9ORSAoY2FuY2VsbGVkKSwgdGhlbiBkb24ndCBkbyBhbnl0aGluZwogICAgICAgICAgICBpZiAobWUucmVhZHlTdGF0ZSA9PT0gRmlsZVdyaXRlci5ET05FKSB7CiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIC8vIFNhdmUgZXJyb3IKICAgICAgICAgICAgbWUuZXJyb3IgPSBlOwoKICAgICAgICAgICAgLy8gSWYgb25lcnJvciBjYWxsYmFjawogICAgICAgICAgICBpZiAodHlwZW9mIG1lLm9uZXJyb3IgPT09ICJmdW5jdGlvbiIpIHsKICAgICAgICAgICAgICAgIGV2dCA9IEZpbGUuX2NyZWF0ZUV2ZW50KCJlcnJvciIsIG1lKTsKICAgICAgICAgICAgICAgIG1lLm9uZXJyb3IoZXZ0KTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgLy8gRE9ORSBzdGF0ZQogICAgICAgICAgICBtZS5yZWFkeVN0YXRlID0gRmlsZVdyaXRlci5ET05FOwoKICAgICAgICAgICAgLy8gSWYgb253cml0ZWVuZCBjYWxsYmFjawogICAgICAgICAgICBpZiAodHlwZW9mIG1lLm9ud3JpdGVlbmQgPT09ICJmdW5jdGlvbiIpIHsKICAgICAgICAgICAgICAgIGV2dCA9IEZpbGUuX2NyZWF0ZUV2ZW50KCJ3cml0ZWVuZCIsIG1lKTsKICAgICAgICAgICAgICAgIG1lLm9ud3JpdGVlbmQoZXZ0KTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICApOwoKfTsKCi8qKiAKICogTW92ZXMgdGhlIGZpbGUgcG9pbnRlciB0byB0aGUgbG9jYXRpb24gc3BlY2lmaWVkLgogKiAKICogSWYgdGhlIG9mZnNldCBpcyBhIG5lZ2F0aXZlIG51bWJlciB0aGUgcG9zaXRpb24gb2YgdGhlIGZpbGUgCiAqIHBvaW50ZXIgaXMgcmV3b3VuZC4gIElmIHRoZSBvZmZzZXQgaXMgZ3JlYXRlciB0aGFuIHRoZSBmaWxlIAogKiBzaXplIHRoZSBwb3NpdGlvbiBpcyBzZXQgdG8gdGhlIGVuZCBvZiB0aGUgZmlsZS4gIAogKiAKICogQHBhcmFtIG9mZnNldCBpcyB0aGUgbG9jYXRpb24gdG8gbW92ZSB0aGUgZmlsZSBwb2ludGVyIHRvLgogKi8KRmlsZVdyaXRlci5wcm90b3R5cGUuc2VlayA9IGZ1bmN0aW9uKG9mZnNldCkgewogICAgLy8gVGhyb3cgYW4gZXhjZXB0aW9uIGlmIHdlIGFyZSBhbHJlYWR5IHdyaXRpbmcgYSBmaWxlCiAgICBpZiAodGhpcy5yZWFkeVN0YXRlID09PSBGaWxlV3JpdGVyLldSSVRJTkcpIHsKICAgICAgICB0aHJvdyBGaWxlRXJyb3IuSU5WQUxJRF9TVEFURV9FUlI7CiAgICB9CgogICAgaWYgKCFvZmZzZXQpIHsKICAgICAgICByZXR1cm47CiAgICB9CiAgICAKICAgIC8vIFNlZSBiYWNrIGZyb20gZW5kIG9mIGZpbGUuCiAgICBpZiAob2Zmc2V0IDwgMCkgewoJCXRoaXMucG9zaXRpb24gPSBNYXRoLm1heChvZmZzZXQgKyB0aGlzLmxlbmd0aCwgMCk7Cgl9CiAgICAvLyBPZmZzZXQgaXMgYmlnZ2VyIHRoZW4gZmlsZSBzaXplIHNvIHNldCBwb3NpdGlvbiAKICAgIC8vIHRvIHRoZSBlbmQgb2YgdGhlIGZpbGUuCgllbHNlIGlmIChvZmZzZXQgPiB0aGlzLmxlbmd0aCkgewoJCXRoaXMucG9zaXRpb24gPSB0aGlzLmxlbmd0aDsKCX0KICAgIC8vIE9mZnNldCBpcyBiZXR3ZWVuIDAgYW5kIGZpbGUgc2l6ZSBzbyBzZXQgdGhlIHBvc2l0aW9uCiAgICAvLyB0byBzdGFydCB3cml0aW5nLgoJZWxzZSB7CgkJdGhpcy5wb3NpdGlvbiA9IG9mZnNldDsKCX0JCn07CgovKiogCiAqIFRydW5jYXRlcyB0aGUgZmlsZSB0byB0aGUgc2l6ZSBzcGVjaWZpZWQuCiAqIAogKiBAcGFyYW0gc2l6ZSB0byBjaG9wIHRoZSBmaWxlIGF0LgogKi8KRmlsZVdyaXRlci5wcm90b3R5cGUudHJ1bmNhdGUgPSBmdW5jdGlvbihzaXplKSB7CgkvLyBUaHJvdyBhbiBleGNlcHRpb24gaWYgd2UgYXJlIGFscmVhZHkgd3JpdGluZyBhIGZpbGUKCWlmICh0aGlzLnJlYWR5U3RhdGUgPT09IEZpbGVXcml0ZXIuV1JJVElORykgewoJCXRocm93IEZpbGVFcnJvci5JTlZBTElEX1NUQVRFX0VSUjsKCX0KCS8vIHdoYXQgaWYgbm8gc2l6ZSBzcGVjaWZpZWQ/IAoKICAgIC8vIFdSSVRJTkcgc3RhdGUKICAgIHRoaXMucmVhZHlTdGF0ZSA9IEZpbGVXcml0ZXIuV1JJVElORzsKCiAgICB2YXIgbWUgPSB0aGlzOwoKICAgIC8vIElmIG9ud3JpdGVzdGFydCBjYWxsYmFjawogICAgaWYgKHR5cGVvZiBtZS5vbndyaXRlc3RhcnQgPT09ICJmdW5jdGlvbiIpIHsKICAgICAgICB2YXIgZXZ0ID0gRmlsZS5fY3JlYXRlRXZlbnQoIndyaXRlc3RhcnQiLCBtZSk7CiAgICAgICAgbWUub253cml0ZXN0YXJ0KGV2dCk7CiAgICB9CgogICAgLy8gV3JpdGUgZmlsZQogICAgbmF2aWdhdG9yLmZpbGVNZ3IudHJ1bmNhdGUodGhpcy5maWxlTmFtZSwgc2l6ZSwKCiAgICAgICAgLy8gU3VjY2VzcyBjYWxsYmFjawogICAgICAgIGZ1bmN0aW9uKHIpIHsKICAgICAgICAgICAgdmFyIGV2dDsKICAgICAgICAgICAgLy8gSWYgRE9ORSAoY2FuY2VsbGVkKSwgdGhlbiBkb24ndCBkbyBhbnl0aGluZwogICAgICAgICAgICBpZiAobWUucmVhZHlTdGF0ZSA9PT0gRmlsZVdyaXRlci5ET05FKSB7CiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIC8vIFVwZGF0ZSB0aGUgbGVuZ3RoIG9mIHRoZSBmaWxlCiAgICAgICAgICAgIG1lLmxlbmd0aCA9IHI7CiAgICAgICAgICAgIG1lLnBvc2l0aW9uID0gTWF0aC5taW4obWUucG9zaXRpb24sIHIpOwoKICAgICAgICAgICAgLy8gSWYgb253cml0ZSBjYWxsYmFjawogICAgICAgICAgICBpZiAodHlwZW9mIG1lLm9ud3JpdGUgPT09ICJmdW5jdGlvbiIpIHsKICAgICAgICAgICAgICAgIGV2dCA9IEZpbGUuX2NyZWF0ZUV2ZW50KCJ3cml0ZSIsIG1lKTsKICAgICAgICAgICAgICAgIG1lLm9ud3JpdGUoZXZ0KTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgLy8gRE9ORSBzdGF0ZQogICAgICAgICAgICBtZS5yZWFkeVN0YXRlID0gRmlsZVdyaXRlci5ET05FOwoKICAgICAgICAgICAgLy8gSWYgb253cml0ZWVuZCBjYWxsYmFjawogICAgICAgICAgICBpZiAodHlwZW9mIG1lLm9ud3JpdGVlbmQgPT09ICJmdW5jdGlvbiIpIHsKICAgICAgICAgICAgICAgIGV2dCA9IEZpbGUuX2NyZWF0ZUV2ZW50KCJ3cml0ZWVuZCIsIG1lKTsKICAgICAgICAgICAgICAgIG1lLm9ud3JpdGVlbmQoZXZ0KTsKICAgICAgICAgICAgfQogICAgICAgIH0sCgogICAgICAgIC8vIEVycm9yIGNhbGxiYWNrCiAgICAgICAgZnVuY3Rpb24oZSkgewogICAgICAgICAgICB2YXIgZXZ0OwogICAgICAgICAgICAvLyBJZiBET05FIChjYW5jZWxsZWQpLCB0aGVuIGRvbid0IGRvIGFueXRoaW5nCiAgICAgICAgICAgIGlmIChtZS5yZWFkeVN0YXRlID09PSBGaWxlV3JpdGVyLkRPTkUpIHsKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgLy8gU2F2ZSBlcnJvcgogICAgICAgICAgICBtZS5lcnJvciA9IGU7CgogICAgICAgICAgICAvLyBJZiBvbmVycm9yIGNhbGxiYWNrCiAgICAgICAgICAgIGlmICh0eXBlb2YgbWUub25lcnJvciA9PT0gImZ1bmN0aW9uIikgewogICAgICAgICAgICAgICAgZXZ0ID0gRmlsZS5fY3JlYXRlRXZlbnQoImVycm9yIiwgbWUpOwogICAgICAgICAgICAgICAgbWUub25lcnJvcihldnQpOwogICAgICAgICAgICB9CgogICAgICAgICAgICAvLyBET05FIHN0YXRlCiAgICAgICAgICAgIG1lLnJlYWR5U3RhdGUgPSBGaWxlV3JpdGVyLkRPTkU7CgogICAgICAgICAgICAvLyBJZiBvbndyaXRlZW5kIGNhbGxiYWNrCiAgICAgICAgICAgIGlmICh0eXBlb2YgbWUub253cml0ZWVuZCA9PT0gImZ1bmN0aW9uIikgewogICAgICAgICAgICAgICAgZXZ0ID0gRmlsZS5fY3JlYXRlRXZlbnQoIndyaXRlZW5kIiwgbWUpOwogICAgICAgICAgICAgICAgbWUub253cml0ZWVuZChldnQpOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgKTsKfTsKCkxvY2FsRmlsZVN5c3RlbSA9IGZ1bmN0aW9uKCkgewp9OwoKLy8gRmlsZSBlcnJvciBjb2RlcwpMb2NhbEZpbGVTeXN0ZW0uVEVNUE9SQVJZID0gMDsKTG9jYWxGaWxlU3lzdGVtLlBFUlNJU1RFTlQgPSAxOwpMb2NhbEZpbGVTeXN0ZW0uUkVTT1VSQ0UgPSAyOwpMb2NhbEZpbGVTeXN0ZW0uQVBQTElDQVRJT04gPSAzOwoKLyoqCiAqIFJlcXVlc3RzIGEgZmlsZXN5c3RlbSBpbiB3aGljaCB0byBzdG9yZSBhcHBsaWNhdGlvbiBkYXRhLgogKiAKICogQHBhcmFtIHtpbnR9IHR5cGUgb2YgZmlsZSBzeXN0ZW0gYmVpbmcgcmVxdWVzdGVkCiAqIEBwYXJhbSB7RnVuY3Rpb259IHN1Y2Nlc3NDYWxsYmFjayBpcyBjYWxsZWQgd2l0aCB0aGUgbmV3IEZpbGVTeXN0ZW0KICogQHBhcmFtIHtGdW5jdGlvbn0gZXJyb3JDYWxsYmFjayBpcyBjYWxsZWQgd2l0aCBhIEZpbGVFcnJvcgogKi8KTG9jYWxGaWxlU3lzdGVtLnByb3RvdHlwZS5yZXF1ZXN0RmlsZVN5c3RlbSA9IGZ1bmN0aW9uKHR5cGUsIHNpemUsIHN1Y2Nlc3NDYWxsYmFjaywgZXJyb3JDYWxsYmFjaykgewoJaWYgKHR5cGUgPCAwIHx8IHR5cGUgPiAzKSB7CgkJaWYgKHR5cGVvZiBlcnJvckNhbGxiYWNrID09ICJmdW5jdGlvbiIpIHsKCQkJZXJyb3JDYWxsYmFjayh7CgkJCQkiY29kZSI6IEZpbGVFcnJvci5TWU5UQVhfRVJSCgkJCX0pOwoJCX0KCX0KCWVsc2UgewoJCVBob25lR2FwLmV4ZWMoc3VjY2Vzc0NhbGxiYWNrLCBlcnJvckNhbGxiYWNrLCAiRmlsZSIsICJyZXF1ZXN0RmlsZVN5c3RlbSIsIFt0eXBlLCBzaXplXSk7Cgl9Cn07CgovKioKICogCiAqIEBwYXJhbSB7RE9NU3RyaW5nfSB1cmkgcmVmZXJyaW5nIHRvIGEgbG9jYWwgZmlsZSBpbiBhIGZpbGVzeXN0ZW0KICogQHBhcmFtIHtGdW5jdGlvbn0gc3VjY2Vzc0NhbGxiYWNrIGlzIGNhbGxlZCB3aXRoIHRoZSBuZXcgZW50cnkKICogQHBhcmFtIHtGdW5jdGlvbn0gZXJyb3JDYWxsYmFjayBpcyBjYWxsZWQgd2l0aCBhIEZpbGVFcnJvcgogKi8KTG9jYWxGaWxlU3lzdGVtLnByb3RvdHlwZS5yZXNvbHZlTG9jYWxGaWxlU3lzdGVtVVJJID0gZnVuY3Rpb24odXJpLCBzdWNjZXNzQ2FsbGJhY2ssIGVycm9yQ2FsbGJhY2spIHsKICAgIFBob25lR2FwLmV4ZWMoc3VjY2Vzc0NhbGxiYWNrLCBlcnJvckNhbGxiYWNrLCAiRmlsZSIsICJyZXNvbHZlTG9jYWxGaWxlU3lzdGVtVVJJIiwgW3VyaV0pOwp9OwoKLyoqCiogVGhpcyBmdW5jdGlvbiAgaXMgcmVxdWlyZWQgYXMgd2UgbmVlZCB0byBjb252ZXJ0IHJhdyAKKiBKU09OIG9iamVjdHMgaW50byBjb25jcmV0ZSBGaWxlIGFuZCBEaXJlY3Rvcnkgb2JqZWN0cy4gIAoqIAoqIEBwYXJhbSBhIEpTT04gT2JqZWN0cyB0aGF0IG5lZWQgdG8gYmUgY29udmVydGVkIHRvIERpcmVjdG9yeUVudHJ5IG9yIEZpbGVFbnRyeSBvYmplY3RzLgoqIEByZXR1cm5zIGFuIGVudHJ5IAoqLwpMb2NhbEZpbGVTeXN0ZW0ucHJvdG90eXBlLl9jYXN0RlMgPSBmdW5jdGlvbihwbHVnaW5SZXN1bHQpIHsKICAgIHZhciBlbnRyeSA9IG51bGw7CiAgICBlbnRyeSA9IG5ldyBEaXJlY3RvcnlFbnRyeSgpOwogICAgZW50cnkuaXNEaXJlY3RvcnkgPSBwbHVnaW5SZXN1bHQubWVzc2FnZS5yb290LmlzRGlyZWN0b3J5OwogICAgZW50cnkuaXNGaWxlID0gcGx1Z2luUmVzdWx0Lm1lc3NhZ2Uucm9vdC5pc0ZpbGU7CiAgICBlbnRyeS5uYW1lID0gcGx1Z2luUmVzdWx0Lm1lc3NhZ2Uucm9vdC5uYW1lOwogICAgZW50cnkuZnVsbFBhdGggPSBwbHVnaW5SZXN1bHQubWVzc2FnZS5yb290LmZ1bGxQYXRoOwogICAgcGx1Z2luUmVzdWx0Lm1lc3NhZ2Uucm9vdCA9IGVudHJ5OwogICAgcmV0dXJuIHBsdWdpblJlc3VsdDsgICAgCn0KCkxvY2FsRmlsZVN5c3RlbS5wcm90b3R5cGUuX2Nhc3RFbnRyeSA9IGZ1bmN0aW9uKHBsdWdpblJlc3VsdCkgewogICAgdmFyIGVudHJ5ID0gbnVsbDsKICAgIGlmIChwbHVnaW5SZXN1bHQubWVzc2FnZS5pc0RpcmVjdG9yeSkgewogICAgICAgIGVudHJ5ID0gbmV3IERpcmVjdG9yeUVudHJ5KCk7CiAgICB9CiAgICBlbHNlIGlmIChwbHVnaW5SZXN1bHQubWVzc2FnZS5pc0ZpbGUpIHsKCQllbnRyeSA9IG5ldyBGaWxlRW50cnkoKTsKICAgIH0KICAgIGVudHJ5LmlzRGlyZWN0b3J5ID0gcGx1Z2luUmVzdWx0Lm1lc3NhZ2UuaXNEaXJlY3Rvcnk7CiAgICBlbnRyeS5pc0ZpbGUgPSBwbHVnaW5SZXN1bHQubWVzc2FnZS5pc0ZpbGU7CiAgICBlbnRyeS5uYW1lID0gcGx1Z2luUmVzdWx0Lm1lc3NhZ2UubmFtZTsKICAgIGVudHJ5LmZ1bGxQYXRoID0gcGx1Z2luUmVzdWx0Lm1lc3NhZ2UuZnVsbFBhdGg7CiAgICBwbHVnaW5SZXN1bHQubWVzc2FnZSA9IGVudHJ5OwogICAgcmV0dXJuIHBsdWdpblJlc3VsdDsgICAgCn0KCkxvY2FsRmlsZVN5c3RlbS5wcm90b3R5cGUuX2Nhc3RFbnRyaWVzID0gZnVuY3Rpb24ocGx1Z2luUmVzdWx0KSB7CiAgICB2YXIgZW50cmllcyA9IHBsdWdpblJlc3VsdC5tZXNzYWdlOwoJdmFyIHJldFZhbCA9IFtdOyAKCWZvciAoaT0wOyBpPGVudHJpZXMubGVuZ3RoOyBpKyspIHsKCQlyZXRWYWwucHVzaCh3aW5kb3cubG9jYWxGaWxlU3lzdGVtLl9jcmVhdGVFbnRyeShlbnRyaWVzW2ldKSk7Cgl9CiAgICBwbHVnaW5SZXN1bHQubWVzc2FnZSA9IHJldFZhbDsKICAgIHJldHVybiBwbHVnaW5SZXN1bHQ7ICAgIAp9CgpMb2NhbEZpbGVTeXN0ZW0ucHJvdG90eXBlLl9jcmVhdGVFbnRyeSA9IGZ1bmN0aW9uKGNhc3RNZSkgewoJdmFyIGVudHJ5ID0gbnVsbDsKICAgIGlmIChjYXN0TWUuaXNEaXJlY3RvcnkpIHsKICAgICAgICBlbnRyeSA9IG5ldyBEaXJlY3RvcnlFbnRyeSgpOwogICAgfQogICAgZWxzZSBpZiAoY2FzdE1lLmlzRmlsZSkgewogICAgICAgIGVudHJ5ID0gbmV3IEZpbGVFbnRyeSgpOwogICAgfQogICAgZW50cnkuaXNEaXJlY3RvcnkgPSBjYXN0TWUuaXNEaXJlY3Rvcnk7CiAgICBlbnRyeS5pc0ZpbGUgPSBjYXN0TWUuaXNGaWxlOwogICAgZW50cnkubmFtZSA9IGNhc3RNZS5uYW1lOwogICAgZW50cnkuZnVsbFBhdGggPSBjYXN0TWUuZnVsbFBhdGg7CiAgICByZXR1cm4gZW50cnk7ICAgIAoKfQoKTG9jYWxGaWxlU3lzdGVtLnByb3RvdHlwZS5fY2FzdERhdGUgPSBmdW5jdGlvbihwbHVnaW5SZXN1bHQpIHsKCWlmIChwbHVnaW5SZXN1bHQubWVzc2FnZS5tb2RpZmljYXRpb25UaW1lKSB7CgkJdmFyIG1ldGFkYXRhT2JqID0gbmV3IE1ldGFkYXRhKCk7CgkJCgkgICAgbWV0YWRhdGFPYmoubW9kaWZpY2F0aW9uVGltZSA9IG5ldyBEYXRlKHBsdWdpblJlc3VsdC5tZXNzYWdlLm1vZGlmaWNhdGlvblRpbWUpOwoJICAgIHBsdWdpblJlc3VsdC5tZXNzYWdlID0gbWV0YWRhdGFPYmo7Cgl9CgllbHNlIGlmIChwbHVnaW5SZXN1bHQubWVzc2FnZS5sYXN0TW9kaWZpZWREYXRlKSB7CgkJdmFyIGZpbGUgPSBuZXcgRmlsZSgpOwogICAgICAgIGZpbGUuc2l6ZSA9IHBsdWdpblJlc3VsdC5tZXNzYWdlLnNpemU7CiAgICAgICAgZmlsZS50eXBlID0gcGx1Z2luUmVzdWx0Lm1lc3NhZ2UudHlwZTsKICAgICAgICBmaWxlLm5hbWUgPSBwbHVnaW5SZXN1bHQubWVzc2FnZS5uYW1lOwogICAgICAgIGZpbGUuZnVsbFBhdGggPSBwbHVnaW5SZXN1bHQubWVzc2FnZS5mdWxsUGF0aDsKCQlmaWxlLmxhc3RNb2RpZmVkRGF0ZSA9IG5ldyBEYXRlKHBsdWdpblJlc3VsdC5tZXNzYWdlLmxhc3RNb2RpZmllZERhdGUpOwoJICAgIHBsdWdpblJlc3VsdC5tZXNzYWdlID0gZmlsZTsJCQoJfQoKICAgIHJldHVybiBwbHVnaW5SZXN1bHQ7CQp9CkxvY2FsRmlsZVN5c3RlbS5wcm90b3R5cGUuX2Nhc3RFcnJvciA9IGZ1bmN0aW9uKHBsdWdpblJlc3VsdCkgewoJdmFyIGZpbGVFcnJvciA9IG5ldyBGaWxlRXJyb3IoKTsKCWZpbGVFcnJvci5jb2RlID0gcGx1Z2luUmVzdWx0Lm1lc3NhZ2U7CglwbHVnaW5SZXN1bHQubWVzc2FnZSA9IGZpbGVFcnJvcjsKCXJldHVybiBwbHVnaW5SZXN1bHQ7Cn0KCi8qKgogKiBJbmZvcm1hdGlvbiBhYm91dCB0aGUgc3RhdGUgb2YgdGhlIGZpbGUgb3IgZGlyZWN0b3J5CiAqIAogKiB7RGF0ZX0gbW9kaWZpY2F0aW9uVGltZSAocmVhZG9ubHkpCiAqLwpNZXRhZGF0YSA9IGZ1bmN0aW9uKCkgewogICAgdGhpcy5tb2RpZmljYXRpb25UaW1lPW51bGw7Cn07CgovKioKICogU3VwcGxpZXMgYXJndW1lbnRzIHRvIG1ldGhvZHMgdGhhdCBsb29rdXAgb3IgY3JlYXRlIGZpbGVzIGFuZCBkaXJlY3RvcmllcwogKiAKICogQHBhcmFtIHtib29sZWFufSBjcmVhdGUgZmlsZSBvciBkaXJlY3RvcnkgaWYgaXQgZG9lc24ndCBleGlzdCAKICogQHBhcmFtIHtib29sZWFufSBleGNsdXNpdmUgaWYgdHJ1ZSB0aGUgY29tbWFuZCB3aWxsIGZhaWwgaWYgdGhlIGZpbGUgb3IgZGlyZWN0b3J5IGV4aXN0cwogKi8KRmxhZ3MgPSBmdW5jdGlvbihjcmVhdGUsIGV4Y2x1c2l2ZSkgewogICAgdGhpcy5jcmVhdGUgPSBjcmVhdGUgfHwgZmFsc2U7CiAgICB0aGlzLmV4Y2x1c2l2ZSA9IGV4Y2x1c2l2ZSB8fCBmYWxzZTsKfTsKCi8qKgogKiBBbiBpbnRlcmZhY2UgcmVwcmVzZW50aW5nIGEgZmlsZSBzeXN0ZW0KICogCiAqIHtET01TdHJpbmd9IG5hbWUgdGhlIHVuaXF1ZSBuYW1lIG9mIHRoZSBmaWxlIHN5c3RlbSAocmVhZG9ubHkpCiAqIHtEaXJlY3RvcnlFbnRyeX0gcm9vdCBkaXJlY3Rvcnkgb2YgdGhlIGZpbGUgc3lzdGVtIChyZWFkb25seSkKICovCkZpbGVTeXN0ZW0gPSBmdW5jdGlvbigpIHsKICAgIHRoaXMubmFtZSA9IG51bGw7CiAgICB0aGlzLnJvb3QgPSBudWxsOwp9OwoKLyoqCiAqIEFuIGludGVyZmFjZSByZXByZXNlbnRpbmcgYSBkaXJlY3Rvcnkgb24gdGhlIGZpbGUgc3lzdGVtLgogKiAKICoge2Jvb2xlYW59IGlzRmlsZSBhbHdheXMgZmFsc2UgKHJlYWRvbmx5KQogKiB7Ym9vbGVhbn0gaXNEaXJlY3RvcnkgYWx3YXlzIHRydWUgKHJlYWRvbmx5KQogKiB7RE9NU3RyaW5nfSBuYW1lIG9mIHRoZSBkaXJlY3RvcnksIGV4Y2x1ZGluZyB0aGUgcGF0aCBsZWFkaW5nIHRvIGl0IChyZWFkb25seSkKICoge0RPTVN0cmluZ30gZnVsbFBhdGggdGhlIGFic29sdXRlIGZ1bGwgcGF0aCB0byB0aGUgZGlyZWN0b3J5IChyZWFkb25seSkKICoge0ZpbGVTeXN0ZW19IGZpbGVzeXN0ZW0gb24gd2hpY2ggdGhlIGRpcmVjdG9yeSByZXNpZGVzIChyZWFkb25seSkKICovCkRpcmVjdG9yeUVudHJ5ID0gZnVuY3Rpb24oKSB7CiAgICB0aGlzLmlzRmlsZSA9IGZhbHNlOwogICAgdGhpcy5pc0RpcmVjdG9yeSA9IHRydWU7CiAgICB0aGlzLm5hbWUgPSBudWxsOwogICAgdGhpcy5mdWxsUGF0aCA9IG51bGw7CiAgICB0aGlzLmZpbGVzeXN0ZW0gPSBudWxsOwp9OwoKLyoqCiAqIENvcGllcyBhIGRpcmVjdG9yeSB0byBhIG5ldyBsb2NhdGlvbgogKiAKICogQHBhcmFtIHtEaXJlY3RvcnlFbnRyeX0gcGFyZW50IHRoZSBkaXJlY3RvcnkgdG8gd2hpY2ggdG8gY29weSB0aGUgZW50cnkKICogQHBhcmFtIHtET01TdHJpbmd9IG5ld05hbWUgdGhlIG5ldyBuYW1lIG9mIHRoZSBlbnRyeSwgZGVmYXVsdHMgdG8gdGhlIGN1cnJlbnQgbmFtZQogKiBAcGFyYW0ge0Z1bmN0aW9ufSBzdWNjZXNzQ2FsbGJhY2sgaXMgY2FsbGVkIHdpdGggdGhlIG5ldyBlbnRyeQogKiBAcGFyYW0ge0Z1bmN0aW9ufSBlcnJvckNhbGxiYWNrIGlzIGNhbGxlZCB3aXRoIGEgRmlsZUVycm9yCiAqLwpEaXJlY3RvcnlFbnRyeS5wcm90b3R5cGUuY29weVRvID0gZnVuY3Rpb24ocGFyZW50LCBuZXdOYW1lLCBzdWNjZXNzQ2FsbGJhY2ssIGVycm9yQ2FsbGJhY2spIHsKICAgIFBob25lR2FwLmV4ZWMoc3VjY2Vzc0NhbGxiYWNrLCBlcnJvckNhbGxiYWNrLCAiRmlsZSIsICJjb3B5VG8iLCBbdGhpcy5mdWxsUGF0aCwgcGFyZW50LCBuZXdOYW1lXSk7Cn07CgovKioKICogTG9va3MgdXAgdGhlIG1ldGFkYXRhIG9mIHRoZSBlbnRyeQogKiAKICogQHBhcmFtIHtGdW5jdGlvbn0gc3VjY2Vzc0NhbGxiYWNrIGlzIGNhbGxlZCB3aXRoIGEgTWV0YWRhdGEgb2JqZWN0CiAqIEBwYXJhbSB7RnVuY3Rpb259IGVycm9yQ2FsbGJhY2sgaXMgY2FsbGVkIHdpdGggYSBGaWxlRXJyb3IKICovCkRpcmVjdG9yeUVudHJ5LnByb3RvdHlwZS5nZXRNZXRhZGF0YSA9IGZ1bmN0aW9uKHN1Y2Nlc3NDYWxsYmFjaywgZXJyb3JDYWxsYmFjaykgewogICAgUGhvbmVHYXAuZXhlYyhzdWNjZXNzQ2FsbGJhY2ssIGVycm9yQ2FsbGJhY2ssICJGaWxlIiwgImdldE1ldGFkYXRhIiwgW3RoaXMuZnVsbFBhdGhdKTsKfTsKCi8qKgogKiBHZXRzIHRoZSBwYXJlbnQgb2YgdGhlIGVudHJ5CiAqIAogKiBAcGFyYW0ge0Z1bmN0aW9ufSBzdWNjZXNzQ2FsbGJhY2sgaXMgY2FsbGVkIHdpdGggYSBwYXJlbnQgZW50cnkKICogQHBhcmFtIHtGdW5jdGlvbn0gZXJyb3JDYWxsYmFjayBpcyBjYWxsZWQgd2l0aCBhIEZpbGVFcnJvcgogKi8KRGlyZWN0b3J5RW50cnkucHJvdG90eXBlLmdldFBhcmVudCA9IGZ1bmN0aW9uKHN1Y2Nlc3NDYWxsYmFjaywgZXJyb3JDYWxsYmFjaykgewogICAgUGhvbmVHYXAuZXhlYyhzdWNjZXNzQ2FsbGJhY2ssIGVycm9yQ2FsbGJhY2ssICJGaWxlIiwgImdldFBhcmVudCIsIFt0aGlzLmZ1bGxQYXRoXSk7Cn07CgovKioKICogTW92ZXMgYSBkaXJlY3RvcnkgdG8gYSBuZXcgbG9jYXRpb24KICogCiAqIEBwYXJhbSB7RGlyZWN0b3J5RW50cnl9IHBhcmVudCB0aGUgZGlyZWN0b3J5IHRvIHdoaWNoIHRvIG1vdmUgdGhlIGVudHJ5CiAqIEBwYXJhbSB7RE9NU3RyaW5nfSBuZXdOYW1lIHRoZSBuZXcgbmFtZSBvZiB0aGUgZW50cnksIGRlZmF1bHRzIHRvIHRoZSBjdXJyZW50IG5hbWUKICogQHBhcmFtIHtGdW5jdGlvbn0gc3VjY2Vzc0NhbGxiYWNrIGlzIGNhbGxlZCB3aXRoIHRoZSBuZXcgZW50cnkKICogQHBhcmFtIHtGdW5jdGlvbn0gZXJyb3JDYWxsYmFjayBpcyBjYWxsZWQgd2l0aCBhIEZpbGVFcnJvcgogKi8KRGlyZWN0b3J5RW50cnkucHJvdG90eXBlLm1vdmVUbyA9IGZ1bmN0aW9uKHBhcmVudCwgbmV3TmFtZSwgc3VjY2Vzc0NhbGxiYWNrLCBlcnJvckNhbGxiYWNrKSB7CiAgICBQaG9uZUdhcC5leGVjKHN1Y2Nlc3NDYWxsYmFjaywgZXJyb3JDYWxsYmFjaywgIkZpbGUiLCAibW92ZVRvIiwgW3RoaXMuZnVsbFBhdGgsIHBhcmVudCwgbmV3TmFtZV0pOwp9OwoKLyoqCiAqIFJlbW92ZXMgdGhlIGVudHJ5CiAqIAogKiBAcGFyYW0ge0Z1bmN0aW9ufSBzdWNjZXNzQ2FsbGJhY2sgaXMgY2FsbGVkIHdpdGggbm8gcGFyYW1ldGVycwogKiBAcGFyYW0ge0Z1bmN0aW9ufSBlcnJvckNhbGxiYWNrIGlzIGNhbGxlZCB3aXRoIGEgRmlsZUVycm9yCiAqLwpEaXJlY3RvcnlFbnRyeS5wcm90b3R5cGUucmVtb3ZlID0gZnVuY3Rpb24oc3VjY2Vzc0NhbGxiYWNrLCBlcnJvckNhbGxiYWNrKSB7CiAgICBQaG9uZUdhcC5leGVjKHN1Y2Nlc3NDYWxsYmFjaywgZXJyb3JDYWxsYmFjaywgIkZpbGUiLCAicmVtb3ZlIiwgW3RoaXMuZnVsbFBhdGhdKTsKfTsKCi8qKgogKiBSZXR1cm5zIGEgVVJJIHRoYXQgY2FuIGJlIHVzZWQgdG8gaWRlbnRpZnkgdGhpcyBlbnRyeS4KICogCiAqIEBwYXJhbSB7RE9NU3RyaW5nfSBtaW1lVHlwZSBmb3IgYSBGaWxlRW50cnksIHRoZSBtaW1lIHR5cGUgdG8gYmUgdXNlZCB0byBpbnRlcnByZXQgdGhlIGZpbGUsIHdoZW4gbG9hZGVkIHRocm91Z2ggdGhpcyBVUkkuCiAqIEBwYXJhbSB7RnVuY3Rpb259IHN1Y2Nlc3NDYWxsYmFjayBpcyBjYWxsZWQgd2l0aCB0aGUgbmV3IGVudHJ5CiAqIEBwYXJhbSB7RnVuY3Rpb259IGVycm9yQ2FsbGJhY2sgaXMgY2FsbGVkIHdpdGggYSBGaWxlRXJyb3IKICovCkRpcmVjdG9yeUVudHJ5LnByb3RvdHlwZS50b1VSSSA9IGZ1bmN0aW9uKG1pbWVUeXBlLCBzdWNjZXNzQ2FsbGJhY2ssIGVycm9yQ2FsbGJhY2spIHsKICAgIHJldHVybiAiZmlsZTovL2xvY2FsaG9zdCIgKyB0aGlzLmZ1bGxQYXRoOwogICAgLy9QaG9uZUdhcC5leGVjKHN1Y2Nlc3NDYWxsYmFjaywgZXJyb3JDYWxsYmFjaywgIkZpbGUiLCAidG9VUkkiLCBbdGhpcy5mdWxsUGF0aCwgbWltZVR5cGVdKTsKfTsKCi8qKgogKiBDcmVhdGVzIGEgbmV3IERpcmVjdG9yeVJlYWRlciB0byByZWFkIGVudHJpZXMgZnJvbSB0aGlzIGRpcmVjdG9yeQogKi8KRGlyZWN0b3J5RW50cnkucHJvdG90eXBlLmNyZWF0ZVJlYWRlciA9IGZ1bmN0aW9uKHN1Y2Nlc3NDYWxsYmFjaywgZXJyb3JDYWxsYmFjaykgewogICAgcmV0dXJuIG5ldyBEaXJlY3RvcnlSZWFkZXIodGhpcy5mdWxsUGF0aCk7Cn07CgovKioKICogQ3JlYXRlcyBvciBsb29rcyB1cCBhIGRpcmVjdG9yeQogKiAKICogQHBhcmFtIHtET01TdHJpbmd9IHBhdGggZWl0aGVyIGEgcmVsYXRpdmUgb3IgYWJzb2x1dGUgcGF0aCBmcm9tIHRoaXMgZGlyZWN0b3J5IGluIHdoaWNoIHRvIGxvb2sgdXAgb3IgY3JlYXRlIGEgZGlyZWN0b3J5CiAqIEBwYXJhbSB7RmxhZ3N9IG9wdGlvbnMgdG8gY3JlYXRlIG9yIGV4Y2x1aXZlbHkgY3JlYXRlIHRoZSBkaXJlY3RvcnkKICogQHBhcmFtIHtGdW5jdGlvbn0gc3VjY2Vzc0NhbGxiYWNrIGlzIGNhbGxlZCB3aXRoIHRoZSBuZXcgZW50cnkKICogQHBhcmFtIHtGdW5jdGlvbn0gZXJyb3JDYWxsYmFjayBpcyBjYWxsZWQgd2l0aCBhIEZpbGVFcnJvcgogKi8KRGlyZWN0b3J5RW50cnkucHJvdG90eXBlLmdldERpcmVjdG9yeSA9IGZ1bmN0aW9uKHBhdGgsIG9wdGlvbnMsIHN1Y2Nlc3NDYWxsYmFjaywgZXJyb3JDYWxsYmFjaykgewogICAgUGhvbmVHYXAuZXhlYyhzdWNjZXNzQ2FsbGJhY2ssIGVycm9yQ2FsbGJhY2ssICJGaWxlIiwgImdldERpcmVjdG9yeSIsIFt0aGlzLmZ1bGxQYXRoLCBwYXRoLCBvcHRpb25zXSk7Cn07CgovKioKICogQ3JlYXRlcyBvciBsb29rcyB1cCBhIGZpbGUKICogCiAqIEBwYXJhbSB7RE9NU3RyaW5nfSBwYXRoIGVpdGhlciBhIHJlbGF0aXZlIG9yIGFic29sdXRlIHBhdGggZnJvbSB0aGlzIGRpcmVjdG9yeSBpbiB3aGljaCB0byBsb29rIHVwIG9yIGNyZWF0ZSBhIGZpbGUKICogQHBhcmFtIHtGbGFnc30gb3B0aW9ucyB0byBjcmVhdGUgb3IgZXhjbHVpdmVseSBjcmVhdGUgdGhlIGZpbGUKICogQHBhcmFtIHtGdW5jdGlvbn0gc3VjY2Vzc0NhbGxiYWNrIGlzIGNhbGxlZCB3aXRoIHRoZSBuZXcgZW50cnkKICogQHBhcmFtIHtGdW5jdGlvbn0gZXJyb3JDYWxsYmFjayBpcyBjYWxsZWQgd2l0aCBhIEZpbGVFcnJvcgogKi8KRGlyZWN0b3J5RW50cnkucHJvdG90eXBlLmdldEZpbGUgPSBmdW5jdGlvbihwYXRoLCBvcHRpb25zLCBzdWNjZXNzQ2FsbGJhY2ssIGVycm9yQ2FsbGJhY2spIHsKICAgIFBob25lR2FwLmV4ZWMoc3VjY2Vzc0NhbGxiYWNrLCBlcnJvckNhbGxiYWNrLCAiRmlsZSIsICJnZXRGaWxlIiwgW3RoaXMuZnVsbFBhdGgsIHBhdGgsIG9wdGlvbnNdKTsKfTsKCi8qKgogKiBEZWxldGVzIGEgZGlyZWN0b3J5IGFuZCBhbGwgb2YgaXQncyBjb250ZW50cwogKiAKICogQHBhcmFtIHtGdW5jdGlvbn0gc3VjY2Vzc0NhbGxiYWNrIGlzIGNhbGxlZCB3aXRoIG5vIHBhcmFtZXRlcnMKICogQHBhcmFtIHtGdW5jdGlvbn0gZXJyb3JDYWxsYmFjayBpcyBjYWxsZWQgd2l0aCBhIEZpbGVFcnJvcgogKi8KRGlyZWN0b3J5RW50cnkucHJvdG90eXBlLnJlbW92ZVJlY3Vyc2l2ZWx5ID0gZnVuY3Rpb24oc3VjY2Vzc0NhbGxiYWNrLCBlcnJvckNhbGxiYWNrKSB7CiAgICBQaG9uZUdhcC5leGVjKHN1Y2Nlc3NDYWxsYmFjaywgZXJyb3JDYWxsYmFjaywgIkZpbGUiLCAicmVtb3ZlUmVjdXJzaXZlbHkiLCBbdGhpcy5mdWxsUGF0aF0pOwp9OwoKLyoqCiAqIEFuIGludGVyZmFjZSB0aGF0IGxpc3RzIHRoZSBmaWxlcyBhbmQgZGlyZWN0b3JpZXMgaW4gYSBkaXJlY3RvcnkuCiAqLwpEaXJlY3RvcnlSZWFkZXIgPSBmdW5jdGlvbihmdWxsUGF0aCl7Cgl0aGlzLmZ1bGxQYXRoID0gZnVsbFBhdGggfHwgbnVsbDsgICAgCn07CgovKioKICogUmV0dXJucyBhIGxpc3Qgb2YgZW50cmllcyBmcm9tIGEgZGlyZWN0b3J5LgogKiAKICogQHBhcmFtIHtGdW5jdGlvbn0gc3VjY2Vzc0NhbGxiYWNrIGlzIGNhbGxlZCB3aXRoIGEgbGlzdCBvZiBlbnRyaWVzCiAqIEBwYXJhbSB7RnVuY3Rpb259IGVycm9yQ2FsbGJhY2sgaXMgY2FsbGVkIHdpdGggYSBGaWxlRXJyb3IKICovCkRpcmVjdG9yeVJlYWRlci5wcm90b3R5cGUucmVhZEVudHJpZXMgPSBmdW5jdGlvbihzdWNjZXNzQ2FsbGJhY2ssIGVycm9yQ2FsbGJhY2spIHsKICAgIFBob25lR2FwLmV4ZWMoc3VjY2Vzc0NhbGxiYWNrLCBlcnJvckNhbGxiYWNrLCAiRmlsZSIsICJyZWFkRW50cmllcyIsIFt0aGlzLmZ1bGxQYXRoXSk7Cn0KIAovKioKICogQW4gaW50ZXJmYWNlIHJlcHJlc2VudGluZyBhIGRpcmVjdG9yeSBvbiB0aGUgZmlsZSBzeXN0ZW0uCiAqIAogKiB7Ym9vbGVhbn0gaXNGaWxlIGFsd2F5cyB0cnVlIChyZWFkb25seSkKICoge2Jvb2xlYW59IGlzRGlyZWN0b3J5IGFsd2F5cyBmYWxzZSAocmVhZG9ubHkpCiAqIHtET01TdHJpbmd9IG5hbWUgb2YgdGhlIGZpbGUsIGV4Y2x1ZGluZyB0aGUgcGF0aCBsZWFkaW5nIHRvIGl0IChyZWFkb25seSkKICoge0RPTVN0cmluZ30gZnVsbFBhdGggdGhlIGFic29sdXRlIGZ1bGwgcGF0aCB0byB0aGUgZmlsZSAocmVhZG9ubHkpCiAqIHtGaWxlU3lzdGVtfSBmaWxlc3lzdGVtIG9uIHdoaWNoIHRoZSBkaXJlY3RvcnkgcmVzaWRlcyAocmVhZG9ubHkpCiAqLwpGaWxlRW50cnkgPSBmdW5jdGlvbigpIHsKICAgIHRoaXMuaXNGaWxlID0gdHJ1ZTsKICAgIHRoaXMuaXNEaXJlY3RvcnkgPSBmYWxzZTsKICAgIHRoaXMubmFtZSA9IG51bGw7CiAgICB0aGlzLmZ1bGxQYXRoID0gbnVsbDsKICAgIHRoaXMuZmlsZXN5c3RlbSA9IG51bGw7Cn07CgovKioKICogQ29waWVzIGEgZmlsZSB0byBhIG5ldyBsb2NhdGlvbgogKiAKICogQHBhcmFtIHtEaXJlY3RvcnlFbnRyeX0gcGFyZW50IHRoZSBkaXJlY3RvcnkgdG8gd2hpY2ggdG8gY29weSB0aGUgZW50cnkKICogQHBhcmFtIHtET01TdHJpbmd9IG5ld05hbWUgdGhlIG5ldyBuYW1lIG9mIHRoZSBlbnRyeSwgZGVmYXVsdHMgdG8gdGhlIGN1cnJlbnQgbmFtZQogKiBAcGFyYW0ge0Z1bmN0aW9ufSBzdWNjZXNzQ2FsbGJhY2sgaXMgY2FsbGVkIHdpdGggdGhlIG5ldyBlbnRyeQogKiBAcGFyYW0ge0Z1bmN0aW9ufSBlcnJvckNhbGxiYWNrIGlzIGNhbGxlZCB3aXRoIGEgRmlsZUVycm9yCiAqLwpGaWxlRW50cnkucHJvdG90eXBlLmNvcHlUbyA9IGZ1bmN0aW9uKHBhcmVudCwgbmV3TmFtZSwgc3VjY2Vzc0NhbGxiYWNrLCBlcnJvckNhbGxiYWNrKSB7CiAgICBQaG9uZUdhcC5leGVjKHN1Y2Nlc3NDYWxsYmFjaywgZXJyb3JDYWxsYmFjaywgIkZpbGUiLCAiY29weVRvIiwgW3RoaXMuZnVsbFBhdGgsIHBhcmVudCwgbmV3TmFtZV0pOwp9OwoKLyoqCiAqIExvb2tzIHVwIHRoZSBtZXRhZGF0YSBvZiB0aGUgZW50cnkKICogCiAqIEBwYXJhbSB7RnVuY3Rpb259IHN1Y2Nlc3NDYWxsYmFjayBpcyBjYWxsZWQgd2l0aCBhIE1ldGFkYXRhIG9iamVjdAogKiBAcGFyYW0ge0Z1bmN0aW9ufSBlcnJvckNhbGxiYWNrIGlzIGNhbGxlZCB3aXRoIGEgRmlsZUVycm9yCiAqLwpGaWxlRW50cnkucHJvdG90eXBlLmdldE1ldGFkYXRhID0gZnVuY3Rpb24oc3VjY2Vzc0NhbGxiYWNrLCBlcnJvckNhbGxiYWNrKSB7CiAgICBQaG9uZUdhcC5leGVjKHN1Y2Nlc3NDYWxsYmFjaywgZXJyb3JDYWxsYmFjaywgIkZpbGUiLCAiZ2V0TWV0YWRhdGEiLCBbdGhpcy5mdWxsUGF0aF0pOwp9OwoKLyoqCiAqIEdldHMgdGhlIHBhcmVudCBvZiB0aGUgZW50cnkKICogCiAqIEBwYXJhbSB7RnVuY3Rpb259IHN1Y2Nlc3NDYWxsYmFjayBpcyBjYWxsZWQgd2l0aCBhIHBhcmVudCBlbnRyeQogKiBAcGFyYW0ge0Z1bmN0aW9ufSBlcnJvckNhbGxiYWNrIGlzIGNhbGxlZCB3aXRoIGEgRmlsZUVycm9yCiAqLwpGaWxlRW50cnkucHJvdG90eXBlLmdldFBhcmVudCA9IGZ1bmN0aW9uKHN1Y2Nlc3NDYWxsYmFjaywgZXJyb3JDYWxsYmFjaykgewogICAgUGhvbmVHYXAuZXhlYyhzdWNjZXNzQ2FsbGJhY2ssIGVycm9yQ2FsbGJhY2ssICJGaWxlIiwgImdldFBhcmVudCIsIFt0aGlzLmZ1bGxQYXRoXSk7Cn07CgovKioKICogTW92ZXMgYSBkaXJlY3RvcnkgdG8gYSBuZXcgbG9jYXRpb24KICogCiAqIEBwYXJhbSB7RGlyZWN0b3J5RW50cnl9IHBhcmVudCB0aGUgZGlyZWN0b3J5IHRvIHdoaWNoIHRvIG1vdmUgdGhlIGVudHJ5CiAqIEBwYXJhbSB7RE9NU3RyaW5nfSBuZXdOYW1lIHRoZSBuZXcgbmFtZSBvZiB0aGUgZW50cnksIGRlZmF1bHRzIHRvIHRoZSBjdXJyZW50IG5hbWUKICogQHBhcmFtIHtGdW5jdGlvbn0gc3VjY2Vzc0NhbGxiYWNrIGlzIGNhbGxlZCB3aXRoIHRoZSBuZXcgZW50cnkKICogQHBhcmFtIHtGdW5jdGlvbn0gZXJyb3JDYWxsYmFjayBpcyBjYWxsZWQgd2l0aCBhIEZpbGVFcnJvcgogKi8KRmlsZUVudHJ5LnByb3RvdHlwZS5tb3ZlVG8gPSBmdW5jdGlvbihwYXJlbnQsIG5ld05hbWUsIHN1Y2Nlc3NDYWxsYmFjaywgZXJyb3JDYWxsYmFjaykgewogICAgUGhvbmVHYXAuZXhlYyhzdWNjZXNzQ2FsbGJhY2ssIGVycm9yQ2FsbGJhY2ssICJGaWxlIiwgIm1vdmVUbyIsIFt0aGlzLmZ1bGxQYXRoLCBwYXJlbnQsIG5ld05hbWVdKTsKfTsKCi8qKgogKiBSZW1vdmVzIHRoZSBlbnRyeQogKiAKICogQHBhcmFtIHtGdW5jdGlvbn0gc3VjY2Vzc0NhbGxiYWNrIGlzIGNhbGxlZCB3aXRoIG5vIHBhcmFtZXRlcnMKICogQHBhcmFtIHtGdW5jdGlvbn0gZXJyb3JDYWxsYmFjayBpcyBjYWxsZWQgd2l0aCBhIEZpbGVFcnJvcgogKi8KRmlsZUVudHJ5LnByb3RvdHlwZS5yZW1vdmUgPSBmdW5jdGlvbihzdWNjZXNzQ2FsbGJhY2ssIGVycm9yQ2FsbGJhY2spIHsKICAgIFBob25lR2FwLmV4ZWMoc3VjY2Vzc0NhbGxiYWNrLCBlcnJvckNhbGxiYWNrLCAiRmlsZSIsICJyZW1vdmUiLCBbdGhpcy5mdWxsUGF0aF0pOwp9OwoKLyoqCiAqIFJldHVybnMgYSBVUkkgdGhhdCBjYW4gYmUgdXNlZCB0byBpZGVudGlmeSB0aGlzIGVudHJ5LgogKiAKICogQHBhcmFtIHtET01TdHJpbmd9IG1pbWVUeXBlIGZvciBhIEZpbGVFbnRyeSwgdGhlIG1pbWUgdHlwZSB0byBiZSB1c2VkIHRvIGludGVycHJldCB0aGUgZmlsZSwgd2hlbiBsb2FkZWQgdGhyb3VnaCB0aGlzIFVSSS4KICogQHBhcmFtIHtGdW5jdGlvbn0gc3VjY2Vzc0NhbGxiYWNrIGlzIGNhbGxlZCB3aXRoIHRoZSBuZXcgZW50cnkKICogQHBhcmFtIHtGdW5jdGlvbn0gZXJyb3JDYWxsYmFjayBpcyBjYWxsZWQgd2l0aCBhIEZpbGVFcnJvcgogKi8KRmlsZUVudHJ5LnByb3RvdHlwZS50b1VSSSA9IGZ1bmN0aW9uKG1pbWVUeXBlLCBzdWNjZXNzQ2FsbGJhY2ssIGVycm9yQ2FsbGJhY2spIHsKICAgIHJldHVybiAiZmlsZTovL2xvY2FsaG9zdCIgKyB0aGlzLmZ1bGxQYXRoOwogICAgLy9QaG9uZUdhcC5leGVjKHN1Y2Nlc3NDYWxsYmFjaywgZXJyb3JDYWxsYmFjaywgIkZpbGUiLCAidG9VUkkiLCBbdGhpcy5mdWxsUGF0aCwgbWltZVR5cGVdKTsKfTsKCi8qKgogKiBDcmVhdGVzIGEgbmV3IEZpbGVXcml0ZXIgYXNzb2NpYXRlZCB3aXRoIHRoZSBmaWxlIHRoYXQgdGhpcyBGaWxlRW50cnkgcmVwcmVzZW50cy4KICogCiAqIEBwYXJhbSB7RnVuY3Rpb259IHN1Y2Nlc3NDYWxsYmFjayBpcyBjYWxsZWQgd2l0aCB0aGUgbmV3IEZpbGVXcml0ZXIKICogQHBhcmFtIHtGdW5jdGlvbn0gZXJyb3JDYWxsYmFjayBpcyBjYWxsZWQgd2l0aCBhIEZpbGVFcnJvcgogKi8KRmlsZUVudHJ5LnByb3RvdHlwZS5jcmVhdGVXcml0ZXIgPSBmdW5jdGlvbihzdWNjZXNzQ2FsbGJhY2ssIGVycm9yQ2FsbGJhY2spIHsKCXRoaXMuZmlsZShmdW5jdGlvbihmaWxlUG9pbnRlcikgewkKCQl2YXIgd3JpdGVyID0gbmV3IEZpbGVXcml0ZXIoZmlsZVBvaW50ZXIpOwoJCWlmICh3cml0ZXIuZmlsZU5hbWUgPT0gbnVsbCB8fCB3cml0ZXIuZmlsZU5hbWUgPT0gIiIpIHsKCQkJaWYgKHR5cGVvZiBlcnJvckNhbGxiYWNrID09ICJmdW5jdGlvbiIpIHsKCQkJCWVycm9yQ2FsbGJhY2soewoJCQkJCSJjb2RlIjogRmlsZUVycm9yLklOVkFMSURfU1RBVEVfRVJSCgkJCQl9KTsKCQl9CgkJfQoJCWlmICh0eXBlb2Ygc3VjY2Vzc0NhbGxiYWNrID09ICJmdW5jdGlvbiIpIHsKCQkJc3VjY2Vzc0NhbGxiYWNrKHdyaXRlcik7CgkJfSAgICAgICAKCX0sIGVycm9yQ2FsbGJhY2spOwp9OwoKLyoqCiAqIFJldHVybnMgYSBGaWxlIHRoYXQgcmVwcmVzZW50cyB0aGUgY3VycmVudCBzdGF0ZSBvZiB0aGUgZmlsZSB0aGF0IHRoaXMgRmlsZUVudHJ5IHJlcHJlc2VudHMuCiAqIAogKiBAcGFyYW0ge0Z1bmN0aW9ufSBzdWNjZXNzQ2FsbGJhY2sgaXMgY2FsbGVkIHdpdGggdGhlIG5ldyBGaWxlIG9iamVjdAogKiBAcGFyYW0ge0Z1bmN0aW9ufSBlcnJvckNhbGxiYWNrIGlzIGNhbGxlZCB3aXRoIGEgRmlsZUVycm9yCiAqLwpGaWxlRW50cnkucHJvdG90eXBlLmZpbGUgPSBmdW5jdGlvbihzdWNjZXNzQ2FsbGJhY2ssIGVycm9yQ2FsbGJhY2spIHsKICAgIFBob25lR2FwLmV4ZWMoc3VjY2Vzc0NhbGxiYWNrLCBlcnJvckNhbGxiYWNrLCAiRmlsZSIsICJnZXRGaWxlTWV0YWRhdGEiLCBbdGhpcy5mdWxsUGF0aF0pOwp9OwoKLyoqCiAqIEFkZCB0aGUgRmlsZVN5c3RlbSBpbnRlcmZhY2UgaW50byB0aGUgYnJvd3Nlci4KICovClBob25lR2FwLmFkZENvbnN0cnVjdG9yKGZ1bmN0aW9uKCkgewoJdmFyIHBnTG9jYWxGaWxlU3lzdGVtID0gbmV3IExvY2FsRmlsZVN5c3RlbSgpOwoJLy8gTmVlZGVkIGZvciBjYXN0IG1ldGhvZHMKICAgIGlmKHR5cGVvZiB3aW5kb3cubG9jYWxGaWxlU3lzdGVtID09ICJ1bmRlZmluZWQiKSB3aW5kb3cubG9jYWxGaWxlU3lzdGVtICA9IHBnTG9jYWxGaWxlU3lzdGVtOwogICAgaWYodHlwZW9mIHdpbmRvdy5yZXF1ZXN0RmlsZVN5c3RlbSA9PSAidW5kZWZpbmVkIikgd2luZG93LnJlcXVlc3RGaWxlU3lzdGVtICA9IHBnTG9jYWxGaWxlU3lzdGVtLnJlcXVlc3RGaWxlU3lzdGVtOwogICAgaWYodHlwZW9mIHdpbmRvdy5yZXNvbHZlTG9jYWxGaWxlU3lzdGVtVVJJID09ICJ1bmRlZmluZWQiKSB3aW5kb3cucmVzb2x2ZUxvY2FsRmlsZVN5c3RlbVVSSSA9IHBnTG9jYWxGaWxlU3lzdGVtLnJlc29sdmVMb2NhbEZpbGVTeXN0ZW1VUkk7Cn0pOwp9OwoKCgoKLyoKICogUGhvbmVHYXAgaXMgYXZhaWxhYmxlIHVuZGVyICplaXRoZXIqIHRoZSB0ZXJtcyBvZiB0aGUgbW9kaWZpZWQgQlNEIGxpY2Vuc2UgKm9yKiB0aGUKICogTUlUIExpY2Vuc2UgKDIwMDgpLiBTZWUgaHR0cDovL29wZW5zb3VyY2Uub3JnL2xpY2Vuc2VzL2FscGhhYmV0aWNhbCBmb3IgZnVsbCB0ZXh0LgogKiAgCiAqIENvcHlyaWdodCAoYykgMjAwNS0yMDExLCBOaXRvYmkgU29mdHdhcmUgSW5jLgogKiBDb3B5cmlnaHQgKGMpIDIwMTEsIE1hdHQgS2FuZQogKi8KCmlmICghUGhvbmVHYXAuaGFzUmVzb3VyY2UoImZpbGV0cmFuc2ZlciIpKSB7CglQaG9uZUdhcC5hZGRSZXNvdXJjZSgiZmlsZXRyYW5zZmVyIik7CgovKioKICogRmlsZVRyYW5zZmVyIHVwbG9hZHMgYSBmaWxlIHRvIGEgcmVtb3RlIHNlcnZlci4KICovCkZpbGVUcmFuc2ZlciA9IGZ1bmN0aW9uKCkge30KCi8qKgogKiBGaWxlVXBsb2FkUmVzdWx0CiAqLwpGaWxlVXBsb2FkUmVzdWx0ID0gZnVuY3Rpb24oKSB7CiAgICB0aGlzLmJ5dGVzU2VudCA9IDA7CiAgICB0aGlzLnJlc3BvbnNlQ29kZSA9IG51bGw7CiAgICB0aGlzLnJlc3BvbnNlID0gbnVsbDsKfQoKLyoqCiAqIEZpbGVUcmFuc2ZlckVycm9yCiAqLwpGaWxlVHJhbnNmZXJFcnJvciA9IGZ1bmN0aW9uKGVycm9yQ29kZSkgewogICAgdGhpcy5jb2RlID0gZXJyb3JDb2RlIHx8IG51bGw7Cn0KCkZpbGVUcmFuc2ZlckVycm9yLkZJTEVfTk9UX0ZPVU5EX0VSUiA9IDE7CkZpbGVUcmFuc2ZlckVycm9yLklOVkFMSURfVVJMX0VSUiA9IDI7CkZpbGVUcmFuc2ZlckVycm9yLkNPTk5FQ1RJT05fRVJSID0gMzsKCi8qKgoqIEdpdmVuIGFuIGFic29sdXRlIGZpbGUgcGF0aCwgdXBsb2FkcyBhIGZpbGUgb24gdGhlIGRldmljZSB0byBhIHJlbW90ZSBzZXJ2ZXIgCiogdXNpbmcgYSBtdWx0aXBhcnQgSFRUUCByZXF1ZXN0LgoqIEBwYXJhbSBmaWxlUGF0aCB7U3RyaW5nfSAgICAgICAgICAgRnVsbCBwYXRoIG9mIHRoZSBmaWxlIG9uIHRoZSBkZXZpY2UKKiBAcGFyYW0gc2VydmVyIHtTdHJpbmd9ICAgICAgICAgICAgIFVSTCBvZiB0aGUgc2VydmVyIHRvIHJlY2VpdmUgdGhlIGZpbGUKKiBAcGFyYW0gc3VjY2Vzc0NhbGxiYWNrIChGdW5jdGlvbn0gIENhbGxiYWNrIHRvIGJlIGludm9rZWQgd2hlbiB1cGxvYWQgaGFzIGNvbXBsZXRlZAoqIEBwYXJhbSBlcnJvckNhbGxiYWNrIHtGdW5jdGlvbn0gICAgQ2FsbGJhY2sgdG8gYmUgaW52b2tlZCB1cG9uIGVycm9yCiogQHBhcmFtIG9wdGlvbnMge0ZpbGVVcGxvYWRPcHRpb25zfSBPcHRpb25hbCBwYXJhbWV0ZXJzIHN1Y2ggYXMgZmlsZSBuYW1lIGFuZCBtaW1ldHlwZSAgICAgICAgICAgCiovCkZpbGVUcmFuc2Zlci5wcm90b3R5cGUudXBsb2FkID0gZnVuY3Rpb24oZmlsZVBhdGgsIHNlcnZlciwgc3VjY2Vzc0NhbGxiYWNrLCBlcnJvckNhbGxiYWNrLCBvcHRpb25zKSB7CglpZighb3B0aW9ucy5wYXJhbXMpIHsKCQlvcHRpb25zLnBhcmFtcyA9IHt9OwoJfQoJb3B0aW9ucy5maWxlUGF0aCA9IGZpbGVQYXRoOwoJb3B0aW9ucy5zZXJ2ZXIgPSBzZXJ2ZXI7CglpZighb3B0aW9ucy5maWxlS2V5KSB7CgkJb3B0aW9ucy5maWxlS2V5ID0gJ2ZpbGUnOwoJfQoJaWYoIW9wdGlvbnMuZmlsZU5hbWUpIHsKCQlvcHRpb25zLmZpbGVOYW1lID0gJ2ltYWdlLmpwZyc7Cgl9CglpZighb3B0aW9ucy5taW1lVHlwZSkgewoJCW9wdGlvbnMubWltZVR5cGUgPSAnaW1hZ2UvanBlZyc7Cgl9CgkKCS8vIHN1Y2Nlc3NDYWxsYmFjayByZXF1aXJlZAoJaWYgKHR5cGVvZiBzdWNjZXNzQ2FsbGJhY2sgIT0gImZ1bmN0aW9uIikgewogICAgICAgIGNvbnNvbGUubG9nKCJGaWxlVHJhbnNmZXIgRXJyb3I6IHN1Y2Nlc3NDYWxsYmFjayBpcyBub3QgYSBmdW5jdGlvbiIpOwogICAgICAgIHJldHVybjsKICAgIH0KCgogICAgLy8gZXJyb3JDYWxsYmFjayBvcHRpb25hbAogICAgaWYgKGVycm9yQ2FsbGJhY2sgJiYgKHR5cGVvZiBlcnJvckNhbGxiYWNrICE9ICJmdW5jdGlvbiIpKSB7CiAgICAgICAgY29uc29sZS5sb2coIkZpbGVUcmFuc2ZlciBFcnJvcjogZXJyb3JDYWxsYmFjayBpcyBub3QgYSBmdW5jdGlvbiIpOwogICAgICAgIHJldHVybjsKICAgIH0KCQogICAgUGhvbmVHYXAuZXhlYyhzdWNjZXNzQ2FsbGJhY2ssIGVycm9yQ2FsbGJhY2ssICdGaWxlVHJhbnNmZXInLCAndXBsb2FkJywgW29wdGlvbnNdKTsKfTsKCkZpbGVUcmFuc2Zlci5wcm90b3R5cGUuX2Nhc3RUcmFuc2ZlckVycm9yID0gZnVuY3Rpb24ocGx1Z2luUmVzdWx0KSB7Cgl2YXIgZmlsZUVycm9yID0gbmV3IEZpbGVUcmFuc2ZlckVycm9yKHBsdWdpblJlc3VsdC5tZXNzYWdlKTsKCS8vZmlsZUVycm9yLmNvZGUgPSBwbHVnaW5SZXN1bHQubWVzc2FnZTsKCXBsdWdpblJlc3VsdC5tZXNzYWdlID0gZmlsZUVycm9yOwoJcmV0dXJuIHBsdWdpblJlc3VsdDsKfQoKRmlsZVRyYW5zZmVyLnByb3RvdHlwZS5fY2FzdFVwbG9hZFJlc3VsdCA9IGZ1bmN0aW9uKHBsdWdpblJlc3VsdCkgewoJdmFyIHJlc3VsdCA9IG5ldyBGaWxlVXBsb2FkUmVzdWx0KCk7CglyZXN1bHQuYnl0ZXNTZW50ID0gcGx1Z2luUmVzdWx0Lm1lc3NhZ2UuYnl0ZXNTZW50OwoJcmVzdWx0LnJlc3BvbnNlQ29kZSA9IHBsdWdpblJlc3VsdC5tZXNzYWdlLnJlc3BvbnNlQ29kZTsKCXJlc3VsdC5yZXNwb25zZSA9IGRlY29kZVVSSUNvbXBvbmVudChwbHVnaW5SZXN1bHQubWVzc2FnZS5yZXNwb25zZSk7CglwbHVnaW5SZXN1bHQubWVzc2FnZSA9IHJlc3VsdDsKCXJldHVybiBwbHVnaW5SZXN1bHQ7Cn0KCi8qKgogKiBPcHRpb25zIHRvIGN1c3RvbWl6ZSB0aGUgSFRUUCByZXF1ZXN0IHVzZWQgdG8gdXBsb2FkIGZpbGVzLgogKiBAcGFyYW0gZmlsZUtleSB7U3RyaW5nfSAgIE5hbWUgb2YgZmlsZSByZXF1ZXN0IHBhcmFtZXRlci4KICogQHBhcmFtIGZpbGVOYW1lIHtTdHJpbmd9ICBGaWxlbmFtZSB0byBiZSB1c2VkIGJ5IHRoZSBzZXJ2ZXIuIERlZmF1bHRzIHRvIGltYWdlLmpwZy4KICogQHBhcmFtIG1pbWVUeXBlIHtTdHJpbmd9ICBNaW1ldHlwZSBvZiB0aGUgdXBsb2FkZWQgZmlsZS4gRGVmYXVsdHMgdG8gaW1hZ2UvanBlZy4KICogQHBhcmFtIHBhcmFtcyB7T2JqZWN0fSAgICBPYmplY3Qgd2l0aCBrZXk6IHZhbHVlIHBhcmFtcyB0byBzZW5kIHRvIHRoZSBzZXJ2ZXIuCiAqLwpGaWxlVXBsb2FkT3B0aW9ucyA9IGZ1bmN0aW9uKGZpbGVLZXksIGZpbGVOYW1lLCBtaW1lVHlwZSwgcGFyYW1zKSB7CiAgICB0aGlzLmZpbGVLZXkgPSBmaWxlS2V5IHx8IG51bGw7CiAgICB0aGlzLmZpbGVOYW1lID0gZmlsZU5hbWUgfHwgbnVsbDsKICAgIHRoaXMubWltZVR5cGUgPSBtaW1lVHlwZSB8fCBudWxsOwogICAgdGhpcy5wYXJhbXMgPSBwYXJhbXMgfHwgbnVsbDsKfQoKClBob25lR2FwLmFkZENvbnN0cnVjdG9yKGZ1bmN0aW9uKCkgewogICAgaWYgKHR5cGVvZiBuYXZpZ2F0b3IuZmlsZVRyYW5zZmVyID09ICJ1bmRlZmluZWQiKSBuYXZpZ2F0b3IuZmlsZVRyYW5zZmVyID0gbmV3IEZpbGVUcmFuc2ZlcigpOwp9KTsKfTsKaWYgKCFQaG9uZUdhcC5oYXNSZXNvdXJjZSgiZ2VvbG9jYXRpb24iKSkgewoJUGhvbmVHYXAuYWRkUmVzb3VyY2UoImdlb2xvY2F0aW9uIik7CgovKioKICogVGhpcyBjbGFzcyBwcm92aWRlcyBhY2Nlc3MgdG8gZGV2aWNlIEdQUyBkYXRhLgogKiBAY29uc3RydWN0b3IKICovCkdlb2xvY2F0aW9uID0gZnVuY3Rpb24oKSB7CiAgICAvLyBUaGUgbGFzdCBrbm93biBHUFMgcG9zaXRpb24uCiAgICB0aGlzLmxhc3RQb3NpdGlvbiA9IG51bGw7CiAgICB0aGlzLmxpc3RlbmVyID0gbnVsbDsKICAgIHRoaXMudGltZW91dFRpbWVySWQgPSAwOwoKfTsKCgovKioKICogQXN5bmNocm9ub3VzbHkgYXF1aXJlcyB0aGUgY3VycmVudCBwb3NpdGlvbi4KICogQHBhcmFtIHtGdW5jdGlvbn0gc3VjY2Vzc0NhbGxiYWNrIFRoZSBmdW5jdGlvbiB0byBjYWxsIHdoZW4gdGhlIHBvc2l0aW9uCiAqIGRhdGEgaXMgYXZhaWxhYmxlCiAqIEBwYXJhbSB7RnVuY3Rpb259IGVycm9yQ2FsbGJhY2sgVGhlIGZ1bmN0aW9uIHRvIGNhbGwgd2hlbiB0aGVyZSBpcyBhbiBlcnJvciAKICogZ2V0dGluZyB0aGUgcG9zaXRpb24gZGF0YS4KICogQHBhcmFtIHtQb3NpdGlvbk9wdGlvbnN9IG9wdGlvbnMgVGhlIG9wdGlvbnMgZm9yIGdldHRpbmcgdGhlIHBvc2l0aW9uIGRhdGEKICogc3VjaCBhcyB0aW1lb3V0LgogKiBQb3NpdGlvbk9wdGlvbnMuZm9yY2VQcm9tcHQ6Qm9vbCBkZWZhdWx0IGZhbHNlLCAKICogLSB0ZWxscyBpUGhvbmUgdG8gcHJvbXB0IHRoZSB1c2VyIHRvIHR1cm4gb24gbG9jYXRpb24gc2VydmljZXMuCiAqIC0gbWF5IGNhdXNlIHlvdXIgYXBwIHRvIGV4aXQgd2hpbGUgdGhlIHVzZXIgaXMgc2VudCB0byB0aGUgU2V0dGluZ3MgYXBwCiAqIFBvc2l0aW9uT3B0aW9ucy5kaXN0YW5jZUZpbHRlcjpkb3VibGUgYWthIE51bWJlcgogKiAtIHVzZWQgdG8gcmVwcmVzZW50IGEgZGlzdGFuY2UgaW4gbWV0ZXJzLgpQb3NpdGlvbk9wdGlvbnMKewogICBkZXNpcmVkQWNjdXJhY3k6TnVtYmVyCiAgIC0gYSBkaXN0YW5jZSBpbiBtZXRlcnMgCgkJPCAxMCAgID0gYmVzdCBhY2N1cmFjeSAgKCBEZWZhdWx0IHZhbHVlICkKCQk8IDEwMCAgPSBOZWFyZXN0IFRlbiBNZXRlcnMKCQk8IDEwMDAgPSBOZWFyZXN0IEh1bmRyZWQgTWV0ZXJzCgkJPCAzMDAwID0gQWNjdXJhY3kgS2lsb21ldGVycwoJCTMwMDArICA9IEFjY3VyYWN5IDMgS2lsb21ldGVycwoJCQoJZm9yY2VQcm9tcHQ6Qm9vbGVhbiBkZWZhdWx0IGZhbHNlICggaVBob25lIE9ubHkhICkKICAgIC0gdGVsbHMgaVBob25lIHRvIHByb21wdCB0aGUgdXNlciB0byB0dXJuIG9uIGxvY2F0aW9uIHNlcnZpY2VzLgoJLSBtYXkgY2F1c2UgeW91ciBhcHAgdG8gZXhpdCB3aGlsZSB0aGUgdXNlciBpcyBzZW50IHRvIHRoZSBTZXR0aW5ncyBhcHAKCQoJZGlzdGFuY2VGaWx0ZXI6TnVtYmVyCgktIFRoZSBtaW5pbXVtIGRpc3RhbmNlIChtZWFzdXJlZCBpbiBtZXRlcnMpIGEgZGV2aWNlIG11c3QgbW92ZSBsYXRlcmFsbHkgYmVmb3JlIGFuIHVwZGF0ZSBldmVudCBpcyBnZW5lcmF0ZWQuCgktIG1lYXN1cmVkIHJlbGF0aXZlIHRvIHRoZSBwcmV2aW91c2x5IGRlbGl2ZXJlZCBsb2NhdGlvbgoJLSBkZWZhdWx0IHZhbHVlOiBudWxsICggYWxsIG1vdmVtZW50cyB3aWxsIGJlIHJlcG9ydGVkICkKCQp9CgogKi8KIApHZW9sb2NhdGlvbi5wcm90b3R5cGUuZ2V0Q3VycmVudFBvc2l0aW9uID0gZnVuY3Rpb24oc3VjY2Vzc0NhbGxiYWNrLCBlcnJvckNhbGxiYWNrLCBvcHRpb25zKSAKewogICAgLy8gaWYgKHRoaXMubGlzdGVuZXIgIT0gbnVsbCkgCiAgICAvLyB7CiAgICAvLyAgICAgY29uc29sZS5sb2coIkdlb2xvY2F0aW9uIEVycm9yOiBTdGlsbCB3YWl0aW5nIGZvciBwcmV2aW91cyBnZXRDdXJyZW50UG9zaXRpb24oKSByZXF1ZXN0LiIpOwogICAgLy8gICAgIGlmIChlcnJvckNhbGxiYWNrICYmIHR5cGVvZihlcnJvckNhbGxiYWNrKSA9PSAnZnVuY3Rpb24nKQogICAgLy8gICAgIHsKICAgIC8vICAgICAgICAgZXJyb3JDYWxsYmFjayhuZXcgUG9zaXRpb25FcnJvcihQb3NpdGlvbkVycm9yLlRJTUVPVVQsICJHZW9sb2NhdGlvbiBFcnJvcjogU3RpbGwgd2FpdGluZyBmb3IgcHJldmlvdXMgZ2V0Q3VycmVudFBvc2l0aW9uKCkgcmVxdWVzdC4iKSk7CiAgICAvLyAgICAgfSAKICAgIC8vICAgICByZXR1cm4gUG9zaXRpb25FcnJvci5USU1FT1VUOwogICAgLy8gfQogICAgCiAgICAvLyBjcmVhdGUgYW4gYWx3YXlzIHZhbGlkIGxvY2FsIHN1Y2Nlc3MgY2FsbGJhY2sKICAgIHZhciB3aW4gPSBzdWNjZXNzQ2FsbGJhY2s7CiAgICBpZiAoIXdpbiB8fCB0eXBlb2Yod2luKSAhPSAnZnVuY3Rpb24nKQogICAgewogICAgICAgIHdpbiA9IGZ1bmN0aW9uKHBvc2l0aW9uKSB7fTsKICAgIH0KICAgIAogICAgLy8gY3JlYXRlIGFuIGFsd2F5cyB2YWxpZCBsb2NhbCBlcnJvciBjYWxsYmFjawogICAgdmFyIGZhaWwgPSBlcnJvckNhbGxiYWNrOwogICAgaWYgKCFmYWlsIHx8IHR5cGVvZihmYWlsKSAhPSAnZnVuY3Rpb24nKQogICAgewogICAgICAgIGZhaWwgPSBmdW5jdGlvbihwb3NpdGlvbkVycm9yKSB7fTsKICAgIH0JCgogICAgdmFyIHNlbGYgPSB0aGlzOwogICAgdmFyIHRvdGFsVGltZSA9IDA7Cgl2YXIgdGltZW91dFRpbWVySWQ7CgkKCS8vIHNldCBwYXJhbXMgdG8gb3VyIGRlZmF1bHQgdmFsdWVzCgl2YXIgcGFyYW1zID0gbmV3IFBvc2l0aW9uT3B0aW9ucygpOwoJCiAgICBpZiAob3B0aW9ucykgCiAgICB7CiAgICAgICAgaWYgKG9wdGlvbnMubWF4aW11bUFnZSkgCiAgICAgICAgewogICAgICAgICAgICAvLyBzcGVjaWFsIGNhc2UgaGVyZSBpZiB3ZSBoYXZlIGEgY2FjaGVkIHZhbHVlIHRoYXQgaXMgeW91bmdlciB0aGFuIG1heGltdW1BZ2UKICAgICAgICAgICAgaWYodGhpcy5sYXN0UG9zaXRpb24pCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIHZhciBub3cgPSBuZXcgRGF0ZSgpLmdldFRpbWUoKTsKICAgICAgICAgICAgICAgIGlmKG5vdyAtIHRoaXMubGFzdFBvc2l0aW9uLnRpbWVzdGFtcCA8IG9wdGlvbnMubWF4aW11bUFnZSkKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICB3aW4odGhpcy5sYXN0UG9zaXRpb24pOyAvLyBzZW5kIGNhY2hlZCBwb3NpdGlvbiBpbW1lZGlhdGVseSAKICAgICAgICAgICAgICAgICAgICByZXR1cm47ICAgICAgICAgICAgICAgICAvLyBOb3RlLCBleGVjdXRpb24gc3RvcHMgaGVyZSAtam0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBwYXJhbXMubWF4aW11bUFnZSA9IG9wdGlvbnMubWF4aW11bUFnZTsKICAgICAgICB9CiAgICAgICAgaWYgKG9wdGlvbnMuZW5hYmxlSGlnaEFjY3VyYWN5KSAKICAgICAgICB7CiAgICAgICAgICAgIHBhcmFtcy5lbmFibGVIaWdoQWNjdXJhY3kgPSAob3B0aW9ucy5lbmFibGVIaWdoQWNjdXJhY3kgPT0gdHJ1ZSk7IC8vIG1ha2Ugc3VyZSBpdCdzIHRydXRoeQogICAgICAgIH0KICAgICAgICBpZiAob3B0aW9ucy50aW1lb3V0KSAKICAgICAgICB7CiAgICAgICAgICAgIHBhcmFtcy50aW1lb3V0ID0gb3B0aW9ucy50aW1lb3V0OwogICAgICAgIH0KICAgIH0KICAgIAogICAgdGhpcy5saXN0ZW5lciA9IHsic3VjY2VzcyI6d2luLCJmYWlsIjpmYWlsfTsKICAgIHRoaXMuc3RhcnQocGFyYW1zKTsKCQoJdmFyIG9uVGltZW91dCA9IGZ1bmN0aW9uKCkKCXsKCSAgICBzZWxmLnNldEVycm9yKG5ldyBQb3NpdGlvbkVycm9yKFBvc2l0aW9uRXJyb3IuVElNRU9VVCwiR2VvbG9jYXRpb24gRXJyb3I6IFRpbWVvdXQuIikpOwoJfTsKCSAKICAgIHRoaXMudGltZW91dFRpbWVySWQgPSBzZXRUaW1lb3V0KG9uVGltZW91dCwgcGFyYW1zLnRpbWVvdXQpOyAKfTsKCi8qKgogKiBBc3luY2hyb25vdXNseSBhcXVpcmVzIHRoZSBwb3NpdGlvbiByZXBlYXRlZGx5IGF0IGEgZ2l2ZW4gaW50ZXJ2YWwuCiAqIEBwYXJhbSB7RnVuY3Rpb259IHN1Y2Nlc3NDYWxsYmFjayBUaGUgZnVuY3Rpb24gdG8gY2FsbCBlYWNoIHRpbWUgdGhlIHBvc2l0aW9uCiAqIGRhdGEgaXMgYXZhaWxhYmxlCiAqIEBwYXJhbSB7RnVuY3Rpb259IGVycm9yQ2FsbGJhY2sgVGhlIGZ1bmN0aW9uIHRvIGNhbGwgd2hlbiB0aGVyZSBpcyBhbiBlcnJvciAKICogZ2V0dGluZyB0aGUgcG9zaXRpb24gZGF0YS4KICogQHBhcmFtIHtQb3NpdGlvbk9wdGlvbnN9IG9wdGlvbnMgVGhlIG9wdGlvbnMgZm9yIGdldHRpbmcgdGhlIHBvc2l0aW9uIGRhdGEKICogc3VjaCBhcyB0aW1lb3V0IGFuZCB0aGUgZnJlcXVlbmN5IG9mIHRoZSB3YXRjaC4KICovCkdlb2xvY2F0aW9uLnByb3RvdHlwZS53YXRjaFBvc2l0aW9uID0gZnVuY3Rpb24oc3VjY2Vzc0NhbGxiYWNrLCBlcnJvckNhbGxiYWNrLCBvcHRpb25zKSB7CgkvLyBJbnZva2UgdGhlIGFwcHJvcHJpYXRlIGNhbGxiYWNrIHdpdGggYSBuZXcgUG9zaXRpb24gb2JqZWN0IGV2ZXJ5IHRpbWUgdGhlIGltcGxlbWVudGF0aW9uIAoJLy8gZGV0ZXJtaW5lcyB0aGF0IHRoZSBwb3NpdGlvbiBvZiB0aGUgaG9zdGluZyBkZXZpY2UgaGFzIGNoYW5nZWQuIAoKCXZhciBzZWxmID0gdGhpczsgLy8gdGhvc2UgPT0gdGhpcyAmIHRoYXQKCQoJdmFyIHBhcmFtcyA9IG5ldyBQb3NpdGlvbk9wdGlvbnMoKTsKCiAgICBpZihvcHRpb25zKQogICAgewogICAgICAgIGlmIChvcHRpb25zLm1heGltdW1BZ2UpIHsKICAgICAgICAgICAgcGFyYW1zLm1heGltdW1BZ2UgPSBvcHRpb25zLm1heGltdW1BZ2U7CiAgICAgICAgfQogICAgICAgIGlmIChvcHRpb25zLmVuYWJsZUhpZ2hBY2N1cmFjeSkgewogICAgICAgICAgICBwYXJhbXMuZW5hYmxlSGlnaEFjY3VyYWN5ID0gb3B0aW9ucy5lbmFibGVIaWdoQWNjdXJhY3k7CiAgICAgICAgfQogICAgICAgIGlmIChvcHRpb25zLnRpbWVvdXQpIHsKICAgICAgICAgICAgcGFyYW1zLnRpbWVvdXQgPSBvcHRpb25zLnRpbWVvdXQ7CiAgICAgICAgfQogICAgfQoKCXZhciB0aGF0ID0gdGhpczsKICAgIHZhciBsYXN0UG9zID0gdGhhdC5sYXN0UG9zaXRpb24/IHRoYXQubGFzdFBvc2l0aW9uLmNsb25lKCkgOiBudWxsOwogICAgCglyZXR1cm4gc2V0SW50ZXJ2YWwoZnVuY3Rpb24oKSAKCXsKICAgICAgICB2YXIgZmlsdGVyRnVuID0gZnVuY3Rpb24ocG9zaXRpb24pIHsKICAgICAgICAgICAgaWYgKGxhc3RQb3MgPT0gbnVsbCB8fCAhcG9zaXRpb24uZXF1YWxzKGxhc3RQb3MpKSB7CiAgICAgICAgICAgICAgICAvLyBvbmx5IGNhbGwgdGhlIHN1Y2Nlc3MgY2FsbGJhY2sgd2hlbiB0aGVyZSBpcyBhIGNoYW5nZSBpbiBwb3NpdGlvbiwgcGVyIFczQwogICAgICAgICAgICAgICAgc3VjY2Vzc0NhbGxiYWNrKHBvc2l0aW9uKTsKICAgICAgICAgICAgfQogICAgICAgICAgICAKICAgICAgICAgICAgLy8gY2xvbmUgdGhlIG5ldyBwb3NpdGlvbiwgc2F2ZSBpdCBhcyBvdXIgbGFzdCBwb3NpdGlvbiAoaW50ZXJuYWwgdmFyKQogICAgICAgICAgICBsYXN0UG9zID0gcG9zaXRpb24uY2xvbmUoKTsKICAgICAgICB9OwoJCXRoYXQuZ2V0Q3VycmVudFBvc2l0aW9uKGZpbHRlckZ1biwgZXJyb3JDYWxsYmFjaywgcGFyYW1zKTsKCX0sIHBhcmFtcy50aW1lb3V0KTsKfTsKCgovKioKICogQ2xlYXJzIHRoZSBzcGVjaWZpZWQgcG9zaXRpb24gd2F0Y2guCiAqIEBwYXJhbSB7U3RyaW5nfSB3YXRjaElkIFRoZSBJRCBvZiB0aGUgd2F0Y2ggcmV0dXJuZWQgZnJvbSAjd2F0Y2hQb3NpdGlvbi4KICovCkdlb2xvY2F0aW9uLnByb3RvdHlwZS5jbGVhcldhdGNoID0gZnVuY3Rpb24od2F0Y2hJZCkgewoJY2xlYXJJbnRlcnZhbCh3YXRjaElkKTsKfTsKCi8qKgogKiBDYWxsZWQgYnkgdGhlIGdlb2xvY2F0aW9uIGZyYW1ld29yayB3aGVuIHRoZSBjdXJyZW50IGxvY2F0aW9uIGlzIGZvdW5kLgogKiBAcGFyYW0ge1Bvc2l0aW9uT3B0aW9uc30gcG9zaXRpb24gVGhlIGN1cnJlbnQgcG9zaXRpb24uCiAqLwpHZW9sb2NhdGlvbi5wcm90b3R5cGUuc2V0TG9jYXRpb24gPSBmdW5jdGlvbihwb3NpdGlvbikgCnsKICAgIHZhciBfcG9zaXRpb24gPSBuZXcgUG9zaXRpb24ocG9zaXRpb24uY29vcmRzLCBwb3NpdGlvbi50aW1lc3RhbXApOwoKICAgIGlmKHRoaXMudGltZW91dFRpbWVySWQpCiAgICB7CiAgICAgICAgY2xlYXJUaW1lb3V0KHRoaXMudGltZW91dFRpbWVySWQpOwogICAgICAgIHRoaXMudGltZW91dFRpbWVySWQgPSAwOwogICAgfQogICAgCgl0aGlzLmxhc3RFcnJvciA9IG51bGw7CiAgICB0aGlzLmxhc3RQb3NpdGlvbiA9IF9wb3NpdGlvbjsKICAgIAogICAgaWYodGhpcy5saXN0ZW5lciAmJiB0eXBlb2YodGhpcy5saXN0ZW5lci5zdWNjZXNzKSA9PSAnZnVuY3Rpb24nKQogICAgewogICAgICAgIHRoaXMubGlzdGVuZXIuc3VjY2VzcyhfcG9zaXRpb24pOwogICAgfQogICAgCiAgICB0aGlzLmxpc3RlbmVyID0gbnVsbDsKfTsKCi8qKgogKiBDYWxsZWQgYnkgdGhlIGdlb2xvY2F0aW9uIGZyYW1ld29yayB3aGVuIGFuIGVycm9yIG9jY3VycyB3aGlsZSBsb29raW5nIHVwIHRoZSBjdXJyZW50IHBvc2l0aW9uLgogKiBAcGFyYW0ge1N0cmluZ30gbWVzc2FnZSBUaGUgdGV4dCBvZiB0aGUgZXJyb3IgbWVzc2FnZS4KICovCkdlb2xvY2F0aW9uLnByb3RvdHlwZS5zZXRFcnJvciA9IGZ1bmN0aW9uKGVycm9yKSAKewoJdmFyIF9lcnJvciA9IG5ldyBQb3NpdGlvbkVycm9yKGVycm9yLmNvZGUsIGVycm9yLm1lc3NhZ2UpOwoJCiAgICBpZih0aGlzLnRpbWVvdXRUaW1lcklkKQogICAgewogICAgICAgIGNsZWFyVGltZW91dCh0aGlzLnRpbWVvdXRUaW1lcklkKTsKICAgICAgICB0aGlzLnRpbWVvdXRUaW1lcklkID0gMDsKICAgIH0KICAgIAogICAgdGhpcy5sYXN0RXJyb3IgPSBfZXJyb3I7CiAgICAvLyBjYWxsIGVycm9yIGhhbmRsZXJzIGRpcmVjdGx5CiAgICBpZih0aGlzLmxpc3RlbmVyICYmIHR5cGVvZih0aGlzLmxpc3RlbmVyLmZhaWwpID09ICdmdW5jdGlvbicpCiAgICB7CiAgICAgICAgdGhpcy5saXN0ZW5lci5mYWlsKF9lcnJvcik7CiAgICB9CiAgICB0aGlzLmxpc3RlbmVyID0gbnVsbDsKCn07CgpHZW9sb2NhdGlvbi5wcm90b3R5cGUuc3RhcnQgPSBmdW5jdGlvbihhcmdzKSAKewogICAgUGhvbmVHYXAuZXhlYygiTG9jYXRpb24uc3RhcnRMb2NhdGlvbiIsIGFyZ3MpOwp9OwoKR2VvbG9jYXRpb24ucHJvdG90eXBlLnN0b3AgPSBmdW5jdGlvbigpIAp7CiAgICBQaG9uZUdhcC5leGVjKCJMb2NhdGlvbi5zdG9wTG9jYXRpb24iKTsKfTsKCgpQaG9uZUdhcC5hZGRDb25zdHJ1Y3RvcihmdW5jdGlvbigpIAp7CiAgICBpZiAodHlwZW9mIG5hdmlnYXRvci5fZ2VvID09ICJ1bmRlZmluZWQiKSAKICAgIHsKICAgICAgICAvLyByZXBsYWNlIG9yaWdPYmoncyBmdW5jdGlvbnMgKCBsaXN0ZWQgaW4gZnVua0xpc3QgKSB3aXRoIHRoZSBzYW1lIG1ldGhvZCBuYW1lIG9uIHByb3h5T2JqCiAgICAgICAgLy8gdGhpcyBpcyBhIHdvcmthcm91bmQgdG8gcHJldmVudCBVSVdlYlZpZXcvTW9iaWxlU2FmYXJpIGRlZmF1bHQgaW1wbGVtZW50YXRpb24gb2YgR2VvTG9jYXRpb24KICAgICAgICAvLyBiZWNhdXNlIGl0IGluY2x1ZGVzIHRoZSBmdWxsIHBhZ2UgcGF0aCBhcyB0aGUgdGl0bGUgb2YgdGhlIGFsZXJ0IHByb21wdAogICAgICAgIHZhciBfX3Byb3h5T2JqID0gZnVuY3Rpb24gKG9yaWdPYmoscHJveHlPYmosZnVua0xpc3QpCiAgICAgICAgewogICAgICAgICAgICB2YXIgcmVwbGFjZUZ1bmsgPSBmdW5jdGlvbihvcmcscHJveHksZk5hbWUpCiAgICAgICAgICAgIHsgCiAgICAgICAgICAgICAgICBvcmdbZk5hbWVdID0gZnVuY3Rpb24oKQogICAgICAgICAgICAgICAgeyAKICAgICAgICAgICAgICAgICAgIHJldHVybiBwcm94eVtmTmFtZV0uYXBwbHkocHJveHksYXJndW1lbnRzKTsgCiAgICAgICAgICAgICAgICB9OyAKICAgICAgICAgICAgfTsKCiAgICAgICAgICAgIGZvcih2YXIgdiBpbiBmdW5rTGlzdCkgeyByZXBsYWNlRnVuayhvcmlnT2JqLHByb3h5T2JqLGZ1bmtMaXN0W3ZdKTt9CiAgICAgICAgfQogICAgICAgIG5hdmlnYXRvci5fZ2VvID0gbmV3IEdlb2xvY2F0aW9uKCk7CiAgICAgICAgX19wcm94eU9iaihuYXZpZ2F0b3IuZ2VvbG9jYXRpb24sIG5hdmlnYXRvci5fZ2VvLAogICAgICAgICAgICAgICAgIFsic2V0TG9jYXRpb24iLCJnZXRDdXJyZW50UG9zaXRpb24iLCJ3YXRjaFBvc2l0aW9uIiwKICAgICAgICAgICAgICAgICAgImNsZWFyV2F0Y2giLCJzZXRFcnJvciIsInN0YXJ0Iiwic3RvcCJdKTsKCiAgICB9Cgp9KTsKfTsKaWYgKCFQaG9uZUdhcC5oYXNSZXNvdXJjZSgiY29tcGFzcyIpKSB7CglQaG9uZUdhcC5hZGRSZXNvdXJjZSgiY29tcGFzcyIpOwoJCi8qKgogKiBUaGlzIGNsYXNzIHByb3ZpZGVzIGFjY2VzcyB0byBkZXZpY2UgQ29tcGFzcyBkYXRhLgogKiBAY29uc3RydWN0b3IKICovCkNvbXBhc3MgPSBmdW5jdGlvbigpIHsKICAgIC8qKgogICAgICogVGhlIGxhc3Qga25vd24gQ29tcGFzcyBwb3NpdGlvbi4KICAgICAqLwogICAgLy8gbGFzdEhlYWRpbmcgYWN0dWFsbHkgY29udGFpbnMgYSBiaXQgbW9yZSBpbmZvIHRoYW4gd2hhdCB3ZSByZXR1cm4gdG8gb3VyIGNhbGxiYWNrcyAKICAgIC8vIHRpbWVzdGFtcCwgbWFnbmV0aWNIZWFkaW5nLCB0cnVlSGVhZGluZywgaGVhZGluZ0FjY3VyYWN5LCB4LCB5LCB6CiAgICAvLyBkb2NzIHNwZWNpZnkgdGhhdCB0aGUgcmV0dXJuIHZhbHVlIGlzIGEgc2ltcGxlICdoZWFkaW5nJwogICAgLy8gaWYgcG9zc2libGUgd2Ugd2lsbCB1c2UgdHJ1ZUhlYWRpbmcsIG90aGVyd2lzZSBtYWduZXRpY0hlYWRpbmcgaXMgcmV0dXJuZWQKICAgIC8vIHRydWVIZWFkaW5nIGlzIG9ubHkgYXZhaWxhYmxlIGlmIGxvY2F0aW9uIHNlcnZpY2VzIGlzIE9OCgl0aGlzLmxhc3RIZWFkaW5nID0gbnVsbDsKICAgIHRoaXMubGFzdEVycm9yID0gbnVsbDsKCXRoaXMuY2FsbGJhY2tzID0gewoJCW9uSGVhZGluZ0NoYW5nZWQ6IFtdLAogICAgICAgIG9uRXJyb3I6ICAgICAgICAgICBbXQogICAgfTsKfTsKCi8qKgogKiBBc3luY2hyb25vdXNseSBhcXVpcmVzIHRoZSBjdXJyZW50IGhlYWRpbmcuCiAqIEBwYXJhbSB7RnVuY3Rpb259IHN1Y2Nlc3NDYWxsYmFjayBUaGUgZnVuY3Rpb24gdG8gY2FsbCB3aGVuIHRoZSBoZWFkaW5nCiAqIGRhdGEgaXMgYXZhaWxhYmxlCiAqIEBwYXJhbSB7RnVuY3Rpb259IGVycm9yQ2FsbGJhY2sgVGhlIGZ1bmN0aW9uIHRvIGNhbGwgd2hlbiB0aGVyZSBpcyBhbiBlcnJvciAKICogZ2V0dGluZyB0aGUgaGVhZGluZyBkYXRhLgogKiBAcGFyYW0ge1Bvc2l0aW9uT3B0aW9uc30gb3B0aW9ucyBUaGUgb3B0aW9ucyBmb3IgZ2V0dGluZyB0aGUgaGVhZGluZyBkYXRhCiAqIHN1Y2ggYXMgdGltZW91dC4KICovCkNvbXBhc3MucHJvdG90eXBlLmdldEN1cnJlbnRIZWFkaW5nID0gZnVuY3Rpb24oc3VjY2Vzc0NhbGxiYWNrLCBlcnJvckNhbGxiYWNrLCBvcHRpb25zKSB7CglpZiAodGhpcy5sYXN0SGVhZGluZyA9PSBudWxsKSB7CiAgICAgICAgdGhpcy5jYWxsYmFja3Mub25IZWFkaW5nQ2hhbmdlZC5wdXNoKHN1Y2Nlc3NDYWxsYmFjayk7CiAgICAgICAgdGhpcy5jYWxsYmFja3Mub25FcnJvci5wdXNoKGVycm9yQ2FsbGJhY2spOwoJCXRoaXMuc3RhcnQob3B0aW9ucyk7Cgl9CgllbHNlCgl7CgkgICAgaWYob3B0aW9ucy5tYXhpbXVtQWdlKQogICAgICAgIHsKICAgICAgICAgICAgdmFyIG5vdyA9IG5ldyBEYXRlKCkuZ2V0VGltZSgpOwogICAgICAgICAgICBpZihub3cgLSB0aGlzLmxhc3RIZWFkaW5nLnRpbWVzdGFtcCA+IG9wdGlvbnMubWF4aW11bUFnZSkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgdGhpcy5jYWxsYmFja3Mub25IZWFkaW5nQ2hhbmdlZC5wdXNoKHN1Y2Nlc3NDYWxsYmFjayk7CiAgICAgICAgICAgICAgICB0aGlzLmNhbGxiYWNrcy5vbkVycm9yLnB1c2goZXJyb3JDYWxsYmFjayk7CiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIHRoaXMuc3RhcnQob3B0aW9ucyk7IC8vIHdlIGhhdmUgYSBjYWNoZWQgdmFsdWUgdGhhdCBpcyBvbGQgLi4uCiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIH0KICAgICAgICB9IAoKICAgICAgICAvLyB3ZSBoYXZlIGEgbGFzdCBoZWFkaW5nICsgaXQgaXMgTk9UIG9sZGVyIHRoYW4gbWF4aW11bUFnZSwgb3IgbWF4aW11bUFnZSBpcyBub3Qgc3BlY2lmaWVkCiAgICAgICAgaWYgKHR5cGVvZiBzdWNjZXNzQ2FsbGJhY2sgPT0gImZ1bmN0aW9uIikgCiAgICAJewogICAgCSAgICB2YXIgcmV0dXJuSGVhZGluZyA9IC0xOwogICAgCSAgICBpZih0aGlzLmxhc3RIZWFkaW5nLnRydWVIZWFkaW5nID4gLTEpCiAgICAJICAgIHsKICAgIAkgICAgICAgIHJldHVybkhlYWRpbmcgPSB0aGlzLmxhc3RIZWFkaW5nLnRydWVIZWFkaW5nOwogICAgCSAgICB9CiAgICAJICAgIGVsc2UgaWYoIHRoaXMubGFzdEhlYWRpbmcubWFnbmV0aWNIZWFkaW5nICkKICAgIAkgICAgewogICAgCSAgICAgICAgcmV0dXJuSGVhZGluZyA9IHRoaXMubGFzdEhlYWRpbmcubWFnbmV0aWNIZWFkaW5nOwogICAgCSAgICB9CiAgICAJCXN1Y2Nlc3NDYWxsYmFjayhyZXR1cm5IZWFkaW5nKTsKICAgIAl9Cgl9CgkKfTsKCi8qKgogKiBBc3luY2hyb25vdXNseSBhcXVpcmVzIHRoZSBoZWFkaW5nIHJlcGVhdGVkbHkgYXQgYSBnaXZlbiBpbnRlcnZhbC4KICogQHBhcmFtIHtGdW5jdGlvbn0gc3VjY2Vzc0NhbGxiYWNrIFRoZSBmdW5jdGlvbiB0byBjYWxsIGVhY2ggdGltZSB0aGUgaGVhZGluZwogKiBkYXRhIGlzIGF2YWlsYWJsZQogKiBAcGFyYW0ge0Z1bmN0aW9ufSBlcnJvckNhbGxiYWNrIFRoZSBmdW5jdGlvbiB0byBjYWxsIHdoZW4gdGhlcmUgaXMgYW4gZXJyb3IgCiAqIGdldHRpbmcgdGhlIGhlYWRpbmcgZGF0YS4KICogQHBhcmFtIHtIZWFkaW5nT3B0aW9uc30gb3B0aW9ucyBUaGUgb3B0aW9ucyBmb3IgZ2V0dGluZyB0aGUgaGVhZGluZyBkYXRhCiAqIHN1Y2ggYXMgdGltZW91dCBhbmQgdGhlIGZyZXF1ZW5jeSBvZiB0aGUgd2F0Y2guCiAqLwpDb21wYXNzLnByb3RvdHlwZS53YXRjaEhlYWRpbmc9IGZ1bmN0aW9uKHN1Y2Nlc3NDYWxsYmFjaywgZXJyb3JDYWxsYmFjaywgb3B0aW9ucykgCnsKCS8vIEludm9rZSB0aGUgYXBwcm9wcmlhdGUgY2FsbGJhY2sgd2l0aCBhIG5ldyBQb3NpdGlvbiBvYmplY3QgZXZlcnkgdGltZSB0aGUgaW1wbGVtZW50YXRpb24gCgkvLyBkZXRlcm1pbmVzIHRoYXQgdGhlIHBvc2l0aW9uIG9mIHRoZSBob3N0aW5nIGRldmljZSBoYXMgY2hhbmdlZC4gCgkKCXZhciBmcmVxdWVuY3kgPSAob3B0aW9ucyAmJiBvcHRpb25zLmZyZXF1ZW5jeSkgPyBvcHRpb25zLmZyZXF1ZW5jeSA6IDEwMDA7Cgl2YXIgc2VsZiA9IHRoaXM7Cgl2YXIgZnVuayA9IGZ1bmN0aW9uKCkgCgl7CgkJc2VsZi5nZXRDdXJyZW50SGVhZGluZyhzdWNjZXNzQ2FsbGJhY2ssIGVycm9yQ2FsbGJhY2ssIG9wdGlvbnMpOwoJfTsKCWZ1bmsoKTsKCXJldHVybiBzZXRJbnRlcnZhbChmdW5rLCBmcmVxdWVuY3kpOwp9OwoKCi8qKgogKiBDbGVhcnMgdGhlIHNwZWNpZmllZCBoZWFkaW5nIHdhdGNoLgogKiBAcGFyYW0ge1N0cmluZ30gd2F0Y2hJZCBUaGUgSUQgb2YgdGhlIHdhdGNoIHJldHVybmVkIGZyb20gI3dhdGNoSGVhZGluZy4KICovCkNvbXBhc3MucHJvdG90eXBlLmNsZWFyV2F0Y2ggPSBmdW5jdGlvbih3YXRjaElkKSAKewoJY2xlYXJJbnRlcnZhbCh3YXRjaElkKTsKfTsKCgovKioKICogQ2FsbGVkIGJ5IHRoZSBnZW9sb2NhdGlvbiBmcmFtZXdvcmsgd2hlbiB0aGUgY3VycmVudCBoZWFkaW5nIGlzIGZvdW5kLgogKiBAcGFyYW0ge2hlYWRpbmd9IGhlYWRpbmcgVGhlIGN1cnJlbnQgaGVhZGluZy4KICovCkNvbXBhc3MucHJvdG90eXBlLnNldEhlYWRpbmcgPSBmdW5jdGlvbihoZWFkaW5nKSAKewogICAgdGhpcy5sYXN0SGVhZGluZyA9IGhlYWRpbmc7CiAgICAvLyB0aGUgbGFzdCBoZWFkaW5nIHdlIGFyZSBzdG9yaW5nIGhhcyBsb3RzIG1vcmUgaW5mbywgYnV0IHRoZSBjdXJyZW50IEFQSSBkb2NzIG9ubHkgc3RhdGUgdGhhdCAKICAgIC8vIHRoZSBkaXJlY3Rpb24gdmFsdWUgaXMgcmV0dXJuZWQuCiAgICB2YXIgcmV0dXJuSGVhZGluZyA9IC0xOwogICAgaWYodGhpcy5sYXN0SGVhZGluZy50cnVlSGVhZGluZyA+IC0xKQogICAgewogICAgICAgIHJldHVybkhlYWRpbmcgPSB0aGlzLmxhc3RIZWFkaW5nLnRydWVIZWFkaW5nOwogICAgfQogICAgZWxzZSBpZiggdGhpcy5sYXN0SGVhZGluZy5tYWduZXRpY0hlYWRpbmcgKQogICAgewogICAgICAgIHJldHVybkhlYWRpbmcgPSB0aGlzLmxhc3RIZWFkaW5nLm1hZ25ldGljSGVhZGluZzsKICAgIH0KICAgIAogICAgdmFyIGFyciA9IHRoaXMuY2FsbGJhY2tzLm9uSGVhZGluZ0NoYW5nZWQ7CiAgICBmb3IgKHZhciBpID0gMCwgbGVuID0gYXJyLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSAKICAgIHsKICAgICAgICBhcnJbaV0ocmV0dXJuSGVhZGluZyk7CiAgICB9CiAgICAvLyBjYWxsYmFja3MgYXJlIG9ubHkgdXNlZCBvbmNlLCBzbyBjbGVhbnVwCiAgICB0aGlzLmNhbGxiYWNrcy5vbkhlYWRpbmdDaGFuZ2VkID0gW107CiAgICB0aGlzLmNhbGxiYWNrcy5vbkVycm9yID0gW107Cn07CgovKioKICogQ2FsbGVkIGJ5IHRoZSBnZW9sb2NhdGlvbiBmcmFtZXdvcmsgd2hlbiBhbiBlcnJvciBvY2N1cnMgd2hpbGUgbG9va2luZyB1cCB0aGUgY3VycmVudCBwb3NpdGlvbi4KICogQHBhcmFtIHtTdHJpbmd9IG1lc3NhZ2UgVGhlIHRleHQgb2YgdGhlIGVycm9yIG1lc3NhZ2UuCiAqLwpDb21wYXNzLnByb3RvdHlwZS5zZXRFcnJvciA9IGZ1bmN0aW9uKG1lc3NhZ2UpIAp7CiAgICB0aGlzLmxhc3RFcnJvciA9IG1lc3NhZ2U7CiAgICB2YXIgYXJyID0gdGhpcy5jYWxsYmFja3Mub25FcnJvcjsKICAgIGZvciAodmFyIGkgPSAwLGxlbiA9IGFyci5sZW5ndGg7IGkgPCBsZW47IGkrKykgCiAgICB7CiAgICAgICAgYXJyW2ldKG1lc3NhZ2UpOwogICAgfQogICAgLy8gY2FsbGJhY2tzIGFyZSBvbmx5IHVzZWQgb25jZSwgc28gY2xlYW51cAogICAgdGhpcy5jYWxsYmFja3Mub25IZWFkaW5nQ2hhbmdlZCA9IFtdOwogICAgdGhpcy5jYWxsYmFja3Mub25FcnJvciA9IFtdOwogICAgdGhpcy5zdG9wKCk7Cn07CgpDb21wYXNzLnByb3RvdHlwZS5zdGFydCA9IGZ1bmN0aW9uKGFyZ3MpIAp7CiAgICBQaG9uZUdhcC5leGVjKCJMb2NhdGlvbi5zdGFydEhlYWRpbmciLCBhcmdzKTsKfTsKCkNvbXBhc3MucHJvdG90eXBlLnN0b3AgPSBmdW5jdGlvbigpIAp7CiAgICBQaG9uZUdhcC5leGVjKCJMb2NhdGlvbi5zdG9wSGVhZGluZyIpOwp9OwoKUGhvbmVHYXAuYWRkQ29uc3RydWN0b3IoZnVuY3Rpb24oKSAKewogICAgaWYgKHR5cGVvZiBuYXZpZ2F0b3IuY29tcGFzcyA9PSAidW5kZWZpbmVkIikgCiAgICB7CiAgICAgICAgbmF2aWdhdG9yLmNvbXBhc3MgPSBuZXcgQ29tcGFzcygpOwogICAgfQp9KTsKfTsKaWYgKCFQaG9uZUdhcC5oYXNSZXNvdXJjZSgibWVkaWEiKSkgewoJUGhvbmVHYXAuYWRkUmVzb3VyY2UoIm1lZGlhIik7CgovKioKICogTWVkaWEvQXVkaW8gb3ZlcnJpZGUuCiAqCiAqLwogCk1lZGlhID0gZnVuY3Rpb24oc3JjLCBzdWNjZXNzQ2FsbGJhY2ssIGVycm9yQ2FsbGJhY2ssIGRvd25sb2FkQ29tcGxldGVDYWxsYmFjaykgewoJCglpZiAoIXNyYykgewoJCXNyYyA9ICJkb2N1bWVudHM6Ly8iICsgU3RyaW5nKChuZXcgRGF0ZSgpKS5nZXRUaW1lKCkpLnJlcGxhY2UoL1xEL2dpLCcnKTsgLy8gcmFuZG9tCgl9Cgl0aGlzLnNyYyA9IHNyYzsKCXZhciBzdWNjZXNzQ0IgPSAoc3VjY2Vzc0NhbGxiYWNrID09IHVuZGVmaW5lZCB8fCBzdWNjZXNzQ2FsbGJhY2sgPT0gbnVsbCkgPyBudWxsIDogR2V0RnVuY3Rpb25OYW1lKHN1Y2Nlc3NDYWxsYmFjayk7Cgl2YXIgZXJyb3JDQiA9IChlcnJvckNhbGxiYWNrID09IHVuZGVmaW5lZCB8fCBlcnJvckNhbGxiYWNrID09IG51bGwpID8gbnVsbCA6IEdldEZ1bmN0aW9uTmFtZShlcnJvckNhbGxiYWNrKTsKCXZhciBkb3dubG9hZENCID0gKGRvd25sb2FkQ29tcGxldGVDYWxsYmFjayA9PSB1bmRlZmluZWQgfHwgZG93bmxvYWRDb21wbGV0ZUNhbGxiYWNrID09IG51bGwpID8gbnVsbCA6IEdldEZ1bmN0aW9uTmFtZShkb3dubG9hZENvbXBsZXRlQ2FsbGJhY2spOwoJCgl0aGlzLnN1Y2Nlc3NDYWxsYmFjayA9IHN1Y2Nlc3NDYWxsYmFjayB8fCBudWxsOwoJdGhpcy5lcnJvckNhbGxiYWNrID0gZXJyb3JDYWxsYmFjayB8fCBudWxsOwkKCXRoaXMuZG93bmxvYWRDb21wbGV0ZUNhbGxiYWNrID0gZG93bmxvYWRDb21wbGV0ZUNhbGxiYWNrIHx8IG51bGw7CiAgICAKCWlmICh0aGlzLnNyYyAhPSBudWxsKSB7CgkJUGhvbmVHYXAuZXhlYygiU291bmQucHJlcGFyZSIsIHRoaXMuc3JjLCBzdWNjZXNzQ0IsIGVycm9yQ0IsIGRvd25sb2FkQ0IpOwoJfQp9CiAKTWVkaWEucHJvdG90eXBlLnBsYXkgPSBmdW5jdGlvbihvcHRpb25zKSB7CglpZiAodGhpcy5zcmMgIT0gbnVsbCkgewoJCVBob25lR2FwLmV4ZWMoIlNvdW5kLnBsYXkiLCB0aGlzLnNyYywgb3B0aW9ucyk7Cgl9Cn07CgpNZWRpYS5wcm90b3R5cGUucGF1c2UgPSBmdW5jdGlvbigpIHsKCWlmICh0aGlzLnNyYyAhPSBudWxsKSB7CgkJUGhvbmVHYXAuZXhlYygiU291bmQucGF1c2UiLCB0aGlzLnNyYyk7Cgl9Cn07CgpNZWRpYS5wcm90b3R5cGUuc3RvcCA9IGZ1bmN0aW9uKCkgewoJaWYgKHRoaXMuc3JjICE9IG51bGwpIHsKCQlQaG9uZUdhcC5leGVjKCJTb3VuZC5zdG9wIiwgdGhpcy5zcmMpOwoJfQp9OwoKTWVkaWEucHJvdG90eXBlLnN0YXJ0QXVkaW9SZWNvcmQgPSBmdW5jdGlvbihvcHRpb25zKSB7CglpZiAodGhpcy5zcmMgIT0gbnVsbCkgewoJCVBob25lR2FwLmV4ZWMoIlNvdW5kLnN0YXJ0QXVkaW9SZWNvcmQiLCB0aGlzLnNyYywgb3B0aW9ucyk7Cgl9Cn07CgpNZWRpYS5wcm90b3R5cGUuc3RvcEF1ZGlvUmVjb3JkID0gZnVuY3Rpb24oKSB7CglpZiAodGhpcy5zcmMgIT0gbnVsbCkgewoJCVBob25lR2FwLmV4ZWMoIlNvdW5kLnN0b3BBdWRpb1JlY29yZCIsIHRoaXMuc3JjKTsKCX0KfTsKCi8qKgogKiBUaGlzIGNsYXNzIGNvbnRhaW5zIGluZm9ybWF0aW9uIGFib3V0IGFueSBNZWRpYSBlcnJvcnMuCiAqIEBjb25zdHJ1Y3RvcgogKi8KTWVkaWFFcnJvciA9IGZ1bmN0aW9uKCkgewoJdGhpcy5jb2RlID0gbnVsbCwKCXRoaXMubWVzc2FnZSA9ICIiOwp9CgpNZWRpYUVycm9yLk1FRElBX0VSUl9BQk9SVEVEIAkJPSAxOwpNZWRpYUVycm9yLk1FRElBX0VSUl9ORVRXT1JLIAkJPSAyOwpNZWRpYUVycm9yLk1FRElBX0VSUl9ERUNPREUgCQk9IDM7Ck1lZGlhRXJyb3IuTUVESUFfRVJSX05PTkVfU1VQUE9SVEVEID0gNDsKCgovL2lmICh0eXBlb2YgbmF2aWdhdG9yLmF1ZGlvID09ICJ1bmRlZmluZWQiKSBuYXZpZ2F0b3IuYXVkaW8gPSBuZXcgTWVkaWEoc3JjKTsKfTtpZiAoIVBob25lR2FwLmhhc1Jlc291cmNlKCJub3RpZmljYXRpb24iKSkgewoJUGhvbmVHYXAuYWRkUmVzb3VyY2UoIm5vdGlmaWNhdGlvbiIpOwoKLyoqCiAqIFRoaXMgY2xhc3MgcHJvdmlkZXMgYWNjZXNzIHRvIG5vdGlmaWNhdGlvbnMgb24gdGhlIGRldmljZS4KICovCk5vdGlmaWNhdGlvbiA9IGZ1bmN0aW9uKCkgewp9OwoKLyoqCiAqIE9wZW4gYSBuYXRpdmUgYWxlcnQgZGlhbG9nLCB3aXRoIGEgY3VzdG9taXphYmxlIHRpdGxlIGFuZCBidXR0b24gdGV4dC4KICoKICogQHBhcmFtIHtTdHJpbmd9IG1lc3NhZ2UgICAgICAgICAgICAgIE1lc3NhZ2UgdG8gcHJpbnQgaW4gdGhlIGJvZHkgb2YgdGhlIGFsZXJ0CiAqIEBwYXJhbSB7RnVuY3Rpb259IGNvbXBsZXRlQ2FsbGJhY2sgICBUaGUgY2FsbGJhY2sgdGhhdCBpcyBjYWxsZWQgd2hlbiB1c2VyIGNsaWNrcyBvbiBhIGJ1dHRvbi4KICogQHBhcmFtIHtTdHJpbmd9IHRpdGxlICAgICAgICAgICAgICAgIFRpdGxlIG9mIHRoZSBhbGVydCBkaWFsb2cgKGRlZmF1bHQ6IEFsZXJ0KQogKiBAcGFyYW0ge1N0cmluZ30gYnV0dG9uTGFiZWwgICAgICAgICAgTGFiZWwgb2YgdGhlIGNsb3NlIGJ1dHRvbiAoZGVmYXVsdDogT0spCiAqLwpOb3RpZmljYXRpb24ucHJvdG90eXBlLmFsZXJ0ID0gZnVuY3Rpb24obWVzc2FnZSwgY29tcGxldGVDYWxsYmFjaywgdGl0bGUsIGJ1dHRvbkxhYmVsKSB7CiAgICB2YXIgX3RpdGxlID0gKHRpdGxlIHx8ICJBbGVydCIpOwogICAgdmFyIF9idXR0b25MYWJlbCA9IChidXR0b25MYWJlbCB8fCAiT0siKTsKICAgIFBob25lR2FwLmV4ZWMoY29tcGxldGVDYWxsYmFjaywgbnVsbCwgIk5vdGlmaWNhdGlvbiIsICJhbGVydCIsIFttZXNzYWdlLHsgInRpdGxlIjogX3RpdGxlLCAiYnV0dG9uTGFiZWwiOiBfYnV0dG9uTGFiZWx9XSk7Cn07CgovKioKICogT3BlbiBhIG5hdGl2ZSBjb25maXJtIGRpYWxvZywgd2l0aCBhIGN1c3RvbWl6YWJsZSB0aXRsZSBhbmQgYnV0dG9uIHRleHQuCiAqIFRoZSByZXN1bHQgdGhhdCB0aGUgdXNlciBzZWxlY3RzIGlzIHJldHVybmVkIHRvIHRoZSByZXN1bHQgY2FsbGJhY2suCiAqCiAqIEBwYXJhbSB7U3RyaW5nfSBtZXNzYWdlICAgICAgICAgICAgICBNZXNzYWdlIHRvIHByaW50IGluIHRoZSBib2R5IG9mIHRoZSBhbGVydAogKiBAcGFyYW0ge0Z1bmN0aW9ufSByZXN1bHRDYWxsYmFjayAgICAgVGhlIGNhbGxiYWNrIHRoYXQgaXMgY2FsbGVkIHdoZW4gdXNlciBjbGlja3Mgb24gYSBidXR0b24uCiAqIEBwYXJhbSB7U3RyaW5nfSB0aXRsZSAgICAgICAgICAgICAgICBUaXRsZSBvZiB0aGUgYWxlcnQgZGlhbG9nIChkZWZhdWx0OiBDb25maXJtKQogKiBAcGFyYW0ge1N0cmluZ30gYnV0dG9uTGFiZWxzICAgICAgICAgQ29tbWEgc2VwYXJhdGVkIGxpc3Qgb2YgdGhlIGxhYmVscyBvZiB0aGUgYnV0dG9ucyAoZGVmYXVsdDogJ09LLENhbmNlbCcpCiAqLwpOb3RpZmljYXRpb24ucHJvdG90eXBlLmNvbmZpcm0gPSBmdW5jdGlvbihtZXNzYWdlLCByZXN1bHRDYWxsYmFjaywgdGl0bGUsIGJ1dHRvbkxhYmVscykgewogICAgdmFyIF90aXRsZSA9ICh0aXRsZSB8fCAiQ29uZmlybSIpOwogICAgdmFyIF9idXR0b25MYWJlbHMgPSAoYnV0dG9uTGFiZWxzIHx8ICJPSyxDYW5jZWwiKTsKICAgIHRoaXMuYWxlcnQobWVzc2FnZSwgcmVzdWx0Q2FsbGJhY2ssIF90aXRsZSwgX2J1dHRvbkxhYmVscyk7Cn07Ci8qKgogKiBTdGFydCBzcGlubmluZyB0aGUgYWN0aXZpdHkgaW5kaWNhdG9yIG9uIHRoZSBzdGF0dXNiYXIKICovCk5vdGlmaWNhdGlvbi5wcm90b3R5cGUuYWN0aXZpdHlTdGFydCA9IGZ1bmN0aW9uKCkgewogICAgUGhvbmVHYXAuZXhlYyhudWxsLCBudWxsLCAiTm90aWZpY2F0aW9uIiwgImFjdGl2aXR5U3RhcnQiLCBbXSk7Cn07CgovKioKICogU3RvcCBzcGlubmluZyB0aGUgYWN0aXZpdHkgaW5kaWNhdG9yIG9uIHRoZSBzdGF0dXNiYXIsIGlmIGl0J3MgY3VycmVudGx5IHNwaW5uaW5nCiAqLwpOb3RpZmljYXRpb24ucHJvdG90eXBlLmFjdGl2aXR5U3RvcCA9IGZ1bmN0aW9uKCkgewogICAgUGhvbmVHYXAuZXhlYyhudWxsLCBudWxsLCAiTm90aWZpY2F0aW9uIiwgImFjdGl2aXR5U3RvcCIsIFtdKTsKfTsKCi8vIGlQaG9uZSBvbmx5Ck5vdGlmaWNhdGlvbi5wcm90b3R5cGUubG9hZGluZ1N0YXJ0ID0gZnVuY3Rpb24ob3B0aW9ucykgewogICAgUGhvbmVHYXAuZXhlYyhudWxsLCBudWxsLCAiTm90aWZpY2F0aW9uIiwibG9hZGluZ1N0YXJ0IiwgW29wdGlvbnNdKTsKfTsKLy8gaVBob25lIG9ubHkKTm90aWZpY2F0aW9uLnByb3RvdHlwZS5sb2FkaW5nU3RvcCA9IGZ1bmN0aW9uKCkgewogICAgUGhvbmVHYXAuZXhlYyhudWxsLCBudWxsLCAiTm90aWZpY2F0aW9uIiwibG9hZGluZ1N0b3AiLCBbXSk7Cn07Ci8qKgogKiBDYXVzZXMgdGhlIGRldmljZSB0byBibGluayBhIHN0YXR1cyBMRUQuCiAqIEBwYXJhbSB7SW50ZWdlcn0gY291bnQgVGhlIG51bWJlciBvZiBibGlua3MuCiAqIEBwYXJhbSB7U3RyaW5nfSBjb2xvdXIgVGhlIGNvbG91ciBvZiB0aGUgbGlnaHQuCiAqLwpOb3RpZmljYXRpb24ucHJvdG90eXBlLmJsaW5rID0gZnVuY3Rpb24oY291bnQsIGNvbG91cikgewovLyBOT1QgSU1QTEVNRU5URUQJCn07CgpOb3RpZmljYXRpb24ucHJvdG90eXBlLnZpYnJhdGUgPSBmdW5jdGlvbihtaWxscykgewoJUGhvbmVHYXAuZXhlYyhudWxsLCBudWxsLCAiTm90aWZpY2F0aW9uIiwgInZpYnJhdGUiLCBbXSk7Cn07CgpOb3RpZmljYXRpb24ucHJvdG90eXBlLmJlZXAgPSBmdW5jdGlvbihjb3VudCwgdm9sdW1lKSB7CgkvLyBObyBWb2x1bWUgeWV0IGZvciB0aGUgaXBob25lIGludGVyZmFjZQoJLy8gV2UgY2FuIHVzZSBhIGNhbm5lZCBiZWVwIHNvdW5kIGFuZCBjYWxsIHRoYXQKCW5ldyBNZWRpYSgnYmVlcC53YXYnKS5wbGF5KCk7Cn07CgpQaG9uZUdhcC5hZGRDb25zdHJ1Y3RvcihmdW5jdGlvbigpIHsKICAgIGlmICh0eXBlb2YgbmF2aWdhdG9yLm5vdGlmaWNhdGlvbiA9PSAidW5kZWZpbmVkIikgbmF2aWdhdG9yLm5vdGlmaWNhdGlvbiA9IG5ldyBOb3RpZmljYXRpb24oKTsKfSk7Cn07CmlmICghUGhvbmVHYXAuaGFzUmVzb3VyY2UoIm9yaWVudGF0aW9uIikpIHsKCVBob25lR2FwLmFkZFJlc291cmNlKCJvcmllbnRhdGlvbiIpOwoKLyoqCiAqIFRoaXMgY2xhc3MgcHJvdmlkZXMgYWNjZXNzIHRvIHRoZSBkZXZpY2Ugb3JpZW50YXRpb24uCiAqIEBjb25zdHJ1Y3RvcgogKi8KT3JpZW50YXRpb24gID0gZnVuY3Rpb24oKSB7CgkvKioKCSAqIFRoZSBjdXJyZW50IG9yaWVudGF0aW9uLCBvciBudWxsIGlmIHRoZSBvcmllbnRhdGlvbiBoYXNuJ3QgY2hhbmdlZCB5ZXQuCgkgKi8KCXRoaXMuY3VycmVudE9yaWVudGF0aW9uID0gbnVsbDsKfQoKLyoqCiAqIFNldCB0aGUgY3VycmVudCBvcmllbnRhdGlvbiBvZiB0aGUgcGhvbmUuICBUaGlzIGlzIGNhbGxlZCBmcm9tIHRoZSBkZXZpY2UgYXV0b21hdGljYWxseS4KICogCiAqIFdoZW4gdGhlIG9yaWVudGF0aW9uIGlzIGNoYW5nZWQsIHRoZSBET01FdmVudCBcYyBvcmllbnRhdGlvbkNoYW5nZWQgaXMgZGlzcGF0Y2hlZCBhZ2FpbnN0CiAqIHRoZSBkb2N1bWVudCBlbGVtZW50LiAgVGhlIGV2ZW50IGhhcyB0aGUgcHJvcGVydHkgXGMgb3JpZW50YXRpb24gd2hpY2ggY2FuIGJlIHVzZWQgdG8gcmV0cmlldmUKICogdGhlIGRldmljZSdzIGN1cnJlbnQgb3JpZW50YXRpb24sIGluIGFkZGl0aW9uIHRvIHRoZSBcYyBPcmllbnRhdGlvbi5jdXJyZW50T3JpZW50YXRpb24gY2xhc3MgcHJvcGVydHkuCiAqCiAqIEBwYXJhbSB7TnVtYmVyfSBvcmllbnRhdGlvbiBUaGUgb3JpZW50YXRpb24gdG8gYmUgc2V0CiAqLwpPcmllbnRhdGlvbi5wcm90b3R5cGUuc2V0T3JpZW50YXRpb24gPSBmdW5jdGlvbihvcmllbnRhdGlvbikgewogICAgT3JpZW50YXRpb24uY3VycmVudE9yaWVudGF0aW9uID0gb3JpZW50YXRpb247CiAgICB2YXIgZSA9IGRvY3VtZW50LmNyZWF0ZUV2ZW50KCdFdmVudHMnKTsKICAgIGUuaW5pdEV2ZW50KCdvcmllbnRhdGlvbkNoYW5nZWQnLCAnZmFsc2UnLCAnZmFsc2UnKTsKICAgIGUub3JpZW50YXRpb24gPSBvcmllbnRhdGlvbjsKICAgIGRvY3VtZW50LmRpc3BhdGNoRXZlbnQoZSk7Cn07CgovKioKICogQXN5bmNocm9ub3VzbHkgYXF1aXJlcyB0aGUgY3VycmVudCBvcmllbnRhdGlvbi4KICogQHBhcmFtIHtGdW5jdGlvbn0gc3VjY2Vzc0NhbGxiYWNrIFRoZSBmdW5jdGlvbiB0byBjYWxsIHdoZW4gdGhlIG9yaWVudGF0aW9uCiAqIGlzIGtub3duLgogKiBAcGFyYW0ge0Z1bmN0aW9ufSBlcnJvckNhbGxiYWNrIFRoZSBmdW5jdGlvbiB0byBjYWxsIHdoZW4gdGhlcmUgaXMgYW4gZXJyb3IgCiAqIGdldHRpbmcgdGhlIG9yaWVudGF0aW9uLgogKi8KT3JpZW50YXRpb24ucHJvdG90eXBlLmdldEN1cnJlbnRPcmllbnRhdGlvbiA9IGZ1bmN0aW9uKHN1Y2Nlc3NDYWxsYmFjaywgZXJyb3JDYWxsYmFjaykgewoJLy8gSWYgdGhlIHBvc2l0aW9uIGlzIGF2YWlsYWJsZSB0aGVuIGNhbGwgc3VjY2VzcwoJLy8gSWYgdGhlIHBvc2l0aW9uIGlzIG5vdCBhdmFpbGFibGUgdGhlbiBjYWxsIGVycm9yCn07CgovKioKICogQXN5bmNocm9ub3VzbHkgYXF1aXJlcyB0aGUgb3JpZW50YXRpb24gcmVwZWF0ZWRseSBhdCBhIGdpdmVuIGludGVydmFsLgogKiBAcGFyYW0ge0Z1bmN0aW9ufSBzdWNjZXNzQ2FsbGJhY2sgVGhlIGZ1bmN0aW9uIHRvIGNhbGwgZWFjaCB0aW1lIHRoZSBvcmllbnRhdGlvbgogKiBkYXRhIGlzIGF2YWlsYWJsZS4KICogQHBhcmFtIHtGdW5jdGlvbn0gZXJyb3JDYWxsYmFjayBUaGUgZnVuY3Rpb24gdG8gY2FsbCB3aGVuIHRoZXJlIGlzIGFuIGVycm9yIAogKiBnZXR0aW5nIHRoZSBvcmllbnRhdGlvbiBkYXRhLgogKi8KT3JpZW50YXRpb24ucHJvdG90eXBlLndhdGNoT3JpZW50YXRpb24gPSBmdW5jdGlvbihzdWNjZXNzQ2FsbGJhY2ssIGVycm9yQ2FsbGJhY2spIHsKCS8vIEludm9rZSB0aGUgYXBwcm9wcmlhdGUgY2FsbGJhY2sgd2l0aCBhIG5ldyBQb3NpdGlvbiBvYmplY3QgZXZlcnkgdGltZSB0aGUgaW1wbGVtZW50YXRpb24gCgkvLyBkZXRlcm1pbmVzIHRoYXQgdGhlIHBvc2l0aW9uIG9mIHRoZSBob3N0aW5nIGRldmljZSBoYXMgY2hhbmdlZC4gCgl0aGlzLmdldEN1cnJlbnRQb3NpdGlvbihzdWNjZXNzQ2FsbGJhY2ssIGVycm9yQ2FsbGJhY2spOwoJcmV0dXJuIHNldEludGVydmFsKGZ1bmN0aW9uKCkgewoJCW5hdmlnYXRvci5vcmllbnRhdGlvbi5nZXRDdXJyZW50T3JpZW50YXRpb24oc3VjY2Vzc0NhbGxiYWNrLCBlcnJvckNhbGxiYWNrKTsKCX0sIDEwMDAwKTsKfTsKCi8qKgogKiBDbGVhcnMgdGhlIHNwZWNpZmllZCBvcmllbnRhdGlvbiB3YXRjaC4KICogQHBhcmFtIHtTdHJpbmd9IHdhdGNoSWQgVGhlIElEIG9mIHRoZSB3YXRjaCByZXR1cm5lZCBmcm9tICN3YXRjaE9yaWVudGF0aW9uLgogKi8KT3JpZW50YXRpb24ucHJvdG90eXBlLmNsZWFyV2F0Y2ggPSBmdW5jdGlvbih3YXRjaElkKSB7CgljbGVhckludGVydmFsKHdhdGNoSWQpOwp9OwoKUGhvbmVHYXAuYWRkQ29uc3RydWN0b3IoZnVuY3Rpb24oKSB7CiAgICBpZiAodHlwZW9mIG5hdmlnYXRvci5vcmllbnRhdGlvbiA9PSAidW5kZWZpbmVkIikgbmF2aWdhdG9yLm9yaWVudGF0aW9uID0gbmV3IE9yaWVudGF0aW9uKCk7Cn0pOwp9OwppZiAoIVBob25lR2FwLmhhc1Jlc291cmNlKCJzbXMiKSkgewoJUGhvbmVHYXAuYWRkUmVzb3VyY2UoInNtcyIpOwoKLyoqCiAqIFRoaXMgY2xhc3MgcHJvdmlkZXMgYWNjZXNzIHRvIHRoZSBkZXZpY2UgU01TIGZ1bmN0aW9uYWxpdHkuCiAqIEBjb25zdHJ1Y3RvcgogKi8KU21zID0gZnVuY3Rpb24oKSB7Cgp9CgovKioKICogU2VuZHMgYW4gU01TIG1lc3NhZ2UuCiAqIEBwYXJhbSB7SW50ZWdlcn0gbnVtYmVyIFRoZSBwaG9uZSBudW1iZXIgdG8gc2VuZCB0aGUgbWVzc2FnZSB0by4KICogQHBhcmFtIHtTdHJpbmd9IG1lc3NhZ2UgVGhlIGNvbnRlbnRzIG9mIHRoZSBTTVMgbWVzc2FnZSB0byBzZW5kLgogKiBAcGFyYW0ge0Z1bmN0aW9ufSBzdWNjZXNzQ2FsbGJhY2sgVGhlIGZ1bmN0aW9uIHRvIGNhbGwgd2hlbiB0aGUgU01TIG1lc3NhZ2UgaXMgc2VudC4KICogQHBhcmFtIHtGdW5jdGlvbn0gZXJyb3JDYWxsYmFjayBUaGUgZnVuY3Rpb24gdG8gY2FsbCB3aGVuIHRoZXJlIGlzIGFuIGVycm9yIHNlbmRpbmcgdGhlIFNNUyBtZXNzYWdlLgogKiBAcGFyYW0ge1Bvc2l0aW9uT3B0aW9uc30gb3B0aW9ucyBUaGUgb3B0aW9ucyBmb3IgYWNjZXNzaW5nIHRoZSBHUFMgbG9jYXRpb24gc3VjaCBhcyB0aW1lb3V0IGFuZCBhY2N1cmFjeS4KICovClNtcy5wcm90b3R5cGUuc2VuZCA9IGZ1bmN0aW9uKG51bWJlciwgbWVzc2FnZSwgc3VjY2Vzc0NhbGxiYWNrLCBlcnJvckNhbGxiYWNrLCBvcHRpb25zKSB7CgkvLyBub3Qgc3VyZSB3aHkgdGhpcyBpcyBoZXJlIHdoZW4gaXQgZG9lcyBub3RoaW5nPz8/Pwp9OwoKUGhvbmVHYXAuYWRkQ29uc3RydWN0b3IoZnVuY3Rpb24oKSB7CiAgICBpZiAodHlwZW9mIG5hdmlnYXRvci5zbXMgPT0gInVuZGVmaW5lZCIpIG5hdmlnYXRvci5zbXMgPSBuZXcgU21zKCk7Cn0pOwp9OwppZiAoIVBob25lR2FwLmhhc1Jlc291cmNlKCJ0ZWxlcGhvbnkiKSkgewoJUGhvbmVHYXAuYWRkUmVzb3VyY2UoInRlbGVwaG9ueSIpOwoKLyoqCiAqIFRoaXMgY2xhc3MgcHJvdmlkZXMgYWNjZXNzIHRvIHRoZSB0ZWxlcGhvbnkgZmVhdHVyZXMgb2YgdGhlIGRldmljZS4KICogQGNvbnN0cnVjdG9yCiAqLwpUZWxlcGhvbnkgPSBmdW5jdGlvbigpIHsKCQp9CgovKioKICogQ2FsbHMgdGhlIHNwZWNpZmVkIG51bWJlci4KICogQHBhcmFtIHtJbnRlZ2VyfSBudW1iZXIgVGhlIG51bWJlciB0byBiZSBjYWxsZWQuCiAqLwpUZWxlcGhvbnkucHJvdG90eXBlLmNhbGwgPSBmdW5jdGlvbihudW1iZXIpIHsKCS8vIG5vdCBzdXJlIHdoeSB0aGlzIGlzIGhlcmUgd2hlbiBpdCBkb2VzIG5vdGhpbmc/Pz8/Cn07CgpQaG9uZUdhcC5hZGRDb25zdHJ1Y3RvcihmdW5jdGlvbigpIHsKICAgIGlmICh0eXBlb2YgbmF2aWdhdG9yLnRlbGVwaG9ueSA9PSAidW5kZWZpbmVkIikgbmF2aWdhdG9yLnRlbGVwaG9ueSA9IG5ldyBUZWxlcGhvbnkoKTsKfSk7Cn07aWYgKCFQaG9uZUdhcC5oYXNSZXNvdXJjZSgibmV0d29yayIpKSB7CglQaG9uZUdhcC5hZGRSZXNvdXJjZSgibmV0d29yayIpOwoJCi8vIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLwoJCkNvbm5lY3Rpb24gPSBmdW5jdGlvbih0eXBlLCBob21lTlcsIGN1cnJlbnROVykgewoJLyoKCSAqIE9uZSBvZiB0aGUgY29ubmVjdGlvbiBjb25zdGFudHMgYmVsb3cuCgkgKi8KCXRoaXMudHlwZSA9IHR5cGUgfHwgMDsKCS8qCgkgKiBUaGUgaG9tZSBuZXR3b3JrIHByb3ZpZGVyLCBvbmx5IHZhbGlkIGlmIGNlbGx1bGFyIGJhc2VkLgoJICovCgl0aGlzLmhvbWVOVyA9IGhvbWVOVyB8fCBudWxsOwoJLyoKCSAqIFRoZSBjdXJyZW50IG5ldHdvcmsgcHJvdmlkZXIsIG9ubHkgdmFsaWQgaWYgY2VsbHVsYXIgYmFzZWQuCiAgICAgKi8KCXRoaXMuY3VycmVudE5XID0gY3VycmVudE5XIHx8IG51bGw7Cn07CgpDb25uZWN0aW9uLlVOS05PV04gPSAwOyAvLyBVbmtub3duIGNvbm5lY3Rpb24gdHlwZQpDb25uZWN0aW9uLkVUSEVSTkVUID0gMTsKQ29ubmVjdGlvbi5XSUZJID0gMjsKQ29ubmVjdGlvbi5DRUxMXzJHID0gMzsKQ29ubmVjdGlvbi5DRUxMXzNHID0gNDsKQ29ubmVjdGlvbi5DRUxMXzRHID0gNTsKQ29ubmVjdGlvbi5OT05FID0gMjA7IC8vIE5PIGNvbm5lY3Rpdml0eQoKLy8gLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vCgovKioKICogVGhpcyBjbGFzcyBjb250YWlucyBpbmZvcm1hdGlvbiBhYm91dCBhbnkgTmV0d29ya1N0YXR1cy4KICogQGNvbnN0cnVjdG9yCiAqLwpOZXR3b3JrU3RhdHVzID0gZnVuY3Rpb24oKSB7Cgl0aGlzLmNvZGUgPSBudWxsOwoJdGhpcy5tZXNzYWdlID0gIiI7Cn0KCk5ldHdvcmtTdGF0dXMuTk9UX1JFQUNIQUJMRSA9IDA7Ck5ldHdvcmtTdGF0dXMuUkVBQ0hBQkxFX1ZJQV9DQVJSSUVSX0RBVEFfTkVUV09SSyA9IDE7Ck5ldHdvcmtTdGF0dXMuUkVBQ0hBQkxFX1ZJQV9XSUZJX05FVFdPUksgPSAyOwoKLyoqCiAqIFRoaXMgY2xhc3MgcHJvdmlkZXMgYWNjZXNzIHRvIGRldmljZSBOZXR3b3JrIGRhdGEgKHJlYWNoYWJpbGl0eSkuCiAqIEBjb25zdHJ1Y3RvcgogKi8KTmV0d29yayA9IGZ1bmN0aW9uKCkgewp9OwoKLyoqCiAqIAogKiBAcGFyYW0ge0Z1bmN0aW9ufSBzdWNjZXNzQ2FsbGJhY2sKICogQHBhcmFtIHtGdW5jdGlvbn0gZXJyb3JDYWxsYmFjawogKiBAcGFyYW0ge09iamVjdH0gb3B0aW9ucwogKi8KTmV0d29yay5wcm90b3R5cGUuaXNSZWFjaGFibGUgPSBmdW5jdGlvbihob3N0TmFtZSwgc3VjY2Vzc0NhbGxiYWNrLCBvcHRpb25zKSB7CglQaG9uZUdhcC5leGVjKCJOZXR3b3JrLmlzUmVhY2hhYmxlIiwgaG9zdE5hbWUsIEdldEZ1bmN0aW9uTmFtZShzdWNjZXNzQ2FsbGJhY2spLCBvcHRpb25zKTsKfTsKCgpQaG9uZUdhcC5hZGRDb25zdHJ1Y3RvcihmdW5jdGlvbigpIHsKICAgIGlmICh0eXBlb2YgbmF2aWdhdG9yLm5ldHdvcmsgPT0gInVuZGVmaW5lZCIpIG5hdmlnYXRvci5uZXR3b3JrID0gbmV3IE5ldHdvcmsoKTsKICAgIGlmICh0eXBlb2YgbmF2aWdhdG9yLmNvbm5lY3Rpb24gPT0gInVuZGVmaW5lZCIpIG5hdmlnYXRvci5jb25uZWN0aW9uID0gbmV3IENvbm5lY3Rpb24oKTsKfSk7Cn07","content_type":"application/javascript","revpos":42},"js/jquery.couch.js":{"data":"Ly8gTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7IHlvdSBtYXkgbm90Ci8vIHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4gWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mCi8vIHRoZSBMaWNlbnNlIGF0Ci8vCi8vICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCi8vCi8vIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKLy8gZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywgV0lUSE9VVAovLyBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuIFNlZSB0aGUKLy8gTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQgbGltaXRhdGlvbnMgdW5kZXIKLy8gdGhlIExpY2Vuc2UuCgovKioKICogQG5hbWVzcGFjZQogKiAkLmNvdWNoIGlzIHVzZWQgdG8gY29tbXVuaWNhdGUgd2l0aCBhIENvdWNoREIgc2VydmVyLCB0aGUgc2VydmVyIG1ldGhvZHMgY2FuCiAqIGJlIGNhbGxlZCBkaXJlY3RseSB3aXRob3V0IGNyZWF0aW5nIGFuIGluc3RhbmNlLiBUeXBpY2FsbHkgYWxsIG1ldGhvZHMgYXJlCiAqIHBhc3NlZCBhbiA8Y29kZT5vcHRpb25zPC9jb2RlPiBvYmplY3Qgd2hpY2ggZGVmaW5lcyBhIHN1Y2Nlc3MgY2FsbGJhY2sgd2hpY2gKICogaXMgY2FsbGVkIHdpdGggdGhlIGRhdGEgcmV0dXJuZWQgZnJvbSB0aGUgaHR0cCByZXF1ZXN0IHRvIENvdWNoREIsIHlvdSBjYW4KICogZmluZCB0aGUgb3RoZXIgc2V0dGluZ3MgdGhhdCBjYW4gYmUgdXNlZCBpbiB0aGUgPGNvZGU+b3B0aW9uczwvY29kZT4gb2JqZWN0CiAqIGZyb20gPGEgaHJlZj0iaHR0cDovL2FwaS5qcXVlcnkuY29tL2pRdWVyeS5hamF4LyNqUXVlcnktYWpheC1zZXR0aW5ncyI+CiAqIGpRdWVyeS5hamF4IHNldHRpbmdzPC9hPgogKiA8cHJlPjxjb2RlPiQuY291Y2guYWN0aXZlVGFza3MoewogKiAgIHN1Y2Nlc3M6IGZ1bmN0aW9uIChkYXRhKSB7CiAqICAgICBjb25zb2xlLmxvZyhkYXRhKTsKICogICB9CiAqIH0pOzwvY29kZT48L3ByZT4KICogT3V0cHV0cyAoZm9yIGV4YW1wbGUpOgogKiA8cHJlPjxjb2RlPlsKICogIHsKICogICAicGlkIiA6ICI8MC4xMTU5OS4wPiIsCiAqICAgInN0YXR1cyIgOiAiQ29waWVkIDAgb2YgMTgzNjkgY2hhbmdlcyAoMCUpIiwKICogICAidGFzayIgOiAicmVjaXBlcyIsCiAqICAgInR5cGUiIDogIkRhdGFiYXNlIENvbXBhY3Rpb24iCiAqICB9CiAqXTwvY29kZT48L3ByZT4KICovCihmdW5jdGlvbigkKSB7CgogICQuY291Y2ggPSAkLmNvdWNoIHx8IHt9OwogIC8qKiBAbGVuZHMgJC5jb3VjaCAqLwoKICAvKioKICAgKiBAcHJpdmF0ZQogICAqLwogIGZ1bmN0aW9uIGVuY29kZURvY0lkKGRvY0lEKSB7CiAgICB2YXIgcGFydHMgPSBkb2NJRC5zcGxpdCgiLyIpOwogICAgaWYgKHBhcnRzWzBdID09ICJfZGVzaWduIikgewogICAgICBwYXJ0cy5zaGlmdCgpOwogICAgICByZXR1cm4gIl9kZXNpZ24vIiArIGVuY29kZVVSSUNvbXBvbmVudChwYXJ0cy5qb2luKCcvJykpOwogICAgfQogICAgcmV0dXJuIGVuY29kZVVSSUNvbXBvbmVudChkb2NJRCk7CiAgfQoKICAvKioKICAgKiBAcHJpdmF0ZQogICAqLwoKICB2YXIgdXVpZENhY2hlID0gW107CgogICQuZXh0ZW5kKCQuY291Y2gsIHsKICAgIHVybFByZWZpeDogJycsCgogICAgLyoqCiAgICAgKiBZb3UgY2FuIG9idGFpbiBhIGxpc3Qgb2YgYWN0aXZlIHRhc2tzIGJ5IHVzaW5nIHRoZSAvX2FjdGl2ZV90YXNrcyBVUkwuCiAgICAgKiBUaGUgcmVzdWx0IGlzIGEgSlNPTiBhcnJheSBvZiB0aGUgY3VycmVudGx5IHJ1bm5pbmcgdGFza3MsIHdpdGggZWFjaCB0YXNrCiAgICAgKiBiZWluZyBkZXNjcmliZWQgd2l0aCBhIHNpbmdsZSBvYmplY3QuCiAgICAgKiBAc2VlIDxhIGhyZWY9Imh0dHA6Ly90ZWNoem9uZS5jb3VjaGJhc2UuY29tL3NpdGVzL2RlZmF1bHQvZmlsZXMvdXBsb2Fkcy8KICAgICAqIGFsbC9kb2N1bWVudGF0aW9uL2NvdWNoYmFzZS1hcGktbWlzYy5odG1sI2NvdWNoYmFzZS1hcGktbWlzY19hY3RpdmUtdGFzawogICAgICogc19nZXQiPmRvY3MgZm9yIC9fYWN0aXZlX3Rhc2tzPC9hPgogICAgICogQHBhcmFtIHthamF4U2V0dGluZ3N9IG9wdGlvbnMgPGEgaHJlZj0iaHR0cDovL2FwaS5qcXVlcnkuY29tL2pRdWVyeS5hamF4CiAgICAgKiAvI2pRdWVyeS1hamF4LXNldHRpbmdzIj5qUXVlcnkgYWpheCBzZXR0aW5nczwvYT4KICAgICAqLwogICAgYWN0aXZlVGFza3M6IGZ1bmN0aW9uKG9wdGlvbnMpIHsKICAgICAgYWpheCgKICAgICAgICB7dXJsOiB0aGlzLnVybFByZWZpeCArICIvX2FjdGl2ZV90YXNrcyJ9LAogICAgICAgIG9wdGlvbnMsCiAgICAgICAgIkFjdGl2ZSB0YXNrIHN0YXR1cyBjb3VsZCBub3QgYmUgcmV0cmlldmVkIgogICAgICApOwogICAgfSwKCiAgICAvKioKICAgICAqIFJldHVybnMgYSBsaXN0IG9mIGFsbCB0aGUgZGF0YWJhc2VzIGluIHRoZSBDb3VjaERCIGluc3RhbmNlCiAgICAgKiBAc2VlIDxhIGhyZWY9Imh0dHA6Ly90ZWNoem9uZS5jb3VjaGJhc2UuY29tL3NpdGVzL2RlZmF1bHQvZmlsZXMvdXBsb2Fkcy8KICAgICAqIGFsbC9kb2N1bWVudGF0aW9uL2NvdWNoYmFzZS1hcGktbWlzYy5odG1sI2NvdWNoYmFzZS1hcGktbWlzY19hY3RpdmUtdGFzawogICAgICogc19nZXQiPmRvY3MgZm9yIC9fYWxsX2RiczwvYT4KICAgICAqIEBwYXJhbSB7YWpheFNldHRpbmdzfSBvcHRpb25zIDxhIGhyZWY9Imh0dHA6Ly9hcGkuanF1ZXJ5LmNvbS9qUXVlcnkuYWpheAogICAgICogLyNqUXVlcnktYWpheC1zZXR0aW5ncyI+alF1ZXJ5IGFqYXggc2V0dGluZ3M8L2E+CiAgICAgKi8KICAgIGFsbERiczogZnVuY3Rpb24ob3B0aW9ucykgewogICAgICBhamF4KAogICAgICAgIHt1cmw6IHRoaXMudXJsUHJlZml4ICsgIi9fYWxsX2RicyJ9LAogICAgICAgIG9wdGlvbnMsCiAgICAgICAgIkFuIGVycm9yIG9jY3VycmVkIHJldHJpZXZpbmcgdGhlIGxpc3Qgb2YgYWxsIGRhdGFiYXNlcyIKICAgICAgKTsKICAgIH0sCgogICAgLyoqCiAgICAgKiBWaWV3IGFuZCBlZGl0IHRoZSBDb3VjaERCIGNvbmZpZ3VyYXRpb24sIGNhbGxlZCB3aXRoIGp1c3QgdGhlIG9wdGlvbnMKICAgICAqIHBhcmFtZXRlciB0aGUgZW50aXJlIGNvbmZpZyBpcyByZXR1cm5lZCwgeW91IGNhbiBiZSBtb3JlIHNwZWNpZmljIGJ5CiAgICAgKiBwYXNzaW5nIHRoZSBzZWN0aW9uIGFuZCBvcHRpb24gcGFyYW1ldGVycywgaWYgeW91IHNwZWNpZnkgYSB2YWx1ZSB0aGF0CiAgICAgKiB2YWx1ZSB3aWxsIGJlIHN0b3JlZCBpbiB0aGUgY29uZmlndXJhdGlvbi4KICAgICAqIEBzZWUgPGEgaHJlZj0iaHR0cDovL3RlY2h6b25lLmNvdWNoYmFzZS5jb20vc2l0ZXMvZGVmYXVsdC9maWxlcy91cGxvYWRzLwogICAgICogYWxsL2RvY3VtZW50YXRpb24vY291Y2hiYXNlLWFwaS1jb25maWcuaHRtbCNjb3VjaGJhc2UtYXBpLWNvbmZpZ19jb25maWcKICAgICAqIC1zZWN0aW9uLWtleV9wdXQiPmRvY3MgZm9yIC9fY29uZmlnPC9hPgogICAgICogQHBhcmFtIHthamF4U2V0dGluZ3N9IG9wdGlvbnMKICAgICAqIDxhIGhyZWY9Imh0dHA6Ly9hcGkuanF1ZXJ5LmNvbS9qUXVlcnkuYWpheC8jalF1ZXJ5LWFqYXgtc2V0dGluZ3MiPgogICAgICogalF1ZXJ5IGFqYXggc2V0dGluZ3M8L2E+CiAgICAgKiBAcGFyYW0ge1N0cmluZ30gW3NlY3Rpb25dIHRoZSBzZWN0aW9uIG9mIHRoZSBjb25maWcKICAgICAqIEBwYXJhbSB7U3RyaW5nfSBbb3B0aW9uXSB0aGUgcGFydGljdWxhciBjb25maWcgb3B0aW9uCiAgICAgKiBAcGFyYW0ge1N0cmluZ30gW3ZhbHVlXSB2YWx1ZSB0byBiZSBzZXQKICAgICAqLwogICAgY29uZmlnOiBmdW5jdGlvbihvcHRpb25zLCBzZWN0aW9uLCBvcHRpb24sIHZhbHVlKSB7CiAgICAgIHZhciByZXEgPSB7dXJsOiB0aGlzLnVybFByZWZpeCArICIvX2NvbmZpZy8ifTsKICAgICAgaWYgKHNlY3Rpb24pIHsKICAgICAgICByZXEudXJsICs9IGVuY29kZVVSSUNvbXBvbmVudChzZWN0aW9uKSArICIvIjsKICAgICAgICBpZiAob3B0aW9uKSB7CiAgICAgICAgICByZXEudXJsICs9IGVuY29kZVVSSUNvbXBvbmVudChvcHRpb24pOwogICAgICAgIH0KICAgICAgfQogICAgICBpZiAodmFsdWUgPT09IG51bGwpIHsKICAgICAgICByZXEudHlwZSA9ICJERUxFVEUiOyAgICAgICAgCiAgICAgIH0gZWxzZSBpZiAodmFsdWUgIT09IHVuZGVmaW5lZCkgewogICAgICAgIHJlcS50eXBlID0gIlBVVCI7CiAgICAgICAgcmVxLmRhdGEgPSB0b0pTT04odmFsdWUpOwogICAgICAgIHJlcS5jb250ZW50VHlwZSA9ICJhcHBsaWNhdGlvbi9qc29uIjsKICAgICAgICByZXEucHJvY2Vzc0RhdGEgPSBmYWxzZQogICAgICB9CgogICAgICBhamF4KHJlcSwgb3B0aW9ucywKICAgICAgICAiQW4gZXJyb3Igb2NjdXJyZWQgcmV0cmlldmluZy91cGRhdGluZyB0aGUgc2VydmVyIGNvbmZpZ3VyYXRpb24iCiAgICAgICk7CiAgICB9LAogICAgCiAgICAvKioKICAgICAqIFJldHVybnMgdGhlIHNlc3Npb24gaW5mb3JtYXRpb24gZm9yIHRoZSBjdXJyZW50bHkgbG9nZ2VkIGluIHVzZXIuCiAgICAgKiBAcGFyYW0ge2FqYXhTZXR0aW5nc30gb3B0aW9ucwogICAgICogPGEgaHJlZj0iaHR0cDovL2FwaS5qcXVlcnkuY29tL2pRdWVyeS5hamF4LyNqUXVlcnktYWpheC1zZXR0aW5ncyI+CiAgICAgKiBqUXVlcnkgYWpheCBzZXR0aW5nczwvYT4KICAgICAqLwogICAgc2Vzc2lvbjogZnVuY3Rpb24ob3B0aW9ucykgewogICAgICBvcHRpb25zID0gb3B0aW9ucyB8fCB7fTsKICAgICAgJC5hamF4KHsKICAgICAgICB0eXBlOiAiR0VUIiwgdXJsOiB0aGlzLnVybFByZWZpeCArICIvX3Nlc3Npb24iLAogICAgICAgIGJlZm9yZVNlbmQ6IGZ1bmN0aW9uKHhocikgewogICAgICAgICAgICB4aHIuc2V0UmVxdWVzdEhlYWRlcignQWNjZXB0JywgJ2FwcGxpY2F0aW9uL2pzb24nKTsKICAgICAgICB9LAogICAgICAgIGNvbXBsZXRlOiBmdW5jdGlvbihyZXEpIHsKICAgICAgICAgIHZhciByZXNwID0gJC5wYXJzZUpTT04ocmVxLnJlc3BvbnNlVGV4dCk7CiAgICAgICAgICBpZiAocmVxLnN0YXR1cyA9PSAyMDApIHsKICAgICAgICAgICAgaWYgKG9wdGlvbnMuc3VjY2Vzcykgb3B0aW9ucy5zdWNjZXNzKHJlc3ApOwogICAgICAgICAgfSBlbHNlIGlmIChvcHRpb25zLmVycm9yKSB7CiAgICAgICAgICAgIG9wdGlvbnMuZXJyb3IocmVxLnN0YXR1cywgcmVzcC5lcnJvciwgcmVzcC5yZWFzb24pOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgYWxlcnQoIkFuIGVycm9yIG9jY3VycmVkIGdldHRpbmcgc2Vzc2lvbiBpbmZvOiAiICsgcmVzcC5yZWFzb24pOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSk7CiAgICB9LAoKICAgIC8qKgogICAgICogQHByaXZhdGUKICAgICAqLwogICAgdXNlckRiIDogZnVuY3Rpb24oY2FsbGJhY2spIHsKICAgICAgJC5jb3VjaC5zZXNzaW9uKHsKICAgICAgICBzdWNjZXNzIDogZnVuY3Rpb24ocmVzcCkgewogICAgICAgICAgdmFyIHVzZXJEYiA9ICQuY291Y2guZGIocmVzcC5pbmZvLmF1dGhlbnRpY2F0aW9uX2RiKTsKICAgICAgICAgIGNhbGxiYWNrKHVzZXJEYik7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0sCgogICAgLyoqCiAgICAgKiBDcmVhdGUgYSBuZXcgdXNlciBvbiB0aGUgQ291Y2hEQiBzZXJ2ZXIsIDxjb2RlPnVzZXJfZG9jPC9jb2RlPiBpcyBhbgogICAgICogb2JqZWN0IHdpdGggYSA8Y29kZT5uYW1lPC9jb2RlPiBmaWVsZCBhbmQgb3RoZXIgaW5mb3JtYXRpb24geW91IHdhbnQKICAgICAqIHRvIHN0b3JlIHJlbGF0aW5nIHRvIHRoYXQgdXNlciwgZm9yIGV4YW1wbGUKICAgICAqIDxjb2RlPnsibmFtZSI6ICJkYWxlaGFydmV5In08L2NvZGU+CiAgICAgKiBAcGFyYW0ge09iamVjdH0gdXNlcl9kb2MgVXNlcnMgZGV0YWlscwogICAgICogQHBhcmFtIHtTdHJpbmd9IHBhc3N3b3JkIFVzZXJzIHBhc3N3b3JkCiAgICAgKiBAcGFyYW0ge2FqYXhTZXR0aW5nc30gb3B0aW9ucwogICAgICogPGEgaHJlZj0iaHR0cDovL2FwaS5qcXVlcnkuY29tL2pRdWVyeS5hamF4LyNqUXVlcnktYWpheC1zZXR0aW5ncyI+CiAgICAgICogalF1ZXJ5IGFqYXggc2V0dGluZ3M8L2E+CiAgICAgKi8KICAgIHNpZ251cDogZnVuY3Rpb24odXNlcl9kb2MsIHBhc3N3b3JkLCBvcHRpb25zKSB7ICAgICAgCiAgICAgIG9wdGlvbnMgPSBvcHRpb25zIHx8IHt9OwogICAgICAvLyBwcmVwYXJlIHVzZXIgZG9jIGJhc2VkIG9uIG5hbWUgYW5kIHBhc3N3b3JkCiAgICAgIHVzZXJfZG9jID0gdGhpcy5wcmVwYXJlVXNlckRvYyh1c2VyX2RvYywgcGFzc3dvcmQpOwogICAgICAkLmNvdWNoLnVzZXJEYihmdW5jdGlvbihkYikgewogICAgICAgIGRiLnNhdmVEb2ModXNlcl9kb2MsIG9wdGlvbnMpOwogICAgICB9KTsKICAgIH0sCgogICAgLyoqCiAgICAgKiBQb3B1bGF0ZXMgYSB1c2VyIGRvYyB3aXRoIGEgbmV3IHBhc3N3b3JkLgogICAgICogQHBhcmFtIHtPYmplY3R9IHVzZXJfZG9jIFVzZXIgZGV0YWlscwogICAgICogQHBhcmFtIHtTdHJpbmd9IG5ld19wYXNzd29yZCBOZXcgUGFzc3dvcmQKICAgICAqLwogICAgcHJlcGFyZVVzZXJEb2M6IGZ1bmN0aW9uKHVzZXJfZG9jLCBuZXdfcGFzc3dvcmQpIHsKICAgICAgaWYgKHR5cGVvZiBoZXhfc2hhMSA9PSAidW5kZWZpbmVkIikgewogICAgICAgIGFsZXJ0KCJjcmVhdGluZyBhIHVzZXIgZG9jIHJlcXVpcmVzIHNoYTEuanMgdG8gYmUgbG9hZGVkIGluIHRoZSBwYWdlIik7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIHZhciB1c2VyX3ByZWZpeCA9ICJvcmcuY291Y2hkYi51c2VyOiI7CiAgICAgIHVzZXJfZG9jLl9pZCA9IHVzZXJfZG9jLl9pZCB8fCB1c2VyX3ByZWZpeCArIHVzZXJfZG9jLm5hbWU7CiAgICAgIGlmIChuZXdfcGFzc3dvcmQpIHsKICAgICAgICAvLyBoYW5kbGUgdGhlIHBhc3N3b3JkIGNyeXB0bwogICAgICAgIHVzZXJfZG9jLnNhbHQgPSAkLmNvdWNoLm5ld1VVSUQoKTsKICAgICAgICB1c2VyX2RvYy5wYXNzd29yZF9zaGEgPSBoZXhfc2hhMShuZXdfcGFzc3dvcmQgKyB1c2VyX2RvYy5zYWx0KTsKICAgICAgfQogICAgICB1c2VyX2RvYy50eXBlID0gInVzZXIiOwogICAgICBpZiAoIXVzZXJfZG9jLnJvbGVzKSB7CiAgICAgICAgdXNlcl9kb2Mucm9sZXMgPSBbXTsKICAgICAgfQogICAgICByZXR1cm4gdXNlcl9kb2M7CiAgICB9LAoKICAgIC8qKgogICAgICogQXV0aGVudGljYXRlIGFnYWluc3QgQ291Y2hEQiwgdGhlIDxjb2RlPm9wdGlvbnM8L2NvZGU+IHBhcmFtZXRlciBpcwogICAgICAqZXhwZWN0ZWQgdG8gaGF2ZSA8Y29kZT5uYW1lPC9jb2RlPiBhbmQgPGNvZGU+cGFzc3dvcmQ8L2NvZGU+IGZpZWxkcy4KICAgICAqIEBwYXJhbSB7YWpheFNldHRpbmdzfSBvcHRpb25zCiAgICAgKiA8YSBocmVmPSJodHRwOi8vYXBpLmpxdWVyeS5jb20valF1ZXJ5LmFqYXgvI2pRdWVyeS1hamF4LXNldHRpbmdzIj4KICAgICAqIGpRdWVyeSBhamF4IHNldHRpbmdzPC9hPgogICAgICovCiAgICBsb2dpbjogZnVuY3Rpb24ob3B0aW9ucykgewogICAgICBvcHRpb25zID0gb3B0aW9ucyB8fCB7fTsKICAgICAgJC5hamF4KHsKICAgICAgICB0eXBlOiAiUE9TVCIsIHVybDogdGhpcy51cmxQcmVmaXggKyAiL19zZXNzaW9uIiwgZGF0YVR5cGU6ICJqc29uIiwKICAgICAgICBkYXRhOiB7bmFtZTogb3B0aW9ucy5uYW1lLCBwYXNzd29yZDogb3B0aW9ucy5wYXNzd29yZH0sCiAgICAgICAgYmVmb3JlU2VuZDogZnVuY3Rpb24oeGhyKSB7CiAgICAgICAgICAgIHhoci5zZXRSZXF1ZXN0SGVhZGVyKCdBY2NlcHQnLCAnYXBwbGljYXRpb24vanNvbicpOwogICAgICAgIH0sCiAgICAgICAgY29tcGxldGU6IGZ1bmN0aW9uKHJlcSkgewogICAgICAgICAgdmFyIHJlc3AgPSAkLnBhcnNlSlNPTihyZXEucmVzcG9uc2VUZXh0KTsKICAgICAgICAgIGlmIChyZXEuc3RhdHVzID09IDIwMCkgewogICAgICAgICAgICBpZiAob3B0aW9ucy5zdWNjZXNzKSBvcHRpb25zLnN1Y2Nlc3MocmVzcCk7CiAgICAgICAgICB9IGVsc2UgaWYgKG9wdGlvbnMuZXJyb3IpIHsKICAgICAgICAgICAgb3B0aW9ucy5lcnJvcihyZXEuc3RhdHVzLCByZXNwLmVycm9yLCByZXNwLnJlYXNvbik7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBhbGVydCgiQW4gZXJyb3Igb2NjdXJyZWQgbG9nZ2luZyBpbjogIiArIHJlc3AucmVhc29uKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0pOwogICAgfSwKCgogICAgLyoqCiAgICAgKiBEZWxldGUgeW91ciBjdXJyZW50IENvdWNoREIgdXNlciBzZXNzaW9uCiAgICAgKiBAcGFyYW0ge2FqYXhTZXR0aW5nc30gb3B0aW9ucwogICAgICogPGEgaHJlZj0iaHR0cDovL2FwaS5qcXVlcnkuY29tL2pRdWVyeS5hamF4LyNqUXVlcnktYWpheC1zZXR0aW5ncyI+CiAgICAgKiBqUXVlcnkgYWpheCBzZXR0aW5nczwvYT4KICAgICAqLwogICAgbG9nb3V0OiBmdW5jdGlvbihvcHRpb25zKSB7CiAgICAgIG9wdGlvbnMgPSBvcHRpb25zIHx8IHt9OwogICAgICAkLmFqYXgoewogICAgICAgIHR5cGU6ICJERUxFVEUiLCB1cmw6IHRoaXMudXJsUHJlZml4ICsgIi9fc2Vzc2lvbiIsIGRhdGFUeXBlOiAianNvbiIsCiAgICAgICAgdXNlcm5hbWUgOiAiXyIsIHBhc3N3b3JkIDogIl8iLAogICAgICAgIGJlZm9yZVNlbmQ6IGZ1bmN0aW9uKHhocikgewogICAgICAgICAgICB4aHIuc2V0UmVxdWVzdEhlYWRlcignQWNjZXB0JywgJ2FwcGxpY2F0aW9uL2pzb24nKTsKICAgICAgICB9LAogICAgICAgIGNvbXBsZXRlOiBmdW5jdGlvbihyZXEpIHsKICAgICAgICAgIHZhciByZXNwID0gJC5wYXJzZUpTT04ocmVxLnJlc3BvbnNlVGV4dCk7CiAgICAgICAgICBpZiAocmVxLnN0YXR1cyA9PSAyMDApIHsKICAgICAgICAgICAgaWYgKG9wdGlvbnMuc3VjY2Vzcykgb3B0aW9ucy5zdWNjZXNzKHJlc3ApOwogICAgICAgICAgfSBlbHNlIGlmIChvcHRpb25zLmVycm9yKSB7CiAgICAgICAgICAgIG9wdGlvbnMuZXJyb3IocmVxLnN0YXR1cywgcmVzcC5lcnJvciwgcmVzcC5yZWFzb24pOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgYWxlcnQoIkFuIGVycm9yIG9jY3VycmVkIGxvZ2dpbmcgb3V0OiAiICsgcmVzcC5yZWFzb24pOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSk7CiAgICB9LAoKICAgIC8qKgogICAgICogQG5hbWVzcGFjZQogICAgICogJC5jb3VjaC5kYiBpcyB1c2VkIHRvIGNvbW11bmljYXRlIHdpdGggYSBzcGVjaWZpYyBDb3VjaERCIGRhdGFiYXNlCiAgICAgKiA8cHJlPjxjb2RlPnZhciAkZGIgPSAkLmNvdWNoLmRiKCJteWRhdGFiYXNlIik7CiAgICAgKiRkYi5hbGxBcHBzKHsKICAgICAqICBzdWNjZXNzOiBmdW5jdGlvbiAoZGF0YSkgewogICAgICogICAgLi4uIHByb2Nlc3MgZGF0YSAuLi4KICAgICAqICB9CiAgICAgKn0pOwogICAgICogPC9jb2RlPjwvcHJlPgogICAgICovCiAgICBkYjogZnVuY3Rpb24obmFtZSwgZGJfb3B0cykgewogICAgICBkYl9vcHRzID0gZGJfb3B0cyB8fCB7fTsKICAgICAgdmFyIHJhd0RvY3MgPSB7fTsKICAgICAgZnVuY3Rpb24gbWF5YmVBcHBseVZlcnNpb24oZG9jKSB7CiAgICAgICAgaWYgKGRvYy5faWQgJiYgZG9jLl9yZXYgJiYgcmF3RG9jc1tkb2MuX2lkXSAmJgogICAgICAgICAgICByYXdEb2NzW2RvYy5faWRdLnJldiA9PSBkb2MuX3JldikgewogICAgICAgICAgLy8gdG9kbzogY2FuIHdlIHVzZSBjb21tb25qcyByZXF1aXJlIGhlcmU/CiAgICAgICAgICBpZiAodHlwZW9mIEJhc2U2NCA9PSAidW5kZWZpbmVkIikgewogICAgICAgICAgICBhbGVydCgicGxlYXNlIGluY2x1ZGUgL191dGlscy9zY3JpcHQvYmFzZTY0LmpzIGluIHRoZSBwYWdlIGZvciAiICsKICAgICAgICAgICAgICAgICAgImJhc2U2NCBzdXBwb3J0Iik7CiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGRvYy5fYXR0YWNobWVudHMgPSBkb2MuX2F0dGFjaG1lbnRzIHx8IHt9OwogICAgICAgICAgICBkb2MuX2F0dGFjaG1lbnRzWyJyZXYtIitkb2MuX3Jldi5zcGxpdCgiLSIpWzBdXSA9IHsKICAgICAgICAgICAgICBjb250ZW50X3R5cGUgOiJhcHBsaWNhdGlvbi9qc29uIiwKICAgICAgICAgICAgICBkYXRhIDogQmFzZTY0LmVuY29kZShyYXdEb2NzW2RvYy5faWRdLnJhdykKICAgICAgICAgICAgfTsKICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9OwogICAgICByZXR1cm4gLyoqIEBsZW5kcyAkLmNvdWNoLmRiICovewogICAgICAgIG5hbWU6IG5hbWUsCiAgICAgICAgdXJpOiB0aGlzLnVybFByZWZpeCArICIvIiArIGVuY29kZVVSSUNvbXBvbmVudChuYW1lKSArICIvIiwKCiAgICAgICAgLyoqCiAgICAgICAgICogUmVxdWVzdCBjb21wYWN0aW9uIG9mIHRoZSBzcGVjaWZpZWQgZGF0YWJhc2UuCiAgICAgICAgICogQHNlZSA8YSBocmVmPSJodHRwOi8vdGVjaHpvbmUuY291Y2hiYXNlLmNvbS9zaXRlcy9kZWZhdWx0L2ZpbGVzLwogICAgICAgICAqIHVwbG9hZHMvYWxsL2RvY3VtZW50YXRpb24vY291Y2hiYXNlLWFwaS1kYi5odG1sI2NvdWNoYmFzZS1hcGktZGJfCiAgICAgICAgICogZGItY29tcGFjdF9wb3N0Ij5kb2NzIGZvciAvZGIvX2NvbXBhY3Q8L2E+CiAgICAgICAgICogQHBhcmFtIHthamF4U2V0dGluZ3N9IG9wdGlvbnMKICAgICAgICAgKiA8YSBocmVmPSJodHRwOi8vYXBpLmpxdWVyeS5jb20valF1ZXJ5LmFqYXgvI2pRdWVyeS1hamF4LXNldHRpbmdzIj4KICAgICAgICAgKiBqUXVlcnkgYWpheCBzZXR0aW5nczwvYT4KICAgICAgICAgKi8KICAgICAgICBjb21wYWN0OiBmdW5jdGlvbihvcHRpb25zKSB7CiAgICAgICAgICAkLmV4dGVuZChvcHRpb25zLCB7c3VjY2Vzc1N0YXR1czogMjAyfSk7CiAgICAgICAgICBhamF4KHsKICAgICAgICAgICAgICB0eXBlOiAiUE9TVCIsIHVybDogdGhpcy51cmkgKyAiX2NvbXBhY3QiLAogICAgICAgICAgICAgIGRhdGE6ICIiLCBwcm9jZXNzRGF0YTogZmFsc2UKICAgICAgICAgICAgfSwKICAgICAgICAgICAgb3B0aW9ucywKICAgICAgICAgICAgIlRoZSBkYXRhYmFzZSBjb3VsZCBub3QgYmUgY29tcGFjdGVkIgogICAgICAgICAgKTsKICAgICAgICB9LAoKICAgICAgICAvKioKICAgICAgICAgKiBDbGVhbnMgdXAgdGhlIGNhY2hlZCB2aWV3IG91dHB1dCBvbiBkaXNrIGZvciBhIGdpdmVuIHZpZXcuCiAgICAgICAgICogQHNlZSA8YSBocmVmPSJodHRwOi8vdGVjaHpvbmUuY291Y2hiYXNlLmNvbS9zaXRlcy9kZWZhdWx0L2ZpbGVzLwogICAgICAgICAqIHVwbG9hZHMvYWxsL2RvY3VtZW50YXRpb24vY291Y2hiYXNlLWFwaS1kYi5odG1sI2NvdWNoYmFzZS1hcGktZGIKICAgICAgICAgKiBfZGItdmlldy1jbGVhbnVwX3Bvc3QiPmRvY3MgZm9yIC9kYi9fY29tcGFjdDwvYT4KICAgICAgICAgKiBAcGFyYW0ge2FqYXhTZXR0aW5nc30gb3B0aW9ucyA8YSBocmVmPSJodHRwOi8vYXBpLmpxdWVyeS5jb20vCiAgICAgICAgICogalF1ZXJ5LmFqYXgvI2pRdWVyeS1hamF4LXNldHRpbmdzIj5qUXVlcnkgYWpheCBzZXR0aW5nczwvYT4KICAgICAgICAgKi8KICAgICAgICB2aWV3Q2xlYW51cDogZnVuY3Rpb24ob3B0aW9ucykgewogICAgICAgICAgJC5leHRlbmQob3B0aW9ucywge3N1Y2Nlc3NTdGF0dXM6IDIwMn0pOwogICAgICAgICAgYWpheCh7CiAgICAgICAgICAgICAgdHlwZTogIlBPU1QiLCB1cmw6IHRoaXMudXJpICsgIl92aWV3X2NsZWFudXAiLAogICAgICAgICAgICAgIGRhdGE6ICIiLCBwcm9jZXNzRGF0YTogZmFsc2UKICAgICAgICAgICAgfSwKICAgICAgICAgICAgb3B0aW9ucywKICAgICAgICAgICAgIlRoZSB2aWV3cyBjb3VsZCBub3QgYmUgY2xlYW5lZCB1cCIKICAgICAgICAgICk7CiAgICAgICAgfSwKCiAgICAgICAgLyoqCiAgICAgICAgICogQ29tcGFjdHMgdGhlIHZpZXcgaW5kZXhlcyBhc3NvY2lhdGVkIHdpdGggdGhlIHNwZWNpZmllZCBkZXNpZ24KICAgICAgICAgKiBkb2N1bWVudC4gWW91IGNhbiB1c2UgdGhpcyBpbiBwbGFjZSBvZiB0aGUgZnVsbCBkYXRhYmFzZSBjb21wYWN0aW9uCiAgICAgICAgICogaWYgeW91IGtub3cgYSBzcGVjaWZpYyBzZXQgb2YgdmlldyBpbmRleGVzIGhhdmUgYmVlbiBhZmZlY3RlZCBieSBhCiAgICAgICAgICogcmVjZW50IGRhdGFiYXNlIGNoYW5nZS4KICAgICAgICAgKiBAc2VlIDxhIGhyZWY9Imh0dHA6Ly90ZWNoem9uZS5jb3VjaGJhc2UuY29tL3NpdGVzL2RlZmF1bHQvZmlsZXMvdXBsCiAgICAgICAgICogb2Fkcy9hbGwvZG9jdW1lbnRhdGlvbi9jb3VjaGJhc2UtYXBpLWRiLmh0bWwjY291Y2hiYXNlLWFwaS1kYl9kYi0KICAgICAgICAgKiBjb21wYWN0LWRlc2lnbi1kb2NfcG9zdCI+ZG9jcyBmb3IgL2RiL19jb21wYWN0L2Rlc2lnbi1kb2M8L2E+CiAgICAgICAgICogQHBhcmFtIHtTdHJpbmd9IGdyb3VwbmFtZSBOYW1lIG9mIGRlc2lnbi1kb2MgdG8gY29tcGFjdAogICAgICAgICAqIEBwYXJhbSB7YWpheFNldHRpbmdzfSBvcHRpb25zIDxhIGhyZWY9Imh0dHA6Ly9hcGkuanF1ZXJ5LmNvbS8KICAgICAgICAgKiBqUXVlcnkuYWpheC8jalF1ZXJ5LWFqYXgtc2V0dGluZ3MiPmpRdWVyeSBhamF4IHNldHRpbmdzPC9hPgogICAgICAgICAqLwogICAgICAgIGNvbXBhY3RWaWV3OiBmdW5jdGlvbihncm91cG5hbWUsIG9wdGlvbnMpIHsKICAgICAgICAgICQuZXh0ZW5kKG9wdGlvbnMsIHtzdWNjZXNzU3RhdHVzOiAyMDJ9KTsKICAgICAgICAgIGFqYXgoewogICAgICAgICAgICAgIHR5cGU6ICJQT1NUIiwgdXJsOiB0aGlzLnVyaSArICJfY29tcGFjdC8iICsgZ3JvdXBuYW1lLAogICAgICAgICAgICAgIGRhdGE6ICIiLCBwcm9jZXNzRGF0YTogZmFsc2UKICAgICAgICAgICAgfSwKICAgICAgICAgICAgb3B0aW9ucywKICAgICAgICAgICAgIlRoZSB2aWV3IGNvdWxkIG5vdCBiZSBjb21wYWN0ZWQiCiAgICAgICAgICApOwogICAgICAgIH0sCgogICAgICAgIC8qKgogICAgICAgICAqIENyZWF0ZSBhIG5ldyBkYXRhYmFzZQogICAgICAgICAqIEBzZWUgPGEgaHJlZj0iaHR0cDovL3RlY2h6b25lLmNvdWNoYmFzZS5jb20vc2l0ZXMvZGVmYXVsdC9maWxlcy8KICAgICAgICAgKiB1cGxvYWRzL2FsbC9kb2N1bWVudGF0aW9uL2NvdWNoYmFzZS1hcGktZGIuaHRtbCNjb3VjaGJhc2UtYXBpLWRiXwogICAgICAgICAqIGRiX3B1dCI+ZG9jcyBmb3IgUFVUIC9kYi88L2E+CiAgICAgICAgICogQHBhcmFtIHthamF4U2V0dGluZ3N9IG9wdGlvbnMgPGEgaHJlZj0iaHR0cDovL2FwaS5qcXVlcnkuY29tLwogICAgICAgICAqIGpRdWVyeS5hamF4LyNqUXVlcnktYWpheC1zZXR0aW5ncyI+alF1ZXJ5IGFqYXggc2V0dGluZ3M8L2E+CiAgICAgICAgICovCiAgICAgICAgY3JlYXRlOiBmdW5jdGlvbihvcHRpb25zKSB7CiAgICAgICAgICAkLmV4dGVuZChvcHRpb25zLCB7c3VjY2Vzc1N0YXR1czogMjAxfSk7CiAgICAgICAgICBhamF4KHsKICAgICAgICAgICAgICB0eXBlOiAiUFVUIiwgdXJsOiB0aGlzLnVyaSwgY29udGVudFR5cGU6ICJhcHBsaWNhdGlvbi9qc29uIiwKICAgICAgICAgICAgICBkYXRhOiAiIiwgcHJvY2Vzc0RhdGE6IGZhbHNlCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIG9wdGlvbnMsCiAgICAgICAgICAgICJUaGUgZGF0YWJhc2UgY291bGQgbm90IGJlIGNyZWF0ZWQiCiAgICAgICAgICApOwogICAgICAgIH0sCgogICAgICAgIC8qKgogICAgICAgICAqIERlbGV0ZXMgdGhlIHNwZWNpZmllZCBkYXRhYmFzZSwgYW5kIGFsbCB0aGUgZG9jdW1lbnRzIGFuZAogICAgICAgICAqIGF0dGFjaG1lbnRzIGNvbnRhaW5lZCB3aXRoaW4gaXQuCiAgICAgICAgICogQHNlZSA8YSBocmVmPSJodHRwOi8vdGVjaHpvbmUuY291Y2hiYXNlLmNvbS9zaXRlcy9kZWZhdWx0L2ZpbGVzLwogICAgICAgICAqIHVwbG9hZHMvYWxsL2RvY3VtZW50YXRpb24vY291Y2hiYXNlLWFwaS1kYi5odG1sI2NvdWNoYmFzZS1hcGktZGJfCiAgICAgICAgICogZGJfZGVsZXRlIj5kb2NzIGZvciBERUxFVEUgL2RiLzwvYT4KICAgICAgICAgKiBAcGFyYW0ge2FqYXhTZXR0aW5nc30gb3B0aW9ucyA8YSBocmVmPSJodHRwOi8vYXBpLmpxdWVyeS5jb20vCiAgICAgICAgICogalF1ZXJ5LmFqYXgvI2pRdWVyeS1hamF4LXNldHRpbmdzIj5qUXVlcnkgYWpheCBzZXR0aW5nczwvYT4KICAgICAgICAgKi8KICAgICAgICBkcm9wOiBmdW5jdGlvbihvcHRpb25zKSB7CiAgICAgICAgICBhamF4KAogICAgICAgICAgICB7dHlwZTogIkRFTEVURSIsIHVybDogdGhpcy51cml9LAogICAgICAgICAgICBvcHRpb25zLAogICAgICAgICAgICAiVGhlIGRhdGFiYXNlIGNvdWxkIG5vdCBiZSBkZWxldGVkIgogICAgICAgICAgKTsKICAgICAgICB9LAoKICAgICAgICAvKioKICAgICAgICAgKiBHZXRzIGluZm9ybWF0aW9uIGFib3V0IHRoZSBzcGVjaWZpZWQgZGF0YWJhc2UuCiAgICAgICAgICogQHNlZSA8YSBocmVmPSJodHRwOi8vdGVjaHpvbmUuY291Y2hiYXNlLmNvbS9zaXRlcy9kZWZhdWx0L2ZpbGVzLwogICAgICAgICAqIHVwbG9hZHMvYWxsL2RvY3VtZW50YXRpb24vY291Y2hiYXNlLWFwaS1kYi5odG1sI2NvdWNoYmFzZS1hcGktZGIKICAgICAgICAgKiBfZGJfZ2V0Ij5kb2NzIGZvciBHRVQgL2RiLzwvYT4KICAgICAgICAgKiBAcGFyYW0ge2FqYXhTZXR0aW5nc30gb3B0aW9ucyA8YSBocmVmPSJodHRwOi8vYXBpLmpxdWVyeS5jb20vCiAgICAgICAgICogalF1ZXJ5LmFqYXgvI2pRdWVyeS1hamF4LXNldHRpbmdzIj5qUXVlcnkgYWpheCBzZXR0aW5nczwvYT4KICAgICAgICAgKi8KICAgICAgICBpbmZvOiBmdW5jdGlvbihvcHRpb25zKSB7CiAgICAgICAgICBhamF4KAogICAgICAgICAgICB7dXJsOiB0aGlzLnVyaX0sCiAgICAgICAgICAgIG9wdGlvbnMsCiAgICAgICAgICAgICJEYXRhYmFzZSBpbmZvcm1hdGlvbiBjb3VsZCBub3QgYmUgcmV0cmlldmVkIgogICAgICAgICAgKTsKICAgICAgICB9LAoKICAgICAgICAvKioKICAgICAgICAgKiBAbmFtZXNwYWNlCiAgICAgICAgICogJC5jb3VjaC5kYi5jaGFuZ2VzIHByb3ZpZGVzIGFuIEFQSSBmb3Igc3Vic2NyaWJpbmcgdG8gdGhlIGNoYW5nZXMKICAgICAgICAgKiBmZWVkCiAgICAgICAgICogPHByZT48Y29kZT52YXIgJGNoYW5nZXMgPSAkLmNvdWNoLmRiKCJteWRhdGFiYXNlIikuY2hhbmdlcygpOwogICAgICAgICAqJGNoYW5nZXMub25DaGFuZ2UgPSBmdW5jdGlvbiAoZGF0YSkgewogICAgICAgICAqICAgIC4uLiBwcm9jZXNzIGRhdGEgLi4uCiAgICAgICAgICogfQogICAgICAgICAqICRjaGFuZ2VzLnN0b3AoKTsKICAgICAgICAgKiA8L2NvZGU+PC9wcmU+CiAgICAgICAgICovCiAgICAgICAgY2hhbmdlczogZnVuY3Rpb24oc2luY2UsIG9wdGlvbnMpIHsKCiAgICAgICAgICBvcHRpb25zID0gb3B0aW9ucyB8fCB7fTsKICAgICAgICAgIC8vIHNldCB1cCB0aGUgcHJvbWlzZSBvYmplY3Qgd2l0aGluIGEgY2xvc3VyZSBmb3IgdGhpcyBoYW5kbGVyCiAgICAgICAgICB2YXIgdGltZW91dCA9IDEwMCwgZGIgPSB0aGlzLCBhY3RpdmUgPSB0cnVlLAogICAgICAgICAgICBsaXN0ZW5lcnMgPSBbXSwKICAgICAgICAgICAgcHJvbWlzZSA9IC8qKiBAbGVuZHMgJC5jb3VjaC5kYi5jaGFuZ2VzICovIHsKICAgICAgICAgICAgICAvKioKICAgICAgICAgICAgICAgKiBBZGQgYSBsaXN0ZW5lciBjYWxsYmFjawogICAgICAgICAgICAgICAqIEBzZWUgPGEgaHJlZj0iaHR0cDovL3RlY2h6b25lLmNvdWNoYmFzZS5jb20vc2l0ZXMvZGVmYXVsdC8KICAgICAgICAgICAgICAgKiBmaWxlcy91cGxvYWRzL2FsbC9kb2N1bWVudGF0aW9uL2NvdWNoYmFzZS1hcGktZGIuaHRtbCNjb3VjaAogICAgICAgICAgICAgICAqIGJhc2UtYXBpLWRiX2RiLWNoYW5nZXNfZ2V0Ij5kb2NzIGZvciAvZGIvX2NoYW5nZXM8L2E+CiAgICAgICAgICAgICAgICogQHBhcmFtIHtGdW5jdGlvbn0gZnVuIENhbGxiYWNrIGZ1bmN0aW9uIHRvIHJ1biB3aGVuCiAgICAgICAgICAgICAgICogbm90aWZpZWQgb2YgY2hhbmdlcy4KICAgICAgICAgICAgICAgKi8KICAgICAgICAgICAgb25DaGFuZ2UgOiBmdW5jdGlvbihmdW4pIHsKICAgICAgICAgICAgICBsaXN0ZW5lcnMucHVzaChmdW4pOwogICAgICAgICAgICB9LAogICAgICAgICAgICAgIC8qKgogICAgICAgICAgICAgICAqIFN0b3Agc3Vic2NyaWJpbmcgdG8gdGhlIGNoYW5nZXMgZmVlZAogICAgICAgICAgICAgICAqLwogICAgICAgICAgICBzdG9wIDogZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgYWN0aXZlID0gZmFsc2U7CiAgICAgICAgICAgIH0KICAgICAgICAgIH07CiAgICAgICAgICAvLyBjYWxsIGVhY2ggbGlzdGVuZXIgd2hlbiB0aGVyZSBpcyBhIGNoYW5nZQogICAgICAgICAgZnVuY3Rpb24gdHJpZ2dlckxpc3RlbmVycyhyZXNwKSB7CiAgICAgICAgICAgICQuZWFjaChsaXN0ZW5lcnMsIGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgIHRoaXMocmVzcCk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfTsKICAgICAgICAgIC8vIHdoZW4gdGhlcmUgaXMgYSBjaGFuZ2UsIGNhbGwgYW55IGxpc3RlbmVycywgdGhlbiBjaGVjayBmb3IKICAgICAgICAgIC8vIGFub3RoZXIgY2hhbmdlCiAgICAgICAgICBvcHRpb25zLnN1Y2Nlc3MgPSBmdW5jdGlvbihyZXNwKSB7CiAgICAgICAgICAgIHRpbWVvdXQgPSAxMDA7CiAgICAgICAgICAgIGlmIChhY3RpdmUpIHsKICAgICAgICAgICAgICBzaW5jZSA9IHJlc3AubGFzdF9zZXE7CiAgICAgICAgICAgICAgdHJpZ2dlckxpc3RlbmVycyhyZXNwKTsKICAgICAgICAgICAgICBnZXRDaGFuZ2VzU2luY2UoKTsKICAgICAgICAgICAgfTsKICAgICAgICAgIH07CiAgICAgICAgICBvcHRpb25zLmVycm9yID0gZnVuY3Rpb24oKSB7CiAgICAgICAgICAgIGlmIChhY3RpdmUpIHsKICAgICAgICAgICAgICBzZXRUaW1lb3V0KGdldENoYW5nZXNTaW5jZSwgdGltZW91dCk7CiAgICAgICAgICAgICAgdGltZW91dCA9IHRpbWVvdXQgKiAyOwogICAgICAgICAgICB9CiAgICAgICAgICB9OwogICAgICAgICAgLy8gYWN0dWFsbHkgbWFrZSB0aGUgY2hhbmdlcyByZXF1ZXN0CiAgICAgICAgICBmdW5jdGlvbiBnZXRDaGFuZ2VzU2luY2UoKSB7CiAgICAgICAgICAgIHZhciBvcHRzID0gJC5leHRlbmQoe2hlYXJ0YmVhdCA6IDEwICogMTAwMH0sIG9wdGlvbnMsIHsKICAgICAgICAgICAgICBmZWVkIDogImxvbmdwb2xsIiwKICAgICAgICAgICAgICBzaW5jZSA6IHNpbmNlCiAgICAgICAgICAgIH0pOwogICAgICAgICAgICBhamF4KAogICAgICAgICAgICAgIHt1cmw6IGRiLnVyaSArICJfY2hhbmdlcyIrZW5jb2RlT3B0aW9ucyhvcHRzKX0sCiAgICAgICAgICAgICAgb3B0aW9ucywKICAgICAgICAgICAgICAiRXJyb3IgY29ubmVjdGluZyB0byAiK2RiLnVyaSsiL19jaGFuZ2VzLiIKICAgICAgICAgICAgKTsKICAgICAgICAgIH0KICAgICAgICAgIC8vIHN0YXJ0IHRoZSBmaXJzdCByZXF1ZXN0CiAgICAgICAgICBpZiAoc2luY2UpIHsKICAgICAgICAgICAgZ2V0Q2hhbmdlc1NpbmNlKCk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBkYi5pbmZvKHsKICAgICAgICAgICAgICBzdWNjZXNzIDogZnVuY3Rpb24oaW5mbykgewogICAgICAgICAgICAgICAgc2luY2UgPSBpbmZvLnVwZGF0ZV9zZXE7CiAgICAgICAgICAgICAgICBnZXRDaGFuZ2VzU2luY2UoKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfQogICAgICAgICAgcmV0dXJuIHByb21pc2U7CiAgICAgICAgfSwKCiAgICAgICAgLyoqCiAgICAgICAgICogRmV0Y2ggYWxsIHRoZSBkb2NzIGluIHRoaXMgZGIsIHlvdSBjYW4gc3BlY2lmeSBhbiBhcnJheSBvZiBrZXlzIHRvCiAgICAgICAgICogZmV0Y2ggYnkgcGFzc2luZyB0aGUgPGNvZGU+a2V5czwvY29kZT4gZmllbGQgaW4gdGhlCiAgICAgICAgICogPGNvZGU+b3B0aW9uczwvY29kZT4KICAgICAgICAgKiBwYXJhbWV0ZXIuCiAgICAgICAgICogQHNlZSA8YSBocmVmPSJodHRwOi8vdGVjaHpvbmUuY291Y2hiYXNlLmNvbS9zaXRlcy9kZWZhdWx0L2ZpbGVzLwogICAgICAgICAqIHVwbG9hZHMvYWxsL2RvY3VtZW50YXRpb24vY291Y2hiYXNlLWFwaS1kYi5odG1sI2NvdWNoYmFzZS1hcGktZGJfCiAgICAgICAgICogZGItYWxsLWRvY3NfZ2V0Ij5kb2NzIGZvciAvZGIvYWxsX2RvY3MvPC9hPgogICAgICAgICAqIEBwYXJhbSB7YWpheFNldHRpbmdzfSBvcHRpb25zIDxhIGhyZWY9Imh0dHA6Ly9hcGkuanF1ZXJ5LmNvbS8KICAgICAgICAgKiBqUXVlcnkuYWpheC8jalF1ZXJ5LWFqYXgtc2V0dGluZ3MiPmpRdWVyeSBhamF4IHNldHRpbmdzPC9hPgogICAgICAgICAqLwogICAgICAgIGFsbERvY3M6IGZ1bmN0aW9uKG9wdGlvbnMpIHsKICAgICAgICAgIHZhciB0eXBlID0gIkdFVCI7CiAgICAgICAgICB2YXIgZGF0YSA9IG51bGw7CiAgICAgICAgICBpZiAob3B0aW9uc1sia2V5cyJdKSB7CiAgICAgICAgICAgIHR5cGUgPSAiUE9TVCI7CiAgICAgICAgICAgIHZhciBrZXlzID0gb3B0aW9uc1sia2V5cyJdOwogICAgICAgICAgICBkZWxldGUgb3B0aW9uc1sia2V5cyJdOwogICAgICAgICAgICBkYXRhID0gdG9KU09OKHsgImtleXMiOiBrZXlzIH0pOwogICAgICAgICAgfQogICAgICAgICAgYWpheCh7CiAgICAgICAgICAgICAgdHlwZTogdHlwZSwKICAgICAgICAgICAgICBkYXRhOiBkYXRhLAogICAgICAgICAgICAgIHVybDogdGhpcy51cmkgKyAiX2FsbF9kb2NzIiArIGVuY29kZU9wdGlvbnMob3B0aW9ucykKICAgICAgICAgICAgfSwKICAgICAgICAgICAgb3B0aW9ucywKICAgICAgICAgICAgIkFuIGVycm9yIG9jY3VycmVkIHJldHJpZXZpbmcgYSBsaXN0IG9mIGFsbCBkb2N1bWVudHMiCiAgICAgICAgICApOwogICAgICAgIH0sCgogICAgICAgIC8qKgogICAgICAgICAqIEZldGNoIGFsbCB0aGUgZGVzaWduIGRvY3MgaW4gdGhpcyBkYgogICAgICAgICAqIEBwYXJhbSB7YWpheFNldHRpbmdzfSBvcHRpb25zIDxhIGhyZWY9Imh0dHA6Ly9hcGkuanF1ZXJ5LmNvbS8KICAgICAgICAgKiBqUXVlcnkuYWpheC8jalF1ZXJ5LWFqYXgtc2V0dGluZ3MiPmpRdWVyeSBhamF4IHNldHRpbmdzPC9hPgogICAgICAgICAqLwogICAgICAgIGFsbERlc2lnbkRvY3M6IGZ1bmN0aW9uKG9wdGlvbnMpIHsKICAgICAgICAgIHRoaXMuYWxsRG9jcygkLmV4dGVuZCgKICAgICAgICAgICAge3N0YXJ0a2V5OiJfZGVzaWduIiwgZW5ka2V5OiJfZGVzaWduMCJ9LCBvcHRpb25zKSk7CiAgICAgICAgfSwKCiAgICAgICAgLyoqCiAgICAgICAgICogRmV0Y2ggYWxsIHRoZSBkZXNpZ24gZG9jcyB3aXRoIGFuIGluZGV4Lmh0bWwsIDxjb2RlPm9wdGlvbnM8L2NvZGU+CiAgICAgICAgICogcGFyYW1ldGVyIGV4cGVjdHMgYW4gPGNvZGU+ZWFjaEFwcDwvY29kZT4gZmllbGQgd2hpY2ggaXMgYSBjYWxsYmFjawogICAgICAgICAqIGNhbGxlZCBvbiBlYWNoIGFwcCBmb3VuZC4KICAgICAgICAgKiBAcGFyYW0ge2FqYXhTZXR0aW5nc30gb3B0aW9ucyA8YSBocmVmPSJodHRwOi8vYXBpLmpxdWVyeS5jb20vCiAgICAgICAgICogalF1ZXJ5LmFqYXgvI2pRdWVyeS1hamF4LXNldHRpbmdzIj5qUXVlcnkgYWpheCBzZXR0aW5nczwvYT4KICAgICAgICAgKi8KICAgICAgICBhbGxBcHBzOiBmdW5jdGlvbihvcHRpb25zKSB7CiAgICAgICAgICBvcHRpb25zID0gb3B0aW9ucyB8fCB7fTsKICAgICAgICAgIHZhciBzZWxmID0gdGhpczsKICAgICAgICAgIGlmIChvcHRpb25zLmVhY2hBcHApIHsKICAgICAgICAgICAgdGhpcy5hbGxEZXNpZ25Eb2NzKHsKICAgICAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbihyZXNwKSB7CiAgICAgICAgICAgICAgICAkLmVhY2gocmVzcC5yb3dzLCBmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAgICAgc2VsZi5vcGVuRG9jKHRoaXMuaWQsIHsKICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbihkZG9jKSB7CiAgICAgICAgICAgICAgICAgICAgICB2YXIgaW5kZXgsIGFwcFBhdGgsIGFwcE5hbWUgPSBkZG9jLl9pZC5zcGxpdCgnLycpOwogICAgICAgICAgICAgICAgICAgICAgYXBwTmFtZS5zaGlmdCgpOwogICAgICAgICAgICAgICAgICAgICAgYXBwTmFtZSA9IGFwcE5hbWUuam9pbignLycpOwogICAgICAgICAgICAgICAgICAgICAgaW5kZXggPSBkZG9jLmNvdWNoYXBwICYmIGRkb2MuY291Y2hhcHAuaW5kZXg7CiAgICAgICAgICAgICAgICAgICAgICBpZiAoaW5kZXgpIHsKICAgICAgICAgICAgICAgICAgICAgICAgYXBwUGF0aCA9IFsnJywgbmFtZSwgZGRvYy5faWQsIGluZGV4XS5qb2luKCcvJyk7CiAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGRkb2MuX2F0dGFjaG1lbnRzICYmCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRkb2MuX2F0dGFjaG1lbnRzWyJpbmRleC5odG1sIl0pIHsKICAgICAgICAgICAgICAgICAgICAgICAgYXBwUGF0aCA9IFsnJywgbmFtZSwgZGRvYy5faWQsICJpbmRleC5odG1sIl0uam9pbignLycpOwogICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgaWYgKGFwcFBhdGgpIG9wdGlvbnMuZWFjaEFwcChhcHBOYW1lLCBhcHBQYXRoLCBkZG9jKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGFsZXJ0KCJQbGVhc2UgcHJvdmlkZSBhbiBlYWNoQXBwIGZ1bmN0aW9uIGZvciBhbGxBcHBzKCkiKTsKICAgICAgICAgIH0KICAgICAgICB9LAoKICAgICAgICAvKioKICAgICAgICAgKiBSZXR1cm5zIHRoZSBzcGVjaWZpZWQgZG9jIGZyb20gdGhlIHNwZWNpZmllZCBkYi4KICAgICAgICAgKiBAc2VlIDxhIGhyZWY9Imh0dHA6Ly90ZWNoem9uZS5jb3VjaGJhc2UuY29tL3NpdGVzL2RlZmF1bHQvZmlsZXMvCiAgICAgICAgICogdXBsb2Fkcy9hbGwvZG9jdW1lbnRhdGlvbi9jb3VjaGJhc2UtYXBpLWRiZG9jLmh0bWwjY291Y2hiYXNlLWFwaS0KICAgICAgICAgKiBkYmRvY19kYi1kb2NfZ2V0Ij5kb2NzIGZvciBHRVQgL2RiL2RvYzwvYT4KICAgICAgICAgKiBAcGFyYW0ge1N0cmluZ30gZG9jSWQgaWQgb2YgZG9jdW1lbnQgdG8gZmV0Y2gKICAgICAgICAgKiBAcGFyYW0ge2FqYXhTZXR0aW5nc30gb3B0aW9ucyA8YSBocmVmPSJodHRwOi8vYXBpLmpxdWVyeS5jb20vCiAgICAgICAgICogalF1ZXJ5LmFqYXgvI2pRdWVyeS1hamF4LXNldHRpbmdzIj5qUXVlcnkgYWpheCBzZXR0aW5nczwvYT4KICAgICAgICAgKiBAcGFyYW0ge2FqYXhTZXR0aW5nc30gYWpheE9wdGlvbnMgPGEgaHJlZj0iaHR0cDovL2FwaS5qcXVlcnkuY29tLwogICAgICAgICAqIGpRdWVyeS5hamF4LyNqUXVlcnktYWpheC1zZXR0aW5ncyI+alF1ZXJ5IGFqYXggc2V0dGluZ3M8L2E+CiAgICAgICAgICovCiAgICAgICAgb3BlbkRvYzogZnVuY3Rpb24oZG9jSWQsIG9wdGlvbnMsIGFqYXhPcHRpb25zKSB7CiAgICAgICAgICBvcHRpb25zID0gb3B0aW9ucyB8fCB7fTsKICAgICAgICAgIGlmIChkYl9vcHRzLmF0dGFjaFByZXZSZXYgfHwgb3B0aW9ucy5hdHRhY2hQcmV2UmV2KSB7CiAgICAgICAgICAgICQuZXh0ZW5kKG9wdGlvbnMsIHsKICAgICAgICAgICAgICBiZWZvcmVTdWNjZXNzIDogZnVuY3Rpb24ocmVxLCBkb2MpIHsKICAgICAgICAgICAgICAgIHJhd0RvY3NbZG9jLl9pZF0gPSB7CiAgICAgICAgICAgICAgICAgIHJldiA6IGRvYy5fcmV2LAogICAgICAgICAgICAgICAgICByYXcgOiByZXEucmVzcG9uc2VUZXh0CiAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAkLmV4dGVuZChvcHRpb25zLCB7CiAgICAgICAgICAgICAgYmVmb3JlU3VjY2VzcyA6IGZ1bmN0aW9uKHJlcSwgZG9jKSB7CiAgICAgICAgICAgICAgICBpZiAoZG9jWyJqcXVlcnkuY291Y2guYXR0YWNoUHJldlJldiJdKSB7CiAgICAgICAgICAgICAgICAgIHJhd0RvY3NbZG9jLl9pZF0gPSB7CiAgICAgICAgICAgICAgICAgICAgcmV2IDogZG9jLl9yZXYsCiAgICAgICAgICAgICAgICAgICAgcmF3IDogcmVxLnJlc3BvbnNlVGV4dAogICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSk7CiAgICAgICAgICB9CiAgICAgICAgICBhamF4KHt1cmw6IHRoaXMudXJpICsgZW5jb2RlRG9jSWQoZG9jSWQpICsgZW5jb2RlT3B0aW9ucyhvcHRpb25zKX0sCiAgICAgICAgICAgIG9wdGlvbnMsCiAgICAgICAgICAgICJUaGUgZG9jdW1lbnQgY291bGQgbm90IGJlIHJldHJpZXZlZCIsCiAgICAgICAgICAgIGFqYXhPcHRpb25zCiAgICAgICAgICApOwogICAgICAgIH0sCgogICAgICAgIC8qKgogICAgICAgICAqIENyZWF0ZSBhIG5ldyBkb2N1bWVudCBpbiB0aGUgc3BlY2lmaWVkIGRhdGFiYXNlLCB1c2luZyB0aGUgc3VwcGxpZWQKICAgICAgICAgKiBKU09OIGRvY3VtZW50IHN0cnVjdHVyZS4gSWYgdGhlIEpTT04gc3RydWN0dXJlIGluY2x1ZGVzIHRoZSBfaWQKICAgICAgICAgKiBmaWVsZCwgdGhlbiB0aGUgZG9jdW1lbnQgd2lsbCBiZSBjcmVhdGVkIHdpdGggdGhlIHNwZWNpZmllZCBkb2N1bWVudAogICAgICAgICAqIElELiBJZiB0aGUgX2lkIGZpZWxkIGlzIG5vdCBzcGVjaWZpZWQsIGEgbmV3IHVuaXF1ZSBJRCB3aWxsIGJlCiAgICAgICAgICogZ2VuZXJhdGVkLgogICAgICAgICAqIEBzZWUgPGEgaHJlZj0iaHR0cDovL3RlY2h6b25lLmNvdWNoYmFzZS5jb20vc2l0ZXMvZGVmYXVsdC9maWxlcy8KICAgICAgICAgKiB1cGxvYWRzL2FsbC9kb2N1bWVudGF0aW9uL2NvdWNoYmFzZS1hcGktZGJkb2MuaHRtbCNjb3VjaGJhc2UtYXBpLQogICAgICAgICAqIGRiZG9jX2RiX3Bvc3QiPmRvY3MgZm9yIEdFVCAvZGIvZG9jPC9hPgogICAgICAgICAqIEBwYXJhbSB7U3RyaW5nfSBkb2MgZG9jdW1lbnQgdG8gc2F2ZQogICAgICAgICAqIEBwYXJhbSB7YWpheFNldHRpbmdzfSBvcHRpb25zIDxhIGhyZWY9Imh0dHA6Ly9hcGkuanF1ZXJ5LmNvbS8KICAgICAgICAgKiBqUXVlcnkuYWpheC8jalF1ZXJ5LWFqYXgtc2V0dGluZ3MiPmpRdWVyeSBhamF4IHNldHRpbmdzPC9hPgogICAgICAgICAqLwogICAgICAgIHNhdmVEb2M6IGZ1bmN0aW9uKGRvYywgb3B0aW9ucykgewogICAgICAgICAgb3B0aW9ucyA9IG9wdGlvbnMgfHwge307CiAgICAgICAgICB2YXIgZGIgPSB0aGlzOwogICAgICAgICAgdmFyIGJlZm9yZVNlbmQgPSBmdWxsQ29tbWl0KG9wdGlvbnMpOwogICAgICAgICAgaWYgKGRvYy5faWQgPT09IHVuZGVmaW5lZCkgewogICAgICAgICAgICB2YXIgbWV0aG9kID0gIlBPU1QiOwogICAgICAgICAgICB2YXIgdXJpID0gdGhpcy51cmk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICB2YXIgbWV0aG9kID0gIlBVVCI7CiAgICAgICAgICAgIHZhciB1cmkgPSB0aGlzLnVyaSArIGVuY29kZURvY0lkKGRvYy5faWQpOwogICAgICAgICAgfQogICAgICAgICAgdmFyIHZlcnNpb25lZCA9IG1heWJlQXBwbHlWZXJzaW9uKGRvYyk7CiAgICAgICAgICAkLmFqYXgoewogICAgICAgICAgICB0eXBlOiBtZXRob2QsIHVybDogdXJpICsgZW5jb2RlT3B0aW9ucyhvcHRpb25zKSwKICAgICAgICAgICAgY29udGVudFR5cGU6ICJhcHBsaWNhdGlvbi9qc29uIiwKICAgICAgICAgICAgZGF0YVR5cGU6ICJqc29uIiwgZGF0YTogdG9KU09OKGRvYyksCiAgICAgICAgICAgIGJlZm9yZVNlbmQgOiBiZWZvcmVTZW5kLAogICAgICAgICAgICBjb21wbGV0ZTogZnVuY3Rpb24ocmVxKSB7CiAgICAgICAgICAgICAgdmFyIHJlc3AgPSAkLnBhcnNlSlNPTihyZXEucmVzcG9uc2VUZXh0KTsKICAgICAgICAgICAgICBpZiAocmVxLnN0YXR1cyA9PSAyMDAgfHwgcmVxLnN0YXR1cyA9PSAyMDEgfHwgcmVxLnN0YXR1cyA9PSAyMDIpIHsKICAgICAgICAgICAgICAgIGRvYy5faWQgPSByZXNwLmlkOwogICAgICAgICAgICAgICAgZG9jLl9yZXYgPSByZXNwLnJldjsKICAgICAgICAgICAgICAgIGlmICh2ZXJzaW9uZWQpIHsKICAgICAgICAgICAgICAgICAgZGIub3BlbkRvYyhkb2MuX2lkLCB7CiAgICAgICAgICAgICAgICAgICAgYXR0YWNoUHJldlJldiA6IHRydWUsCiAgICAgICAgICAgICAgICAgICAgc3VjY2VzcyA6IGZ1bmN0aW9uKGQpIHsKICAgICAgICAgICAgICAgICAgICAgIGRvYy5fYXR0YWNobWVudHMgPSBkLl9hdHRhY2htZW50czsKICAgICAgICAgICAgICAgICAgICAgIGlmIChvcHRpb25zLnN1Y2Nlc3MpIG9wdGlvbnMuc3VjY2VzcyhyZXNwKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgaWYgKG9wdGlvbnMuc3VjY2Vzcykgb3B0aW9ucy5zdWNjZXNzKHJlc3ApOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0gZWxzZSBpZiAob3B0aW9ucy5lcnJvcikgewogICAgICAgICAgICAgICAgb3B0aW9ucy5lcnJvcihyZXEuc3RhdHVzLCByZXNwLmVycm9yLCByZXNwLnJlYXNvbik7CiAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIGFsZXJ0KCJUaGUgZG9jdW1lbnQgY291bGQgbm90IGJlIHNhdmVkOiAiICsgcmVzcC5yZWFzb24pOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgfSk7CiAgICAgICAgfSwKCiAgICAgICAgLyoqCiAgICAgICAgICogU2F2ZSBhIGxpc3Qgb2YgZG9jdW1lbnRzCiAgICAgICAgICogQHNlZSA8YSBocmVmPSJodHRwOi8vdGVjaHpvbmUuY291Y2hiYXNlLmNvbS9zaXRlcy9kZWZhdWx0L2ZpbGVzLwogICAgICAgICAqIHVwbG9hZHMvYWxsL2RvY3VtZW50YXRpb24vY291Y2hiYXNlLWFwaS1kYi5odG1sI2NvdWNoYmFzZS1hcGktZGJfCiAgICAgICAgICogZGItYnVsay1kb2NzX3Bvc3QiPmRvY3MgZm9yIC9kYi9fYnVsa19kb2NzPC9hPgogICAgICAgICAqIEBwYXJhbSB7T2JqZWN0W119IGRvY3MgTGlzdCBvZiBkb2N1bWVudHMgdG8gc2F2ZQogICAgICAgICAqIEBwYXJhbSB7YWpheFNldHRpbmdzfSBvcHRpb25zIDxhIGhyZWY9Imh0dHA6Ly9hcGkuanF1ZXJ5LmNvbS8KICAgICAgICAgKiBqUXVlcnkuYWpheC8jalF1ZXJ5LWFqYXgtc2V0dGluZ3MiPmpRdWVyeSBhamF4IHNldHRpbmdzPC9hPgogICAgICAgICAqLwogICAgICAgIGJ1bGtTYXZlOiBmdW5jdGlvbihkb2NzLCBvcHRpb25zKSB7CiAgICAgICAgICB2YXIgYmVmb3JlU2VuZCA9IGZ1bGxDb21taXQob3B0aW9ucyk7CiAgICAgICAgICAkLmV4dGVuZChvcHRpb25zLCB7c3VjY2Vzc1N0YXR1czogMjAxLCBiZWZvcmVTZW5kIDogYmVmb3JlU2VuZH0pOwogICAgICAgICAgYWpheCh7CiAgICAgICAgICAgICAgdHlwZTogIlBPU1QiLAogICAgICAgICAgICAgIHVybDogdGhpcy51cmkgKyAiX2J1bGtfZG9jcyIgKyBlbmNvZGVPcHRpb25zKG9wdGlvbnMpLAogICAgICAgICAgICAgIGNvbnRlbnRUeXBlOiAiYXBwbGljYXRpb24vanNvbiIsIGRhdGE6IHRvSlNPTihkb2NzKQogICAgICAgICAgICB9LAogICAgICAgICAgICBvcHRpb25zLAogICAgICAgICAgICAiVGhlIGRvY3VtZW50cyBjb3VsZCBub3QgYmUgc2F2ZWQiCiAgICAgICAgICApOwogICAgICAgIH0sCgogICAgICAgIC8qKgogICAgICAgICAqIERlbGV0ZXMgdGhlIHNwZWNpZmllZCBkb2N1bWVudCBmcm9tIHRoZSBkYXRhYmFzZS4gWW91IG11c3Qgc3VwcGx5CiAgICAgICAgICogdGhlIGN1cnJlbnQgKGxhdGVzdCkgcmV2aXNpb24gYW5kIDxjb2RlPmlkPC9jb2RlPiBvZiB0aGUgZG9jdW1lbnQKICAgICAgICAgKiB0byBkZWxldGUgZWcgPGNvZGU+cmVtb3ZlRG9jKHtfaWQ6Im15ZG9jIiwgX3JldjogIjEtMjM0NSJ9KTwvY29kZT4KICAgICAgICAgKiBAc2VlIDxhIGhyZWY9Imh0dHA6Ly90ZWNoem9uZS5jb3VjaGJhc2UuY29tL3NpdGVzL2RlZmF1bHQvZmlsZXMvCiAgICAgICAgICogdXBsb2Fkcy9hbGwvZG9jdW1lbnRhdGlvbi9jb3VjaGJhc2UtYXBpLWRiZG9jLmh0bWwjY291Y2hiYXNlLWFwaQogICAgICAgICAqIC1kYmRvY19kYi1kb2NfZGVsZXRlIj5kb2NzIGZvciBERUxFVEUgL2RiL2RvYzwvYT4KICAgICAgICAgKiBAcGFyYW0ge09iamVjdH0gZG9jIERvY3VtZW50IHRvIGRlbGV0ZQogICAgICAgICAqIEBwYXJhbSB7YWpheFNldHRpbmdzfSBvcHRpb25zIDxhIGhyZWY9Imh0dHA6Ly9hcGkuanF1ZXJ5LmNvbS8KICAgICAgICAgKiBqUXVlcnkuYWpheC8jalF1ZXJ5LWFqYXgtc2V0dGluZ3MiPmpRdWVyeSBhamF4IHNldHRpbmdzPC9hPgogICAgICAgICAqLwogICAgICAgIHJlbW92ZURvYzogZnVuY3Rpb24oZG9jLCBvcHRpb25zKSB7CiAgICAgICAgICBhamF4KHsKICAgICAgICAgICAgICB0eXBlOiAiREVMRVRFIiwKICAgICAgICAgICAgICB1cmw6IHRoaXMudXJpICsKICAgICAgICAgICAgICAgICAgIGVuY29kZURvY0lkKGRvYy5faWQpICsKICAgICAgICAgICAgICAgICAgIGVuY29kZU9wdGlvbnMoe3JldjogZG9jLl9yZXZ9KQogICAgICAgICAgICB9LAogICAgICAgICAgICBvcHRpb25zLAogICAgICAgICAgICAiVGhlIGRvY3VtZW50IGNvdWxkIG5vdCBiZSBkZWxldGVkIgogICAgICAgICAgKTsKICAgICAgICB9LAoKICAgICAgICAvKioKICAgICAgICAgKiBSZW1vdmUgYSBzZXQgb2YgZG9jdW1lbnRzCiAgICAgICAgICogQHNlZSA8YSBocmVmPSJodHRwOi8vdGVjaHpvbmUuY291Y2hiYXNlLmNvbS9zaXRlcy9kZWZhdWx0L2ZpbGVzLwogICAgICAgICAqIHVwbG9hZHMvYWxsL2RvY3VtZW50YXRpb24vY291Y2hiYXNlLWFwaS1kYi5odG1sI2NvdWNoYmFzZS1hcGktZGJfCiAgICAgICAgICogZGItYnVsay1kb2NzX3Bvc3QiPmRvY3MgZm9yIC9kYi9fYnVsa19kb2NzPC9hPgogICAgICAgICAqIEBwYXJhbSB7U3RyaW5nW119IGRvY3MgTGlzdCBvZiBkb2N1bWVudCBpZCdzIHRvIHJlbW92ZQogICAgICAgICAqIEBwYXJhbSB7YWpheFNldHRpbmdzfSBvcHRpb25zIDxhIGhyZWY9Imh0dHA6Ly9hcGkuanF1ZXJ5LmNvbS8KICAgICAgICAgKiBqUXVlcnkuYWpheC8jalF1ZXJ5LWFqYXgtc2V0dGluZ3MiPmpRdWVyeSBhamF4IHNldHRpbmdzPC9hPgogICAgICAgICAqLwogICAgICAgIGJ1bGtSZW1vdmU6IGZ1bmN0aW9uKGRvY3MsIG9wdGlvbnMpewogICAgICAgICAgZG9jcy5kb2NzID0gJC5lYWNoKAogICAgICAgICAgICBkb2NzLmRvY3MsIGZ1bmN0aW9uKGksIGRvYyl7CiAgICAgICAgICAgICAgZG9jLl9kZWxldGVkID0gdHJ1ZTsKICAgICAgICAgICAgfQogICAgICAgICAgKTsKICAgICAgICAgICQuZXh0ZW5kKG9wdGlvbnMsIHtzdWNjZXNzU3RhdHVzOiAyMDF9KTsKICAgICAgICAgIGFqYXgoewogICAgICAgICAgICAgIHR5cGU6ICJQT1NUIiwKICAgICAgICAgICAgICB1cmw6IHRoaXMudXJpICsgIl9idWxrX2RvY3MiICsgZW5jb2RlT3B0aW9ucyhvcHRpb25zKSwKICAgICAgICAgICAgICBkYXRhOiB0b0pTT04oZG9jcykKICAgICAgICAgICAgfSwKICAgICAgICAgICAgb3B0aW9ucywKICAgICAgICAgICAgIlRoZSBkb2N1bWVudHMgY291bGQgbm90IGJlIGRlbGV0ZWQiCiAgICAgICAgICApOwogICAgICAgIH0sCgogICAgICAgIC8qKgogICAgICAgICAqIFRoZSBDT1BZIGNvbW1hbmQgKHdoaWNoIGlzIG5vbi1zdGFuZGFyZCBIVFRQKSBjb3BpZXMgYW4gZXhpc3RpbmcKICAgICAgICAgKiBkb2N1bWVudCB0byBhIG5ldyBvciBleGlzdGluZyBkb2N1bWVudC4KICAgICAgICAgKiBAc2VlIDxhIGhyZWY9Imh0dHA6Ly90ZWNoem9uZS5jb3VjaGJhc2UuY29tL3NpdGVzL2RlZmF1bHQvZmlsZXMvCiAgICAgICAgICogdXBsb2Fkcy9hbGwvZG9jdW1lbnRhdGlvbi9jb3VjaGJhc2UtYXBpLWRiZG9jLmh0bWwjY291Y2hiYXNlLWFwaS0KICAgICAgICAgKiBkYmRvY19kYi1kb2NfY29weSI+ZG9jcyBmb3IgQ09QWSAvZGIvZG9jPC9hPgogICAgICAgICAqIEBwYXJhbSB7U3RyaW5nW119IGRvY0lkIGRvY3VtZW50IGlkIHRvIGNvcHkKICAgICAgICAgKiBAcGFyYW0ge2FqYXhTZXR0aW5nc30gb3B0aW9ucyA8YSBocmVmPSJodHRwOi8vYXBpLmpxdWVyeS5jb20vCiAgICAgICAgICogalF1ZXJ5LmFqYXgvI2pRdWVyeS1hamF4LXNldHRpbmdzIj5qUXVlcnkgYWpheCBzZXR0aW5nczwvYT4KICAgICAgICAgKiBAcGFyYW0ge2FqYXhTZXR0aW5nc30gb3B0aW9ucyA8YSBocmVmPSJodHRwOi8vYXBpLmpxdWVyeS5jb20vCiAgICAgICAgICogalF1ZXJ5LmFqYXgvI2pRdWVyeS1hamF4LXNldHRpbmdzIj5qUXVlcnkgYWpheCBzZXR0aW5nczwvYT4KICAgICAgICAgKi8KICAgICAgICBjb3B5RG9jOiBmdW5jdGlvbihkb2NJZCwgb3B0aW9ucywgYWpheE9wdGlvbnMpIHsKICAgICAgICAgIGFqYXhPcHRpb25zID0gJC5leHRlbmQoYWpheE9wdGlvbnMsIHsKICAgICAgICAgICAgY29tcGxldGU6IGZ1bmN0aW9uKHJlcSkgewogICAgICAgICAgICAgIHZhciByZXNwID0gJC5wYXJzZUpTT04ocmVxLnJlc3BvbnNlVGV4dCk7CiAgICAgICAgICAgICAgaWYgKHJlcS5zdGF0dXMgPT0gMjAxKSB7CiAgICAgICAgICAgICAgICBpZiAob3B0aW9ucy5zdWNjZXNzKSBvcHRpb25zLnN1Y2Nlc3MocmVzcCk7CiAgICAgICAgICAgICAgfSBlbHNlIGlmIChvcHRpb25zLmVycm9yKSB7CiAgICAgICAgICAgICAgICBvcHRpb25zLmVycm9yKHJlcS5zdGF0dXMsIHJlc3AuZXJyb3IsIHJlc3AucmVhc29uKTsKICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgYWxlcnQoIlRoZSBkb2N1bWVudCBjb3VsZCBub3QgYmUgY29waWVkOiAiICsgcmVzcC5yZWFzb24pOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgfSk7CiAgICAgICAgICBhamF4KHsKICAgICAgICAgICAgICB0eXBlOiAiQ09QWSIsCiAgICAgICAgICAgICAgdXJsOiB0aGlzLnVyaSArIGVuY29kZURvY0lkKGRvY0lkKQogICAgICAgICAgICB9LAogICAgICAgICAgICBvcHRpb25zLAogICAgICAgICAgICAiVGhlIGRvY3VtZW50IGNvdWxkIG5vdCBiZSBjb3BpZWQiLAogICAgICAgICAgICBhamF4T3B0aW9ucwogICAgICAgICAgKTsKICAgICAgICB9LAoKICAgICAgICAvKioKICAgICAgICAgKiBDcmVhdGVzIChhbmQgZXhlY3V0ZXMpIGEgdGVtcG9yYXJ5IHZpZXcgYmFzZWQgb24gdGhlIHZpZXcgZnVuY3Rpb24KICAgICAgICAgKiBzdXBwbGllZCBpbiB0aGUgSlNPTiByZXF1ZXN0LgogICAgICAgICAqIEBzZWUgPGEgaHJlZj0iaHR0cDovL3RlY2h6b25lLmNvdWNoYmFzZS5jb20vc2l0ZXMvZGVmYXVsdC9maWxlcy8KICAgICAgICAgKiB1cGxvYWRzL2FsbC9kb2N1bWVudGF0aW9uL2NvdWNoYmFzZS1hcGktZGIuaHRtbCNjb3VjaGJhc2UtYXBpLWRiCiAgICAgICAgICogX2RiLXRlbXAtdmlld19wb3N0Ij5kb2NzIGZvciAvZGIvX3RlbXBfdmlldzwvYT4KICAgICAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBtYXBGdW4gTWFwIGZ1bmN0aW9uCiAgICAgICAgICogQHBhcmFtIHtGdW5jdGlvbn0gcmVkdWNlRnVuIFJlZHVjZSBmdW5jdGlvbgogICAgICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGxhbmd1YWdlIExhbmd1YWdlIHRoZSBtYXAgLyByZWR1Y2UgZnVucyBhcmUKICAgICAgICAgKiBpbXBsZW1lbnRlZCBpbgogICAgICAgICAqIEBwYXJhbSB7YWpheFNldHRpbmdzfSBvcHRpb25zIDxhIGhyZWY9Imh0dHA6Ly9hcGkuanF1ZXJ5LmNvbS8KICAgICAgICAgKiBqUXVlcnkuYWpheC8jalF1ZXJ5LWFqYXgtc2V0dGluZ3MiPmpRdWVyeSBhamF4IHNldHRpbmdzPC9hPgogICAgICAgICAqLwogICAgICAgIHF1ZXJ5OiBmdW5jdGlvbihtYXBGdW4sIHJlZHVjZUZ1biwgbGFuZ3VhZ2UsIG9wdGlvbnMpIHsKICAgICAgICAgIGxhbmd1YWdlID0gbGFuZ3VhZ2UgfHwgImphdmFzY3JpcHQiOwogICAgICAgICAgaWYgKHR5cGVvZihtYXBGdW4pICE9PSAic3RyaW5nIikgewogICAgICAgICAgICBtYXBGdW4gPSBtYXBGdW4udG9Tb3VyY2UgPyBtYXBGdW4udG9Tb3VyY2UoKQogICAgICAgICAgICAgIDogIigiICsgbWFwRnVuLnRvU3RyaW5nKCkgKyAiKSI7CiAgICAgICAgICB9CiAgICAgICAgICB2YXIgYm9keSA9IHtsYW5ndWFnZTogbGFuZ3VhZ2UsIG1hcDogbWFwRnVufTsKICAgICAgICAgIGlmIChyZWR1Y2VGdW4gIT0gbnVsbCkgewogICAgICAgICAgICBpZiAodHlwZW9mKHJlZHVjZUZ1bikgIT09ICJzdHJpbmciKQogICAgICAgICAgICAgIHJlZHVjZUZ1biA9IHJlZHVjZUZ1bi50b1NvdXJjZSA/IHJlZHVjZUZ1bi50b1NvdXJjZSgpCiAgICAgICAgICAgICAgICA6ICIoIiArIHJlZHVjZUZ1bi50b1N0cmluZygpICsgIikiOwogICAgICAgICAgICBib2R5LnJlZHVjZSA9IHJlZHVjZUZ1bjsKICAgICAgICAgIH0KICAgICAgICAgIGFqYXgoewogICAgICAgICAgICAgIHR5cGU6ICJQT1NUIiwKICAgICAgICAgICAgICB1cmw6IHRoaXMudXJpICsgIl90ZW1wX3ZpZXciICsgZW5jb2RlT3B0aW9ucyhvcHRpb25zKSwKICAgICAgICAgICAgICBjb250ZW50VHlwZTogImFwcGxpY2F0aW9uL2pzb24iLCBkYXRhOiB0b0pTT04oYm9keSkKICAgICAgICAgICAgfSwKICAgICAgICAgICAgb3B0aW9ucywKICAgICAgICAgICAgIkFuIGVycm9yIG9jY3VycmVkIHF1ZXJ5aW5nIHRoZSBkYXRhYmFzZSIKICAgICAgICAgICk7CiAgICAgICAgfSwKCiAgICAgICAgLyoqCiAgICAgICAgICogRmV0Y2ggYSBfbGlzdCB2aWV3IG91dHB1dCwgeW91IGNhbiBzcGVjaWZ5IGEgbGlzdCBvZgogICAgICAgICAqIDxjb2RlPmtleXM8L2NvZGU+IGluIHRoZSBvcHRpb25zIG9iamVjdCB0byByZWNpZXZlIG9ubHkgdGhvc2Uga2V5cy4KICAgICAgICAgKiBAc2VlIDxhIGhyZWY9Imh0dHA6Ly90ZWNoem9uZS5jb3VjaGJhc2UuY29tL3NpdGVzL2RlZmF1bHQvZmlsZXMvCiAgICAgICAgICogdXBsb2Fkcy9hbGwvZG9jdW1lbnRhdGlvbi9jb3VjaGJhc2UtYXBpLWRlc2lnbi5odG1sI2NvdWNoYmFzZS1hcGkKICAgICAgICAgKiAtZGVzaWduX2RiLWRlc2lnbi1kZXNpZ25kb2MtbGlzdC1saXN0bmFtZS12aWV3bmFtZV9nZXQiPgogICAgICAgICAqIGRvY3MgZm9yIC9kYi9fZGVzaWduL2Rlc2lnbi1kb2MvX2xpc3QvbDEvdjE8L2E+CiAgICAgICAgICogQHBhcmFtIHtTdHJpbmd9IGxpc3QgTGlzdG5hbWUgaW4gdGhlIGZvcm0gb2YgZGRvYy9saXN0bmFtZQogICAgICAgICAqIEBwYXJhbSB7U3RyaW5nfSB2aWV3IFZpZXcgdG8gcnVuIGxpc3QgYWdhaW5zdAogICAgICAgICAqIEBwYXJhbSB7b3B0aW9uc30gQ291Y2hEQiA8YSBocmVmPSJodHRwOi8vd2lraS5hcGFjaGUub3JnL2NvdWNoZGIvCiAgICAgICAgICogSFRUUF92aWV3X0FQSSI+VmlldyBPcHRpb25zPC9hPgogICAgICAgICAqIEBwYXJhbSB7YWpheFNldHRpbmdzfSBvcHRpb25zIDxhIGhyZWY9Imh0dHA6Ly9hcGkuanF1ZXJ5LmNvbS8KICAgICAgICAgKiBqUXVlcnkuYWpheC8jalF1ZXJ5LWFqYXgtc2V0dGluZ3MiPmpRdWVyeSBhamF4IHNldHRpbmdzPC9hPgogICAgICAgICAqLwogICAgICAgIGxpc3Q6IGZ1bmN0aW9uKGxpc3QsIHZpZXcsIG9wdGlvbnMsIGFqYXhPcHRpb25zKSB7CiAgICAgICAgICB2YXIgbGlzdCA9IGxpc3Quc3BsaXQoJy8nKTsKICAgICAgICAgIHZhciBvcHRpb25zID0gb3B0aW9ucyB8fCB7fTsKICAgICAgICAgIHZhciB0eXBlID0gJ0dFVCc7CiAgICAgICAgICB2YXIgZGF0YSA9IG51bGw7CiAgICAgICAgICBpZiAob3B0aW9uc1sna2V5cyddKSB7CiAgICAgICAgICAgIHR5cGUgPSAnUE9TVCc7CiAgICAgICAgICAgIHZhciBrZXlzID0gb3B0aW9uc1sna2V5cyddOwogICAgICAgICAgICBkZWxldGUgb3B0aW9uc1sna2V5cyddOwogICAgICAgICAgICBkYXRhID0gdG9KU09OKHsna2V5cyc6IGtleXMgfSk7CiAgICAgICAgICB9CiAgICAgICAgICBhamF4KHsKICAgICAgICAgICAgICB0eXBlOiB0eXBlLAogICAgICAgICAgICAgIGRhdGE6IGRhdGEsCiAgICAgICAgICAgICAgdXJsOiB0aGlzLnVyaSArICdfZGVzaWduLycgKyBsaXN0WzBdICsKICAgICAgICAgICAgICAgICAgICcvX2xpc3QvJyArIGxpc3RbMV0gKyAnLycgKyB2aWV3ICsgZW5jb2RlT3B0aW9ucyhvcHRpb25zKQogICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgYWpheE9wdGlvbnMsICdBbiBlcnJvciBvY2N1cmVkIGFjY2Vzc2luZyB0aGUgbGlzdCcKICAgICAgICAgICk7CiAgICAgICAgfSwKCiAgICAgICAgLyoqCiAgICAgICAgICogRXhlY3V0ZXMgdGhlIHNwZWNpZmllZCB2aWV3LW5hbWUgZnJvbSB0aGUgc3BlY2lmaWVkIGRlc2lnbi1kb2MKICAgICAgICAgKiBkZXNpZ24gZG9jdW1lbnQsIHlvdSBjYW4gc3BlY2lmeSBhIGxpc3Qgb2YgPGNvZGU+a2V5czwvY29kZT4KICAgICAgICAgKiBpbiB0aGUgb3B0aW9ucyBvYmplY3QgdG8gcmVjaWV2ZSBvbmx5IHRob3NlIGtleXMuCiAgICAgICAgICogQHNlZSA8YSBocmVmPSJodHRwOi8vdGVjaHpvbmUuY291Y2hiYXNlLmNvbS9zaXRlcy9kZWZhdWx0L2ZpbGVzLwogICAgICAgICAqIHVwbG9hZHMvYWxsL2RvY3VtZW50YXRpb24vY291Y2hiYXNlLWFwaS1kZXNpZ24uaHRtbCNjb3VjaGJhc2UtYXBpLQogICAgICAgICAqIGRlc2lnbl9kYi1kZXNpZ24tZGVzaWduZG9jLXZpZXctdmlld25hbWVfZ2V0Ij5kb2NzIGZvciAvZGIvCiAgICAgICAgICogX2Rlc2lnbi9kZXNpZ24tZG9jL19saXN0L2wxL3YxPC9hPgogICAgICAgICAqIEBwYXJhbSB7U3RyaW5nfSBuYW1lIFZpZXcgdG8gcnVuIGxpc3QgYWdhaW5zdAogICAgICAgICAqIEBwYXJhbSB7YWpheFNldHRpbmdzfSBvcHRpb25zIDxhIGhyZWY9Imh0dHA6Ly9hcGkuanF1ZXJ5LmNvbS8KICAgICAgICAgKiBqUXVlcnkuYWpheC8jalF1ZXJ5LWFqYXgtc2V0dGluZ3MiPmpRdWVyeSBhamF4IHNldHRpbmdzPC9hPgogICAgICAgICAqLwogICAgICAgIHZpZXc6IGZ1bmN0aW9uKG5hbWUsIG9wdGlvbnMpIHsKICAgICAgICAgIHZhciBuYW1lID0gbmFtZS5zcGxpdCgnLycpOwogICAgICAgICAgdmFyIG9wdGlvbnMgPSBvcHRpb25zIHx8IHt9OwogICAgICAgICAgdmFyIHR5cGUgPSAiR0VUIjsKICAgICAgICAgIHZhciBkYXRhPSBudWxsOwogICAgICAgICAgaWYgKG9wdGlvbnNbImtleXMiXSkgewogICAgICAgICAgICB0eXBlID0gIlBPU1QiOwogICAgICAgICAgICB2YXIga2V5cyA9IG9wdGlvbnNbImtleXMiXTsKICAgICAgICAgICAgZGVsZXRlIG9wdGlvbnNbImtleXMiXTsKICAgICAgICAgICAgZGF0YSA9IHRvSlNPTih7ICJrZXlzIjoga2V5cyB9KTsKICAgICAgICAgIH0KICAgICAgICAgIGFqYXgoewogICAgICAgICAgICAgIHR5cGU6IHR5cGUsCiAgICAgICAgICAgICAgZGF0YTogZGF0YSwKICAgICAgICAgICAgICB1cmw6IHRoaXMudXJpICsgIl9kZXNpZ24vIiArIG5hbWVbMF0gKwogICAgICAgICAgICAgICAgICAgIi9fdmlldy8iICsgbmFtZVsxXSArIGVuY29kZU9wdGlvbnMob3B0aW9ucykKICAgICAgICAgICAgfSwKICAgICAgICAgICAgb3B0aW9ucywgIkFuIGVycm9yIG9jY3VycmVkIGFjY2Vzc2luZyB0aGUgdmlldyIKICAgICAgICAgICk7CiAgICAgICAgfSwKCiAgICAgICAgLyoqCiAgICAgICAgICogRmV0Y2ggYW4gYXJiaXRyYXJ5IENvdWNoREIgZGF0YWJhc2UgcHJvcGVydHkKICAgICAgICAgKiBAc2VlIDxhIGhyZWY9Imh0dHA6Ly90ZWNoem9uZS5jb3VjaGJhc2UuY29tL3NpdGVzL2RlZmF1bHQvZmlsZXMvCiAgICAgICAgICogdXBsb2Fkcy9hbGwvZG9jdW1lbnRhdGlvbi9jb3VjaGJhc2UtYXBpLmh0bWwiPmRvY3MgZm9yIC9kYi9fcHJvcDwvYT4KICAgICAgICAgKiBAcGFyYW0ge1N0cmluZ30gcHJvcE5hbWUgUHJvcGVyeSBuYW1lIHRvIGZldGNoCiAgICAgICAgICogQHBhcmFtIHthamF4U2V0dGluZ3N9IG9wdGlvbnMgPGEgaHJlZj0iaHR0cDovL2FwaS5qcXVlcnkuY29tLwogICAgICAgICAqIGpRdWVyeS5hamF4LyNqUXVlcnktYWpheC1zZXR0aW5ncyI+alF1ZXJ5IGFqYXggc2V0dGluZ3M8L2E+CiAgICAgICAgICogQHBhcmFtIHthamF4U2V0dGluZ3N9IGFqYXhPcHRpb25zIDxhIGhyZWY9Imh0dHA6Ly9hcGkuanF1ZXJ5LmNvbS8KICAgICAgICAgKiBqUXVlcnkuYWpheC8jalF1ZXJ5LWFqYXgtc2V0dGluZ3MiPmpRdWVyeSBhamF4IHNldHRpbmdzPC9hPgogICAgICAgICAqLwogICAgICAgIGdldERiUHJvcGVydHk6IGZ1bmN0aW9uKHByb3BOYW1lLCBvcHRpb25zLCBhamF4T3B0aW9ucykgewogICAgICAgICAgYWpheCh7dXJsOiB0aGlzLnVyaSArIHByb3BOYW1lICsgZW5jb2RlT3B0aW9ucyhvcHRpb25zKX0sCiAgICAgICAgICAgIG9wdGlvbnMsCiAgICAgICAgICAgICJUaGUgcHJvcGVydHkgY291bGQgbm90IGJlIHJldHJpZXZlZCIsCiAgICAgICAgICAgIGFqYXhPcHRpb25zCiAgICAgICAgICApOwogICAgICAgIH0sCgogICAgICAgIC8qKgogICAgICAgICAqIFNldCBhbiBhcmJpdHJhcnkgQ291Y2hEQiBkYXRhYmFzZSBwcm9wZXJ0eQogICAgICAgICAqIEBzZWUgPGEgaHJlZj0iaHR0cDovL3RlY2h6b25lLmNvdWNoYmFzZS5jb20vc2l0ZXMvZGVmYXVsdC9maWxlcy8KICAgICAgICAgKiB1cGxvYWRzL2FsbC9kb2N1bWVudGF0aW9uL2NvdWNoYmFzZS1hcGkuaHRtbCI+ZG9jcyBmb3IgL2RiL19wcm9wPC9hPgogICAgICAgICAqIEBwYXJhbSB7U3RyaW5nfSBwcm9wTmFtZSBQcm9wZXJ5IG5hbWUgdG8gZmV0Y2gKICAgICAgICAgKiBAcGFyYW0ge1N0cmluZ30gcHJvcFZhbHVlIFByb3BlcnkgdmFsdWUgdG8gc2V0CiAgICAgICAgICogQHBhcmFtIHthamF4U2V0dGluZ3N9IG9wdGlvbnMgPGEgaHJlZj0iaHR0cDovL2FwaS5qcXVlcnkuY29tLwogICAgICAgICAqIGpRdWVyeS5hamF4LyNqUXVlcnktYWpheC1zZXR0aW5ncyI+alF1ZXJ5IGFqYXggc2V0dGluZ3M8L2E+CiAgICAgICAgICogQHBhcmFtIHthamF4U2V0dGluZ3N9IGFqYXhPcHRpb25zIDxhIGhyZWY9Imh0dHA6Ly9hcGkuanF1ZXJ5LmNvbS8KICAgICAgICAgKiBqUXVlcnkuYWpheC8jalF1ZXJ5LWFqYXgtc2V0dGluZ3MiPmpRdWVyeSBhamF4IHNldHRpbmdzPC9hPgogICAgICAgICAqLwogICAgICAgIHNldERiUHJvcGVydHk6IGZ1bmN0aW9uKHByb3BOYW1lLCBwcm9wVmFsdWUsIG9wdGlvbnMsIGFqYXhPcHRpb25zKSB7CiAgICAgICAgICBhamF4KHsKICAgICAgICAgICAgdHlwZTogIlBVVCIsIAogICAgICAgICAgICB1cmw6IHRoaXMudXJpICsgcHJvcE5hbWUgKyBlbmNvZGVPcHRpb25zKG9wdGlvbnMpLAogICAgICAgICAgICBkYXRhIDogSlNPTi5zdHJpbmdpZnkocHJvcFZhbHVlKQogICAgICAgICAgfSwKICAgICAgICAgICAgb3B0aW9ucywKICAgICAgICAgICAgIlRoZSBwcm9wZXJ0eSBjb3VsZCBub3QgYmUgdXBkYXRlZCIsCiAgICAgICAgICAgIGFqYXhPcHRpb25zCiAgICAgICAgICApOwogICAgICAgIH0KICAgICAgfTsKICAgIH0sCgogICAgZW5jb2RlRG9jSWQ6IGVuY29kZURvY0lkLCAKCiAgICAvKioKICAgICAqIEFjY2Vzc2luZyB0aGUgcm9vdCBvZiBhIENvdWNoREIgaW5zdGFuY2UgcmV0dXJucyBtZXRhIGluZm9ybWF0aW9uIGFib3V0CiAgICAgKiB0aGUgaW5zdGFuY2UuIFRoZSByZXNwb25zZSBpcyBhIEpTT04gc3RydWN0dXJlIGNvbnRhaW5pbmcgaW5mb3JtYXRpb24KICAgICAqIGFib3V0IHRoZSBzZXJ2ZXIsIGluY2x1ZGluZyBhIHdlbGNvbWUgbWVzc2FnZSBhbmQgdGhlIHZlcnNpb24gb2YgdGhlCiAgICAgKiBzZXJ2ZXIuCiAgICAgKiBAc2VlIDxhIGhyZWY9Imh0dHA6Ly90ZWNoem9uZS5jb3VjaGJhc2UuY29tL3NpdGVzL2RlZmF1bHQvZmlsZXMvdXBsb2Fkcy8KICAgICAqIGFsbC9kb2N1bWVudGF0aW9uL2NvdWNoYmFzZS1hcGktbWlzYy5odG1sI2NvdWNoYmFzZS1hcGktbWlzY19yb290X2dldCI+CiAgICAgKiBkb2NzIGZvciBHRVQgLzwvYT4KICAgICAqIEBwYXJhbSB7YWpheFNldHRpbmdzfSBvcHRpb25zIDxhIGhyZWY9Imh0dHA6Ly9hcGkuanF1ZXJ5LmNvbS8KICAgICAqIGpRdWVyeS5hamF4LyNqUXVlcnktYWpheC1zZXR0aW5ncyI+alF1ZXJ5IGFqYXggc2V0dGluZ3M8L2E+CiAgICAgKi8KICAgIGluZm86IGZ1bmN0aW9uKG9wdGlvbnMpIHsKICAgICAgYWpheCgKICAgICAgICB7dXJsOiB0aGlzLnVybFByZWZpeCArICIvIn0sCiAgICAgICAgb3B0aW9ucywKICAgICAgICAiU2VydmVyIGluZm9ybWF0aW9uIGNvdWxkIG5vdCBiZSByZXRyaWV2ZWQiCiAgICAgICk7CiAgICB9LAoKICAgIC8qKgogICAgICogUmVxdWVzdCwgY29uZmlndXJlLCBvciBzdG9wLCBhIHJlcGxpY2F0aW9uIG9wZXJhdGlvbi4KICAgICAqIEBzZWUgPGEgaHJlZj0iaHR0cDovL3RlY2h6b25lLmNvdWNoYmFzZS5jb20vc2l0ZXMvZGVmYXVsdC9maWxlcy8KICAgICAqIHVwbG9hZHMvYWxsL2RvY3VtZW50YXRpb24vY291Y2hiYXNlLWFwaS1taXNjLmh0bWwjY291Y2hiYXNlLWFwaS0KICAgICAqIG1pc2NfcmVwbGljYXRlX3Bvc3QiPmRvY3MgZm9yIFBPU1QgL19yZXBsaWNhdGU8L2E+CiAgICAgKiBAcGFyYW0ge1N0cmluZ30gc291cmNlIFBhdGggb3IgdXJsIHRvIHNvdXJjZSBkYXRhYmFzZQogICAgICogQHBhcmFtIHtTdHJpbmd9IHRhcmdldCBQYXRoIG9yIHVybCB0byB0YXJnZXQgZGF0YWJhc2UKICAgICAqIEBwYXJhbSB7YWpheFNldHRpbmdzfSBhamF4T3B0aW9ucyA8YSBocmVmPSJodHRwOi8vYXBpLmpxdWVyeS5jb20vCiAgICAgKiBqUXVlcnkuYWpheC8jalF1ZXJ5LWFqYXgtc2V0dGluZ3MiPmpRdWVyeSBhamF4IHNldHRpbmdzPC9hPgogICAgICogQHBhcmFtIHtPYmplY3R9IHJlcE9wdHMgQWRkaXRpb25hbCByZXBsaWNhdGlvbiBvcHRpb25zCiAgICAgKi8KICAgIHJlcGxpY2F0ZTogZnVuY3Rpb24oc291cmNlLCB0YXJnZXQsIGFqYXhPcHRpb25zLCByZXBPcHRzKSB7CiAgICAgIHJlcE9wdHMgPSAkLmV4dGVuZCh7c291cmNlOiBzb3VyY2UsIHRhcmdldDogdGFyZ2V0fSwgcmVwT3B0cyk7CiAgICAgIGlmIChyZXBPcHRzLmNvbnRpbnVvdXMgJiYgIXJlcE9wdHMuY2FuY2VsKSB7CiAgICAgICAgYWpheE9wdGlvbnMuc3VjY2Vzc1N0YXR1cyA9IDIwMjsKICAgICAgfQogICAgICBhamF4KHsKICAgICAgICAgIHR5cGU6ICJQT1NUIiwgdXJsOiB0aGlzLnVybFByZWZpeCArICIvX3JlcGxpY2F0ZSIsCiAgICAgICAgICBkYXRhOiBKU09OLnN0cmluZ2lmeShyZXBPcHRzKSwKICAgICAgICAgIGNvbnRlbnRUeXBlOiAiYXBwbGljYXRpb24vanNvbiIKICAgICAgICB9LAogICAgICAgIGFqYXhPcHRpb25zLAogICAgICAgICJSZXBsaWNhdGlvbiBmYWlsZWQiCiAgICAgICk7CiAgICB9LAoKICAgIC8qKgogICAgICogRmV0Y2ggYSBuZXcgVVVJRAogICAgICogQHNlZSA8YSBocmVmPSJodHRwOi8vdGVjaHpvbmUuY291Y2hiYXNlLmNvbS9zaXRlcy9kZWZhdWx0L2ZpbGVzLwogICAgICogdXBsb2Fkcy9hbGwvZG9jdW1lbnRhdGlvbi9jb3VjaGJhc2UtYXBpLW1pc2MuaHRtbCNjb3VjaGJhc2UtYXBpLQogICAgICogbWlzY191dWlkc19nZXQiPmRvY3MgZm9yIC9fdXVpZHM8L2E+CiAgICAgKiBAcGFyYW0ge0ludH0gY2FjaGVOdW0gTnVtYmVyIG9mIHV1aWRzIHRvIGtlZXAgY2FjaGVkIGZvciBmdXR1cmUgdXNlCiAgICAgKi8KICAgIG5ld1VVSUQ6IGZ1bmN0aW9uKGNhY2hlTnVtKSB7CiAgICAgIGlmIChjYWNoZU51bSA9PT0gdW5kZWZpbmVkKSB7CiAgICAgICAgY2FjaGVOdW0gPSAxOwogICAgICB9CiAgICAgIGlmICghdXVpZENhY2hlLmxlbmd0aCkgewogICAgICAgIGFqYXgoe3VybDogdGhpcy51cmxQcmVmaXggKyAiL191dWlkcyIsIGRhdGE6IHtjb3VudDogY2FjaGVOdW19LCBhc3luYzoKICAgICAgICAgICAgICBmYWxzZX0sIHsKICAgICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24ocmVzcCkgewogICAgICAgICAgICAgIHV1aWRDYWNoZSA9IHJlc3AudXVpZHM7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0sCiAgICAgICAgICAiRmFpbGVkIHRvIHJldHJpZXZlIFVVSUQgYmF0Y2guIgogICAgICAgICk7CiAgICAgIH0KICAgICAgcmV0dXJuIHV1aWRDYWNoZS5zaGlmdCgpOwogICAgfQogIH0pOwoKICAvKioKICAgKiBAcHJpdmF0ZQogICAqLwogIGZ1bmN0aW9uIGFqYXgob2JqLCBvcHRpb25zLCBlcnJvck1lc3NhZ2UsIGFqYXhPcHRpb25zKSB7CgogICAgdmFyIGRlZmF1bHRBamF4T3B0cyA9IHsKICAgICAgY29udGVudFR5cGU6ICJhcHBsaWNhdGlvbi9qc29uIiwKICAgICAgaGVhZGVyczp7IkFjY2VwdCI6ICJhcHBsaWNhdGlvbi9qc29uIn0KICAgIH07CgogICAgb3B0aW9ucyA9ICQuZXh0ZW5kKHtzdWNjZXNzU3RhdHVzOiAyMDB9LCBvcHRpb25zKTsKICAgIGFqYXhPcHRpb25zID0gJC5leHRlbmQoZGVmYXVsdEFqYXhPcHRzLCBhamF4T3B0aW9ucyk7CiAgICBlcnJvck1lc3NhZ2UgPSBlcnJvck1lc3NhZ2UgfHwgIlVua25vd24gZXJyb3IiOwogICAgJC5hamF4KCQuZXh0ZW5kKCQuZXh0ZW5kKHsKICAgICAgdHlwZTogIkdFVCIsIGRhdGFUeXBlOiAianNvbiIsIGNhY2hlIDogISQuYnJvd3Nlci5tc2llLAogICAgICBiZWZvcmVTZW5kOiBmdW5jdGlvbih4aHIpewogICAgICAgIGlmKGFqYXhPcHRpb25zICYmIGFqYXhPcHRpb25zLmhlYWRlcnMpewogICAgICAgICAgZm9yICh2YXIgaGVhZGVyIGluIGFqYXhPcHRpb25zLmhlYWRlcnMpewogICAgICAgICAgICB4aHIuc2V0UmVxdWVzdEhlYWRlcihoZWFkZXIsIGFqYXhPcHRpb25zLmhlYWRlcnNbaGVhZGVyXSk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9LAogICAgICBjb21wbGV0ZTogZnVuY3Rpb24ocmVxKSB7CiAgICAgICAgdHJ5IHsKICAgICAgICAgIHZhciByZXNwID0gJC5wYXJzZUpTT04ocmVxLnJlc3BvbnNlVGV4dCk7CiAgICAgICAgfSBjYXRjaChlKSB7CiAgICAgICAgICBpZiAob3B0aW9ucy5lcnJvcikgewogICAgICAgICAgICBvcHRpb25zLmVycm9yKHJlcS5zdGF0dXMsIHJlcSwgZSk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBhbGVydChlcnJvck1lc3NhZ2UgKyAiOiAiICsgZSk7CiAgICAgICAgICB9CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIGlmIChvcHRpb25zLmFqYXhTdGFydCkgewogICAgICAgICAgb3B0aW9ucy5hamF4U3RhcnQocmVzcCk7CiAgICAgICAgfQogICAgICAgIGlmIChyZXEuc3RhdHVzID09IG9wdGlvbnMuc3VjY2Vzc1N0YXR1cykgewogICAgICAgICAgaWYgKG9wdGlvbnMuYmVmb3JlU3VjY2Vzcykgb3B0aW9ucy5iZWZvcmVTdWNjZXNzKHJlcSwgcmVzcCk7CiAgICAgICAgICBpZiAob3B0aW9ucy5zdWNjZXNzKSBvcHRpb25zLnN1Y2Nlc3MocmVzcCk7CiAgICAgICAgfSBlbHNlIGlmIChvcHRpb25zLmVycm9yKSB7CiAgICAgICAgICBvcHRpb25zLmVycm9yKHJlcS5zdGF0dXMsIHJlc3AgJiYgcmVzcC5lcnJvciB8fAogICAgICAgICAgICAgICAgICAgICAgICBlcnJvck1lc3NhZ2UsIHJlc3AgJiYgcmVzcC5yZWFzb24gfHwgIm5vIHJlc3BvbnNlIik7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGFsZXJ0KGVycm9yTWVzc2FnZSArICI6ICIgKyByZXNwLnJlYXNvbik7CiAgICAgICAgfQogICAgICB9CiAgICB9LCBvYmopLCBhamF4T3B0aW9ucykpOwogIH0KCiAgLyoqCiAgICogQHByaXZhdGUKICAgKi8KICBmdW5jdGlvbiBmdWxsQ29tbWl0KG9wdGlvbnMpIHsKICAgIHZhciBvcHRpb25zID0gb3B0aW9ucyB8fCB7fTsKICAgIGlmICh0eXBlb2Ygb3B0aW9ucy5lbnN1cmVfZnVsbF9jb21taXQgIT09ICJ1bmRlZmluZWQiKSB7CiAgICAgIHZhciBjb21taXQgPSBvcHRpb25zLmVuc3VyZV9mdWxsX2NvbW1pdDsKICAgICAgZGVsZXRlIG9wdGlvbnMuZW5zdXJlX2Z1bGxfY29tbWl0OwogICAgICByZXR1cm4gZnVuY3Rpb24oeGhyKSB7CiAgICAgICAgeGhyLnNldFJlcXVlc3RIZWFkZXIoJ0FjY2VwdCcsICdhcHBsaWNhdGlvbi9qc29uJyk7CiAgICAgICAgeGhyLnNldFJlcXVlc3RIZWFkZXIoIlgtQ291Y2gtRnVsbC1Db21taXQiLCBjb21taXQudG9TdHJpbmcoKSk7CiAgICAgIH07CiAgICB9CiAgfTsKCiAgLyoqCiAgICogQHByaXZhdGUKICAgKi8KICAvLyBDb252ZXJ0IGEgb3B0aW9ucyBvYmplY3QgdG8gYW4gdXJsIHF1ZXJ5IHN0cmluZy4KICAvLyBleDoge2tleTondmFsdWUnLGtleTI6J3ZhbHVlMid9IGJlY29tZXMgJz9rZXk9InZhbHVlIiZrZXkyPSJ2YWx1ZTIiJwogIGZ1bmN0aW9uIGVuY29kZU9wdGlvbnMob3B0aW9ucykgewogICAgdmFyIGJ1ZiA9IFtdOwogICAgaWYgKHR5cGVvZihvcHRpb25zKSA9PT0gIm9iamVjdCIgJiYgb3B0aW9ucyAhPT0gbnVsbCkgewogICAgICBmb3IgKHZhciBuYW1lIGluIG9wdGlvbnMpIHsKICAgICAgICBpZiAoJC5pbkFycmF5KG5hbWUsCiAgICAgICAgICAgICAgICAgICAgICBbImVycm9yIiwgInN1Y2Nlc3MiLCAiYmVmb3JlU3VjY2VzcyIsICJhamF4U3RhcnQiXSkgPj0gMCkKICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgIHZhciB2YWx1ZSA9IG9wdGlvbnNbbmFtZV07CiAgICAgICAgaWYgKCQuaW5BcnJheShuYW1lLCBbImtleSIsICJzdGFydGtleSIsICJlbmRrZXkiXSkgPj0gMCkgewogICAgICAgICAgdmFsdWUgPSB0b0pTT04odmFsdWUpOwogICAgICAgIH0KICAgICAgICBidWYucHVzaChlbmNvZGVVUklDb21wb25lbnQobmFtZSkgKyAiPSIgKyBlbmNvZGVVUklDb21wb25lbnQodmFsdWUpKTsKICAgICAgfQogICAgfQogICAgcmV0dXJuIGJ1Zi5sZW5ndGggPyAiPyIgKyBidWYuam9pbigiJiIpIDogIiI7CiAgfQoKICAvKioKICAgKiBAcHJpdmF0ZQogICAqLwogIGZ1bmN0aW9uIHRvSlNPTihvYmopIHsKICAgIHJldHVybiBvYmogIT09IG51bGwgPyBKU09OLnN0cmluZ2lmeShvYmopIDogbnVsbDsKICB9Cgp9KShqUXVlcnkpOwo=","content_type":"application/javascript","revpos":42},"js/jquery-1.6.1.min.js":{"data":"LyohCiAqIGpRdWVyeSBKYXZhU2NyaXB0IExpYnJhcnkgdjEuNi4xCiAqIGh0dHA6Ly9qcXVlcnkuY29tLwogKgogKiBDb3B5cmlnaHQgMjAxMSwgSm9obiBSZXNpZwogKiBEdWFsIGxpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgb3IgR1BMIFZlcnNpb24gMiBsaWNlbnNlcy4KICogaHR0cDovL2pxdWVyeS5vcmcvbGljZW5zZQogKgogKiBJbmNsdWRlcyBTaXp6bGUuanMKICogaHR0cDovL3NpenpsZWpzLmNvbS8KICogQ29weXJpZ2h0IDIwMTEsIFRoZSBEb2pvIEZvdW5kYXRpb24KICogUmVsZWFzZWQgdW5kZXIgdGhlIE1JVCwgQlNELCBhbmQgR1BMIExpY2Vuc2VzLgogKgogKiBEYXRlOiBUaHUgTWF5IDEyIDE1OjA0OjM2IDIwMTEgLTA0MDAKICovCihmdW5jdGlvbihhLGIpe2Z1bmN0aW9uIGN5KGEpe3JldHVybiBmLmlzV2luZG93KGEpP2E6YS5ub2RlVHlwZT09PTk/YS5kZWZhdWx0Vmlld3x8YS5wYXJlbnRXaW5kb3c6ITF9ZnVuY3Rpb24gY3YoYSl7aWYoIWNqW2FdKXt2YXIgYj1mKCI8IithKyI+IikuYXBwZW5kVG8oImJvZHkiKSxkPWIuY3NzKCJkaXNwbGF5Iik7Yi5yZW1vdmUoKTtpZihkPT09Im5vbmUifHxkPT09IiIpe2NrfHwoY2s9Yy5jcmVhdGVFbGVtZW50KCJpZnJhbWUiKSxjay5mcmFtZUJvcmRlcj1jay53aWR0aD1jay5oZWlnaHQ9MCksYy5ib2R5LmFwcGVuZENoaWxkKGNrKTtpZighY2x8fCFjay5jcmVhdGVFbGVtZW50KWNsPShjay5jb250ZW50V2luZG93fHxjay5jb250ZW50RG9jdW1lbnQpLmRvY3VtZW50LGNsLndyaXRlKCI8IWRvY3R5cGU+PGh0bWw+PGJvZHk+PC9ib2R5PjwvaHRtbD4iKTtiPWNsLmNyZWF0ZUVsZW1lbnQoYSksY2wuYm9keS5hcHBlbmRDaGlsZChiKSxkPWYuY3NzKGIsImRpc3BsYXkiKSxjLmJvZHkucmVtb3ZlQ2hpbGQoY2spfWNqW2FdPWR9cmV0dXJuIGNqW2FdfWZ1bmN0aW9uIGN1KGEsYil7dmFyIGM9e307Zi5lYWNoKGNwLmNvbmNhdC5hcHBseShbXSxjcC5zbGljZSgwLGIpKSxmdW5jdGlvbigpe2NbdGhpc109YX0pO3JldHVybiBjfWZ1bmN0aW9uIGN0KCl7Y3E9Yn1mdW5jdGlvbiBjcygpe3NldFRpbWVvdXQoY3QsMCk7cmV0dXJuIGNxPWYubm93KCl9ZnVuY3Rpb24gY2koKXt0cnl7cmV0dXJuIG5ldyBhLkFjdGl2ZVhPYmplY3QoIk1pY3Jvc29mdC5YTUxIVFRQIil9Y2F0Y2goYil7fX1mdW5jdGlvbiBjaCgpe3RyeXtyZXR1cm4gbmV3IGEuWE1MSHR0cFJlcXVlc3R9Y2F0Y2goYil7fX1mdW5jdGlvbiBjYihhLGMpe2EuZGF0YUZpbHRlciYmKGM9YS5kYXRhRmlsdGVyKGMsYS5kYXRhVHlwZSkpO3ZhciBkPWEuZGF0YVR5cGVzLGU9e30sZyxoLGk9ZC5sZW5ndGgsaixrPWRbMF0sbCxtLG4sbyxwO2ZvcihnPTE7ZzxpO2crKyl7aWYoZz09PTEpZm9yKGggaW4gYS5jb252ZXJ0ZXJzKXR5cGVvZiBoPT0ic3RyaW5nIiYmKGVbaC50b0xvd2VyQ2FzZSgpXT1hLmNvbnZlcnRlcnNbaF0pO2w9ayxrPWRbZ107aWYoaz09PSIqIilrPWw7ZWxzZSBpZihsIT09IioiJiZsIT09ayl7bT1sKyIgIitrLG49ZVttXXx8ZVsiKiAiK2tdO2lmKCFuKXtwPWI7Zm9yKG8gaW4gZSl7aj1vLnNwbGl0KCIgIik7aWYoalswXT09PWx8fGpbMF09PT0iKiIpe3A9ZVtqWzFdKyIgIitrXTtpZihwKXtvPWVbb10sbz09PSEwP249cDpwPT09ITAmJihuPW8pO2JyZWFrfX19fSFuJiYhcCYmZi5lcnJvcigiTm8gY29udmVyc2lvbiBmcm9tICIrbS5yZXBsYWNlKCIgIiwiIHRvICIpKSxuIT09ITAmJihjPW4/bihjKTpwKG8oYykpKX19cmV0dXJuIGN9ZnVuY3Rpb24gY2EoYSxjLGQpe3ZhciBlPWEuY29udGVudHMsZj1hLmRhdGFUeXBlcyxnPWEucmVzcG9uc2VGaWVsZHMsaCxpLGosaztmb3IoaSBpbiBnKWkgaW4gZCYmKGNbZ1tpXV09ZFtpXSk7d2hpbGUoZlswXT09PSIqIilmLnNoaWZ0KCksaD09PWImJihoPWEubWltZVR5cGV8fGMuZ2V0UmVzcG9uc2VIZWFkZXIoImNvbnRlbnQtdHlwZSIpKTtpZihoKWZvcihpIGluIGUpaWYoZVtpXSYmZVtpXS50ZXN0KGgpKXtmLnVuc2hpZnQoaSk7YnJlYWt9aWYoZlswXWluIGQpaj1mWzBdO2Vsc2V7Zm9yKGkgaW4gZCl7aWYoIWZbMF18fGEuY29udmVydGVyc1tpKyIgIitmWzBdXSl7aj1pO2JyZWFrfWt8fChrPWkpfWo9anx8a31pZihqKXtqIT09ZlswXSYmZi51bnNoaWZ0KGopO3JldHVybiBkW2pdfX1mdW5jdGlvbiBiXyhhLGIsYyxkKXtpZihmLmlzQXJyYXkoYikpZi5lYWNoKGIsZnVuY3Rpb24oYixlKXtjfHxiRi50ZXN0KGEpP2QoYSxlKTpiXyhhKyJbIisodHlwZW9mIGU9PSJvYmplY3QifHxmLmlzQXJyYXkoZSk/YjoiIikrIl0iLGUsYyxkKX0pO2Vsc2UgaWYoIWMmJmIhPW51bGwmJnR5cGVvZiBiPT0ib2JqZWN0Iilmb3IodmFyIGUgaW4gYiliXyhhKyJbIitlKyJdIixiW2VdLGMsZCk7ZWxzZSBkKGEsYil9ZnVuY3Rpb24gYiQoYSxjLGQsZSxmLGcpe2Y9Znx8Yy5kYXRhVHlwZXNbMF0sZz1nfHx7fSxnW2ZdPSEwO3ZhciBoPWFbZl0saT0wLGo9aD9oLmxlbmd0aDowLGs9YT09PWJVLGw7Zm9yKDtpPGomJihrfHwhbCk7aSsrKWw9aFtpXShjLGQsZSksdHlwZW9mIGw9PSJzdHJpbmciJiYoIWt8fGdbbF0/bD1iOihjLmRhdGFUeXBlcy51bnNoaWZ0KGwpLGw9YiQoYSxjLGQsZSxsLGcpKSk7KGt8fCFsKSYmIWdbIioiXSYmKGw9YiQoYSxjLGQsZSwiKiIsZykpO3JldHVybiBsfWZ1bmN0aW9uIGJaKGEpe3JldHVybiBmdW5jdGlvbihiLGMpe3R5cGVvZiBiIT0ic3RyaW5nIiYmKGM9YixiPSIqIik7aWYoZi5pc0Z1bmN0aW9uKGMpKXt2YXIgZD1iLnRvTG93ZXJDYXNlKCkuc3BsaXQoYlEpLGU9MCxnPWQubGVuZ3RoLGgsaSxqO2Zvcig7ZTxnO2UrKyloPWRbZV0saj0vXlwrLy50ZXN0KGgpLGomJihoPWguc3Vic3RyKDEpfHwiKiIpLGk9YVtoXT1hW2hdfHxbXSxpW2o/InVuc2hpZnQiOiJwdXNoIl0oYyl9fX1mdW5jdGlvbiBiRChhLGIsYyl7dmFyIGQ9Yj09PSJ3aWR0aCI/Yng6YnksZT1iPT09IndpZHRoIj9hLm9mZnNldFdpZHRoOmEub2Zmc2V0SGVpZ2h0O2lmKGM9PT0iYm9yZGVyIilyZXR1cm4gZTtmLmVhY2goZCxmdW5jdGlvbigpe2N8fChlLT1wYXJzZUZsb2F0KGYuY3NzKGEsInBhZGRpbmciK3RoaXMpKXx8MCksYz09PSJtYXJnaW4iP2UrPXBhcnNlRmxvYXQoZi5jc3MoYSwibWFyZ2luIit0aGlzKSl8fDA6ZS09cGFyc2VGbG9hdChmLmNzcyhhLCJib3JkZXIiK3RoaXMrIldpZHRoIikpfHwwfSk7cmV0dXJuIGV9ZnVuY3Rpb24gYm4oYSxiKXtiLnNyYz9mLmFqYXgoe3VybDpiLnNyYyxhc3luYzohMSxkYXRhVHlwZToic2NyaXB0In0pOmYuZ2xvYmFsRXZhbCgoYi50ZXh0fHxiLnRleHRDb250ZW50fHxiLmlubmVySFRNTHx8IiIpLnJlcGxhY2UoYmYsIi8qJDAqLyIpKSxiLnBhcmVudE5vZGUmJmIucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChiKX1mdW5jdGlvbiBibShhKXtmLm5vZGVOYW1lKGEsImlucHV0Iik/YmwoYSk6YS5nZXRFbGVtZW50c0J5VGFnTmFtZSYmZi5ncmVwKGEuZ2V0RWxlbWVudHNCeVRhZ05hbWUoImlucHV0IiksYmwpfWZ1bmN0aW9uIGJsKGEpe2lmKGEudHlwZT09PSJjaGVja2JveCJ8fGEudHlwZT09PSJyYWRpbyIpYS5kZWZhdWx0Q2hlY2tlZD1hLmNoZWNrZWR9ZnVuY3Rpb24gYmsoYSl7cmV0dXJuImdldEVsZW1lbnRzQnlUYWdOYW1lImluIGE/YS5nZXRFbGVtZW50c0J5VGFnTmFtZSgiKiIpOiJxdWVyeVNlbGVjdG9yQWxsImluIGE/YS5xdWVyeVNlbGVjdG9yQWxsKCIqIik6W119ZnVuY3Rpb24gYmooYSxiKXt2YXIgYztpZihiLm5vZGVUeXBlPT09MSl7Yi5jbGVhckF0dHJpYnV0ZXMmJmIuY2xlYXJBdHRyaWJ1dGVzKCksYi5tZXJnZUF0dHJpYnV0ZXMmJmIubWVyZ2VBdHRyaWJ1dGVzKGEpLGM9Yi5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpO2lmKGM9PT0ib2JqZWN0IiliLm91dGVySFRNTD1hLm91dGVySFRNTDtlbHNlIGlmKGMhPT0iaW5wdXQifHxhLnR5cGUhPT0iY2hlY2tib3giJiZhLnR5cGUhPT0icmFkaW8iKXtpZihjPT09Im9wdGlvbiIpYi5zZWxlY3RlZD1hLmRlZmF1bHRTZWxlY3RlZDtlbHNlIGlmKGM9PT0iaW5wdXQifHxjPT09InRleHRhcmVhIiliLmRlZmF1bHRWYWx1ZT1hLmRlZmF1bHRWYWx1ZX1lbHNlIGEuY2hlY2tlZCYmKGIuZGVmYXVsdENoZWNrZWQ9Yi5jaGVja2VkPWEuY2hlY2tlZCksYi52YWx1ZSE9PWEudmFsdWUmJihiLnZhbHVlPWEudmFsdWUpO2IucmVtb3ZlQXR0cmlidXRlKGYuZXhwYW5kbyl9fWZ1bmN0aW9uIGJpKGEsYil7aWYoYi5ub2RlVHlwZT09PTEmJiEhZi5oYXNEYXRhKGEpKXt2YXIgYz1mLmV4cGFuZG8sZD1mLmRhdGEoYSksZT1mLmRhdGEoYixkKTtpZihkPWRbY10pe3ZhciBnPWQuZXZlbnRzO2U9ZVtjXT1mLmV4dGVuZCh7fSxkKTtpZihnKXtkZWxldGUgZS5oYW5kbGUsZS5ldmVudHM9e307Zm9yKHZhciBoIGluIGcpZm9yKHZhciBpPTAsaj1nW2hdLmxlbmd0aDtpPGo7aSsrKWYuZXZlbnQuYWRkKGIsaCsoZ1toXVtpXS5uYW1lc3BhY2U/Ii4iOiIiKStnW2hdW2ldLm5hbWVzcGFjZSxnW2hdW2ldLGdbaF1baV0uZGF0YSl9fX19ZnVuY3Rpb24gYmgoYSxiKXtyZXR1cm4gZi5ub2RlTmFtZShhLCJ0YWJsZSIpP2EuZ2V0RWxlbWVudHNCeVRhZ05hbWUoInRib2R5IilbMF18fGEuYXBwZW5kQ2hpbGQoYS5vd25lckRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoInRib2R5IikpOmF9ZnVuY3Rpb24gWChhLGIsYyl7Yj1ifHwwO2lmKGYuaXNGdW5jdGlvbihiKSlyZXR1cm4gZi5ncmVwKGEsZnVuY3Rpb24oYSxkKXt2YXIgZT0hIWIuY2FsbChhLGQsYSk7cmV0dXJuIGU9PT1jfSk7aWYoYi5ub2RlVHlwZSlyZXR1cm4gZi5ncmVwKGEsZnVuY3Rpb24oYSxkKXtyZXR1cm4gYT09PWI9PT1jfSk7aWYodHlwZW9mIGI9PSJzdHJpbmciKXt2YXIgZD1mLmdyZXAoYSxmdW5jdGlvbihhKXtyZXR1cm4gYS5ub2RlVHlwZT09PTF9KTtpZihTLnRlc3QoYikpcmV0dXJuIGYuZmlsdGVyKGIsZCwhYyk7Yj1mLmZpbHRlcihiLGQpfXJldHVybiBmLmdyZXAoYSxmdW5jdGlvbihhLGQpe3JldHVybiBmLmluQXJyYXkoYSxiKT49MD09PWN9KX1mdW5jdGlvbiBXKGEpe3JldHVybiFhfHwhYS5wYXJlbnROb2RlfHxhLnBhcmVudE5vZGUubm9kZVR5cGU9PT0xMX1mdW5jdGlvbiBPKGEsYil7cmV0dXJuKGEmJmEhPT0iKiI/YSsiLiI6IiIpK2IucmVwbGFjZShBLCJgIikucmVwbGFjZShCLCImIil9ZnVuY3Rpb24gTihhKXt2YXIgYixjLGQsZSxnLGgsaSxqLGssbCxtLG4sbyxwPVtdLHE9W10scj1mLl9kYXRhKHRoaXMsImV2ZW50cyIpO2lmKCEoYS5saXZlRmlyZWQ9PT10aGlzfHwhcnx8IXIubGl2ZXx8YS50YXJnZXQuZGlzYWJsZWR8fGEuYnV0dG9uJiZhLnR5cGU9PT0iY2xpY2siKSl7YS5uYW1lc3BhY2UmJihuPW5ldyBSZWdFeHAoIihefFxcLikiK2EubmFtZXNwYWNlLnNwbGl0KCIuIikuam9pbigiXFwuKD86LipcXC4pPyIpKyIoXFwufCQpIikpLGEubGl2ZUZpcmVkPXRoaXM7dmFyIHM9ci5saXZlLnNsaWNlKDApO2ZvcihpPTA7aTxzLmxlbmd0aDtpKyspZz1zW2ldLGcub3JpZ1R5cGUucmVwbGFjZSh5LCIiKT09PWEudHlwZT9xLnB1c2goZy5zZWxlY3Rvcik6cy5zcGxpY2UoaS0tLDEpO2U9ZihhLnRhcmdldCkuY2xvc2VzdChxLGEuY3VycmVudFRhcmdldCk7Zm9yKGo9MCxrPWUubGVuZ3RoO2o8aztqKyspe209ZVtqXTtmb3IoaT0wO2k8cy5sZW5ndGg7aSsrKXtnPXNbaV07aWYobS5zZWxlY3Rvcj09PWcuc2VsZWN0b3ImJighbnx8bi50ZXN0KGcubmFtZXNwYWNlKSkmJiFtLmVsZW0uZGlzYWJsZWQpe2g9bS5lbGVtLGQ9bnVsbDtpZihnLnByZVR5cGU9PT0ibW91c2VlbnRlciJ8fGcucHJlVHlwZT09PSJtb3VzZWxlYXZlIilhLnR5cGU9Zy5wcmVUeXBlLGQ9ZihhLnJlbGF0ZWRUYXJnZXQpLmNsb3Nlc3QoZy5zZWxlY3RvcilbMF0sZCYmZi5jb250YWlucyhoLGQpJiYoZD1oKTsoIWR8fGQhPT1oKSYmcC5wdXNoKHtlbGVtOmgsaGFuZGxlT2JqOmcsbGV2ZWw6bS5sZXZlbH0pfX19Zm9yKGo9MCxrPXAubGVuZ3RoO2o8aztqKyspe2U9cFtqXTtpZihjJiZlLmxldmVsPmMpYnJlYWs7YS5jdXJyZW50VGFyZ2V0PWUuZWxlbSxhLmRhdGE9ZS5oYW5kbGVPYmouZGF0YSxhLmhhbmRsZU9iaj1lLmhhbmRsZU9iaixvPWUuaGFuZGxlT2JqLm9yaWdIYW5kbGVyLmFwcGx5KGUuZWxlbSxhcmd1bWVudHMpO2lmKG89PT0hMXx8YS5pc1Byb3BhZ2F0aW9uU3RvcHBlZCgpKXtjPWUubGV2ZWwsbz09PSExJiYoYj0hMSk7aWYoYS5pc0ltbWVkaWF0ZVByb3BhZ2F0aW9uU3RvcHBlZCgpKWJyZWFrfX1yZXR1cm4gYn19ZnVuY3Rpb24gTChhLGMsZCl7dmFyIGU9Zi5leHRlbmQoe30sZFswXSk7ZS50eXBlPWEsZS5vcmlnaW5hbEV2ZW50PXt9LGUubGl2ZUZpcmVkPWIsZi5ldmVudC5oYW5kbGUuY2FsbChjLGUpLGUuaXNEZWZhdWx0UHJldmVudGVkKCkmJmRbMF0ucHJldmVudERlZmF1bHQoKX1mdW5jdGlvbiBGKCl7cmV0dXJuITB9ZnVuY3Rpb24gRSgpe3JldHVybiExfWZ1bmN0aW9uIG0oYSxjLGQpe3ZhciBlPWMrImRlZmVyIixnPWMrInF1ZXVlIixoPWMrIm1hcmsiLGk9Zi5kYXRhKGEsZSxiLCEwKTtpJiYoZD09PSJxdWV1ZSJ8fCFmLmRhdGEoYSxnLGIsITApKSYmKGQ9PT0ibWFyayJ8fCFmLmRhdGEoYSxoLGIsITApKSYmc2V0VGltZW91dChmdW5jdGlvbigpeyFmLmRhdGEoYSxnLGIsITApJiYhZi5kYXRhKGEsaCxiLCEwKSYmKGYucmVtb3ZlRGF0YShhLGUsITApLGkucmVzb2x2ZSgpKX0sMCl9ZnVuY3Rpb24gbChhKXtmb3IodmFyIGIgaW4gYSlpZihiIT09InRvSlNPTiIpcmV0dXJuITE7cmV0dXJuITB9ZnVuY3Rpb24gayhhLGMsZCl7aWYoZD09PWImJmEubm9kZVR5cGU9PT0xKXt2YXIgZT0iZGF0YS0iK2MucmVwbGFjZShqLCIkMS0kMiIpLnRvTG93ZXJDYXNlKCk7ZD1hLmdldEF0dHJpYnV0ZShlKTtpZih0eXBlb2YgZD09InN0cmluZyIpe3RyeXtkPWQ9PT0idHJ1ZSI/ITA6ZD09PSJmYWxzZSI/ITE6ZD09PSJudWxsIj9udWxsOmYuaXNOYU4oZCk/aS50ZXN0KGQpP2YucGFyc2VKU09OKGQpOmQ6cGFyc2VGbG9hdChkKX1jYXRjaChnKXt9Zi5kYXRhKGEsYyxkKX1lbHNlIGQ9Yn1yZXR1cm4gZH12YXIgYz1hLmRvY3VtZW50LGQ9YS5uYXZpZ2F0b3IsZT1hLmxvY2F0aW9uLGY9ZnVuY3Rpb24oKXtmdW5jdGlvbiBIKCl7aWYoIWUuaXNSZWFkeSl7dHJ5e2MuZG9jdW1lbnRFbGVtZW50LmRvU2Nyb2xsKCJsZWZ0Iil9Y2F0Y2goYSl7c2V0VGltZW91dChILDEpO3JldHVybn1lLnJlYWR5KCl9fXZhciBlPWZ1bmN0aW9uKGEsYil7cmV0dXJuIG5ldyBlLmZuLmluaXQoYSxiLGgpfSxmPWEualF1ZXJ5LGc9YS4kLGgsaT0vXig/OltePF0qKDxbXHdcV10rPilbXj5dKiR8IyhbXHdcLV0qKSQpLyxqPS9cUy8saz0vXlxzKy8sbD0vXHMrJC8sbT0vXGQvLG49L148KFx3KylccypcLz8+KD86PFwvXDE+KT8kLyxvPS9eW1xdLDp7fVxzXSokLyxwPS9cXCg/OlsiXFxcL2JmbnJ0XXx1WzAtOWEtZkEtRl17NH0pL2cscT0vIlteIlxcXG5ccl0qInx0cnVlfGZhbHNlfG51bGx8LT9cZCsoPzpcLlxkKik/KD86W2VFXVsrXC1dP1xkKyk/L2cscj0vKD86Xnw6fCwpKD86XHMqXFspKy9nLHM9Lyh3ZWJraXQpWyBcL10oW1x3Ll0rKS8sdD0vKG9wZXJhKSg/Oi4qdmVyc2lvbik/WyBcL10oW1x3Ll0rKS8sdT0vKG1zaWUpIChbXHcuXSspLyx2PS8obW96aWxsYSkoPzouKj8gcnY6KFtcdy5dKykpPy8sdz1kLnVzZXJBZ2VudCx4LHkseixBPU9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcsQj1PYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LEM9QXJyYXkucHJvdG90eXBlLnB1c2gsRD1BcnJheS5wcm90b3R5cGUuc2xpY2UsRT1TdHJpbmcucHJvdG90eXBlLnRyaW0sRj1BcnJheS5wcm90b3R5cGUuaW5kZXhPZixHPXt9O2UuZm49ZS5wcm90b3R5cGU9e2NvbnN0cnVjdG9yOmUsaW5pdDpmdW5jdGlvbihhLGQsZil7dmFyIGcsaCxqLGs7aWYoIWEpcmV0dXJuIHRoaXM7aWYoYS5ub2RlVHlwZSl7dGhpcy5jb250ZXh0PXRoaXNbMF09YSx0aGlzLmxlbmd0aD0xO3JldHVybiB0aGlzfWlmKGE9PT0iYm9keSImJiFkJiZjLmJvZHkpe3RoaXMuY29udGV4dD1jLHRoaXNbMF09Yy5ib2R5LHRoaXMuc2VsZWN0b3I9YSx0aGlzLmxlbmd0aD0xO3JldHVybiB0aGlzfWlmKHR5cGVvZiBhPT0ic3RyaW5nIil7YS5jaGFyQXQoMCkhPT0iPCJ8fGEuY2hhckF0KGEubGVuZ3RoLTEpIT09Ij4ifHxhLmxlbmd0aDwzP2c9aS5leGVjKGEpOmc9W251bGwsYSxudWxsXTtpZihnJiYoZ1sxXXx8IWQpKXtpZihnWzFdKXtkPWQgaW5zdGFuY2VvZiBlP2RbMF06ZCxrPWQ/ZC5vd25lckRvY3VtZW50fHxkOmMsaj1uLmV4ZWMoYSksaj9lLmlzUGxhaW5PYmplY3QoZCk/KGE9W2MuY3JlYXRlRWxlbWVudChqWzFdKV0sZS5mbi5hdHRyLmNhbGwoYSxkLCEwKSk6YT1bay5jcmVhdGVFbGVtZW50KGpbMV0pXTooaj1lLmJ1aWxkRnJhZ21lbnQoW2dbMV1dLFtrXSksYT0oai5jYWNoZWFibGU/ZS5jbG9uZShqLmZyYWdtZW50KTpqLmZyYWdtZW50KS5jaGlsZE5vZGVzKTtyZXR1cm4gZS5tZXJnZSh0aGlzLGEpfWg9Yy5nZXRFbGVtZW50QnlJZChnWzJdKTtpZihoJiZoLnBhcmVudE5vZGUpe2lmKGguaWQhPT1nWzJdKXJldHVybiBmLmZpbmQoYSk7dGhpcy5sZW5ndGg9MSx0aGlzWzBdPWh9dGhpcy5jb250ZXh0PWMsdGhpcy5zZWxlY3Rvcj1hO3JldHVybiB0aGlzfXJldHVybiFkfHxkLmpxdWVyeT8oZHx8ZikuZmluZChhKTp0aGlzLmNvbnN0cnVjdG9yKGQpLmZpbmQoYSl9aWYoZS5pc0Z1bmN0aW9uKGEpKXJldHVybiBmLnJlYWR5KGEpO2Euc2VsZWN0b3IhPT1iJiYodGhpcy5zZWxlY3Rvcj1hLnNlbGVjdG9yLHRoaXMuY29udGV4dD1hLmNvbnRleHQpO3JldHVybiBlLm1ha2VBcnJheShhLHRoaXMpfSxzZWxlY3RvcjoiIixqcXVlcnk6IjEuNi4xIixsZW5ndGg6MCxzaXplOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubGVuZ3RofSx0b0FycmF5OmZ1bmN0aW9uKCl7cmV0dXJuIEQuY2FsbCh0aGlzLDApfSxnZXQ6ZnVuY3Rpb24oYSl7cmV0dXJuIGE9PW51bGw/dGhpcy50b0FycmF5KCk6YTwwP3RoaXNbdGhpcy5sZW5ndGgrYV06dGhpc1thXX0scHVzaFN0YWNrOmZ1bmN0aW9uKGEsYixjKXt2YXIgZD10aGlzLmNvbnN0cnVjdG9yKCk7ZS5pc0FycmF5KGEpP0MuYXBwbHkoZCxhKTplLm1lcmdlKGQsYSksZC5wcmV2T2JqZWN0PXRoaXMsZC5jb250ZXh0PXRoaXMuY29udGV4dCxiPT09ImZpbmQiP2Quc2VsZWN0b3I9dGhpcy5zZWxlY3RvcisodGhpcy5zZWxlY3Rvcj8iICI6IiIpK2M6YiYmKGQuc2VsZWN0b3I9dGhpcy5zZWxlY3RvcisiLiIrYisiKCIrYysiKSIpO3JldHVybiBkfSxlYWNoOmZ1bmN0aW9uKGEsYil7cmV0dXJuIGUuZWFjaCh0aGlzLGEsYil9LHJlYWR5OmZ1bmN0aW9uKGEpe2UuYmluZFJlYWR5KCkseS5kb25lKGEpO3JldHVybiB0aGlzfSxlcTpmdW5jdGlvbihhKXtyZXR1cm4gYT09PS0xP3RoaXMuc2xpY2UoYSk6dGhpcy5zbGljZShhLCthKzEpfSxmaXJzdDpmdW5jdGlvbigpe3JldHVybiB0aGlzLmVxKDApfSxsYXN0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZXEoLTEpfSxzbGljZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLnB1c2hTdGFjayhELmFwcGx5KHRoaXMsYXJndW1lbnRzKSwic2xpY2UiLEQuY2FsbChhcmd1bWVudHMpLmpvaW4oIiwiKSl9LG1hcDpmdW5jdGlvbihhKXtyZXR1cm4gdGhpcy5wdXNoU3RhY2soZS5tYXAodGhpcyxmdW5jdGlvbihiLGMpe3JldHVybiBhLmNhbGwoYixjLGIpfSkpfSxlbmQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5wcmV2T2JqZWN0fHx0aGlzLmNvbnN0cnVjdG9yKG51bGwpfSxwdXNoOkMsc29ydDpbXS5zb3J0LHNwbGljZTpbXS5zcGxpY2V9LGUuZm4uaW5pdC5wcm90b3R5cGU9ZS5mbixlLmV4dGVuZD1lLmZuLmV4dGVuZD1mdW5jdGlvbigpe3ZhciBhLGMsZCxmLGcsaCxpPWFyZ3VtZW50c1swXXx8e30saj0xLGs9YXJndW1lbnRzLmxlbmd0aCxsPSExO3R5cGVvZiBpPT0iYm9vbGVhbiImJihsPWksaT1hcmd1bWVudHNbMV18fHt9LGo9MiksdHlwZW9mIGkhPSJvYmplY3QiJiYhZS5pc0Z1bmN0aW9uKGkpJiYoaT17fSksaz09PWomJihpPXRoaXMsLS1qKTtmb3IoO2o8aztqKyspaWYoKGE9YXJndW1lbnRzW2pdKSE9bnVsbClmb3IoYyBpbiBhKXtkPWlbY10sZj1hW2NdO2lmKGk9PT1mKWNvbnRpbnVlO2wmJmYmJihlLmlzUGxhaW5PYmplY3QoZil8fChnPWUuaXNBcnJheShmKSkpPyhnPyhnPSExLGg9ZCYmZS5pc0FycmF5KGQpP2Q6W10pOmg9ZCYmZS5pc1BsYWluT2JqZWN0KGQpP2Q6e30saVtjXT1lLmV4dGVuZChsLGgsZikpOmYhPT1iJiYoaVtjXT1mKX1yZXR1cm4gaX0sZS5leHRlbmQoe25vQ29uZmxpY3Q6ZnVuY3Rpb24oYil7YS4kPT09ZSYmKGEuJD1nKSxiJiZhLmpRdWVyeT09PWUmJihhLmpRdWVyeT1mKTtyZXR1cm4gZX0saXNSZWFkeTohMSxyZWFkeVdhaXQ6MSxob2xkUmVhZHk6ZnVuY3Rpb24oYSl7YT9lLnJlYWR5V2FpdCsrOmUucmVhZHkoITApfSxyZWFkeTpmdW5jdGlvbihhKXtpZihhPT09ITAmJiEtLWUucmVhZHlXYWl0fHxhIT09ITAmJiFlLmlzUmVhZHkpe2lmKCFjLmJvZHkpcmV0dXJuIHNldFRpbWVvdXQoZS5yZWFkeSwxKTtlLmlzUmVhZHk9ITA7aWYoYSE9PSEwJiYtLWUucmVhZHlXYWl0PjApcmV0dXJuO3kucmVzb2x2ZVdpdGgoYyxbZV0pLGUuZm4udHJpZ2dlciYmZShjKS50cmlnZ2VyKCJyZWFkeSIpLnVuYmluZCgicmVhZHkiKX19LGJpbmRSZWFkeTpmdW5jdGlvbigpe2lmKCF5KXt5PWUuX0RlZmVycmVkKCk7aWYoYy5yZWFkeVN0YXRlPT09ImNvbXBsZXRlIilyZXR1cm4gc2V0VGltZW91dChlLnJlYWR5LDEpO2lmKGMuYWRkRXZlbnRMaXN0ZW5lciljLmFkZEV2ZW50TGlzdGVuZXIoIkRPTUNvbnRlbnRMb2FkZWQiLHosITEpLGEuYWRkRXZlbnRMaXN0ZW5lcigibG9hZCIsZS5yZWFkeSwhMSk7ZWxzZSBpZihjLmF0dGFjaEV2ZW50KXtjLmF0dGFjaEV2ZW50KCJvbnJlYWR5c3RhdGVjaGFuZ2UiLHopLGEuYXR0YWNoRXZlbnQoIm9ubG9hZCIsZS5yZWFkeSk7dmFyIGI9ITE7dHJ5e2I9YS5mcmFtZUVsZW1lbnQ9PW51bGx9Y2F0Y2goZCl7fWMuZG9jdW1lbnRFbGVtZW50LmRvU2Nyb2xsJiZiJiZIKCl9fX0saXNGdW5jdGlvbjpmdW5jdGlvbihhKXtyZXR1cm4gZS50eXBlKGEpPT09ImZ1bmN0aW9uIn0saXNBcnJheTpBcnJheS5pc0FycmF5fHxmdW5jdGlvbihhKXtyZXR1cm4gZS50eXBlKGEpPT09ImFycmF5In0saXNXaW5kb3c6ZnVuY3Rpb24oYSl7cmV0dXJuIGEmJnR5cGVvZiBhPT0ib2JqZWN0IiYmInNldEludGVydmFsImluIGF9LGlzTmFOOmZ1bmN0aW9uKGEpe3JldHVybiBhPT1udWxsfHwhbS50ZXN0KGEpfHxpc05hTihhKX0sdHlwZTpmdW5jdGlvbihhKXtyZXR1cm4gYT09bnVsbD9TdHJpbmcoYSk6R1tBLmNhbGwoYSldfHwib2JqZWN0In0saXNQbGFpbk9iamVjdDpmdW5jdGlvbihhKXtpZighYXx8ZS50eXBlKGEpIT09Im9iamVjdCJ8fGEubm9kZVR5cGV8fGUuaXNXaW5kb3coYSkpcmV0dXJuITE7aWYoYS5jb25zdHJ1Y3RvciYmIUIuY2FsbChhLCJjb25zdHJ1Y3RvciIpJiYhQi5jYWxsKGEuY29uc3RydWN0b3IucHJvdG90eXBlLCJpc1Byb3RvdHlwZU9mIikpcmV0dXJuITE7dmFyIGM7Zm9yKGMgaW4gYSk7cmV0dXJuIGM9PT1ifHxCLmNhbGwoYSxjKX0saXNFbXB0eU9iamVjdDpmdW5jdGlvbihhKXtmb3IodmFyIGIgaW4gYSlyZXR1cm4hMTtyZXR1cm4hMH0sZXJyb3I6ZnVuY3Rpb24oYSl7dGhyb3cgYX0scGFyc2VKU09OOmZ1bmN0aW9uKGIpe2lmKHR5cGVvZiBiIT0ic3RyaW5nInx8IWIpcmV0dXJuIG51bGw7Yj1lLnRyaW0oYik7aWYoYS5KU09OJiZhLkpTT04ucGFyc2UpcmV0dXJuIGEuSlNPTi5wYXJzZShiKTtpZihvLnRlc3QoYi5yZXBsYWNlKHAsIkAiKS5yZXBsYWNlKHEsIl0iKS5yZXBsYWNlKHIsIiIpKSlyZXR1cm4obmV3IEZ1bmN0aW9uKCJyZXR1cm4gIitiKSkoKTtlLmVycm9yKCJJbnZhbGlkIEpTT046ICIrYil9LHBhcnNlWE1MOmZ1bmN0aW9uKGIsYyxkKXthLkRPTVBhcnNlcj8oZD1uZXcgRE9NUGFyc2VyLGM9ZC5wYXJzZUZyb21TdHJpbmcoYiwidGV4dC94bWwiKSk6KGM9bmV3IEFjdGl2ZVhPYmplY3QoIk1pY3Jvc29mdC5YTUxET00iKSxjLmFzeW5jPSJmYWxzZSIsYy5sb2FkWE1MKGIpKSxkPWMuZG9jdW1lbnRFbGVtZW50LCghZHx8IWQubm9kZU5hbWV8fGQubm9kZU5hbWU9PT0icGFyc2VyZXJyb3IiKSYmZS5lcnJvcigiSW52YWxpZCBYTUw6ICIrYik7cmV0dXJuIGN9LG5vb3A6ZnVuY3Rpb24oKXt9LGdsb2JhbEV2YWw6ZnVuY3Rpb24oYil7YiYmai50ZXN0KGIpJiYoYS5leGVjU2NyaXB0fHxmdW5jdGlvbihiKXthLmV2YWwuY2FsbChhLGIpfSkoYil9LG5vZGVOYW1lOmZ1bmN0aW9uKGEsYil7cmV0dXJuIGEubm9kZU5hbWUmJmEubm9kZU5hbWUudG9VcHBlckNhc2UoKT09PWIudG9VcHBlckNhc2UoKX0sZWFjaDpmdW5jdGlvbihhLGMsZCl7dmFyIGYsZz0wLGg9YS5sZW5ndGgsaT1oPT09Ynx8ZS5pc0Z1bmN0aW9uKGEpO2lmKGQpe2lmKGkpe2ZvcihmIGluIGEpaWYoYy5hcHBseShhW2ZdLGQpPT09ITEpYnJlYWt9ZWxzZSBmb3IoO2c8aDspaWYoYy5hcHBseShhW2crK10sZCk9PT0hMSlicmVha31lbHNlIGlmKGkpe2ZvcihmIGluIGEpaWYoYy5jYWxsKGFbZl0sZixhW2ZdKT09PSExKWJyZWFrfWVsc2UgZm9yKDtnPGg7KWlmKGMuY2FsbChhW2ddLGcsYVtnKytdKT09PSExKWJyZWFrO3JldHVybiBhfSx0cmltOkU/ZnVuY3Rpb24oYSl7cmV0dXJuIGE9PW51bGw/IiI6RS5jYWxsKGEpfTpmdW5jdGlvbihhKXtyZXR1cm4gYT09bnVsbD8iIjooYSsiIikucmVwbGFjZShrLCIiKS5yZXBsYWNlKGwsIiIpfSxtYWtlQXJyYXk6ZnVuY3Rpb24oYSxiKXt2YXIgYz1ifHxbXTtpZihhIT1udWxsKXt2YXIgZD1lLnR5cGUoYSk7YS5sZW5ndGg9PW51bGx8fGQ9PT0ic3RyaW5nInx8ZD09PSJmdW5jdGlvbiJ8fGQ9PT0icmVnZXhwInx8ZS5pc1dpbmRvdyhhKT9DLmNhbGwoYyxhKTplLm1lcmdlKGMsYSl9cmV0dXJuIGN9LGluQXJyYXk6ZnVuY3Rpb24oYSxiKXtpZihGKXJldHVybiBGLmNhbGwoYixhKTtmb3IodmFyIGM9MCxkPWIubGVuZ3RoO2M8ZDtjKyspaWYoYltjXT09PWEpcmV0dXJuIGM7cmV0dXJuLTF9LG1lcmdlOmZ1bmN0aW9uKGEsYyl7dmFyIGQ9YS5sZW5ndGgsZT0wO2lmKHR5cGVvZiBjLmxlbmd0aD09Im51bWJlciIpZm9yKHZhciBmPWMubGVuZ3RoO2U8ZjtlKyspYVtkKytdPWNbZV07ZWxzZSB3aGlsZShjW2VdIT09YilhW2QrK109Y1tlKytdO2EubGVuZ3RoPWQ7cmV0dXJuIGF9LGdyZXA6ZnVuY3Rpb24oYSxiLGMpe3ZhciBkPVtdLGU7Yz0hIWM7Zm9yKHZhciBmPTAsZz1hLmxlbmd0aDtmPGc7ZisrKWU9ISFiKGFbZl0sZiksYyE9PWUmJmQucHVzaChhW2ZdKTtyZXR1cm4gZH0sbWFwOmZ1bmN0aW9uKGEsYyxkKXt2YXIgZixnLGg9W10saT0wLGo9YS5sZW5ndGgsaz1hIGluc3RhbmNlb2YgZXx8aiE9PWImJnR5cGVvZiBqPT0ibnVtYmVyIiYmKGo+MCYmYVswXSYmYVtqLTFdfHxqPT09MHx8ZS5pc0FycmF5KGEpKTtpZihrKWZvcig7aTxqO2krKylmPWMoYVtpXSxpLGQpLGYhPW51bGwmJihoW2gubGVuZ3RoXT1mKTtlbHNlIGZvcihnIGluIGEpZj1jKGFbZ10sZyxkKSxmIT1udWxsJiYoaFtoLmxlbmd0aF09Zik7cmV0dXJuIGguY29uY2F0LmFwcGx5KFtdLGgpfSxndWlkOjEscHJveHk6ZnVuY3Rpb24oYSxjKXtpZih0eXBlb2YgYz09InN0cmluZyIpe3ZhciBkPWFbY107Yz1hLGE9ZH1pZighZS5pc0Z1bmN0aW9uKGEpKXJldHVybiBiO3ZhciBmPUQuY2FsbChhcmd1bWVudHMsMiksZz1mdW5jdGlvbigpe3JldHVybiBhLmFwcGx5KGMsZi5jb25jYXQoRC5jYWxsKGFyZ3VtZW50cykpKX07Zy5ndWlkPWEuZ3VpZD1hLmd1aWR8fGcuZ3VpZHx8ZS5ndWlkKys7cmV0dXJuIGd9LGFjY2VzczpmdW5jdGlvbihhLGMsZCxmLGcsaCl7dmFyIGk9YS5sZW5ndGg7aWYodHlwZW9mIGM9PSJvYmplY3QiKXtmb3IodmFyIGogaW4gYyllLmFjY2VzcyhhLGosY1tqXSxmLGcsZCk7cmV0dXJuIGF9aWYoZCE9PWIpe2Y9IWgmJmYmJmUuaXNGdW5jdGlvbihkKTtmb3IodmFyIGs9MDtrPGk7aysrKWcoYVtrXSxjLGY/ZC5jYWxsKGFba10sayxnKGFba10sYykpOmQsaCk7cmV0dXJuIGF9cmV0dXJuIGk/ZyhhWzBdLGMpOmJ9LG5vdzpmdW5jdGlvbigpe3JldHVybihuZXcgRGF0ZSkuZ2V0VGltZSgpfSx1YU1hdGNoOmZ1bmN0aW9uKGEpe2E9YS50b0xvd2VyQ2FzZSgpO3ZhciBiPXMuZXhlYyhhKXx8dC5leGVjKGEpfHx1LmV4ZWMoYSl8fGEuaW5kZXhPZigiY29tcGF0aWJsZSIpPDAmJnYuZXhlYyhhKXx8W107cmV0dXJue2Jyb3dzZXI6YlsxXXx8IiIsdmVyc2lvbjpiWzJdfHwiMCJ9fSxzdWI6ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGIsYyl7cmV0dXJuIG5ldyBhLmZuLmluaXQoYixjKX1lLmV4dGVuZCghMCxhLHRoaXMpLGEuc3VwZXJjbGFzcz10aGlzLGEuZm49YS5wcm90b3R5cGU9dGhpcygpLGEuZm4uY29uc3RydWN0b3I9YSxhLnN1Yj10aGlzLnN1YixhLmZuLmluaXQ9ZnVuY3Rpb24oZCxmKXtmJiZmIGluc3RhbmNlb2YgZSYmIShmIGluc3RhbmNlb2YgYSkmJihmPWEoZikpO3JldHVybiBlLmZuLmluaXQuY2FsbCh0aGlzLGQsZixiKX0sYS5mbi5pbml0LnByb3RvdHlwZT1hLmZuO3ZhciBiPWEoYyk7cmV0dXJuIGF9LGJyb3dzZXI6e319KSxlLmVhY2goIkJvb2xlYW4gTnVtYmVyIFN0cmluZyBGdW5jdGlvbiBBcnJheSBEYXRlIFJlZ0V4cCBPYmplY3QiLnNwbGl0KCIgIiksZnVuY3Rpb24oYSxiKXtHWyJbb2JqZWN0ICIrYisiXSJdPWIudG9Mb3dlckNhc2UoKX0pLHg9ZS51YU1hdGNoKHcpLHguYnJvd3NlciYmKGUuYnJvd3Nlclt4LmJyb3dzZXJdPSEwLGUuYnJvd3Nlci52ZXJzaW9uPXgudmVyc2lvbiksZS5icm93c2VyLndlYmtpdCYmKGUuYnJvd3Nlci5zYWZhcmk9ITApLGoudGVzdCgiwqAiKSYmKGs9L15bXHNceEEwXSsvLGw9L1tcc1x4QTBdKyQvKSxoPWUoYyksYy5hZGRFdmVudExpc3RlbmVyP3o9ZnVuY3Rpb24oKXtjLnJlbW92ZUV2ZW50TGlzdGVuZXIoIkRPTUNvbnRlbnRMb2FkZWQiLHosITEpLGUucmVhZHkoKX06Yy5hdHRhY2hFdmVudCYmKHo9ZnVuY3Rpb24oKXtjLnJlYWR5U3RhdGU9PT0iY29tcGxldGUiJiYoYy5kZXRhY2hFdmVudCgib25yZWFkeXN0YXRlY2hhbmdlIix6KSxlLnJlYWR5KCkpfSk7cmV0dXJuIGV9KCksZz0iZG9uZSBmYWlsIGlzUmVzb2x2ZWQgaXNSZWplY3RlZCBwcm9taXNlIHRoZW4gYWx3YXlzIHBpcGUiLnNwbGl0KCIgIiksaD1bXS5zbGljZTtmLmV4dGVuZCh7X0RlZmVycmVkOmZ1bmN0aW9uKCl7dmFyIGE9W10sYixjLGQsZT17ZG9uZTpmdW5jdGlvbigpe2lmKCFkKXt2YXIgYz1hcmd1bWVudHMsZyxoLGksaixrO2ImJihrPWIsYj0wKTtmb3IoZz0wLGg9Yy5sZW5ndGg7ZzxoO2crKylpPWNbZ10saj1mLnR5cGUoaSksaj09PSJhcnJheSI/ZS5kb25lLmFwcGx5KGUsaSk6aj09PSJmdW5jdGlvbiImJmEucHVzaChpKTtrJiZlLnJlc29sdmVXaXRoKGtbMF0sa1sxXSl9cmV0dXJuIHRoaXN9LHJlc29sdmVXaXRoOmZ1bmN0aW9uKGUsZil7aWYoIWQmJiFiJiYhYyl7Zj1mfHxbXSxjPTE7dHJ5e3doaWxlKGFbMF0pYS5zaGlmdCgpLmFwcGx5KGUsZil9ZmluYWxseXtiPVtlLGZdLGM9MH19cmV0dXJuIHRoaXN9LHJlc29sdmU6ZnVuY3Rpb24oKXtlLnJlc29sdmVXaXRoKHRoaXMsYXJndW1lbnRzKTtyZXR1cm4gdGhpc30saXNSZXNvbHZlZDpmdW5jdGlvbigpe3JldHVybiEhY3x8ISFifSxjYW5jZWw6ZnVuY3Rpb24oKXtkPTEsYT1bXTtyZXR1cm4gdGhpc319O3JldHVybiBlfSxEZWZlcnJlZDpmdW5jdGlvbihhKXt2YXIgYj1mLl9EZWZlcnJlZCgpLGM9Zi5fRGVmZXJyZWQoKSxkO2YuZXh0ZW5kKGIse3RoZW46ZnVuY3Rpb24oYSxjKXtiLmRvbmUoYSkuZmFpbChjKTtyZXR1cm4gdGhpc30sYWx3YXlzOmZ1bmN0aW9uKCl7cmV0dXJuIGIuZG9uZS5hcHBseShiLGFyZ3VtZW50cykuZmFpbC5hcHBseSh0aGlzLGFyZ3VtZW50cyl9LGZhaWw6Yy5kb25lLHJlamVjdFdpdGg6Yy5yZXNvbHZlV2l0aCxyZWplY3Q6Yy5yZXNvbHZlLGlzUmVqZWN0ZWQ6Yy5pc1Jlc29sdmVkLHBpcGU6ZnVuY3Rpb24oYSxjKXtyZXR1cm4gZi5EZWZlcnJlZChmdW5jdGlvbihkKXtmLmVhY2goe2RvbmU6W2EsInJlc29sdmUiXSxmYWlsOltjLCJyZWplY3QiXX0sZnVuY3Rpb24oYSxjKXt2YXIgZT1jWzBdLGc9Y1sxXSxoO2YuaXNGdW5jdGlvbihlKT9iW2FdKGZ1bmN0aW9uKCl7aD1lLmFwcGx5KHRoaXMsYXJndW1lbnRzKSxoJiZmLmlzRnVuY3Rpb24oaC5wcm9taXNlKT9oLnByb21pc2UoKS50aGVuKGQucmVzb2x2ZSxkLnJlamVjdCk6ZFtnXShoKX0pOmJbYV0oZFtnXSl9KX0pLnByb21pc2UoKX0scHJvbWlzZTpmdW5jdGlvbihhKXtpZihhPT1udWxsKXtpZihkKXJldHVybiBkO2Q9YT17fX12YXIgYz1nLmxlbmd0aDt3aGlsZShjLS0pYVtnW2NdXT1iW2dbY11dO3JldHVybiBhfX0pLGIuZG9uZShjLmNhbmNlbCkuZmFpbChiLmNhbmNlbCksZGVsZXRlIGIuY2FuY2VsLGEmJmEuY2FsbChiLGIpO3JldHVybiBifSx3aGVuOmZ1bmN0aW9uKGEpe2Z1bmN0aW9uIGkoYSl7cmV0dXJuIGZ1bmN0aW9uKGMpe2JbYV09YXJndW1lbnRzLmxlbmd0aD4xP2guY2FsbChhcmd1bWVudHMsMCk6YywtLWV8fGcucmVzb2x2ZVdpdGgoZyxoLmNhbGwoYiwwKSl9fXZhciBiPWFyZ3VtZW50cyxjPTAsZD1iLmxlbmd0aCxlPWQsZz1kPD0xJiZhJiZmLmlzRnVuY3Rpb24oYS5wcm9taXNlKT9hOmYuRGVmZXJyZWQoKTtpZihkPjEpe2Zvcig7YzxkO2MrKyliW2NdJiZmLmlzRnVuY3Rpb24oYltjXS5wcm9taXNlKT9iW2NdLnByb21pc2UoKS50aGVuKGkoYyksZy5yZWplY3QpOi0tZTtlfHxnLnJlc29sdmVXaXRoKGcsYil9ZWxzZSBnIT09YSYmZy5yZXNvbHZlV2l0aChnLGQ/W2FdOltdKTtyZXR1cm4gZy5wcm9taXNlKCl9fSksZi5zdXBwb3J0PWZ1bmN0aW9uKCl7dmFyIGE9Yy5jcmVhdGVFbGVtZW50KCJkaXYiKSxiPWMuZG9jdW1lbnRFbGVtZW50LGQsZSxmLGcsaCxpLGosayxsLG0sbixvLHAscSxyO2Euc2V0QXR0cmlidXRlKCJjbGFzc05hbWUiLCJ0IiksYS5pbm5lckhUTUw9IiAgIDxsaW5rLz48dGFibGU+PC90YWJsZT48YSBocmVmPScvYScgc3R5bGU9J3RvcDoxcHg7ZmxvYXQ6bGVmdDtvcGFjaXR5Oi41NTsnPmE8L2E+PGlucHV0IHR5cGU9J2NoZWNrYm94Jy8+IixkPWEuZ2V0RWxlbWVudHNCeVRhZ05hbWUoIioiKSxlPWEuZ2V0RWxlbWVudHNCeVRhZ05hbWUoImEiKVswXTtpZighZHx8IWQubGVuZ3RofHwhZSlyZXR1cm57fTtmPWMuY3JlYXRlRWxlbWVudCgic2VsZWN0IiksZz1mLmFwcGVuZENoaWxkKGMuY3JlYXRlRWxlbWVudCgib3B0aW9uIikpLGg9YS5nZXRFbGVtZW50c0J5VGFnTmFtZSgiaW5wdXQiKVswXSxqPXtsZWFkaW5nV2hpdGVzcGFjZTphLmZpcnN0Q2hpbGQubm9kZVR5cGU9PT0zLHRib2R5OiFhLmdldEVsZW1lbnRzQnlUYWdOYW1lKCJ0Ym9keSIpLmxlbmd0aCxodG1sU2VyaWFsaXplOiEhYS5nZXRFbGVtZW50c0J5VGFnTmFtZSgibGluayIpLmxlbmd0aCxzdHlsZTovdG9wLy50ZXN0KGUuZ2V0QXR0cmlidXRlKCJzdHlsZSIpKSxocmVmTm9ybWFsaXplZDplLmdldEF0dHJpYnV0ZSgiaHJlZiIpPT09Ii9hIixvcGFjaXR5Oi9eMC41NSQvLnRlc3QoZS5zdHlsZS5vcGFjaXR5KSxjc3NGbG9hdDohIWUuc3R5bGUuY3NzRmxvYXQsY2hlY2tPbjpoLnZhbHVlPT09Im9uIixvcHRTZWxlY3RlZDpnLnNlbGVjdGVkLGdldFNldEF0dHJpYnV0ZTphLmNsYXNzTmFtZSE9PSJ0IixzdWJtaXRCdWJibGVzOiEwLGNoYW5nZUJ1YmJsZXM6ITAsZm9jdXNpbkJ1YmJsZXM6ITEsZGVsZXRlRXhwYW5kbzohMCxub0Nsb25lRXZlbnQ6ITAsaW5saW5lQmxvY2tOZWVkc0xheW91dDohMSxzaHJpbmtXcmFwQmxvY2tzOiExLHJlbGlhYmxlTWFyZ2luUmlnaHQ6ITB9LGguY2hlY2tlZD0hMCxqLm5vQ2xvbmVDaGVja2VkPWguY2xvbmVOb2RlKCEwKS5jaGVja2VkLGYuZGlzYWJsZWQ9ITAsai5vcHREaXNhYmxlZD0hZy5kaXNhYmxlZDt0cnl7ZGVsZXRlIGEudGVzdH1jYXRjaChzKXtqLmRlbGV0ZUV4cGFuZG89ITF9IWEuYWRkRXZlbnRMaXN0ZW5lciYmYS5hdHRhY2hFdmVudCYmYS5maXJlRXZlbnQmJihhLmF0dGFjaEV2ZW50KCJvbmNsaWNrIixmdW5jdGlvbiBiKCl7ai5ub0Nsb25lRXZlbnQ9ITEsYS5kZXRhY2hFdmVudCgib25jbGljayIsYil9KSxhLmNsb25lTm9kZSghMCkuZmlyZUV2ZW50KCJvbmNsaWNrIikpLGg9Yy5jcmVhdGVFbGVtZW50KCJpbnB1dCIpLGgudmFsdWU9InQiLGguc2V0QXR0cmlidXRlKCJ0eXBlIiwicmFkaW8iKSxqLnJhZGlvVmFsdWU9aC52YWx1ZT09PSJ0IixoLnNldEF0dHJpYnV0ZSgiY2hlY2tlZCIsImNoZWNrZWQiKSxhLmFwcGVuZENoaWxkKGgpLGs9Yy5jcmVhdGVEb2N1bWVudEZyYWdtZW50KCksay5hcHBlbmRDaGlsZChhLmZpcnN0Q2hpbGQpLGouY2hlY2tDbG9uZT1rLmNsb25lTm9kZSghMCkuY2xvbmVOb2RlKCEwKS5sYXN0Q2hpbGQuY2hlY2tlZCxhLmlubmVySFRNTD0iIixhLnN0eWxlLndpZHRoPWEuc3R5bGUucGFkZGluZ0xlZnQ9IjFweCIsbD1jLmNyZWF0ZUVsZW1lbnQoImJvZHkiKSxtPXt2aXNpYmlsaXR5OiJoaWRkZW4iLHdpZHRoOjAsaGVpZ2h0OjAsYm9yZGVyOjAsbWFyZ2luOjAsYmFja2dyb3VuZDoibm9uZSJ9O2ZvcihxIGluIG0pbC5zdHlsZVtxXT1tW3FdO2wuYXBwZW5kQ2hpbGQoYSksYi5pbnNlcnRCZWZvcmUobCxiLmZpcnN0Q2hpbGQpLGouYXBwZW5kQ2hlY2tlZD1oLmNoZWNrZWQsai5ib3hNb2RlbD1hLm9mZnNldFdpZHRoPT09Miwiem9vbSJpbiBhLnN0eWxlJiYoYS5zdHlsZS5kaXNwbGF5PSJpbmxpbmUiLGEuc3R5bGUuem9vbT0xLGouaW5saW5lQmxvY2tOZWVkc0xheW91dD1hLm9mZnNldFdpZHRoPT09MixhLnN0eWxlLmRpc3BsYXk9IiIsYS5pbm5lckhUTUw9IjxkaXYgc3R5bGU9J3dpZHRoOjRweDsnPjwvZGl2PiIsai5zaHJpbmtXcmFwQmxvY2tzPWEub2Zmc2V0V2lkdGghPT0yKSxhLmlubmVySFRNTD0iPHRhYmxlPjx0cj48dGQgc3R5bGU9J3BhZGRpbmc6MDtib3JkZXI6MDtkaXNwbGF5Om5vbmUnPjwvdGQ+PHRkPnQ8L3RkPjwvdHI+PC90YWJsZT4iLG49YS5nZXRFbGVtZW50c0J5VGFnTmFtZSgidGQiKSxyPW5bMF0ub2Zmc2V0SGVpZ2h0PT09MCxuWzBdLnN0eWxlLmRpc3BsYXk9IiIsblsxXS5zdHlsZS5kaXNwbGF5PSJub25lIixqLnJlbGlhYmxlSGlkZGVuT2Zmc2V0cz1yJiZuWzBdLm9mZnNldEhlaWdodD09PTAsYS5pbm5lckhUTUw9IiIsYy5kZWZhdWx0VmlldyYmYy5kZWZhdWx0Vmlldy5nZXRDb21wdXRlZFN0eWxlJiYoaT1jLmNyZWF0ZUVsZW1lbnQoImRpdiIpLGkuc3R5bGUud2lkdGg9IjAiLGkuc3R5bGUubWFyZ2luUmlnaHQ9IjAiLGEuYXBwZW5kQ2hpbGQoaSksai5yZWxpYWJsZU1hcmdpblJpZ2h0PShwYXJzZUludCgoYy5kZWZhdWx0Vmlldy5nZXRDb21wdXRlZFN0eWxlKGksbnVsbCl8fHttYXJnaW5SaWdodDowfSkubWFyZ2luUmlnaHQsMTApfHwwKT09PTApLGwuaW5uZXJIVE1MPSIiLGIucmVtb3ZlQ2hpbGQobCk7aWYoYS5hdHRhY2hFdmVudClmb3IocSBpbntzdWJtaXQ6MSxjaGFuZ2U6MSxmb2N1c2luOjF9KXA9Im9uIitxLHI9cCBpbiBhLHJ8fChhLnNldEF0dHJpYnV0ZShwLCJyZXR1cm47Iikscj10eXBlb2YgYVtwXT09ImZ1bmN0aW9uIiksaltxKyJCdWJibGVzIl09cjtyZXR1cm4gan0oKSxmLmJveE1vZGVsPWYuc3VwcG9ydC5ib3hNb2RlbDt2YXIgaT0vXig/Olx7LipcfXxcWy4qXF0pJC8saj0vKFthLXpdKShbQS1aXSkvZztmLmV4dGVuZCh7Y2FjaGU6e30sdXVpZDowLGV4cGFuZG86ImpRdWVyeSIrKGYuZm4uanF1ZXJ5K01hdGgucmFuZG9tKCkpLnJlcGxhY2UoL1xEL2csIiIpLG5vRGF0YTp7ZW1iZWQ6ITAsb2JqZWN0OiJjbHNpZDpEMjdDREI2RS1BRTZELTExY2YtOTZCOC00NDQ1NTM1NDAwMDAiLGFwcGxldDohMH0saGFzRGF0YTpmdW5jdGlvbihhKXthPWEubm9kZVR5cGU/Zi5jYWNoZVthW2YuZXhwYW5kb11dOmFbZi5leHBhbmRvXTtyZXR1cm4hIWEmJiFsKGEpfSxkYXRhOmZ1bmN0aW9uKGEsYyxkLGUpe2lmKCEhZi5hY2NlcHREYXRhKGEpKXt2YXIgZz1mLmV4cGFuZG8saD10eXBlb2YgYz09InN0cmluZyIsaSxqPWEubm9kZVR5cGUsaz1qP2YuY2FjaGU6YSxsPWo/YVtmLmV4cGFuZG9dOmFbZi5leHBhbmRvXSYmZi5leHBhbmRvO2lmKCghbHx8ZSYmbCYmIWtbbF1bZ10pJiZoJiZkPT09YilyZXR1cm47bHx8KGo/YVtmLmV4cGFuZG9dPWw9KytmLnV1aWQ6bD1mLmV4cGFuZG8pLGtbbF18fChrW2xdPXt9LGp8fChrW2xdLnRvSlNPTj1mLm5vb3ApKTtpZih0eXBlb2YgYz09Im9iamVjdCJ8fHR5cGVvZiBjPT0iZnVuY3Rpb24iKWU/a1tsXVtnXT1mLmV4dGVuZChrW2xdW2ddLGMpOmtbbF09Zi5leHRlbmQoa1tsXSxjKTtpPWtbbF0sZSYmKGlbZ118fChpW2ddPXt9KSxpPWlbZ10pLGQhPT1iJiYoaVtmLmNhbWVsQ2FzZShjKV09ZCk7aWYoYz09PSJldmVudHMiJiYhaVtjXSlyZXR1cm4gaVtnXSYmaVtnXS5ldmVudHM7cmV0dXJuIGg/aVtmLmNhbWVsQ2FzZShjKV06aX19LHJlbW92ZURhdGE6ZnVuY3Rpb24oYixjLGQpe2lmKCEhZi5hY2NlcHREYXRhKGIpKXt2YXIgZT1mLmV4cGFuZG8sZz1iLm5vZGVUeXBlLGg9Zz9mLmNhY2hlOmIsaT1nP2JbZi5leHBhbmRvXTpmLmV4cGFuZG87aWYoIWhbaV0pcmV0dXJuO2lmKGMpe3ZhciBqPWQ/aFtpXVtlXTpoW2ldO2lmKGope2RlbGV0ZSBqW2NdO2lmKCFsKGopKXJldHVybn19aWYoZCl7ZGVsZXRlIGhbaV1bZV07aWYoIWwoaFtpXSkpcmV0dXJufXZhciBrPWhbaV1bZV07Zi5zdXBwb3J0LmRlbGV0ZUV4cGFuZG98fGghPWE/ZGVsZXRlIGhbaV06aFtpXT1udWxsLGs/KGhbaV09e30sZ3x8KGhbaV0udG9KU09OPWYubm9vcCksaFtpXVtlXT1rKTpnJiYoZi5zdXBwb3J0LmRlbGV0ZUV4cGFuZG8/ZGVsZXRlIGJbZi5leHBhbmRvXTpiLnJlbW92ZUF0dHJpYnV0ZT9iLnJlbW92ZUF0dHJpYnV0ZShmLmV4cGFuZG8pOmJbZi5leHBhbmRvXT1udWxsKX19LF9kYXRhOmZ1bmN0aW9uKGEsYixjKXtyZXR1cm4gZi5kYXRhKGEsYixjLCEwKX0sYWNjZXB0RGF0YTpmdW5jdGlvbihhKXtpZihhLm5vZGVOYW1lKXt2YXIgYj1mLm5vRGF0YVthLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCldO2lmKGIpcmV0dXJuIGIhPT0hMCYmYS5nZXRBdHRyaWJ1dGUoImNsYXNzaWQiKT09PWJ9cmV0dXJuITB9fSksZi5mbi5leHRlbmQoe2RhdGE6ZnVuY3Rpb24oYSxjKXt2YXIgZD1udWxsO2lmKHR5cGVvZiBhPT0idW5kZWZpbmVkIil7aWYodGhpcy5sZW5ndGgpe2Q9Zi5kYXRhKHRoaXNbMF0pO2lmKHRoaXNbMF0ubm9kZVR5cGU9PT0xKXt2YXIgZT10aGlzWzBdLmF0dHJpYnV0ZXMsZztmb3IodmFyIGg9MCxpPWUubGVuZ3RoO2g8aTtoKyspZz1lW2hdLm5hbWUsZy5pbmRleE9mKCJkYXRhLSIpPT09MCYmKGc9Zi5jYW1lbENhc2UoZy5zdWJzdHJpbmcoNSkpLGsodGhpc1swXSxnLGRbZ10pKX19cmV0dXJuIGR9aWYodHlwZW9mIGE9PSJvYmplY3QiKXJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oKXtmLmRhdGEodGhpcyxhKX0pO3ZhciBqPWEuc3BsaXQoIi4iKTtqWzFdPWpbMV0/Ii4iK2pbMV06IiI7aWYoYz09PWIpe2Q9dGhpcy50cmlnZ2VySGFuZGxlcigiZ2V0RGF0YSIralsxXSsiISIsW2pbMF1dKSxkPT09YiYmdGhpcy5sZW5ndGgmJihkPWYuZGF0YSh0aGlzWzBdLGEpLGQ9ayh0aGlzWzBdLGEsZCkpO3JldHVybiBkPT09YiYmalsxXT90aGlzLmRhdGEoalswXSk6ZH1yZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKCl7dmFyIGI9Zih0aGlzKSxkPVtqWzBdLGNdO2IudHJpZ2dlckhhbmRsZXIoInNldERhdGEiK2pbMV0rIiEiLGQpLGYuZGF0YSh0aGlzLGEsYyksYi50cmlnZ2VySGFuZGxlcigiY2hhbmdlRGF0YSIralsxXSsiISIsZCl9KX0scmVtb3ZlRGF0YTpmdW5jdGlvbihhKXtyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKCl7Zi5yZW1vdmVEYXRhKHRoaXMsYSl9KX19KSxmLmV4dGVuZCh7X21hcms6ZnVuY3Rpb24oYSxjKXthJiYoYz0oY3x8ImZ4IikrIm1hcmsiLGYuZGF0YShhLGMsKGYuZGF0YShhLGMsYiwhMCl8fDApKzEsITApKX0sX3VubWFyazpmdW5jdGlvbihhLGMsZCl7YSE9PSEwJiYoZD1jLGM9YSxhPSExKTtpZihjKXtkPWR8fCJmeCI7dmFyIGU9ZCsibWFyayIsZz1hPzA6KGYuZGF0YShjLGUsYiwhMCl8fDEpLTE7Zz9mLmRhdGEoYyxlLGcsITApOihmLnJlbW92ZURhdGEoYyxlLCEwKSxtKGMsZCwibWFyayIpKX19LHF1ZXVlOmZ1bmN0aW9uKGEsYyxkKXtpZihhKXtjPShjfHwiZngiKSsicXVldWUiO3ZhciBlPWYuZGF0YShhLGMsYiwhMCk7ZCYmKCFlfHxmLmlzQXJyYXkoZCk/ZT1mLmRhdGEoYSxjLGYubWFrZUFycmF5KGQpLCEwKTplLnB1c2goZCkpO3JldHVybiBlfHxbXX19LGRlcXVldWU6ZnVuY3Rpb24oYSxiKXtiPWJ8fCJmeCI7dmFyIGM9Zi5xdWV1ZShhLGIpLGQ9Yy5zaGlmdCgpLGU7ZD09PSJpbnByb2dyZXNzIiYmKGQ9Yy5zaGlmdCgpKSxkJiYoYj09PSJmeCImJmMudW5zaGlmdCgiaW5wcm9ncmVzcyIpLGQuY2FsbChhLGZ1bmN0aW9uKCl7Zi5kZXF1ZXVlKGEsYil9KSksYy5sZW5ndGh8fChmLnJlbW92ZURhdGEoYSxiKyJxdWV1ZSIsITApLG0oYSxiLCJxdWV1ZSIpKX19KSxmLmZuLmV4dGVuZCh7cXVldWU6ZnVuY3Rpb24oYSxjKXt0eXBlb2YgYSE9InN0cmluZyImJihjPWEsYT0iZngiKTtpZihjPT09YilyZXR1cm4gZi5xdWV1ZSh0aGlzWzBdLGEpO3JldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oKXt2YXIgYj1mLnF1ZXVlKHRoaXMsYSxjKTthPT09ImZ4IiYmYlswXSE9PSJpbnByb2dyZXNzIiYmZi5kZXF1ZXVlKHRoaXMsYSl9KX0sZGVxdWV1ZTpmdW5jdGlvbihhKXtyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKCl7Zi5kZXF1ZXVlKHRoaXMsYSl9KX0sZGVsYXk6ZnVuY3Rpb24oYSxiKXthPWYuZng/Zi5meC5zcGVlZHNbYV18fGE6YSxiPWJ8fCJmeCI7cmV0dXJuIHRoaXMucXVldWUoYixmdW5jdGlvbigpe3ZhciBjPXRoaXM7c2V0VGltZW91dChmdW5jdGlvbigpe2YuZGVxdWV1ZShjLGIpfSxhKX0pfSxjbGVhclF1ZXVlOmZ1bmN0aW9uKGEpe3JldHVybiB0aGlzLnF1ZXVlKGF8fCJmeCIsW10pfSxwcm9taXNlOmZ1bmN0aW9uKGEsYyl7ZnVuY3Rpb24gbSgpey0taHx8ZC5yZXNvbHZlV2l0aChlLFtlXSl9dHlwZW9mIGEhPSJzdHJpbmciJiYoYz1hLGE9YiksYT1hfHwiZngiO3ZhciBkPWYuRGVmZXJyZWQoKSxlPXRoaXMsZz1lLmxlbmd0aCxoPTEsaT1hKyJkZWZlciIsaj1hKyJxdWV1ZSIsaz1hKyJtYXJrIixsO3doaWxlKGctLSlpZihsPWYuZGF0YShlW2ddLGksYiwhMCl8fChmLmRhdGEoZVtnXSxqLGIsITApfHxmLmRhdGEoZVtnXSxrLGIsITApKSYmZi5kYXRhKGVbZ10saSxmLl9EZWZlcnJlZCgpLCEwKSloKyssbC5kb25lKG0pO20oKTtyZXR1cm4gZC5wcm9taXNlKCl9fSk7dmFyIG49L1tcblx0XHJdL2csbz0vXHMrLyxwPS9cci9nLHE9L14oPzpidXR0b258aW5wdXQpJC9pLHI9L14oPzpidXR0b258aW5wdXR8b2JqZWN0fHNlbGVjdHx0ZXh0YXJlYSkkL2kscz0vXmEoPzpyZWEpPyQvaSx0PS9eKD86YXV0b2ZvY3VzfGF1dG9wbGF5fGFzeW5jfGNoZWNrZWR8Y29udHJvbHN8ZGVmZXJ8ZGlzYWJsZWR8aGlkZGVufGxvb3B8bXVsdGlwbGV8b3BlbnxyZWFkb25seXxyZXF1aXJlZHxzY29wZWR8c2VsZWN0ZWQpJC9pLHU9L1w6Lyx2LHc7Zi5mbi5leHRlbmQoe2F0dHI6ZnVuY3Rpb24oYSxiKXtyZXR1cm4gZi5hY2Nlc3ModGhpcyxhLGIsITAsZi5hdHRyKX0scmVtb3ZlQXR0cjpmdW5jdGlvbihhKXtyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKCl7Zi5yZW1vdmVBdHRyKHRoaXMsYSl9KX0scHJvcDpmdW5jdGlvbihhLGIpe3JldHVybiBmLmFjY2Vzcyh0aGlzLGEsYiwhMCxmLnByb3ApfSxyZW1vdmVQcm9wOmZ1bmN0aW9uKGEpe2E9Zi5wcm9wRml4W2FdfHxhO3JldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oKXt0cnl7dGhpc1thXT1iLGRlbGV0ZSB0aGlzW2FdfWNhdGNoKGMpe319KX0sYWRkQ2xhc3M6ZnVuY3Rpb24oYSl7aWYoZi5pc0Z1bmN0aW9uKGEpKXJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oYil7dmFyIGM9Zih0aGlzKTtjLmFkZENsYXNzKGEuY2FsbCh0aGlzLGIsYy5hdHRyKCJjbGFzcyIpfHwiIikpfSk7aWYoYSYmdHlwZW9mIGE9PSJzdHJpbmciKXt2YXIgYj0oYXx8IiIpLnNwbGl0KG8pO2Zvcih2YXIgYz0wLGQ9dGhpcy5sZW5ndGg7YzxkO2MrKyl7dmFyIGU9dGhpc1tjXTtpZihlLm5vZGVUeXBlPT09MSlpZighZS5jbGFzc05hbWUpZS5jbGFzc05hbWU9YTtlbHNle3ZhciBnPSIgIitlLmNsYXNzTmFtZSsiICIsaD1lLmNsYXNzTmFtZTtmb3IodmFyIGk9MCxqPWIubGVuZ3RoO2k8ajtpKyspZy5pbmRleE9mKCIgIitiW2ldKyIgIik8MCYmKGgrPSIgIitiW2ldKTtlLmNsYXNzTmFtZT1mLnRyaW0oaCl9fX1yZXR1cm4gdGhpc30scmVtb3ZlQ2xhc3M6ZnVuY3Rpb24oYSl7aWYoZi5pc0Z1bmN0aW9uKGEpKXJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oYil7dmFyIGM9Zih0aGlzKTtjLnJlbW92ZUNsYXNzKGEuY2FsbCh0aGlzLGIsYy5hdHRyKCJjbGFzcyIpKSl9KTtpZihhJiZ0eXBlb2YgYT09InN0cmluZyJ8fGE9PT1iKXt2YXIgYz0oYXx8IiIpLnNwbGl0KG8pO2Zvcih2YXIgZD0wLGU9dGhpcy5sZW5ndGg7ZDxlO2QrKyl7dmFyIGc9dGhpc1tkXTtpZihnLm5vZGVUeXBlPT09MSYmZy5jbGFzc05hbWUpaWYoYSl7dmFyIGg9KCIgIitnLmNsYXNzTmFtZSsiICIpLnJlcGxhY2UobiwiICIpO2Zvcih2YXIgaT0wLGo9Yy5sZW5ndGg7aTxqO2krKyloPWgucmVwbGFjZSgiICIrY1tpXSsiICIsIiAiKTtnLmNsYXNzTmFtZT1mLnRyaW0oaCl9ZWxzZSBnLmNsYXNzTmFtZT0iIn19cmV0dXJuIHRoaXN9LHRvZ2dsZUNsYXNzOmZ1bmN0aW9uKGEsYil7dmFyIGM9dHlwZW9mIGEsZD10eXBlb2YgYj09ImJvb2xlYW4iO2lmKGYuaXNGdW5jdGlvbihhKSlyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKGMpe3ZhciBkPWYodGhpcyk7ZC50b2dnbGVDbGFzcyhhLmNhbGwodGhpcyxjLGQuYXR0cigiY2xhc3MiKSxiKSxiKX0pO3JldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oKXtpZihjPT09InN0cmluZyIpe3ZhciBlLGc9MCxoPWYodGhpcyksaT1iLGo9YS5zcGxpdChvKTt3aGlsZShlPWpbZysrXSlpPWQ/aTohaC5oYXNDbGFzcyhlKSxoW2k/ImFkZENsYXNzIjoicmVtb3ZlQ2xhc3MiXShlKX1lbHNlIGlmKGM9PT0idW5kZWZpbmVkInx8Yz09PSJib29sZWFuIil0aGlzLmNsYXNzTmFtZSYmZi5fZGF0YSh0aGlzLCJfX2NsYXNzTmFtZV9fIix0aGlzLmNsYXNzTmFtZSksdGhpcy5jbGFzc05hbWU9dGhpcy5jbGFzc05hbWV8fGE9PT0hMT8iIjpmLl9kYXRhKHRoaXMsIl9fY2xhc3NOYW1lX18iKXx8IiJ9KX0saGFzQ2xhc3M6ZnVuY3Rpb24oYSl7dmFyIGI9IiAiK2ErIiAiO2Zvcih2YXIgYz0wLGQ9dGhpcy5sZW5ndGg7YzxkO2MrKylpZigoIiAiK3RoaXNbY10uY2xhc3NOYW1lKyIgIikucmVwbGFjZShuLCIgIikuaW5kZXhPZihiKT4tMSlyZXR1cm4hMDtyZXR1cm4hMX0sdmFsOmZ1bmN0aW9uKGEpe3ZhciBjLGQsZT10aGlzWzBdO2lmKCFhcmd1bWVudHMubGVuZ3RoKXtpZihlKXtjPWYudmFsSG9va3NbZS5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpXXx8Zi52YWxIb29rc1tlLnR5cGVdO2lmKGMmJiJnZXQiaW4gYyYmKGQ9Yy5nZXQoZSwidmFsdWUiKSkhPT1iKXJldHVybiBkO3JldHVybihlLnZhbHVlfHwiIikucmVwbGFjZShwLCIiKX1yZXR1cm4gYn12YXIgZz1mLmlzRnVuY3Rpb24oYSk7cmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbihkKXt2YXIgZT1mKHRoaXMpLGg7aWYodGhpcy5ub2RlVHlwZT09PTEpe2c/aD1hLmNhbGwodGhpcyxkLGUudmFsKCkpOmg9YSxoPT1udWxsP2g9IiI6dHlwZW9mIGg9PSJudW1iZXIiP2grPSIiOmYuaXNBcnJheShoKSYmKGg9Zi5tYXAoaCxmdW5jdGlvbihhKXtyZXR1cm4gYT09bnVsbD8iIjphKyIifSkpLGM9Zi52YWxIb29rc1t0aGlzLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCldfHxmLnZhbEhvb2tzW3RoaXMudHlwZV07aWYoIWN8fCEoInNldCJpbiBjKXx8Yy5zZXQodGhpcyxoLCJ2YWx1ZSIpPT09Yil0aGlzLnZhbHVlPWh9fSl9fSksZi5leHRlbmQoe3ZhbEhvb2tzOntvcHRpb246e2dldDpmdW5jdGlvbihhKXt2YXIgYj1hLmF0dHJpYnV0ZXMudmFsdWU7cmV0dXJuIWJ8fGIuc3BlY2lmaWVkP2EudmFsdWU6YS50ZXh0fX0sc2VsZWN0OntnZXQ6ZnVuY3Rpb24oYSl7dmFyIGIsYz1hLnNlbGVjdGVkSW5kZXgsZD1bXSxlPWEub3B0aW9ucyxnPWEudHlwZT09PSJzZWxlY3Qtb25lIjtpZihjPDApcmV0dXJuIG51bGw7Zm9yKHZhciBoPWc/YzowLGk9Zz9jKzE6ZS5sZW5ndGg7aDxpO2grKyl7dmFyIGo9ZVtoXTtpZihqLnNlbGVjdGVkJiYoZi5zdXBwb3J0Lm9wdERpc2FibGVkPyFqLmRpc2FibGVkOmouZ2V0QXR0cmlidXRlKCJkaXNhYmxlZCIpPT09bnVsbCkmJighai5wYXJlbnROb2RlLmRpc2FibGVkfHwhZi5ub2RlTmFtZShqLnBhcmVudE5vZGUsIm9wdGdyb3VwIikpKXtiPWYoaikudmFsKCk7aWYoZylyZXR1cm4gYjtkLnB1c2goYil9fWlmKGcmJiFkLmxlbmd0aCYmZS5sZW5ndGgpcmV0dXJuIGYoZVtjXSkudmFsKCk7cmV0dXJuIGR9LHNldDpmdW5jdGlvbihhLGIpe3ZhciBjPWYubWFrZUFycmF5KGIpO2YoYSkuZmluZCgib3B0aW9uIikuZWFjaChmdW5jdGlvbigpe3RoaXMuc2VsZWN0ZWQ9Zi5pbkFycmF5KGYodGhpcykudmFsKCksYyk+PTB9KSxjLmxlbmd0aHx8KGEuc2VsZWN0ZWRJbmRleD0tMSk7cmV0dXJuIGN9fX0sYXR0ckZuOnt2YWw6ITAsY3NzOiEwLGh0bWw6ITAsdGV4dDohMCxkYXRhOiEwLHdpZHRoOiEwLGhlaWdodDohMCxvZmZzZXQ6ITB9LGF0dHJGaXg6e3RhYmluZGV4OiJ0YWJJbmRleCJ9LGF0dHI6ZnVuY3Rpb24oYSxjLGQsZSl7dmFyIGc9YS5ub2RlVHlwZTtpZighYXx8Zz09PTN8fGc9PT04fHxnPT09MilyZXR1cm4gYjtpZihlJiZjIGluIGYuYXR0ckZuKXJldHVybiBmKGEpW2NdKGQpO2lmKCEoImdldEF0dHJpYnV0ZSJpbiBhKSlyZXR1cm4gZi5wcm9wKGEsYyxkKTt2YXIgaCxpLGo9ZyE9PTF8fCFmLmlzWE1MRG9jKGEpO2M9aiYmZi5hdHRyRml4W2NdfHxjLGk9Zi5hdHRySG9va3NbY10saXx8KCF0LnRlc3QoYyl8fHR5cGVvZiBkIT0iYm9vbGVhbiImJmQhPT1iJiZkLnRvTG93ZXJDYXNlKCkhPT1jLnRvTG93ZXJDYXNlKCk/diYmKGYubm9kZU5hbWUoYSwiZm9ybSIpfHx1LnRlc3QoYykpJiYoaT12KTppPXcpO2lmKGQhPT1iKXtpZihkPT09bnVsbCl7Zi5yZW1vdmVBdHRyKGEsYyk7cmV0dXJuIGJ9aWYoaSYmInNldCJpbiBpJiZqJiYoaD1pLnNldChhLGQsYykpIT09YilyZXR1cm4gaDthLnNldEF0dHJpYnV0ZShjLCIiK2QpO3JldHVybiBkfWlmKGkmJiJnZXQiaW4gaSYmailyZXR1cm4gaS5nZXQoYSxjKTtoPWEuZ2V0QXR0cmlidXRlKGMpO3JldHVybiBoPT09bnVsbD9iOmh9LHJlbW92ZUF0dHI6ZnVuY3Rpb24oYSxiKXt2YXIgYzthLm5vZGVUeXBlPT09MSYmKGI9Zi5hdHRyRml4W2JdfHxiLGYuc3VwcG9ydC5nZXRTZXRBdHRyaWJ1dGU/YS5yZW1vdmVBdHRyaWJ1dGUoYik6KGYuYXR0cihhLGIsIiIpLGEucmVtb3ZlQXR0cmlidXRlTm9kZShhLmdldEF0dHJpYnV0ZU5vZGUoYikpKSx0LnRlc3QoYikmJihjPWYucHJvcEZpeFtiXXx8YilpbiBhJiYoYVtjXT0hMSkpfSxhdHRySG9va3M6e3R5cGU6e3NldDpmdW5jdGlvbihhLGIpe2lmKHEudGVzdChhLm5vZGVOYW1lKSYmYS5wYXJlbnROb2RlKWYuZXJyb3IoInR5cGUgcHJvcGVydHkgY2FuJ3QgYmUgY2hhbmdlZCIpO2Vsc2UgaWYoIWYuc3VwcG9ydC5yYWRpb1ZhbHVlJiZiPT09InJhZGlvIiYmZi5ub2RlTmFtZShhLCJpbnB1dCIpKXt2YXIgYz1hLnZhbHVlO2Euc2V0QXR0cmlidXRlKCJ0eXBlIixiKSxjJiYoYS52YWx1ZT1jKTtyZXR1cm4gYn19fSx0YWJJbmRleDp7Z2V0OmZ1bmN0aW9uKGEpe3ZhciBjPWEuZ2V0QXR0cmlidXRlTm9kZSgidGFiSW5kZXgiKTtyZXR1cm4gYyYmYy5zcGVjaWZpZWQ/cGFyc2VJbnQoYy52YWx1ZSwxMCk6ci50ZXN0KGEubm9kZU5hbWUpfHxzLnRlc3QoYS5ub2RlTmFtZSkmJmEuaHJlZj8wOmJ9fX0scHJvcEZpeDp7dGFiaW5kZXg6InRhYkluZGV4IixyZWFkb25seToicmVhZE9ubHkiLCJmb3IiOiJodG1sRm9yIiwiY2xhc3MiOiJjbGFzc05hbWUiLG1heGxlbmd0aDoibWF4TGVuZ3RoIixjZWxsc3BhY2luZzoiY2VsbFNwYWNpbmciLGNlbGxwYWRkaW5nOiJjZWxsUGFkZGluZyIscm93c3Bhbjoicm93U3BhbiIsY29sc3BhbjoiY29sU3BhbiIsdXNlbWFwOiJ1c2VNYXAiLGZyYW1lYm9yZGVyOiJmcmFtZUJvcmRlciIsY29udGVudGVkaXRhYmxlOiJjb250ZW50RWRpdGFibGUifSxwcm9wOmZ1bmN0aW9uKGEsYyxkKXt2YXIgZT1hLm5vZGVUeXBlO2lmKCFhfHxlPT09M3x8ZT09PTh8fGU9PT0yKXJldHVybiBiO3ZhciBnLGgsaT1lIT09MXx8IWYuaXNYTUxEb2MoYSk7Yz1pJiZmLnByb3BGaXhbY118fGMsaD1mLnByb3BIb29rc1tjXTtyZXR1cm4gZCE9PWI/aCYmInNldCJpbiBoJiYoZz1oLnNldChhLGQsYykpIT09Yj9nOmFbY109ZDpoJiYiZ2V0ImluIGgmJihnPWguZ2V0KGEsYykpIT09Yj9nOmFbY119LHByb3BIb29rczp7fX0pLHc9e2dldDpmdW5jdGlvbihhLGMpe3JldHVybiBhW2YucHJvcEZpeFtjXXx8Y10/Yy50b0xvd2VyQ2FzZSgpOmJ9LHNldDpmdW5jdGlvbihhLGIsYyl7dmFyIGQ7Yj09PSExP2YucmVtb3ZlQXR0cihhLGMpOihkPWYucHJvcEZpeFtjXXx8YyxkIGluIGEmJihhW2RdPWIpLGEuc2V0QXR0cmlidXRlKGMsYy50b0xvd2VyQ2FzZSgpKSk7cmV0dXJuIGN9fSxmLmF0dHJIb29rcy52YWx1ZT17Z2V0OmZ1bmN0aW9uKGEsYil7aWYodiYmZi5ub2RlTmFtZShhLCJidXR0b24iKSlyZXR1cm4gdi5nZXQoYSxiKTtyZXR1cm4gYS52YWx1ZX0sc2V0OmZ1bmN0aW9uKGEsYixjKXtpZih2JiZmLm5vZGVOYW1lKGEsImJ1dHRvbiIpKXJldHVybiB2LnNldChhLGIsYyk7YS52YWx1ZT1ifX0sZi5zdXBwb3J0LmdldFNldEF0dHJpYnV0ZXx8KGYuYXR0ckZpeD1mLnByb3BGaXgsdj1mLmF0dHJIb29rcy5uYW1lPWYudmFsSG9va3MuYnV0dG9uPXtnZXQ6ZnVuY3Rpb24oYSxjKXt2YXIgZDtkPWEuZ2V0QXR0cmlidXRlTm9kZShjKTtyZXR1cm4gZCYmZC5ub2RlVmFsdWUhPT0iIj9kLm5vZGVWYWx1ZTpifSxzZXQ6ZnVuY3Rpb24oYSxiLGMpe3ZhciBkPWEuZ2V0QXR0cmlidXRlTm9kZShjKTtpZihkKXtkLm5vZGVWYWx1ZT1iO3JldHVybiBifX19LGYuZWFjaChbIndpZHRoIiwiaGVpZ2h0Il0sZnVuY3Rpb24oYSxiKXtmLmF0dHJIb29rc1tiXT1mLmV4dGVuZChmLmF0dHJIb29rc1tiXSx7c2V0OmZ1bmN0aW9uKGEsYyl7aWYoYz09PSIiKXthLnNldEF0dHJpYnV0ZShiLCJhdXRvIik7cmV0dXJuIGN9fX0pfSkpLGYuc3VwcG9ydC5ocmVmTm9ybWFsaXplZHx8Zi5lYWNoKFsiaHJlZiIsInNyYyIsIndpZHRoIiwiaGVpZ2h0Il0sZnVuY3Rpb24oYSxjKXtmLmF0dHJIb29rc1tjXT1mLmV4dGVuZChmLmF0dHJIb29rc1tjXSx7Z2V0OmZ1bmN0aW9uKGEpe3ZhciBkPWEuZ2V0QXR0cmlidXRlKGMsMik7cmV0dXJuIGQ9PT1udWxsP2I6ZH19KX0pLGYuc3VwcG9ydC5zdHlsZXx8KGYuYXR0ckhvb2tzLnN0eWxlPXtnZXQ6ZnVuY3Rpb24oYSl7cmV0dXJuIGEuc3R5bGUuY3NzVGV4dC50b0xvd2VyQ2FzZSgpfHxifSxzZXQ6ZnVuY3Rpb24oYSxiKXtyZXR1cm4gYS5zdHlsZS5jc3NUZXh0PSIiK2J9fSksZi5zdXBwb3J0Lm9wdFNlbGVjdGVkfHwoZi5wcm9wSG9va3Muc2VsZWN0ZWQ9Zi5leHRlbmQoZi5wcm9wSG9va3Muc2VsZWN0ZWQse2dldDpmdW5jdGlvbihhKXt2YXIgYj1hLnBhcmVudE5vZGU7YiYmKGIuc2VsZWN0ZWRJbmRleCxiLnBhcmVudE5vZGUmJmIucGFyZW50Tm9kZS5zZWxlY3RlZEluZGV4KX19KSksZi5zdXBwb3J0LmNoZWNrT258fGYuZWFjaChbInJhZGlvIiwiY2hlY2tib3giXSxmdW5jdGlvbigpe2YudmFsSG9va3NbdGhpc109e2dldDpmdW5jdGlvbihhKXtyZXR1cm4gYS5nZXRBdHRyaWJ1dGUoInZhbHVlIik9PT1udWxsPyJvbiI6YS52YWx1ZX19fSksZi5lYWNoKFsicmFkaW8iLCJjaGVja2JveCJdLGZ1bmN0aW9uKCl7Zi52YWxIb29rc1t0aGlzXT1mLmV4dGVuZChmLnZhbEhvb2tzW3RoaXNdLHtzZXQ6ZnVuY3Rpb24oYSxiKXtpZihmLmlzQXJyYXkoYikpcmV0dXJuIGEuY2hlY2tlZD1mLmluQXJyYXkoZihhKS52YWwoKSxiKT49MH19KX0pO3ZhciB4PU9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkseT0vXC4oLiopJC8sej0vXig/OnRleHRhcmVhfGlucHV0fHNlbGVjdCkkL2ksQT0vXC4vZyxCPS8gL2csQz0vW15cd1xzLnxgXS9nLEQ9ZnVuY3Rpb24oYSl7cmV0dXJuIGEucmVwbGFjZShDLCJcXCQmIil9O2YuZXZlbnQ9e2FkZDpmdW5jdGlvbihhLGMsZCxlKXtpZihhLm5vZGVUeXBlIT09MyYmYS5ub2RlVHlwZSE9PTgpe2lmKGQ9PT0hMSlkPUU7ZWxzZSBpZighZClyZXR1cm47dmFyIGcsaDtkLmhhbmRsZXImJihnPWQsZD1nLmhhbmRsZXIpLGQuZ3VpZHx8KGQuZ3VpZD1mLmd1aWQrKyk7dmFyIGk9Zi5fZGF0YShhKTtpZighaSlyZXR1cm47dmFyIGo9aS5ldmVudHMsaz1pLmhhbmRsZTtqfHwoaS5ldmVudHM9aj17fSksa3x8KGkuaGFuZGxlPWs9ZnVuY3Rpb24oYSl7cmV0dXJuIHR5cGVvZiBmIT0idW5kZWZpbmVkIiYmKCFhfHxmLmV2ZW50LnRyaWdnZXJlZCE9PWEudHlwZSk/Zi5ldmVudC5oYW5kbGUuYXBwbHkoay5lbGVtLGFyZ3VtZW50cyk6Yn0pLGsuZWxlbT1hLGM9Yy5zcGxpdCgiICIpO3ZhciBsLG09MCxuO3doaWxlKGw9Y1ttKytdKXtoPWc/Zi5leHRlbmQoe30sZyk6e2hhbmRsZXI6ZCxkYXRhOmV9LGwuaW5kZXhPZigiLiIpPi0xPyhuPWwuc3BsaXQoIi4iKSxsPW4uc2hpZnQoKSxoLm5hbWVzcGFjZT1uLnNsaWNlKDApLnNvcnQoKS5qb2luKCIuIikpOihuPVtdLGgubmFtZXNwYWNlPSIiKSxoLnR5cGU9bCxoLmd1aWR8fChoLmd1aWQ9ZC5ndWlkKTt2YXIgbz1qW2xdLHA9Zi5ldmVudC5zcGVjaWFsW2xdfHx7fTtpZighbyl7bz1qW2xdPVtdO2lmKCFwLnNldHVwfHxwLnNldHVwLmNhbGwoYSxlLG4sayk9PT0hMSlhLmFkZEV2ZW50TGlzdGVuZXI/YS5hZGRFdmVudExpc3RlbmVyKGwsaywhMSk6YS5hdHRhY2hFdmVudCYmYS5hdHRhY2hFdmVudCgib24iK2wsayl9cC5hZGQmJihwLmFkZC5jYWxsKGEsaCksaC5oYW5kbGVyLmd1aWR8fChoLmhhbmRsZXIuZ3VpZD1kLmd1aWQpKSxvLnB1c2goaCksZi5ldmVudC5nbG9iYWxbbF09ITB9YT1udWxsfX0sZ2xvYmFsOnt9LHJlbW92ZTpmdW5jdGlvbihhLGMsZCxlKXtpZihhLm5vZGVUeXBlIT09MyYmYS5ub2RlVHlwZSE9PTgpe2Q9PT0hMSYmKGQ9RSk7dmFyIGcsaCxpLGosaz0wLGwsbSxuLG8scCxxLHIscz1mLmhhc0RhdGEoYSkmJmYuX2RhdGEoYSksdD1zJiZzLmV2ZW50cztpZighc3x8IXQpcmV0dXJuO2MmJmMudHlwZSYmKGQ9Yy5oYW5kbGVyLGM9Yy50eXBlKTtpZighY3x8dHlwZW9mIGM9PSJzdHJpbmciJiZjLmNoYXJBdCgwKT09PSIuIil7Yz1jfHwiIjtmb3IoaCBpbiB0KWYuZXZlbnQucmVtb3ZlKGEsaCtjKTtyZXR1cm59Yz1jLnNwbGl0KCIgIik7d2hpbGUoaD1jW2srK10pe3I9aCxxPW51bGwsbD1oLmluZGV4T2YoIi4iKTwwLG09W10sbHx8KG09aC5zcGxpdCgiLiIpLGg9bS5zaGlmdCgpLG49bmV3IFJlZ0V4cCgiKF58XFwuKSIrZi5tYXAobS5zbGljZSgwKS5zb3J0KCksRCkuam9pbigiXFwuKD86LipcXC4pPyIpKyIoXFwufCQpIikpLHA9dFtoXTtpZighcCljb250aW51ZTtpZighZCl7Zm9yKGo9MDtqPHAubGVuZ3RoO2orKyl7cT1wW2pdO2lmKGx8fG4udGVzdChxLm5hbWVzcGFjZSkpZi5ldmVudC5yZW1vdmUoYSxyLHEuaGFuZGxlcixqKSxwLnNwbGljZShqLS0sMSl9Y29udGludWV9bz1mLmV2ZW50LnNwZWNpYWxbaF18fHt9O2ZvcihqPWV8fDA7ajxwLmxlbmd0aDtqKyspe3E9cFtqXTtpZihkLmd1aWQ9PT1xLmd1aWQpe2lmKGx8fG4udGVzdChxLm5hbWVzcGFjZSkpZT09bnVsbCYmcC5zcGxpY2Uoai0tLDEpLG8ucmVtb3ZlJiZvLnJlbW92ZS5jYWxsKGEscSk7aWYoZSE9bnVsbClicmVha319aWYocC5sZW5ndGg9PT0wfHxlIT1udWxsJiZwLmxlbmd0aD09PTEpKCFvLnRlYXJkb3dufHxvLnRlYXJkb3duLmNhbGwoYSxtKT09PSExKSYmZi5yZW1vdmVFdmVudChhLGgscy5oYW5kbGUpLGc9bnVsbCxkZWxldGUgdFtoXX1pZihmLmlzRW1wdHlPYmplY3QodCkpe3ZhciB1PXMuaGFuZGxlO3UmJih1LmVsZW09bnVsbCksZGVsZXRlIHMuZXZlbnRzLGRlbGV0ZSBzLmhhbmRsZSxmLmlzRW1wdHlPYmplY3QocykmJmYucmVtb3ZlRGF0YShhLGIsITApfX19LGN1c3RvbUV2ZW50OntnZXREYXRhOiEwLHNldERhdGE6ITAsY2hhbmdlRGF0YTohMH0sdHJpZ2dlcjpmdW5jdGlvbihjLGQsZSxnKXt2YXIgaD1jLnR5cGV8fGMsaT1bXSxqO2guaW5kZXhPZigiISIpPj0wJiYoaD1oLnNsaWNlKDAsLTEpLGo9ITApLGguaW5kZXhPZigiLiIpPj0wJiYoaT1oLnNwbGl0KCIuIiksaD1pLnNoaWZ0KCksaS5zb3J0KCkpO2lmKCEhZSYmIWYuZXZlbnQuY3VzdG9tRXZlbnRbaF18fCEhZi5ldmVudC5nbG9iYWxbaF0pe2M9dHlwZW9mIGM9PSJvYmplY3QiP2NbZi5leHBhbmRvXT9jOm5ldyBmLkV2ZW50KGgsYyk6bmV3IGYuRXZlbnQoaCksYy50eXBlPWgsYy5leGNsdXNpdmU9aixjLm5hbWVzcGFjZT1pLmpvaW4oIi4iKSxjLm5hbWVzcGFjZV9yZT1uZXcgUmVnRXhwKCIoXnxcXC4pIitpLmpvaW4oIlxcLig/Oi4qXFwuKT8iKSsiKFxcLnwkKSIpO2lmKGd8fCFlKWMucHJldmVudERlZmF1bHQoKSxjLnN0b3BQcm9wYWdhdGlvbigpO2lmKCFlKXtmLmVhY2goZi5jYWNoZSxmdW5jdGlvbigpe3ZhciBhPWYuZXhwYW5kbyxiPXRoaXNbYV07YiYmYi5ldmVudHMmJmIuZXZlbnRzW2hdJiZmLmV2ZW50LnRyaWdnZXIoYyxkLGIuaGFuZGxlLmVsZW0KKX0pO3JldHVybn1pZihlLm5vZGVUeXBlPT09M3x8ZS5ub2RlVHlwZT09PTgpcmV0dXJuO2MucmVzdWx0PWIsYy50YXJnZXQ9ZSxkPWQ/Zi5tYWtlQXJyYXkoZCk6W10sZC51bnNoaWZ0KGMpO3ZhciBrPWUsbD1oLmluZGV4T2YoIjoiKTwwPyJvbiIraDoiIjtkb3t2YXIgbT1mLl9kYXRhKGssImhhbmRsZSIpO2MuY3VycmVudFRhcmdldD1rLG0mJm0uYXBwbHkoayxkKSxsJiZmLmFjY2VwdERhdGEoaykmJmtbbF0mJmtbbF0uYXBwbHkoayxkKT09PSExJiYoYy5yZXN1bHQ9ITEsYy5wcmV2ZW50RGVmYXVsdCgpKSxrPWsucGFyZW50Tm9kZXx8ay5vd25lckRvY3VtZW50fHxrPT09Yy50YXJnZXQub3duZXJEb2N1bWVudCYmYX13aGlsZShrJiYhYy5pc1Byb3BhZ2F0aW9uU3RvcHBlZCgpKTtpZighYy5pc0RlZmF1bHRQcmV2ZW50ZWQoKSl7dmFyIG4sbz1mLmV2ZW50LnNwZWNpYWxbaF18fHt9O2lmKCghby5fZGVmYXVsdHx8by5fZGVmYXVsdC5jYWxsKGUub3duZXJEb2N1bWVudCxjKT09PSExKSYmKGghPT0iY2xpY2sifHwhZi5ub2RlTmFtZShlLCJhIikpJiZmLmFjY2VwdERhdGEoZSkpe3RyeXtsJiZlW2hdJiYobj1lW2xdLG4mJihlW2xdPW51bGwpLGYuZXZlbnQudHJpZ2dlcmVkPWgsZVtoXSgpKX1jYXRjaChwKXt9biYmKGVbbF09biksZi5ldmVudC50cmlnZ2VyZWQ9Yn19cmV0dXJuIGMucmVzdWx0fX0saGFuZGxlOmZ1bmN0aW9uKGMpe2M9Zi5ldmVudC5maXgoY3x8YS5ldmVudCk7dmFyIGQ9KChmLl9kYXRhKHRoaXMsImV2ZW50cyIpfHx7fSlbYy50eXBlXXx8W10pLnNsaWNlKDApLGU9IWMuZXhjbHVzaXZlJiYhYy5uYW1lc3BhY2UsZz1BcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsMCk7Z1swXT1jLGMuY3VycmVudFRhcmdldD10aGlzO2Zvcih2YXIgaD0wLGk9ZC5sZW5ndGg7aDxpO2grKyl7dmFyIGo9ZFtoXTtpZihlfHxjLm5hbWVzcGFjZV9yZS50ZXN0KGoubmFtZXNwYWNlKSl7Yy5oYW5kbGVyPWouaGFuZGxlcixjLmRhdGE9ai5kYXRhLGMuaGFuZGxlT2JqPWo7dmFyIGs9ai5oYW5kbGVyLmFwcGx5KHRoaXMsZyk7ayE9PWImJihjLnJlc3VsdD1rLGs9PT0hMSYmKGMucHJldmVudERlZmF1bHQoKSxjLnN0b3BQcm9wYWdhdGlvbigpKSk7aWYoYy5pc0ltbWVkaWF0ZVByb3BhZ2F0aW9uU3RvcHBlZCgpKWJyZWFrfX1yZXR1cm4gYy5yZXN1bHR9LHByb3BzOiJhbHRLZXkgYXR0ckNoYW5nZSBhdHRyTmFtZSBidWJibGVzIGJ1dHRvbiBjYW5jZWxhYmxlIGNoYXJDb2RlIGNsaWVudFggY2xpZW50WSBjdHJsS2V5IGN1cnJlbnRUYXJnZXQgZGF0YSBkZXRhaWwgZXZlbnRQaGFzZSBmcm9tRWxlbWVudCBoYW5kbGVyIGtleUNvZGUgbGF5ZXJYIGxheWVyWSBtZXRhS2V5IG5ld1ZhbHVlIG9mZnNldFggb2Zmc2V0WSBwYWdlWCBwYWdlWSBwcmV2VmFsdWUgcmVsYXRlZE5vZGUgcmVsYXRlZFRhcmdldCBzY3JlZW5YIHNjcmVlblkgc2hpZnRLZXkgc3JjRWxlbWVudCB0YXJnZXQgdG9FbGVtZW50IHZpZXcgd2hlZWxEZWx0YSB3aGljaCIuc3BsaXQoIiAiKSxmaXg6ZnVuY3Rpb24oYSl7aWYoYVtmLmV4cGFuZG9dKXJldHVybiBhO3ZhciBkPWE7YT1mLkV2ZW50KGQpO2Zvcih2YXIgZT10aGlzLnByb3BzLmxlbmd0aCxnO2U7KWc9dGhpcy5wcm9wc1stLWVdLGFbZ109ZFtnXTthLnRhcmdldHx8KGEudGFyZ2V0PWEuc3JjRWxlbWVudHx8YyksYS50YXJnZXQubm9kZVR5cGU9PT0zJiYoYS50YXJnZXQ9YS50YXJnZXQucGFyZW50Tm9kZSksIWEucmVsYXRlZFRhcmdldCYmYS5mcm9tRWxlbWVudCYmKGEucmVsYXRlZFRhcmdldD1hLmZyb21FbGVtZW50PT09YS50YXJnZXQ/YS50b0VsZW1lbnQ6YS5mcm9tRWxlbWVudCk7aWYoYS5wYWdlWD09bnVsbCYmYS5jbGllbnRYIT1udWxsKXt2YXIgaD1hLnRhcmdldC5vd25lckRvY3VtZW50fHxjLGk9aC5kb2N1bWVudEVsZW1lbnQsaj1oLmJvZHk7YS5wYWdlWD1hLmNsaWVudFgrKGkmJmkuc2Nyb2xsTGVmdHx8aiYmai5zY3JvbGxMZWZ0fHwwKS0oaSYmaS5jbGllbnRMZWZ0fHxqJiZqLmNsaWVudExlZnR8fDApLGEucGFnZVk9YS5jbGllbnRZKyhpJiZpLnNjcm9sbFRvcHx8aiYmai5zY3JvbGxUb3B8fDApLShpJiZpLmNsaWVudFRvcHx8aiYmai5jbGllbnRUb3B8fDApfWEud2hpY2g9PW51bGwmJihhLmNoYXJDb2RlIT1udWxsfHxhLmtleUNvZGUhPW51bGwpJiYoYS53aGljaD1hLmNoYXJDb2RlIT1udWxsP2EuY2hhckNvZGU6YS5rZXlDb2RlKSwhYS5tZXRhS2V5JiZhLmN0cmxLZXkmJihhLm1ldGFLZXk9YS5jdHJsS2V5KSwhYS53aGljaCYmYS5idXR0b24hPT1iJiYoYS53aGljaD1hLmJ1dHRvbiYxPzE6YS5idXR0b24mMj8zOmEuYnV0dG9uJjQ/MjowKTtyZXR1cm4gYX0sZ3VpZDoxZTgscHJveHk6Zi5wcm94eSxzcGVjaWFsOntyZWFkeTp7c2V0dXA6Zi5iaW5kUmVhZHksdGVhcmRvd246Zi5ub29wfSxsaXZlOnthZGQ6ZnVuY3Rpb24oYSl7Zi5ldmVudC5hZGQodGhpcyxPKGEub3JpZ1R5cGUsYS5zZWxlY3RvciksZi5leHRlbmQoe30sYSx7aGFuZGxlcjpOLGd1aWQ6YS5oYW5kbGVyLmd1aWR9KSl9LHJlbW92ZTpmdW5jdGlvbihhKXtmLmV2ZW50LnJlbW92ZSh0aGlzLE8oYS5vcmlnVHlwZSxhLnNlbGVjdG9yKSxhKX19LGJlZm9yZXVubG9hZDp7c2V0dXA6ZnVuY3Rpb24oYSxiLGMpe2YuaXNXaW5kb3codGhpcykmJih0aGlzLm9uYmVmb3JldW5sb2FkPWMpfSx0ZWFyZG93bjpmdW5jdGlvbihhLGIpe3RoaXMub25iZWZvcmV1bmxvYWQ9PT1iJiYodGhpcy5vbmJlZm9yZXVubG9hZD1udWxsKX19fX0sZi5yZW1vdmVFdmVudD1jLnJlbW92ZUV2ZW50TGlzdGVuZXI/ZnVuY3Rpb24oYSxiLGMpe2EucmVtb3ZlRXZlbnRMaXN0ZW5lciYmYS5yZW1vdmVFdmVudExpc3RlbmVyKGIsYywhMSl9OmZ1bmN0aW9uKGEsYixjKXthLmRldGFjaEV2ZW50JiZhLmRldGFjaEV2ZW50KCJvbiIrYixjKX0sZi5FdmVudD1mdW5jdGlvbihhLGIpe2lmKCF0aGlzLnByZXZlbnREZWZhdWx0KXJldHVybiBuZXcgZi5FdmVudChhLGIpO2EmJmEudHlwZT8odGhpcy5vcmlnaW5hbEV2ZW50PWEsdGhpcy50eXBlPWEudHlwZSx0aGlzLmlzRGVmYXVsdFByZXZlbnRlZD1hLmRlZmF1bHRQcmV2ZW50ZWR8fGEucmV0dXJuVmFsdWU9PT0hMXx8YS5nZXRQcmV2ZW50RGVmYXVsdCYmYS5nZXRQcmV2ZW50RGVmYXVsdCgpP0Y6RSk6dGhpcy50eXBlPWEsYiYmZi5leHRlbmQodGhpcyxiKSx0aGlzLnRpbWVTdGFtcD1mLm5vdygpLHRoaXNbZi5leHBhbmRvXT0hMH0sZi5FdmVudC5wcm90b3R5cGU9e3ByZXZlbnREZWZhdWx0OmZ1bmN0aW9uKCl7dGhpcy5pc0RlZmF1bHRQcmV2ZW50ZWQ9Rjt2YXIgYT10aGlzLm9yaWdpbmFsRXZlbnQ7IWF8fChhLnByZXZlbnREZWZhdWx0P2EucHJldmVudERlZmF1bHQoKTphLnJldHVyblZhbHVlPSExKX0sc3RvcFByb3BhZ2F0aW9uOmZ1bmN0aW9uKCl7dGhpcy5pc1Byb3BhZ2F0aW9uU3RvcHBlZD1GO3ZhciBhPXRoaXMub3JpZ2luYWxFdmVudDshYXx8KGEuc3RvcFByb3BhZ2F0aW9uJiZhLnN0b3BQcm9wYWdhdGlvbigpLGEuY2FuY2VsQnViYmxlPSEwKX0sc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uOmZ1bmN0aW9uKCl7dGhpcy5pc0ltbWVkaWF0ZVByb3BhZ2F0aW9uU3RvcHBlZD1GLHRoaXMuc3RvcFByb3BhZ2F0aW9uKCl9LGlzRGVmYXVsdFByZXZlbnRlZDpFLGlzUHJvcGFnYXRpb25TdG9wcGVkOkUsaXNJbW1lZGlhdGVQcm9wYWdhdGlvblN0b3BwZWQ6RX07dmFyIEc9ZnVuY3Rpb24oYSl7dmFyIGI9YS5yZWxhdGVkVGFyZ2V0O2EudHlwZT1hLmRhdGE7dHJ5e2lmKGImJmIhPT1jJiYhYi5wYXJlbnROb2RlKXJldHVybjt3aGlsZShiJiZiIT09dGhpcyliPWIucGFyZW50Tm9kZTtiIT09dGhpcyYmZi5ldmVudC5oYW5kbGUuYXBwbHkodGhpcyxhcmd1bWVudHMpfWNhdGNoKGQpe319LEg9ZnVuY3Rpb24oYSl7YS50eXBlPWEuZGF0YSxmLmV2ZW50LmhhbmRsZS5hcHBseSh0aGlzLGFyZ3VtZW50cyl9O2YuZWFjaCh7bW91c2VlbnRlcjoibW91c2VvdmVyIixtb3VzZWxlYXZlOiJtb3VzZW91dCJ9LGZ1bmN0aW9uKGEsYil7Zi5ldmVudC5zcGVjaWFsW2FdPXtzZXR1cDpmdW5jdGlvbihjKXtmLmV2ZW50LmFkZCh0aGlzLGIsYyYmYy5zZWxlY3Rvcj9IOkcsYSl9LHRlYXJkb3duOmZ1bmN0aW9uKGEpe2YuZXZlbnQucmVtb3ZlKHRoaXMsYixhJiZhLnNlbGVjdG9yP0g6Ryl9fX0pLGYuc3VwcG9ydC5zdWJtaXRCdWJibGVzfHwoZi5ldmVudC5zcGVjaWFsLnN1Ym1pdD17c2V0dXA6ZnVuY3Rpb24oYSxiKXtpZighZi5ub2RlTmFtZSh0aGlzLCJmb3JtIikpZi5ldmVudC5hZGQodGhpcywiY2xpY2suc3BlY2lhbFN1Ym1pdCIsZnVuY3Rpb24oYSl7dmFyIGI9YS50YXJnZXQsYz1iLnR5cGU7KGM9PT0ic3VibWl0Inx8Yz09PSJpbWFnZSIpJiZmKGIpLmNsb3Nlc3QoImZvcm0iKS5sZW5ndGgmJkwoInN1Ym1pdCIsdGhpcyxhcmd1bWVudHMpfSksZi5ldmVudC5hZGQodGhpcywia2V5cHJlc3Muc3BlY2lhbFN1Ym1pdCIsZnVuY3Rpb24oYSl7dmFyIGI9YS50YXJnZXQsYz1iLnR5cGU7KGM9PT0idGV4dCJ8fGM9PT0icGFzc3dvcmQiKSYmZihiKS5jbG9zZXN0KCJmb3JtIikubGVuZ3RoJiZhLmtleUNvZGU9PT0xMyYmTCgic3VibWl0Iix0aGlzLGFyZ3VtZW50cyl9KTtlbHNlIHJldHVybiExfSx0ZWFyZG93bjpmdW5jdGlvbihhKXtmLmV2ZW50LnJlbW92ZSh0aGlzLCIuc3BlY2lhbFN1Ym1pdCIpfX0pO2lmKCFmLnN1cHBvcnQuY2hhbmdlQnViYmxlcyl7dmFyIEksSj1mdW5jdGlvbihhKXt2YXIgYj1hLnR5cGUsYz1hLnZhbHVlO2I9PT0icmFkaW8ifHxiPT09ImNoZWNrYm94Ij9jPWEuY2hlY2tlZDpiPT09InNlbGVjdC1tdWx0aXBsZSI/Yz1hLnNlbGVjdGVkSW5kZXg+LTE/Zi5tYXAoYS5vcHRpb25zLGZ1bmN0aW9uKGEpe3JldHVybiBhLnNlbGVjdGVkfSkuam9pbigiLSIpOiIiOmYubm9kZU5hbWUoYSwic2VsZWN0IikmJihjPWEuc2VsZWN0ZWRJbmRleCk7cmV0dXJuIGN9LEs9ZnVuY3Rpb24oYyl7dmFyIGQ9Yy50YXJnZXQsZSxnO2lmKCEhei50ZXN0KGQubm9kZU5hbWUpJiYhZC5yZWFkT25seSl7ZT1mLl9kYXRhKGQsIl9jaGFuZ2VfZGF0YSIpLGc9SihkKSwoYy50eXBlIT09ImZvY3Vzb3V0Inx8ZC50eXBlIT09InJhZGlvIikmJmYuX2RhdGEoZCwiX2NoYW5nZV9kYXRhIixnKTtpZihlPT09Ynx8Zz09PWUpcmV0dXJuO2lmKGUhPW51bGx8fGcpYy50eXBlPSJjaGFuZ2UiLGMubGl2ZUZpcmVkPWIsZi5ldmVudC50cmlnZ2VyKGMsYXJndW1lbnRzWzFdLGQpfX07Zi5ldmVudC5zcGVjaWFsLmNoYW5nZT17ZmlsdGVyczp7Zm9jdXNvdXQ6SyxiZWZvcmVkZWFjdGl2YXRlOkssY2xpY2s6ZnVuY3Rpb24oYSl7dmFyIGI9YS50YXJnZXQsYz1mLm5vZGVOYW1lKGIsImlucHV0Iik/Yi50eXBlOiIiOyhjPT09InJhZGlvInx8Yz09PSJjaGVja2JveCJ8fGYubm9kZU5hbWUoYiwic2VsZWN0IikpJiZLLmNhbGwodGhpcyxhKX0sa2V5ZG93bjpmdW5jdGlvbihhKXt2YXIgYj1hLnRhcmdldCxjPWYubm9kZU5hbWUoYiwiaW5wdXQiKT9iLnR5cGU6IiI7KGEua2V5Q29kZT09PTEzJiYhZi5ub2RlTmFtZShiLCJ0ZXh0YXJlYSIpfHxhLmtleUNvZGU9PT0zMiYmKGM9PT0iY2hlY2tib3gifHxjPT09InJhZGlvIil8fGM9PT0ic2VsZWN0LW11bHRpcGxlIikmJksuY2FsbCh0aGlzLGEpfSxiZWZvcmVhY3RpdmF0ZTpmdW5jdGlvbihhKXt2YXIgYj1hLnRhcmdldDtmLl9kYXRhKGIsIl9jaGFuZ2VfZGF0YSIsSihiKSl9fSxzZXR1cDpmdW5jdGlvbihhLGIpe2lmKHRoaXMudHlwZT09PSJmaWxlIilyZXR1cm4hMTtmb3IodmFyIGMgaW4gSSlmLmV2ZW50LmFkZCh0aGlzLGMrIi5zcGVjaWFsQ2hhbmdlIixJW2NdKTtyZXR1cm4gei50ZXN0KHRoaXMubm9kZU5hbWUpfSx0ZWFyZG93bjpmdW5jdGlvbihhKXtmLmV2ZW50LnJlbW92ZSh0aGlzLCIuc3BlY2lhbENoYW5nZSIpO3JldHVybiB6LnRlc3QodGhpcy5ub2RlTmFtZSl9fSxJPWYuZXZlbnQuc3BlY2lhbC5jaGFuZ2UuZmlsdGVycyxJLmZvY3VzPUkuYmVmb3JlYWN0aXZhdGV9Zi5zdXBwb3J0LmZvY3VzaW5CdWJibGVzfHxmLmVhY2goe2ZvY3VzOiJmb2N1c2luIixibHVyOiJmb2N1c291dCJ9LGZ1bmN0aW9uKGEsYil7ZnVuY3Rpb24gZShhKXt2YXIgYz1mLmV2ZW50LmZpeChhKTtjLnR5cGU9YixjLm9yaWdpbmFsRXZlbnQ9e30sZi5ldmVudC50cmlnZ2VyKGMsbnVsbCxjLnRhcmdldCksYy5pc0RlZmF1bHRQcmV2ZW50ZWQoKSYmYS5wcmV2ZW50RGVmYXVsdCgpfXZhciBkPTA7Zi5ldmVudC5zcGVjaWFsW2JdPXtzZXR1cDpmdW5jdGlvbigpe2QrKz09PTAmJmMuYWRkRXZlbnRMaXN0ZW5lcihhLGUsITApfSx0ZWFyZG93bjpmdW5jdGlvbigpey0tZD09PTAmJmMucmVtb3ZlRXZlbnRMaXN0ZW5lcihhLGUsITApfX19KSxmLmVhY2goWyJiaW5kIiwib25lIl0sZnVuY3Rpb24oYSxjKXtmLmZuW2NdPWZ1bmN0aW9uKGEsZCxlKXt2YXIgZztpZih0eXBlb2YgYT09Im9iamVjdCIpe2Zvcih2YXIgaCBpbiBhKXRoaXNbY10oaCxkLGFbaF0sZSk7cmV0dXJuIHRoaXN9aWYoYXJndW1lbnRzLmxlbmd0aD09PTJ8fGQ9PT0hMSllPWQsZD1iO2M9PT0ib25lIj8oZz1mdW5jdGlvbihhKXtmKHRoaXMpLnVuYmluZChhLGcpO3JldHVybiBlLmFwcGx5KHRoaXMsYXJndW1lbnRzKX0sZy5ndWlkPWUuZ3VpZHx8Zi5ndWlkKyspOmc9ZTtpZihhPT09InVubG9hZCImJmMhPT0ib25lIil0aGlzLm9uZShhLGQsZSk7ZWxzZSBmb3IodmFyIGk9MCxqPXRoaXMubGVuZ3RoO2k8ajtpKyspZi5ldmVudC5hZGQodGhpc1tpXSxhLGcsZCk7cmV0dXJuIHRoaXN9fSksZi5mbi5leHRlbmQoe3VuYmluZDpmdW5jdGlvbihhLGIpe2lmKHR5cGVvZiBhPT0ib2JqZWN0IiYmIWEucHJldmVudERlZmF1bHQpZm9yKHZhciBjIGluIGEpdGhpcy51bmJpbmQoYyxhW2NdKTtlbHNlIGZvcih2YXIgZD0wLGU9dGhpcy5sZW5ndGg7ZDxlO2QrKylmLmV2ZW50LnJlbW92ZSh0aGlzW2RdLGEsYik7cmV0dXJuIHRoaXN9LGRlbGVnYXRlOmZ1bmN0aW9uKGEsYixjLGQpe3JldHVybiB0aGlzLmxpdmUoYixjLGQsYSl9LHVuZGVsZWdhdGU6ZnVuY3Rpb24oYSxiLGMpe3JldHVybiBhcmd1bWVudHMubGVuZ3RoPT09MD90aGlzLnVuYmluZCgibGl2ZSIpOnRoaXMuZGllKGIsbnVsbCxjLGEpfSx0cmlnZ2VyOmZ1bmN0aW9uKGEsYil7cmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbigpe2YuZXZlbnQudHJpZ2dlcihhLGIsdGhpcyl9KX0sdHJpZ2dlckhhbmRsZXI6ZnVuY3Rpb24oYSxiKXtpZih0aGlzWzBdKXJldHVybiBmLmV2ZW50LnRyaWdnZXIoYSxiLHRoaXNbMF0sITApfSx0b2dnbGU6ZnVuY3Rpb24oYSl7dmFyIGI9YXJndW1lbnRzLGM9YS5ndWlkfHxmLmd1aWQrKyxkPTAsZT1mdW5jdGlvbihjKXt2YXIgZT0oZi5kYXRhKHRoaXMsImxhc3RUb2dnbGUiK2EuZ3VpZCl8fDApJWQ7Zi5kYXRhKHRoaXMsImxhc3RUb2dnbGUiK2EuZ3VpZCxlKzEpLGMucHJldmVudERlZmF1bHQoKTtyZXR1cm4gYltlXS5hcHBseSh0aGlzLGFyZ3VtZW50cyl8fCExfTtlLmd1aWQ9Yzt3aGlsZShkPGIubGVuZ3RoKWJbZCsrXS5ndWlkPWM7cmV0dXJuIHRoaXMuY2xpY2soZSl9LGhvdmVyOmZ1bmN0aW9uKGEsYil7cmV0dXJuIHRoaXMubW91c2VlbnRlcihhKS5tb3VzZWxlYXZlKGJ8fGEpfX0pO3ZhciBNPXtmb2N1czoiZm9jdXNpbiIsYmx1cjoiZm9jdXNvdXQiLG1vdXNlZW50ZXI6Im1vdXNlb3ZlciIsbW91c2VsZWF2ZToibW91c2VvdXQifTtmLmVhY2goWyJsaXZlIiwiZGllIl0sZnVuY3Rpb24oYSxjKXtmLmZuW2NdPWZ1bmN0aW9uKGEsZCxlLGcpe3ZhciBoLGk9MCxqLGssbCxtPWd8fHRoaXMuc2VsZWN0b3Isbj1nP3RoaXM6Zih0aGlzLmNvbnRleHQpO2lmKHR5cGVvZiBhPT0ib2JqZWN0IiYmIWEucHJldmVudERlZmF1bHQpe2Zvcih2YXIgbyBpbiBhKW5bY10obyxkLGFbb10sbSk7cmV0dXJuIHRoaXN9aWYoYz09PSJkaWUiJiYhYSYmZyYmZy5jaGFyQXQoMCk9PT0iLiIpe24udW5iaW5kKGcpO3JldHVybiB0aGlzfWlmKGQ9PT0hMXx8Zi5pc0Z1bmN0aW9uKGQpKWU9ZHx8RSxkPWI7YT0oYXx8IiIpLnNwbGl0KCIgIik7d2hpbGUoKGg9YVtpKytdKSE9bnVsbCl7aj15LmV4ZWMoaCksaz0iIixqJiYoaz1qWzBdLGg9aC5yZXBsYWNlKHksIiIpKTtpZihoPT09ImhvdmVyIil7YS5wdXNoKCJtb3VzZWVudGVyIitrLCJtb3VzZWxlYXZlIitrKTtjb250aW51ZX1sPWgsTVtoXT8oYS5wdXNoKE1baF0rayksaD1oK2spOmg9KE1baF18fGgpK2s7aWYoYz09PSJsaXZlIilmb3IodmFyIHA9MCxxPW4ubGVuZ3RoO3A8cTtwKyspZi5ldmVudC5hZGQobltwXSwibGl2ZS4iK08oaCxtKSx7ZGF0YTpkLHNlbGVjdG9yOm0saGFuZGxlcjplLG9yaWdUeXBlOmgsb3JpZ0hhbmRsZXI6ZSxwcmVUeXBlOmx9KTtlbHNlIG4udW5iaW5kKCJsaXZlLiIrTyhoLG0pLGUpfXJldHVybiB0aGlzfX0pLGYuZWFjaCgiYmx1ciBmb2N1cyBmb2N1c2luIGZvY3Vzb3V0IGxvYWQgcmVzaXplIHNjcm9sbCB1bmxvYWQgY2xpY2sgZGJsY2xpY2sgbW91c2Vkb3duIG1vdXNldXAgbW91c2Vtb3ZlIG1vdXNlb3ZlciBtb3VzZW91dCBtb3VzZWVudGVyIG1vdXNlbGVhdmUgY2hhbmdlIHNlbGVjdCBzdWJtaXQga2V5ZG93biBrZXlwcmVzcyBrZXl1cCBlcnJvciIuc3BsaXQoIiAiKSxmdW5jdGlvbihhLGIpe2YuZm5bYl09ZnVuY3Rpb24oYSxjKXtjPT1udWxsJiYoYz1hLGE9bnVsbCk7cmV0dXJuIGFyZ3VtZW50cy5sZW5ndGg+MD90aGlzLmJpbmQoYixhLGMpOnRoaXMudHJpZ2dlcihiKX0sZi5hdHRyRm4mJihmLmF0dHJGbltiXT0hMCl9KSxmdW5jdGlvbigpe2Z1bmN0aW9uIHUoYSxiLGMsZCxlLGYpe2Zvcih2YXIgZz0wLGg9ZC5sZW5ndGg7ZzxoO2crKyl7dmFyIGk9ZFtnXTtpZihpKXt2YXIgaj0hMTtpPWlbYV07d2hpbGUoaSl7aWYoaS5zaXpjYWNoZT09PWMpe2o9ZFtpLnNpenNldF07YnJlYWt9aWYoaS5ub2RlVHlwZT09PTEpe2Z8fChpLnNpemNhY2hlPWMsaS5zaXpzZXQ9Zyk7aWYodHlwZW9mIGIhPSJzdHJpbmciKXtpZihpPT09Yil7aj0hMDticmVha319ZWxzZSBpZihrLmZpbHRlcihiLFtpXSkubGVuZ3RoPjApe2o9aTticmVha319aT1pW2FdfWRbZ109an19fWZ1bmN0aW9uIHQoYSxiLGMsZCxlLGYpe2Zvcih2YXIgZz0wLGg9ZC5sZW5ndGg7ZzxoO2crKyl7dmFyIGk9ZFtnXTtpZihpKXt2YXIgaj0hMTtpPWlbYV07d2hpbGUoaSl7aWYoaS5zaXpjYWNoZT09PWMpe2o9ZFtpLnNpenNldF07YnJlYWt9aS5ub2RlVHlwZT09PTEmJiFmJiYoaS5zaXpjYWNoZT1jLGkuc2l6c2V0PWcpO2lmKGkubm9kZU5hbWUudG9Mb3dlckNhc2UoKT09PWIpe2o9aTticmVha31pPWlbYV19ZFtnXT1qfX19dmFyIGE9LygoPzpcKCg/OlwoW14oKV0rXCl8W14oKV0rKStcKXxcWyg/OlxbW15cW1xdXSpcXXxbJyJdW14nIl0qWyciXXxbXlxbXF0nIl0rKStcXXxcXC58W14gPit+LChcW1xcXSspK3xbPit+XSkoXHMqLFxzKik/KCg/Oi58XHJ8XG4pKikvZyxkPTAsZT1PYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLGc9ITEsaD0hMCxpPS9cXC9nLGo9L1xXLztbMCwwXS5zb3J0KGZ1bmN0aW9uKCl7aD0hMTtyZXR1cm4gMH0pO3ZhciBrPWZ1bmN0aW9uKGIsZCxmLGcpe2Y9Znx8W10sZD1kfHxjO3ZhciBoPWQ7aWYoZC5ub2RlVHlwZSE9PTEmJmQubm9kZVR5cGUhPT05KXJldHVybltdO2lmKCFifHx0eXBlb2YgYiE9InN0cmluZyIpcmV0dXJuIGY7dmFyIGksaixuLG8scSxyLHMsdCx1PSEwLHc9ay5pc1hNTChkKSx4PVtdLHk9Yjtkb3thLmV4ZWMoIiIpLGk9YS5leGVjKHkpO2lmKGkpe3k9aVszXSx4LnB1c2goaVsxXSk7aWYoaVsyXSl7bz1pWzNdO2JyZWFrfX19d2hpbGUoaSk7aWYoeC5sZW5ndGg+MSYmbS5leGVjKGIpKWlmKHgubGVuZ3RoPT09MiYmbC5yZWxhdGl2ZVt4WzBdXSlqPXYoeFswXSt4WzFdLGQpO2Vsc2V7aj1sLnJlbGF0aXZlW3hbMF1dP1tkXTprKHguc2hpZnQoKSxkKTt3aGlsZSh4Lmxlbmd0aCliPXguc2hpZnQoKSxsLnJlbGF0aXZlW2JdJiYoYis9eC5zaGlmdCgpKSxqPXYoYixqKX1lbHNleyFnJiZ4Lmxlbmd0aD4xJiZkLm5vZGVUeXBlPT09OSYmIXcmJmwubWF0Y2guSUQudGVzdCh4WzBdKSYmIWwubWF0Y2guSUQudGVzdCh4W3gubGVuZ3RoLTFdKSYmKHE9ay5maW5kKHguc2hpZnQoKSxkLHcpLGQ9cS5leHByP2suZmlsdGVyKHEuZXhwcixxLnNldClbMF06cS5zZXRbMF0pO2lmKGQpe3E9Zz97ZXhwcjp4LnBvcCgpLHNldDpwKGcpfTprLmZpbmQoeC5wb3AoKSx4Lmxlbmd0aD09PTEmJih4WzBdPT09In4ifHx4WzBdPT09IisiKSYmZC5wYXJlbnROb2RlP2QucGFyZW50Tm9kZTpkLHcpLGo9cS5leHByP2suZmlsdGVyKHEuZXhwcixxLnNldCk6cS5zZXQseC5sZW5ndGg+MD9uPXAoaik6dT0hMTt3aGlsZSh4Lmxlbmd0aClyPXgucG9wKCkscz1yLGwucmVsYXRpdmVbcl0/cz14LnBvcCgpOnI9IiIscz09bnVsbCYmKHM9ZCksbC5yZWxhdGl2ZVtyXShuLHMsdyl9ZWxzZSBuPXg9W119bnx8KG49aiksbnx8ay5lcnJvcihyfHxiKTtpZihlLmNhbGwobik9PT0iW29iamVjdCBBcnJheV0iKWlmKCF1KWYucHVzaC5hcHBseShmLG4pO2Vsc2UgaWYoZCYmZC5ub2RlVHlwZT09PTEpZm9yKHQ9MDtuW3RdIT1udWxsO3QrKyluW3RdJiYoblt0XT09PSEwfHxuW3RdLm5vZGVUeXBlPT09MSYmay5jb250YWlucyhkLG5bdF0pKSYmZi5wdXNoKGpbdF0pO2Vsc2UgZm9yKHQ9MDtuW3RdIT1udWxsO3QrKyluW3RdJiZuW3RdLm5vZGVUeXBlPT09MSYmZi5wdXNoKGpbdF0pO2Vsc2UgcChuLGYpO28mJihrKG8saCxmLGcpLGsudW5pcXVlU29ydChmKSk7cmV0dXJuIGZ9O2sudW5pcXVlU29ydD1mdW5jdGlvbihhKXtpZihyKXtnPWgsYS5zb3J0KHIpO2lmKGcpZm9yKHZhciBiPTE7YjxhLmxlbmd0aDtiKyspYVtiXT09PWFbYi0xXSYmYS5zcGxpY2UoYi0tLDEpfXJldHVybiBhfSxrLm1hdGNoZXM9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gayhhLG51bGwsbnVsbCxiKX0say5tYXRjaGVzU2VsZWN0b3I9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gayhiLG51bGwsbnVsbCxbYV0pLmxlbmd0aD4wfSxrLmZpbmQ9ZnVuY3Rpb24oYSxiLGMpe3ZhciBkO2lmKCFhKXJldHVybltdO2Zvcih2YXIgZT0wLGY9bC5vcmRlci5sZW5ndGg7ZTxmO2UrKyl7dmFyIGcsaD1sLm9yZGVyW2VdO2lmKGc9bC5sZWZ0TWF0Y2hbaF0uZXhlYyhhKSl7dmFyIGo9Z1sxXTtnLnNwbGljZSgxLDEpO2lmKGouc3Vic3RyKGoubGVuZ3RoLTEpIT09IlxcIil7Z1sxXT0oZ1sxXXx8IiIpLnJlcGxhY2UoaSwiIiksZD1sLmZpbmRbaF0oZyxiLGMpO2lmKGQhPW51bGwpe2E9YS5yZXBsYWNlKGwubWF0Y2hbaF0sIiIpO2JyZWFrfX19fWR8fChkPXR5cGVvZiBiLmdldEVsZW1lbnRzQnlUYWdOYW1lIT0idW5kZWZpbmVkIj9iLmdldEVsZW1lbnRzQnlUYWdOYW1lKCIqIik6W10pO3JldHVybntzZXQ6ZCxleHByOmF9fSxrLmZpbHRlcj1mdW5jdGlvbihhLGMsZCxlKXt2YXIgZixnLGg9YSxpPVtdLGo9YyxtPWMmJmNbMF0mJmsuaXNYTUwoY1swXSk7d2hpbGUoYSYmYy5sZW5ndGgpe2Zvcih2YXIgbiBpbiBsLmZpbHRlcilpZigoZj1sLmxlZnRNYXRjaFtuXS5leGVjKGEpKSE9bnVsbCYmZlsyXSl7dmFyIG8scCxxPWwuZmlsdGVyW25dLHI9ZlsxXTtnPSExLGYuc3BsaWNlKDEsMSk7aWYoci5zdWJzdHIoci5sZW5ndGgtMSk9PT0iXFwiKWNvbnRpbnVlO2o9PT1pJiYoaT1bXSk7aWYobC5wcmVGaWx0ZXJbbl0pe2Y9bC5wcmVGaWx0ZXJbbl0oZixqLGQsaSxlLG0pO2lmKCFmKWc9bz0hMDtlbHNlIGlmKGY9PT0hMCljb250aW51ZX1pZihmKWZvcih2YXIgcz0wOyhwPWpbc10pIT1udWxsO3MrKylpZihwKXtvPXEocCxmLHMsaik7dmFyIHQ9ZV4hIW87ZCYmbyE9bnVsbD90P2c9ITA6altzXT0hMTp0JiYoaS5wdXNoKHApLGc9ITApfWlmKG8hPT1iKXtkfHwoaj1pKSxhPWEucmVwbGFjZShsLm1hdGNoW25dLCIiKTtpZighZylyZXR1cm5bXTticmVha319aWYoYT09PWgpaWYoZz09bnVsbClrLmVycm9yKGEpO2Vsc2UgYnJlYWs7aD1hfXJldHVybiBqfSxrLmVycm9yPWZ1bmN0aW9uKGEpe3Rocm93IlN5bnRheCBlcnJvciwgdW5yZWNvZ25pemVkIGV4cHJlc3Npb246ICIrYX07dmFyIGw9ay5zZWxlY3RvcnM9e29yZGVyOlsiSUQiLCJOQU1FIiwiVEFHIl0sbWF0Y2g6e0lEOi8jKCg/Oltcd1x1MDBjMC1cdUZGRkZcLV18XFwuKSspLyxDTEFTUzovXC4oKD86W1x3XHUwMGMwLVx1RkZGRlwtXXxcXC4pKykvLE5BTUU6L1xbbmFtZT1bJyJdKigoPzpbXHdcdTAwYzAtXHVGRkZGXC1dfFxcLikrKVsnIl0qXF0vLEFUVFI6L1xbXHMqKCg/Oltcd1x1MDBjMC1cdUZGRkZcLV18XFwuKSspXHMqKD86KFxTPz0pXHMqKD86KFsnIl0pKC4qPylcM3woIz8oPzpbXHdcdTAwYzAtXHVGRkZGXC1dfFxcLikqKXwpfClccypcXS8sVEFHOi9eKCg/Oltcd1x1MDBjMC1cdUZGRkZcKlwtXXxcXC4pKykvLENISUxEOi86KG9ubHl8bnRofGxhc3R8Zmlyc3QpLWNoaWxkKD86XChccyooZXZlbnxvZGR8KD86WytcLV0/XGQrfCg/OlsrXC1dP1xkKik/blxzKig/OlsrXC1dXHMqXGQrKT8pKVxzKlwpKT8vLFBPUzovOihudGh8ZXF8Z3R8bHR8Zmlyc3R8bGFzdHxldmVufG9kZCkoPzpcKChcZCopXCkpPyg/PVteXC1dfCQpLyxQU0VVRE86LzooKD86W1x3XHUwMGMwLVx1RkZGRlwtXXxcXC4pKykoPzpcKChbJyJdPykoKD86XChbXlwpXStcKXxbXlwoXCldKikrKVwyXCkpPy99LGxlZnRNYXRjaDp7fSxhdHRyTWFwOnsiY2xhc3MiOiJjbGFzc05hbWUiLCJmb3IiOiJodG1sRm9yIn0sYXR0ckhhbmRsZTp7aHJlZjpmdW5jdGlvbihhKXtyZXR1cm4gYS5nZXRBdHRyaWJ1dGUoImhyZWYiKX0sdHlwZTpmdW5jdGlvbihhKXtyZXR1cm4gYS5nZXRBdHRyaWJ1dGUoInR5cGUiKX19LHJlbGF0aXZlOnsiKyI6ZnVuY3Rpb24oYSxiKXt2YXIgYz10eXBlb2YgYj09InN0cmluZyIsZD1jJiYhai50ZXN0KGIpLGU9YyYmIWQ7ZCYmKGI9Yi50b0xvd2VyQ2FzZSgpKTtmb3IodmFyIGY9MCxnPWEubGVuZ3RoLGg7ZjxnO2YrKylpZihoPWFbZl0pe3doaWxlKChoPWgucHJldmlvdXNTaWJsaW5nKSYmaC5ub2RlVHlwZSE9PTEpO2FbZl09ZXx8aCYmaC5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpPT09Yj9ofHwhMTpoPT09Yn1lJiZrLmZpbHRlcihiLGEsITApfSwiPiI6ZnVuY3Rpb24oYSxiKXt2YXIgYyxkPXR5cGVvZiBiPT0ic3RyaW5nIixlPTAsZj1hLmxlbmd0aDtpZihkJiYhai50ZXN0KGIpKXtiPWIudG9Mb3dlckNhc2UoKTtmb3IoO2U8ZjtlKyspe2M9YVtlXTtpZihjKXt2YXIgZz1jLnBhcmVudE5vZGU7YVtlXT1nLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCk9PT1iP2c6ITF9fX1lbHNle2Zvcig7ZTxmO2UrKyljPWFbZV0sYyYmKGFbZV09ZD9jLnBhcmVudE5vZGU6Yy5wYXJlbnROb2RlPT09Yik7ZCYmay5maWx0ZXIoYixhLCEwKX19LCIiOmZ1bmN0aW9uKGEsYixjKXt2YXIgZSxmPWQrKyxnPXU7dHlwZW9mIGI9PSJzdHJpbmciJiYhai50ZXN0KGIpJiYoYj1iLnRvTG93ZXJDYXNlKCksZT1iLGc9dCksZygicGFyZW50Tm9kZSIsYixmLGEsZSxjKX0sIn4iOmZ1bmN0aW9uKGEsYixjKXt2YXIgZSxmPWQrKyxnPXU7dHlwZW9mIGI9PSJzdHJpbmciJiYhai50ZXN0KGIpJiYoYj1iLnRvTG93ZXJDYXNlKCksZT1iLGc9dCksZygicHJldmlvdXNTaWJsaW5nIixiLGYsYSxlLGMpfX0sZmluZDp7SUQ6ZnVuY3Rpb24oYSxiLGMpe2lmKHR5cGVvZiBiLmdldEVsZW1lbnRCeUlkIT0idW5kZWZpbmVkIiYmIWMpe3ZhciBkPWIuZ2V0RWxlbWVudEJ5SWQoYVsxXSk7cmV0dXJuIGQmJmQucGFyZW50Tm9kZT9bZF06W119fSxOQU1FOmZ1bmN0aW9uKGEsYil7aWYodHlwZW9mIGIuZ2V0RWxlbWVudHNCeU5hbWUhPSJ1bmRlZmluZWQiKXt2YXIgYz1bXSxkPWIuZ2V0RWxlbWVudHNCeU5hbWUoYVsxXSk7Zm9yKHZhciBlPTAsZj1kLmxlbmd0aDtlPGY7ZSsrKWRbZV0uZ2V0QXR0cmlidXRlKCJuYW1lIik9PT1hWzFdJiZjLnB1c2goZFtlXSk7cmV0dXJuIGMubGVuZ3RoPT09MD9udWxsOmN9fSxUQUc6ZnVuY3Rpb24oYSxiKXtpZih0eXBlb2YgYi5nZXRFbGVtZW50c0J5VGFnTmFtZSE9InVuZGVmaW5lZCIpcmV0dXJuIGIuZ2V0RWxlbWVudHNCeVRhZ05hbWUoYVsxXSl9fSxwcmVGaWx0ZXI6e0NMQVNTOmZ1bmN0aW9uKGEsYixjLGQsZSxmKXthPSIgIithWzFdLnJlcGxhY2UoaSwiIikrIiAiO2lmKGYpcmV0dXJuIGE7Zm9yKHZhciBnPTAsaDsoaD1iW2ddKSE9bnVsbDtnKyspaCYmKGVeKGguY2xhc3NOYW1lJiYoIiAiK2guY2xhc3NOYW1lKyIgIikucmVwbGFjZSgvW1x0XG5ccl0vZywiICIpLmluZGV4T2YoYSk+PTApP2N8fGQucHVzaChoKTpjJiYoYltnXT0hMSkpO3JldHVybiExfSxJRDpmdW5jdGlvbihhKXtyZXR1cm4gYVsxXS5yZXBsYWNlKGksIiIpfSxUQUc6ZnVuY3Rpb24oYSxiKXtyZXR1cm4gYVsxXS5yZXBsYWNlKGksIiIpLnRvTG93ZXJDYXNlKCl9LENISUxEOmZ1bmN0aW9uKGEpe2lmKGFbMV09PT0ibnRoIil7YVsyXXx8ay5lcnJvcihhWzBdKSxhWzJdPWFbMl0ucmVwbGFjZSgvXlwrfFxzKi9nLCIiKTt2YXIgYj0vKC0/KShcZCopKD86bihbK1wtXT9cZCopKT8vLmV4ZWMoYVsyXT09PSJldmVuIiYmIjJuInx8YVsyXT09PSJvZGQiJiYiMm4rMSJ8fCEvXEQvLnRlc3QoYVsyXSkmJiIwbisiK2FbMl18fGFbMl0pO2FbMl09YlsxXSsoYlsyXXx8MSktMCxhWzNdPWJbM10tMH1lbHNlIGFbMl0mJmsuZXJyb3IoYVswXSk7YVswXT1kKys7cmV0dXJuIGF9LEFUVFI6ZnVuY3Rpb24oYSxiLGMsZCxlLGYpe3ZhciBnPWFbMV09YVsxXS5yZXBsYWNlKGksIiIpOyFmJiZsLmF0dHJNYXBbZ10mJihhWzFdPWwuYXR0ck1hcFtnXSksYVs0XT0oYVs0XXx8YVs1XXx8IiIpLnJlcGxhY2UoaSwiIiksYVsyXT09PSJ+PSImJihhWzRdPSIgIithWzRdKyIgIik7cmV0dXJuIGF9LFBTRVVETzpmdW5jdGlvbihiLGMsZCxlLGYpe2lmKGJbMV09PT0ibm90IilpZigoYS5leGVjKGJbM10pfHwiIikubGVuZ3RoPjF8fC9eXHcvLnRlc3QoYlszXSkpYlszXT1rKGJbM10sbnVsbCxudWxsLGMpO2Vsc2V7dmFyIGc9ay5maWx0ZXIoYlszXSxjLGQsITBeZik7ZHx8ZS5wdXNoLmFwcGx5KGUsZyk7cmV0dXJuITF9ZWxzZSBpZihsLm1hdGNoLlBPUy50ZXN0KGJbMF0pfHxsLm1hdGNoLkNISUxELnRlc3QoYlswXSkpcmV0dXJuITA7cmV0dXJuIGJ9LFBPUzpmdW5jdGlvbihhKXthLnVuc2hpZnQoITApO3JldHVybiBhfX0sZmlsdGVyczp7ZW5hYmxlZDpmdW5jdGlvbihhKXtyZXR1cm4gYS5kaXNhYmxlZD09PSExJiZhLnR5cGUhPT0iaGlkZGVuIn0sZGlzYWJsZWQ6ZnVuY3Rpb24oYSl7cmV0dXJuIGEuZGlzYWJsZWQ9PT0hMH0sY2hlY2tlZDpmdW5jdGlvbihhKXtyZXR1cm4gYS5jaGVja2VkPT09ITB9LHNlbGVjdGVkOmZ1bmN0aW9uKGEpe2EucGFyZW50Tm9kZSYmYS5wYXJlbnROb2RlLnNlbGVjdGVkSW5kZXg7cmV0dXJuIGEuc2VsZWN0ZWQ9PT0hMH0scGFyZW50OmZ1bmN0aW9uKGEpe3JldHVybiEhYS5maXJzdENoaWxkfSxlbXB0eTpmdW5jdGlvbihhKXtyZXR1cm4hYS5maXJzdENoaWxkfSxoYXM6ZnVuY3Rpb24oYSxiLGMpe3JldHVybiEhayhjWzNdLGEpLmxlbmd0aH0saGVhZGVyOmZ1bmN0aW9uKGEpe3JldHVybi9oXGQvaS50ZXN0KGEubm9kZU5hbWUpfSx0ZXh0OmZ1bmN0aW9uKGEpe3ZhciBiPWEuZ2V0QXR0cmlidXRlKCJ0eXBlIiksYz1hLnR5cGU7cmV0dXJuIGEubm9kZU5hbWUudG9Mb3dlckNhc2UoKT09PSJpbnB1dCImJiJ0ZXh0Ij09PWMmJihiPT09Y3x8Yj09PW51bGwpfSxyYWRpbzpmdW5jdGlvbihhKXtyZXR1cm4gYS5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpPT09ImlucHV0IiYmInJhZGlvIj09PWEudHlwZX0sY2hlY2tib3g6ZnVuY3Rpb24oYSl7cmV0dXJuIGEubm9kZU5hbWUudG9Mb3dlckNhc2UoKT09PSJpbnB1dCImJiJjaGVja2JveCI9PT1hLnR5cGV9LGZpbGU6ZnVuY3Rpb24oYSl7cmV0dXJuIGEubm9kZU5hbWUudG9Mb3dlckNhc2UoKT09PSJpbnB1dCImJiJmaWxlIj09PWEudHlwZX0scGFzc3dvcmQ6ZnVuY3Rpb24oYSl7cmV0dXJuIGEubm9kZU5hbWUudG9Mb3dlckNhc2UoKT09PSJpbnB1dCImJiJwYXNzd29yZCI9PT1hLnR5cGV9LHN1Ym1pdDpmdW5jdGlvbihhKXt2YXIgYj1hLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCk7cmV0dXJuKGI9PT0iaW5wdXQifHxiPT09ImJ1dHRvbiIpJiYic3VibWl0Ij09PWEudHlwZX0saW1hZ2U6ZnVuY3Rpb24oYSl7cmV0dXJuIGEubm9kZU5hbWUudG9Mb3dlckNhc2UoKT09PSJpbnB1dCImJiJpbWFnZSI9PT1hLnR5cGV9LHJlc2V0OmZ1bmN0aW9uKGEpe3ZhciBiPWEubm9kZU5hbWUudG9Mb3dlckNhc2UoKTtyZXR1cm4oYj09PSJpbnB1dCJ8fGI9PT0iYnV0dG9uIikmJiJyZXNldCI9PT1hLnR5cGV9LGJ1dHRvbjpmdW5jdGlvbihhKXt2YXIgYj1hLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCk7cmV0dXJuIGI9PT0iaW5wdXQiJiYiYnV0dG9uIj09PWEudHlwZXx8Yj09PSJidXR0b24ifSxpbnB1dDpmdW5jdGlvbihhKXtyZXR1cm4vaW5wdXR8c2VsZWN0fHRleHRhcmVhfGJ1dHRvbi9pLnRlc3QoYS5ub2RlTmFtZSl9LGZvY3VzOmZ1bmN0aW9uKGEpe3JldHVybiBhPT09YS5vd25lckRvY3VtZW50LmFjdGl2ZUVsZW1lbnR9fSxzZXRGaWx0ZXJzOntmaXJzdDpmdW5jdGlvbihhLGIpe3JldHVybiBiPT09MH0sbGFzdDpmdW5jdGlvbihhLGIsYyxkKXtyZXR1cm4gYj09PWQubGVuZ3RoLTF9LGV2ZW46ZnVuY3Rpb24oYSxiKXtyZXR1cm4gYiUyPT09MH0sb2RkOmZ1bmN0aW9uKGEsYil7cmV0dXJuIGIlMj09PTF9LGx0OmZ1bmN0aW9uKGEsYixjKXtyZXR1cm4gYjxjWzNdLTB9LGd0OmZ1bmN0aW9uKGEsYixjKXtyZXR1cm4gYj5jWzNdLTB9LG50aDpmdW5jdGlvbihhLGIsYyl7cmV0dXJuIGNbM10tMD09PWJ9LGVxOmZ1bmN0aW9uKGEsYixjKXtyZXR1cm4gY1szXS0wPT09Yn19LGZpbHRlcjp7UFNFVURPOmZ1bmN0aW9uKGEsYixjLGQpe3ZhciBlPWJbMV0sZj1sLmZpbHRlcnNbZV07aWYoZilyZXR1cm4gZihhLGMsYixkKTtpZihlPT09ImNvbnRhaW5zIilyZXR1cm4oYS50ZXh0Q29udGVudHx8YS5pbm5lclRleHR8fGsuZ2V0VGV4dChbYV0pfHwiIikuaW5kZXhPZihiWzNdKT49MDtpZihlPT09Im5vdCIpe3ZhciBnPWJbM107Zm9yKHZhciBoPTAsaT1nLmxlbmd0aDtoPGk7aCsrKWlmKGdbaF09PT1hKXJldHVybiExO3JldHVybiEwfWsuZXJyb3IoZSl9LENISUxEOmZ1bmN0aW9uKGEsYil7dmFyIGM9YlsxXSxkPWE7c3dpdGNoKGMpe2Nhc2Uib25seSI6Y2FzZSJmaXJzdCI6d2hpbGUoZD1kLnByZXZpb3VzU2libGluZylpZihkLm5vZGVUeXBlPT09MSlyZXR1cm4hMTtpZihjPT09ImZpcnN0IilyZXR1cm4hMDtkPWE7Y2FzZSJsYXN0Ijp3aGlsZShkPWQubmV4dFNpYmxpbmcpaWYoZC5ub2RlVHlwZT09PTEpcmV0dXJuITE7cmV0dXJuITA7Y2FzZSJudGgiOnZhciBlPWJbMl0sZj1iWzNdO2lmKGU9PT0xJiZmPT09MClyZXR1cm4hMDt2YXIgZz1iWzBdLGg9YS5wYXJlbnROb2RlO2lmKGgmJihoLnNpemNhY2hlIT09Z3x8IWEubm9kZUluZGV4KSl7dmFyIGk9MDtmb3IoZD1oLmZpcnN0Q2hpbGQ7ZDtkPWQubmV4dFNpYmxpbmcpZC5ub2RlVHlwZT09PTEmJihkLm5vZGVJbmRleD0rK2kpO2guc2l6Y2FjaGU9Z312YXIgaj1hLm5vZGVJbmRleC1mO3JldHVybiBlPT09MD9qPT09MDpqJWU9PT0wJiZqL2U+PTB9fSxJRDpmdW5jdGlvbihhLGIpe3JldHVybiBhLm5vZGVUeXBlPT09MSYmYS5nZXRBdHRyaWJ1dGUoImlkIik9PT1ifSxUQUc6ZnVuY3Rpb24oYSxiKXtyZXR1cm4gYj09PSIqIiYmYS5ub2RlVHlwZT09PTF8fGEubm9kZU5hbWUudG9Mb3dlckNhc2UoKT09PWJ9LENMQVNTOmZ1bmN0aW9uKGEsYil7cmV0dXJuKCIgIisoYS5jbGFzc05hbWV8fGEuZ2V0QXR0cmlidXRlKCJjbGFzcyIpKSsiICIpLmluZGV4T2YoYik+LTF9LEFUVFI6ZnVuY3Rpb24oYSxiKXt2YXIgYz1iWzFdLGQ9bC5hdHRySGFuZGxlW2NdP2wuYXR0ckhhbmRsZVtjXShhKTphW2NdIT1udWxsP2FbY106YS5nZXRBdHRyaWJ1dGUoYyksZT1kKyIiLGY9YlsyXSxnPWJbNF07cmV0dXJuIGQ9PW51bGw/Zj09PSIhPSI6Zj09PSI9Ij9lPT09ZzpmPT09Iio9Ij9lLmluZGV4T2YoZyk+PTA6Zj09PSJ+PSI/KCIgIitlKyIgIikuaW5kZXhPZihnKT49MDpnP2Y9PT0iIT0iP2UhPT1nOmY9PT0iXj0iP2UuaW5kZXhPZihnKT09PTA6Zj09PSIkPSI/ZS5zdWJzdHIoZS5sZW5ndGgtZy5sZW5ndGgpPT09ZzpmPT09Inw9Ij9lPT09Z3x8ZS5zdWJzdHIoMCxnLmxlbmd0aCsxKT09PWcrIi0iOiExOmUmJmQhPT0hMX0sUE9TOmZ1bmN0aW9uKGEsYixjLGQpe3ZhciBlPWJbMl0sZj1sLnNldEZpbHRlcnNbZV07aWYoZilyZXR1cm4gZihhLGMsYixkKX19fSxtPWwubWF0Y2guUE9TLG49ZnVuY3Rpb24oYSxiKXtyZXR1cm4iXFwiKyhiLTArMSl9O2Zvcih2YXIgbyBpbiBsLm1hdGNoKWwubWF0Y2hbb109bmV3IFJlZ0V4cChsLm1hdGNoW29dLnNvdXJjZSsvKD8hW15cW10qXF0pKD8hW15cKF0qXCkpLy5zb3VyY2UpLGwubGVmdE1hdGNoW29dPW5ldyBSZWdFeHAoLyheKD86LnxccnxcbikqPykvLnNvdXJjZStsLm1hdGNoW29dLnNvdXJjZS5yZXBsYWNlKC9cXChcZCspL2csbikpO3ZhciBwPWZ1bmN0aW9uKGEsYil7YT1BcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhLDApO2lmKGIpe2IucHVzaC5hcHBseShiLGEpO3JldHVybiBifXJldHVybiBhfTt0cnl7QXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYy5kb2N1bWVudEVsZW1lbnQuY2hpbGROb2RlcywwKVswXS5ub2RlVHlwZX1jYXRjaChxKXtwPWZ1bmN0aW9uKGEsYil7dmFyIGM9MCxkPWJ8fFtdO2lmKGUuY2FsbChhKT09PSJbb2JqZWN0IEFycmF5XSIpQXJyYXkucHJvdG90eXBlLnB1c2guYXBwbHkoZCxhKTtlbHNlIGlmKHR5cGVvZiBhLmxlbmd0aD09Im51bWJlciIpZm9yKHZhciBmPWEubGVuZ3RoO2M8ZjtjKyspZC5wdXNoKGFbY10pO2Vsc2UgZm9yKDthW2NdO2MrKylkLnB1c2goYVtjXSk7cmV0dXJuIGR9fXZhciByLHM7Yy5kb2N1bWVudEVsZW1lbnQuY29tcGFyZURvY3VtZW50UG9zaXRpb24/cj1mdW5jdGlvbihhLGIpe2lmKGE9PT1iKXtnPSEwO3JldHVybiAwfWlmKCFhLmNvbXBhcmVEb2N1bWVudFBvc2l0aW9ufHwhYi5jb21wYXJlRG9jdW1lbnRQb3NpdGlvbilyZXR1cm4gYS5jb21wYXJlRG9jdW1lbnRQb3NpdGlvbj8tMToxO3JldHVybiBhLmNvbXBhcmVEb2N1bWVudFBvc2l0aW9uKGIpJjQ/LTE6MX06KHI9ZnVuY3Rpb24oYSxiKXtpZihhPT09Yil7Zz0hMDtyZXR1cm4gMH1pZihhLnNvdXJjZUluZGV4JiZiLnNvdXJjZUluZGV4KXJldHVybiBhLnNvdXJjZUluZGV4LWIuc291cmNlSW5kZXg7dmFyIGMsZCxlPVtdLGY9W10saD1hLnBhcmVudE5vZGUsaT1iLnBhcmVudE5vZGUsaj1oO2lmKGg9PT1pKXJldHVybiBzKGEsYik7aWYoIWgpcmV0dXJuLTE7aWYoIWkpcmV0dXJuIDE7d2hpbGUoaillLnVuc2hpZnQoaiksaj1qLnBhcmVudE5vZGU7aj1pO3doaWxlKGopZi51bnNoaWZ0KGopLGo9ai5wYXJlbnROb2RlO2M9ZS5sZW5ndGgsZD1mLmxlbmd0aDtmb3IodmFyIGs9MDtrPGMmJms8ZDtrKyspaWYoZVtrXSE9PWZba10pcmV0dXJuIHMoZVtrXSxmW2tdKTtyZXR1cm4gaz09PWM/cyhhLGZba10sLTEpOnMoZVtrXSxiLDEpfSxzPWZ1bmN0aW9uKGEsYixjKXtpZihhPT09YilyZXR1cm4gYzt2YXIgZD1hLm5leHRTaWJsaW5nO3doaWxlKGQpe2lmKGQ9PT1iKXJldHVybi0xO2Q9ZC5uZXh0U2libGluZ31yZXR1cm4gMX0pLGsuZ2V0VGV4dD1mdW5jdGlvbihhKXt2YXIgYj0iIixjO2Zvcih2YXIgZD0wO2FbZF07ZCsrKWM9YVtkXSxjLm5vZGVUeXBlPT09M3x8Yy5ub2RlVHlwZT09PTQ/Yis9Yy5ub2RlVmFsdWU6Yy5ub2RlVHlwZSE9PTgmJihiKz1rLmdldFRleHQoYy5jaGlsZE5vZGVzKSk7cmV0dXJuIGJ9LGZ1bmN0aW9uKCl7dmFyIGE9Yy5jcmVhdGVFbGVtZW50KCJkaXYiKSxkPSJzY3JpcHQiKyhuZXcgRGF0ZSkuZ2V0VGltZSgpLGU9Yy5kb2N1bWVudEVsZW1lbnQ7YS5pbm5lckhUTUw9IjxhIG5hbWU9JyIrZCsiJy8+IixlLmluc2VydEJlZm9yZShhLGUuZmlyc3RDaGlsZCksYy5nZXRFbGVtZW50QnlJZChkKSYmKGwuZmluZC5JRD1mdW5jdGlvbihhLGMsZCl7aWYodHlwZW9mIGMuZ2V0RWxlbWVudEJ5SWQhPSJ1bmRlZmluZWQiJiYhZCl7dmFyIGU9Yy5nZXRFbGVtZW50QnlJZChhWzFdKTtyZXR1cm4gZT9lLmlkPT09YVsxXXx8dHlwZW9mIGUuZ2V0QXR0cmlidXRlTm9kZSE9InVuZGVmaW5lZCImJmUuZ2V0QXR0cmlidXRlTm9kZSgiaWQiKS5ub2RlVmFsdWU9PT1hWzFdP1tlXTpiOltdfX0sbC5maWx0ZXIuSUQ9ZnVuY3Rpb24oYSxiKXt2YXIgYz10eXBlb2YgYS5nZXRBdHRyaWJ1dGVOb2RlIT0idW5kZWZpbmVkIiYmYS5nZXRBdHRyaWJ1dGVOb2RlKCJpZCIpO3JldHVybiBhLm5vZGVUeXBlPT09MSYmYyYmYy5ub2RlVmFsdWU9PT1ifSksZS5yZW1vdmVDaGlsZChhKSxlPWE9bnVsbH0oKSxmdW5jdGlvbigpe3ZhciBhPWMuY3JlYXRlRWxlbWVudCgiZGl2Iik7YS5hcHBlbmRDaGlsZChjLmNyZWF0ZUNvbW1lbnQoIiIpKSxhLmdldEVsZW1lbnRzQnlUYWdOYW1lKCIqIikubGVuZ3RoPjAmJihsLmZpbmQuVEFHPWZ1bmN0aW9uKGEsYil7dmFyIGM9Yi5nZXRFbGVtZW50c0J5VGFnTmFtZShhWzFdKTtpZihhWzFdPT09IioiKXt2YXIgZD1bXTtmb3IodmFyIGU9MDtjW2VdO2UrKyljW2VdLm5vZGVUeXBlPT09MSYmZC5wdXNoKGNbZV0pO2M9ZH1yZXR1cm4gY30pLGEuaW5uZXJIVE1MPSI8YSBocmVmPScjJz48L2E+IixhLmZpcnN0Q2hpbGQmJnR5cGVvZiBhLmZpcnN0Q2hpbGQuZ2V0QXR0cmlidXRlIT0idW5kZWZpbmVkIiYmYS5maXJzdENoaWxkLmdldEF0dHJpYnV0ZSgiaHJlZiIpIT09IiMiJiYobC5hdHRySGFuZGxlLmhyZWY9ZnVuY3Rpb24oYSl7cmV0dXJuIGEuZ2V0QXR0cmlidXRlKCJocmVmIiwyKX0pLGE9bnVsbH0oKSxjLnF1ZXJ5U2VsZWN0b3JBbGwmJmZ1bmN0aW9uKCl7dmFyIGE9ayxiPWMuY3JlYXRlRWxlbWVudCgiZGl2IiksZD0iX19zaXp6bGVfXyI7Yi5pbm5lckhUTUw9IjxwIGNsYXNzPSdURVNUJz48L3A+IjtpZighYi5xdWVyeVNlbGVjdG9yQWxsfHxiLnF1ZXJ5U2VsZWN0b3JBbGwoIi5URVNUIikubGVuZ3RoIT09MCl7az1mdW5jdGlvbihiLGUsZixnKXtlPWV8fGM7aWYoIWcmJiFrLmlzWE1MKGUpKXt2YXIgaD0vXihcdyskKXxeXC4oW1x3XC1dKyQpfF4jKFtcd1wtXSskKS8uZXhlYyhiKTtpZihoJiYoZS5ub2RlVHlwZT09PTF8fGUubm9kZVR5cGU9PT05KSl7aWYoaFsxXSlyZXR1cm4gcChlLmdldEVsZW1lbnRzQnlUYWdOYW1lKGIpLGYpO2lmKGhbMl0mJmwuZmluZC5DTEFTUyYmZS5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKXJldHVybiBwKGUuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShoWzJdKSxmKX1pZihlLm5vZGVUeXBlPT09OSl7aWYoYj09PSJib2R5IiYmZS5ib2R5KXJldHVybiBwKFtlLmJvZHldLGYpO2lmKGgmJmhbM10pe3ZhciBpPWUuZ2V0RWxlbWVudEJ5SWQoaFszXSk7aWYoIWl8fCFpLnBhcmVudE5vZGUpcmV0dXJuIHAoW10sZik7aWYoaS5pZD09PWhbM10pcmV0dXJuIHAoW2ldLGYpfXRyeXtyZXR1cm4gcChlLnF1ZXJ5U2VsZWN0b3JBbGwoYiksZil9Y2F0Y2goail7fX1lbHNlIGlmKGUubm9kZVR5cGU9PT0xJiZlLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCkhPT0ib2JqZWN0Iil7dmFyIG09ZSxuPWUuZ2V0QXR0cmlidXRlKCJpZCIpLG89bnx8ZCxxPWUucGFyZW50Tm9kZSxyPS9eXHMqWyt+XS8udGVzdChiKTtuP289by5yZXBsYWNlKC8nL2csIlxcJCYiKTplLnNldEF0dHJpYnV0ZSgiaWQiLG8pLHImJnEmJihlPWUucGFyZW50Tm9kZSk7dHJ5e2lmKCFyfHxxKXJldHVybiBwKGUucXVlcnlTZWxlY3RvckFsbCgiW2lkPSciK28rIiddICIrYiksZil9Y2F0Y2gocyl7fWZpbmFsbHl7bnx8bS5yZW1vdmVBdHRyaWJ1dGUoImlkIil9fX1yZXR1cm4gYShiLGUsZixnKX07Zm9yKHZhciBlIGluIGEpa1tlXT1hW2VdO2I9bnVsbH19KCksZnVuY3Rpb24oKXt2YXIgYT1jLmRvY3VtZW50RWxlbWVudCxiPWEubWF0Y2hlc1NlbGVjdG9yfHxhLm1vek1hdGNoZXNTZWxlY3Rvcnx8YS53ZWJraXRNYXRjaGVzU2VsZWN0b3J8fGEubXNNYXRjaGVzU2VsZWN0b3I7aWYoYil7dmFyIGQ9IWIuY2FsbChjLmNyZWF0ZUVsZW1lbnQoImRpdiIpLCJkaXYiKSxlPSExO3RyeXtiLmNhbGwoYy5kb2N1bWVudEVsZW1lbnQsIlt0ZXN0IT0nJ106c2l6emxlIil9Y2F0Y2goZil7ZT0hMH1rLm1hdGNoZXNTZWxlY3Rvcj1mdW5jdGlvbihhLGMpe2M9Yy5yZXBsYWNlKC9cPVxzKihbXiciXF1dKilccypcXS9nLCI9JyQxJ10iKTtpZighay5pc1hNTChhKSl0cnl7aWYoZXx8IWwubWF0Y2guUFNFVURPLnRlc3QoYykmJiEvIT0vLnRlc3QoYykpe3ZhciBmPWIuY2FsbChhLGMpO2lmKGZ8fCFkfHxhLmRvY3VtZW50JiZhLmRvY3VtZW50Lm5vZGVUeXBlIT09MTEpcmV0dXJuIGZ9fWNhdGNoKGcpe31yZXR1cm4gayhjLG51bGwsbnVsbCxbYV0pLmxlbmd0aD4wfX19KCksZnVuY3Rpb24oKXt2YXIgYT1jLmNyZWF0ZUVsZW1lbnQoImRpdiIpO2EuaW5uZXJIVE1MPSI8ZGl2IGNsYXNzPSd0ZXN0IGUnPjwvZGl2PjxkaXYgY2xhc3M9J3Rlc3QnPjwvZGl2PiI7aWYoISFhLmdldEVsZW1lbnRzQnlDbGFzc05hbWUmJmEuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgiZSIpLmxlbmd0aCE9PTApe2EubGFzdENoaWxkLmNsYXNzTmFtZT0iZSI7aWYoYS5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCJlIikubGVuZ3RoPT09MSlyZXR1cm47bC5vcmRlci5zcGxpY2UoMSwwLCJDTEFTUyIpLGwuZmluZC5DTEFTUz1mdW5jdGlvbihhLGIsYyl7aWYodHlwZW9mIGIuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSE9InVuZGVmaW5lZCImJiFjKXJldHVybiBiLmdldEVsZW1lbnRzQnlDbGFzc05hbWUoYVsxXSl9LGE9bnVsbH19KCksYy5kb2N1bWVudEVsZW1lbnQuY29udGFpbnM/ay5jb250YWlucz1mdW5jdGlvbihhLGIpe3JldHVybiBhIT09YiYmKGEuY29udGFpbnM/YS5jb250YWlucyhiKTohMCl9OmMuZG9jdW1lbnRFbGVtZW50LmNvbXBhcmVEb2N1bWVudFBvc2l0aW9uP2suY29udGFpbnM9ZnVuY3Rpb24oYSxiKXtyZXR1cm4hIShhLmNvbXBhcmVEb2N1bWVudFBvc2l0aW9uKGIpJjE2KX06ay5jb250YWlucz1mdW5jdGlvbigpe3JldHVybiExfSxrLmlzWE1MPWZ1bmN0aW9uKGEpe3ZhciBiPShhP2Eub3duZXJEb2N1bWVudHx8YTowKS5kb2N1bWVudEVsZW1lbnQ7cmV0dXJuIGI/Yi5ub2RlTmFtZSE9PSJIVE1MIjohMX07dmFyIHY9ZnVuY3Rpb24oYSxiKXt2YXIgYyxkPVtdLGU9IiIsZj1iLm5vZGVUeXBlP1tiXTpiO3doaWxlKGM9bC5tYXRjaC5QU0VVRE8uZXhlYyhhKSllKz1jWzBdLGE9YS5yZXBsYWNlKGwubWF0Y2guUFNFVURPLCIiKTthPWwucmVsYXRpdmVbYV0/YSsiKiI6YTtmb3IodmFyIGc9MCxoPWYubGVuZ3RoO2c8aDtnKyspayhhLGZbZ10sZCk7cmV0dXJuIGsuZmlsdGVyKGUsZCl9O2YuZmluZD1rLGYuZXhwcj1rLnNlbGVjdG9ycyxmLmV4cHJbIjoiXT1mLmV4cHIuZmlsdGVycyxmLnVuaXF1ZT1rLnVuaXF1ZVNvcnQsZi50ZXh0PWsuZ2V0VGV4dCxmLmlzWE1MRG9jPWsuaXNYTUwsZi5jb250YWlucz1rLmNvbnRhaW5zfSgpO3ZhciBQPS9VbnRpbCQvLFE9L14oPzpwYXJlbnRzfHByZXZVbnRpbHxwcmV2QWxsKS8sUj0vLC8sUz0vXi5bXjojXFtcLixdKiQvLFQ9QXJyYXkucHJvdG90eXBlLnNsaWNlLFU9Zi5leHByLm1hdGNoLlBPUyxWPXtjaGlsZHJlbjohMCxjb250ZW50czohMCxuZXh0OiEwLHByZXY6ITB9O2YuZm4uZXh0ZW5kKHtmaW5kOmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMsYyxkO2lmKHR5cGVvZiBhIT0ic3RyaW5nIilyZXR1cm4gZihhKS5maWx0ZXIoZnVuY3Rpb24oKXtmb3IoYz0wLGQ9Yi5sZW5ndGg7YzxkO2MrKylpZihmLmNvbnRhaW5zKGJbY10sdGhpcykpcmV0dXJuITB9KTt2YXIgZT10aGlzLnB1c2hTdGFjaygiIiwiZmluZCIsYSksZyxoLGk7Zm9yKGM9MCxkPXRoaXMubGVuZ3RoO2M8ZDtjKyspe2c9ZS5sZW5ndGgsZi5maW5kKGEsdGhpc1tjXSxlKTtpZihjPjApZm9yKGg9ZztoPGUubGVuZ3RoO2grKylmb3IoaT0wO2k8ZztpKyspaWYoZVtpXT09PWVbaF0pe2Uuc3BsaWNlKGgtLSwxKTticmVha319cmV0dXJuIGV9LGhhczpmdW5jdGlvbihhKXt2YXIgYj1mKGEpO3JldHVybiB0aGlzLmZpbHRlcihmdW5jdGlvbigpe2Zvcih2YXIgYT0wLGM9Yi5sZW5ndGg7YTxjO2ErKylpZihmLmNvbnRhaW5zKHRoaXMsYlthXSkpcmV0dXJuITB9KX0sbm90OmZ1bmN0aW9uKGEpe3JldHVybiB0aGlzLnB1c2hTdGFjayhYKHRoaXMsYSwhMSksIm5vdCIsYSl9LGZpbHRlcjpmdW5jdGlvbihhKXtyZXR1cm4gdGhpcy5wdXNoU3RhY2soWCh0aGlzLGEsITApLCJmaWx0ZXIiLGEpfSxpczpmdW5jdGlvbihhKXtyZXR1cm4hIWEmJih0eXBlb2YgYT09InN0cmluZyI/Zi5maWx0ZXIoYSx0aGlzKS5sZW5ndGg+MDp0aGlzLmZpbHRlcihhKS5sZW5ndGg+MCl9LGNsb3Nlc3Q6ZnVuY3Rpb24oYSxiKXt2YXIgYz1bXSxkLGUsZz10aGlzWzBdO2lmKGYuaXNBcnJheShhKSl7dmFyIGgsaSxqPXt9LGs9MTtpZihnJiZhLmxlbmd0aCl7Zm9yKGQ9MCxlPWEubGVuZ3RoO2Q8ZTtkKyspaT1hW2RdLGpbaV18fChqW2ldPVUudGVzdChpKT9mKGksYnx8dGhpcy5jb250ZXh0KTppKTt3aGlsZShnJiZnLm93bmVyRG9jdW1lbnQmJmchPT1iKXtmb3IoaSBpbiBqKWg9altpXSwoaC5qcXVlcnk/aC5pbmRleChnKT4tMTpmKGcpLmlzKGgpKSYmYy5wdXNoKHtzZWxlY3RvcjppLGVsZW06ZyxsZXZlbDprfSk7Zz1nLnBhcmVudE5vZGUsaysrfX1yZXR1cm4gY312YXIgbD1VLnRlc3QoYSl8fHR5cGVvZiBhIT0ic3RyaW5nIj9mKGEsYnx8dGhpcy5jb250ZXh0KTowO2ZvcihkPTAsZT10aGlzLmxlbmd0aDtkPGU7ZCsrKXtnPXRoaXNbZF07d2hpbGUoZyl7aWYobD9sLmluZGV4KGcpPi0xOmYuZmluZC5tYXRjaGVzU2VsZWN0b3IoZyxhKSl7Yy5wdXNoKGcpO2JyZWFrfWc9Zy5wYXJlbnROb2RlO2lmKCFnfHwhZy5vd25lckRvY3VtZW50fHxnPT09Ynx8Zy5ub2RlVHlwZT09PTExKWJyZWFrfX1jPWMubGVuZ3RoPjE/Zi51bmlxdWUoYyk6YztyZXR1cm4gdGhpcy5wdXNoU3RhY2soYywiY2xvc2VzdCIsYSl9LGluZGV4OmZ1bmN0aW9uKGEpe2lmKCFhfHx0eXBlb2YgYT09InN0cmluZyIpcmV0dXJuIGYuaW5BcnJheSh0aGlzWzBdLGE/ZihhKTp0aGlzLnBhcmVudCgpLmNoaWxkcmVuKCkpO3JldHVybiBmLmluQXJyYXkoYS5qcXVlcnk/YVswXTphLHRoaXMpfSxhZGQ6ZnVuY3Rpb24oYSxiKXt2YXIgYz10eXBlb2YgYT09InN0cmluZyI/ZihhLGIpOmYubWFrZUFycmF5KGEmJmEubm9kZVR5cGU/W2FdOmEpLGQ9Zi5tZXJnZSh0aGlzLmdldCgpLGMpO3JldHVybiB0aGlzLnB1c2hTdGFjayhXKGNbMF0pfHxXKGRbMF0pP2Q6Zi51bmlxdWUoZCkpfSxhbmRTZWxmOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuYWRkKHRoaXMucHJldk9iamVjdCl9fSksZi5lYWNoKHtwYXJlbnQ6ZnVuY3Rpb24oYSl7dmFyIGI9YS5wYXJlbnROb2RlO3JldHVybiBiJiZiLm5vZGVUeXBlIT09MTE/YjpudWxsfSxwYXJlbnRzOmZ1bmN0aW9uKGEpe3JldHVybiBmLmRpcihhLCJwYXJlbnROb2RlIil9LHBhcmVudHNVbnRpbDpmdW5jdGlvbihhLGIsYyl7cmV0dXJuIGYuZGlyKGEsInBhcmVudE5vZGUiLGMpfSxuZXh0OmZ1bmN0aW9uKGEpe3JldHVybiBmLm50aChhLDIsIm5leHRTaWJsaW5nIil9LHByZXY6ZnVuY3Rpb24oYSl7cmV0dXJuIGYubnRoKGEsMiwicHJldmlvdXNTaWJsaW5nIil9LG5leHRBbGw6ZnVuY3Rpb24oYSl7cmV0dXJuIGYuZGlyKGEsIm5leHRTaWJsaW5nIil9LHByZXZBbGw6ZnVuY3Rpb24oYSl7cmV0dXJuIGYuZGlyKGEsInByZXZpb3VzU2libGluZyIpfSxuZXh0VW50aWw6ZnVuY3Rpb24oYSxiLGMpe3JldHVybiBmLmRpcihhLCJuZXh0U2libGluZyIsYyl9LHByZXZVbnRpbDpmdW5jdGlvbihhLGIsYyl7cmV0dXJuIGYuZGlyKGEsInByZXZpb3VzU2libGluZyIsYyl9LHNpYmxpbmdzOmZ1bmN0aW9uKGEpe3JldHVybiBmLnNpYmxpbmcoYS5wYXJlbnROb2RlLmZpcnN0Q2hpbGQsYSl9LGNoaWxkcmVuOmZ1bmN0aW9uKGEpe3JldHVybiBmLnNpYmxpbmcoYS5maXJzdENoaWxkKX0sY29udGVudHM6ZnVuY3Rpb24oYSl7cmV0dXJuIGYubm9kZU5hbWUoYSwiaWZyYW1lIik/YS5jb250ZW50RG9jdW1lbnR8fGEuY29udGVudFdpbmRvdy5kb2N1bWVudDpmLm1ha2VBcnJheShhLmNoaWxkTm9kZXMpfX0sZnVuY3Rpb24oYSxiKXtmLmZuW2FdPWZ1bmN0aW9uKGMsZCl7dmFyIGU9Zi5tYXAodGhpcyxiLGMpLGc9VC5jYWxsKGFyZ3VtZW50cyk7UC50ZXN0KGEpfHwoZD1jKSxkJiZ0eXBlb2YgZD09InN0cmluZyImJihlPWYuZmlsdGVyKGQsZSkpLGU9dGhpcy5sZW5ndGg+MSYmIVZbYV0/Zi51bmlxdWUoZSk6ZSwodGhpcy5sZW5ndGg+MXx8Ui50ZXN0KGQpKSYmUS50ZXN0KGEpJiYoZT1lLnJldmVyc2UoKSk7cmV0dXJuIHRoaXMucHVzaFN0YWNrKGUsYSxnLmpvaW4oIiwiKSl9fSksZi5leHRlbmQoe2ZpbHRlcjpmdW5jdGlvbihhLGIsYyl7YyYmKGE9Ijpub3QoIithKyIpIik7cmV0dXJuIGIubGVuZ3RoPT09MT9mLmZpbmQubWF0Y2hlc1NlbGVjdG9yKGJbMF0sYSk/W2JbMF1dOltdOmYuZmluZC5tYXRjaGVzKGEsYil9LGRpcjpmdW5jdGlvbihhLGMsZCl7dmFyIGU9W10sZz1hW2NdO3doaWxlKGcmJmcubm9kZVR5cGUhPT05JiYoZD09PWJ8fGcubm9kZVR5cGUhPT0xfHwhZihnKS5pcyhkKSkpZy5ub2RlVHlwZT09PTEmJmUucHVzaChnKSxnPWdbY107cmV0dXJuIGV9LG50aDpmdW5jdGlvbihhLGIsYyxkKXtiPWJ8fDE7dmFyIGU9MDtmb3IoO2E7YT1hW2NdKWlmKGEubm9kZVR5cGU9PT0xJiYrK2U9PT1iKWJyZWFrO3JldHVybiBhfSxzaWJsaW5nOmZ1bmN0aW9uKGEsYil7dmFyIGM9W107Zm9yKDthO2E9YS5uZXh0U2libGluZylhLm5vZGVUeXBlPT09MSYmYSE9PWImJmMucHVzaChhKTtyZXR1cm4gY319KTt2YXIgWT0vIGpRdWVyeVxkKz0iKD86XGQrfG51bGwpIi9nLFo9L15ccysvLCQ9LzwoPyFhcmVhfGJyfGNvbHxlbWJlZHxocnxpbWd8aW5wdXR8bGlua3xtZXRhfHBhcmFtKSgoW1x3Ol0rKVtePl0qKVwvPi9pZyxfPS88KFtcdzpdKykvLGJhPS88dGJvZHkvaSxiYj0vPHwmIz9cdys7LyxiYz0vPCg/OnNjcmlwdHxvYmplY3R8ZW1iZWR8b3B0aW9ufHN0eWxlKS9pLGJkPS9jaGVja2VkXHMqKD86W149XXw9XHMqLmNoZWNrZWQuKS9pLGJlPS9cLyhqYXZhfGVjbWEpc2NyaXB0L2ksYmY9L15ccyo8ISg/OlxbQ0RBVEFcW3xcLVwtKS8sYmc9e29wdGlvbjpbMSwiPHNlbGVjdCBtdWx0aXBsZT0nbXVsdGlwbGUnPiIsIjwvc2VsZWN0PiJdLGxlZ2VuZDpbMSwiPGZpZWxkc2V0PiIsIjwvZmllbGRzZXQ+Il0sdGhlYWQ6WzEsIjx0YWJsZT4iLCI8L3RhYmxlPiJdLHRyOlsyLCI8dGFibGU+PHRib2R5PiIsIjwvdGJvZHk+PC90YWJsZT4iXSx0ZDpbMywiPHRhYmxlPjx0Ym9keT48dHI+IiwiPC90cj48L3Rib2R5PjwvdGFibGU+Il0sY29sOlsyLCI8dGFibGU+PHRib2R5PjwvdGJvZHk+PGNvbGdyb3VwPiIsIjwvY29sZ3JvdXA+PC90YWJsZT4iXSxhcmVhOlsxLCI8bWFwPiIsIjwvbWFwPiJdLF9kZWZhdWx0OlswLCIiLCIiXX07Ymcub3B0Z3JvdXA9Ymcub3B0aW9uLGJnLnRib2R5PWJnLnRmb290PWJnLmNvbGdyb3VwPWJnLmNhcHRpb249YmcudGhlYWQsYmcudGg9YmcudGQsZi5zdXBwb3J0Lmh0bWxTZXJpYWxpemV8fChiZy5fZGVmYXVsdD1bMSwiZGl2PGRpdj4iLCI8L2Rpdj4iXSksZi5mbi5leHRlbmQoe3RleHQ6ZnVuY3Rpb24oYSl7aWYoZi5pc0Z1bmN0aW9uKGEpKXJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oYil7dmFyIGM9Zih0aGlzKTtjLnRleHQoYS5jYWxsKHRoaXMsYixjLnRleHQoKSkpfSk7aWYodHlwZW9mIGEhPSJvYmplY3QiJiZhIT09YilyZXR1cm4gdGhpcy5lbXB0eSgpLmFwcGVuZCgodGhpc1swXSYmdGhpc1swXS5vd25lckRvY3VtZW50fHxjKS5jcmVhdGVUZXh0Tm9kZShhKSk7cmV0dXJuIGYudGV4dCh0aGlzKX0sd3JhcEFsbDpmdW5jdGlvbihhKXtpZihmLmlzRnVuY3Rpb24oYSkpcmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbihiKXtmKHRoaXMpLndyYXBBbGwoYS5jYWxsKHRoaXMsYikpfSk7aWYodGhpc1swXSl7dmFyIGI9ZihhLHRoaXNbMF0ub3duZXJEb2N1bWVudCkuZXEoMCkuY2xvbmUoITApO3RoaXNbMF0ucGFyZW50Tm9kZSYmYi5pbnNlcnRCZWZvcmUodGhpc1swXSksYi5tYXAoZnVuY3Rpb24oKXt2YXIgYT10aGlzO3doaWxlKGEuZmlyc3RDaGlsZCYmYS5maXJzdENoaWxkLm5vZGVUeXBlPT09MSlhPWEuZmlyc3RDaGlsZDtyZXR1cm4gYX0pLmFwcGVuZCh0aGlzKX1yZXR1cm4gdGhpc30sd3JhcElubmVyOmZ1bmN0aW9uKGEpe2lmKGYuaXNGdW5jdGlvbihhKSlyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKGIpe2YodGhpcykud3JhcElubmVyKGEuY2FsbCh0aGlzLGIpKX0pO3JldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oKXt2YXIgYj1mKHRoaXMpLGM9Yi5jb250ZW50cygpO2MubGVuZ3RoP2Mud3JhcEFsbChhKTpiLmFwcGVuZChhKX0pfSx3cmFwOmZ1bmN0aW9uKGEpe3JldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oKXtmKHRoaXMpLndyYXBBbGwoYSl9KX0sdW53cmFwOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucGFyZW50KCkuZWFjaChmdW5jdGlvbigpe2Yubm9kZU5hbWUodGhpcywiYm9keSIpfHxmKHRoaXMpLnJlcGxhY2VXaXRoKHRoaXMuY2hpbGROb2Rlcyl9KS5lbmQoKX0sYXBwZW5kOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZG9tTWFuaXAoYXJndW1lbnRzLCEwLGZ1bmN0aW9uKGEpe3RoaXMubm9kZVR5cGU9PT0xJiZ0aGlzLmFwcGVuZENoaWxkKGEpfSl9LHByZXBlbmQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5kb21NYW5pcChhcmd1bWVudHMsITAsZnVuY3Rpb24oYSl7dGhpcy5ub2RlVHlwZT09PTEmJnRoaXMuaW5zZXJ0QmVmb3JlKGEsdGhpcy5maXJzdENoaWxkKX0pfSxiZWZvcmU6ZnVuY3Rpb24oKXtpZih0aGlzWzBdJiZ0aGlzWzBdLnBhcmVudE5vZGUpcmV0dXJuIHRoaXMuZG9tTWFuaXAoYXJndW1lbnRzLCExLGZ1bmN0aW9uKGEpe3RoaXMucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUoYSx0aGlzKX0pO2lmKGFyZ3VtZW50cy5sZW5ndGgpe3ZhciBhPWYoYXJndW1lbnRzWzBdKTthLnB1c2guYXBwbHkoYSx0aGlzLnRvQXJyYXkoKSk7cmV0dXJuIHRoaXMucHVzaFN0YWNrKGEsImJlZm9yZSIsYXJndW1lbnRzKX19LGFmdGVyOmZ1bmN0aW9uKCl7aWYodGhpc1swXSYmdGhpc1swXS5wYXJlbnROb2RlKXJldHVybiB0aGlzLmRvbU1hbmlwKGFyZ3VtZW50cywhMSxmdW5jdGlvbihhKXt0aGlzLnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKGEsdGhpcy5uZXh0U2libGluZyl9KTtpZihhcmd1bWVudHMubGVuZ3RoKXt2YXIgYT10aGlzLnB1c2hTdGFjayh0aGlzLCJhZnRlciIsYXJndW1lbnRzKTthLnB1c2guYXBwbHkoYSxmKGFyZ3VtZW50c1swXSkudG9BcnJheSgpKTtyZXR1cm4gYX19LHJlbW92ZTpmdW5jdGlvbihhLGIpe2Zvcih2YXIgYz0wLGQ7KGQ9dGhpc1tjXSkhPW51bGw7YysrKWlmKCFhfHxmLmZpbHRlcihhLFtkXSkubGVuZ3RoKSFiJiZkLm5vZGVUeXBlPT09MSYmKGYuY2xlYW5EYXRhKGQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoIioiKSksZi5jbGVhbkRhdGEoW2RdKSksZC5wYXJlbnROb2RlJiZkLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoZCk7cmV0dXJuIHRoaXN9LGVtcHR5OmZ1bmN0aW9uKCl7Zm9yKHZhciBhPTAsYjsoYj10aGlzW2FdKSE9bnVsbDthKyspe2Iubm9kZVR5cGU9PT0xJiZmLmNsZWFuRGF0YShiLmdldEVsZW1lbnRzQnlUYWdOYW1lKCIqIikpO3doaWxlKGIuZmlyc3RDaGlsZCliLnJlbW92ZUNoaWxkKGIuZmlyc3RDaGlsZCl9cmV0dXJuIHRoaXN9LGNsb25lOmZ1bmN0aW9uKGEsYil7YT1hPT1udWxsPyExOmEsYj1iPT1udWxsP2E6YjtyZXR1cm4gdGhpcy5tYXAoZnVuY3Rpb24oKXtyZXR1cm4gZi5jbG9uZSh0aGlzLGEsYil9KX0saHRtbDpmdW5jdGlvbihhKXtpZihhPT09YilyZXR1cm4gdGhpc1swXSYmdGhpc1swXS5ub2RlVHlwZT09PTE/dGhpc1swXS5pbm5lckhUTUwucmVwbGFjZShZLCIiKTpudWxsO2lmKHR5cGVvZiBhPT0ic3RyaW5nIiYmIWJjLnRlc3QoYSkmJihmLnN1cHBvcnQubGVhZGluZ1doaXRlc3BhY2V8fCFaLnRlc3QoYSkpJiYhYmdbKF8uZXhlYyhhKXx8WyIiLCIiXSlbMV0udG9Mb3dlckNhc2UoKV0pe2E9YS5yZXBsYWNlKCQsIjwkMT48LyQyPiIpO3RyeXtmb3IodmFyIGM9MCxkPXRoaXMubGVuZ3RoO2M8ZDtjKyspdGhpc1tjXS5ub2RlVHlwZT09PTEmJihmLmNsZWFuRGF0YSh0aGlzW2NdLmdldEVsZW1lbnRzQnlUYWdOYW1lKCIqIikpLHRoaXNbY10uaW5uZXJIVE1MPWEpfWNhdGNoKGUpe3RoaXMuZW1wdHkoKS5hcHBlbmQoYSl9fWVsc2UgZi5pc0Z1bmN0aW9uKGEpP3RoaXMuZWFjaChmdW5jdGlvbihiKXt2YXIgYz1mKHRoaXMpO2MuaHRtbChhLmNhbGwodGhpcyxiLGMuaHRtbCgpKSl9KTp0aGlzLmVtcHR5KCkuYXBwZW5kKGEpO3JldHVybiB0aGlzfSxyZXBsYWNlV2l0aDpmdW5jdGlvbihhKXtpZih0aGlzWzBdJiZ0aGlzWzBdLnBhcmVudE5vZGUpe2lmKGYuaXNGdW5jdGlvbihhKSlyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKGIpe3ZhciBjPWYodGhpcyksZD1jLmh0bWwoKTtjLnJlcGxhY2VXaXRoKGEuY2FsbCh0aGlzLGIsZCkpfSk7dHlwZW9mIGEhPSJzdHJpbmciJiYoYT1mKGEpLmRldGFjaCgpKTtyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKCl7dmFyIGI9dGhpcy5uZXh0U2libGluZyxjPXRoaXMucGFyZW50Tm9kZTtmKHRoaXMpLnJlbW92ZSgpLGI/ZihiKS5iZWZvcmUoYSk6ZihjKS5hcHBlbmQoYSl9KX1yZXR1cm4gdGhpcy5sZW5ndGg/dGhpcy5wdXNoU3RhY2soZihmLmlzRnVuY3Rpb24oYSk/YSgpOmEpLCJyZXBsYWNlV2l0aCIsYSk6dGhpc30sZGV0YWNoOmZ1bmN0aW9uKGEpe3JldHVybiB0aGlzLnJlbW92ZShhLCEwKX0sZG9tTWFuaXA6ZnVuY3Rpb24oYSxjLGQpe3ZhciBlLGcsaCxpLGo9YVswXSxrPVtdO2lmKCFmLnN1cHBvcnQuY2hlY2tDbG9uZSYmYXJndW1lbnRzLmxlbmd0aD09PTMmJnR5cGVvZiBqPT0ic3RyaW5nIiYmYmQudGVzdChqKSlyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKCl7Zih0aGlzKS5kb21NYW5pcChhLGMsZCwhMCl9KTtpZihmLmlzRnVuY3Rpb24oaikpcmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbihlKXt2YXIgZz1mKHRoaXMpO2FbMF09ai5jYWxsKHRoaXMsZSxjP2cuaHRtbCgpOmIpLGcuZG9tTWFuaXAoYSxjLGQpfSk7aWYodGhpc1swXSl7aT1qJiZqLnBhcmVudE5vZGUsZi5zdXBwb3J0LnBhcmVudE5vZGUmJmkmJmkubm9kZVR5cGU9PT0xMSYmaS5jaGlsZE5vZGVzLmxlbmd0aD09PXRoaXMubGVuZ3RoP2U9e2ZyYWdtZW50Oml9OmU9Zi5idWlsZEZyYWdtZW50KGEsdGhpcyxrKSxoPWUuZnJhZ21lbnQsaC5jaGlsZE5vZGVzLmxlbmd0aD09PTE/Zz1oPWguZmlyc3RDaGlsZDpnPWguZmlyc3RDaGlsZDtpZihnKXtjPWMmJmYubm9kZU5hbWUoZywidHIiKTtmb3IodmFyIGw9MCxtPXRoaXMubGVuZ3RoLG49bS0xO2w8bTtsKyspZC5jYWxsKGM/YmgodGhpc1tsXSxnKTp0aGlzW2xdLGUuY2FjaGVhYmxlfHxtPjEmJmw8bj9mLmNsb25lKGgsITAsITApOmgpfWsubGVuZ3RoJiZmLmVhY2goayxibil9cmV0dXJuIHRoaXN9fSksZi5idWlsZEZyYWdtZW50PWZ1bmN0aW9uKGEsYixkKXt2YXIgZSxnLGgsaT1iJiZiWzBdP2JbMF0ub3duZXJEb2N1bWVudHx8YlswXTpjO2EubGVuZ3RoPT09MSYmdHlwZW9mIGFbMF09PSJzdHJpbmciJiZhWzBdLmxlbmd0aDw1MTImJmk9PT1jJiZhWzBdLmNoYXJBdCgwKT09PSI8IiYmIWJjLnRlc3QoYVswXSkmJihmLnN1cHBvcnQuY2hlY2tDbG9uZXx8IWJkLnRlc3QoYVswXSkpJiYoZz0hMCxoPWYuZnJhZ21lbnRzW2FbMF1dLGgmJmghPT0xJiYoZT1oKSksZXx8KGU9aS5jcmVhdGVEb2N1bWVudEZyYWdtZW50KCksZi5jbGVhbihhLGksZSxkKSksZyYmKGYuZnJhZ21lbnRzW2FbMF1dPWg/ZToxKTtyZXR1cm57ZnJhZ21lbnQ6ZSxjYWNoZWFibGU6Z319LGYuZnJhZ21lbnRzPXt9LGYuZWFjaCh7YXBwZW5kVG86ImFwcGVuZCIscHJlcGVuZFRvOiJwcmVwZW5kIixpbnNlcnRCZWZvcmU6ImJlZm9yZSIsaW5zZXJ0QWZ0ZXI6ImFmdGVyIixyZXBsYWNlQWxsOiJyZXBsYWNlV2l0aCJ9LGZ1bmN0aW9uKGEsYil7Zi5mblthXT1mdW5jdGlvbihjKXt2YXIgZD1bXSxlPWYoYyksZz10aGlzLmxlbmd0aD09PTEmJnRoaXNbMF0ucGFyZW50Tm9kZTtpZihnJiZnLm5vZGVUeXBlPT09MTEmJmcuY2hpbGROb2Rlcy5sZW5ndGg9PT0xJiZlLmxlbmd0aD09PTEpe2VbYl0odGhpc1swXSk7cmV0dXJuIHRoaXN9Zm9yKHZhciBoPTAsaT1lLmxlbmd0aDtoPGk7aCsrKXt2YXIgaj0oaD4wP3RoaXMuY2xvbmUoITApOnRoaXMpLmdldCgpO2YoZVtoXSlbYl0oaiksZD1kLmNvbmNhdChqKX1yZXR1cm4gdGhpcy5wdXNoU3RhY2soZCxhLGUuc2VsZWN0b3IpfX0pLGYuZXh0ZW5kKHtjbG9uZTpmdW5jdGlvbihhLGIsYyl7dmFyIGQ9YS5jbG9uZU5vZGUoITApLGUsZyxoO2lmKCghZi5zdXBwb3J0Lm5vQ2xvbmVFdmVudHx8IWYuc3VwcG9ydC5ub0Nsb25lQ2hlY2tlZCkmJihhLm5vZGVUeXBlPT09MXx8YS5ub2RlVHlwZT09PTExKSYmIWYuaXNYTUxEb2MoYSkpe2JqKGEsZCksZT1iayhhKSxnPWJrKGQpO2ZvcihoPTA7ZVtoXTsrK2gpYmooZVtoXSxnW2hdKX1pZihiKXtiaShhLGQpO2lmKGMpe2U9YmsoYSksZz1iayhkKTtmb3IoaD0wO2VbaF07KytoKWJpKGVbaF0sZ1toXSl9fXJldHVybiBkfSxjbGVhbjpmdW5jdGlvbihhLGIsZCxlKXt2YXIgZztiPWJ8fGMsdHlwZW9mIGIuY3JlYXRlRWxlbWVudD09InVuZGVmaW5lZCImJihiPWIub3duZXJEb2N1bWVudHx8CmJbMF0mJmJbMF0ub3duZXJEb2N1bWVudHx8Yyk7dmFyIGg9W10saTtmb3IodmFyIGo9MCxrOyhrPWFbal0pIT1udWxsO2orKyl7dHlwZW9mIGs9PSJudW1iZXIiJiYoays9IiIpO2lmKCFrKWNvbnRpbnVlO2lmKHR5cGVvZiBrPT0ic3RyaW5nIilpZighYmIudGVzdChrKSlrPWIuY3JlYXRlVGV4dE5vZGUoayk7ZWxzZXtrPWsucmVwbGFjZSgkLCI8JDE+PC8kMj4iKTt2YXIgbD0oXy5leGVjKGspfHxbIiIsIiJdKVsxXS50b0xvd2VyQ2FzZSgpLG09YmdbbF18fGJnLl9kZWZhdWx0LG49bVswXSxvPWIuY3JlYXRlRWxlbWVudCgiZGl2Iik7by5pbm5lckhUTUw9bVsxXStrK21bMl07d2hpbGUobi0tKW89by5sYXN0Q2hpbGQ7aWYoIWYuc3VwcG9ydC50Ym9keSl7dmFyIHA9YmEudGVzdChrKSxxPWw9PT0idGFibGUiJiYhcD9vLmZpcnN0Q2hpbGQmJm8uZmlyc3RDaGlsZC5jaGlsZE5vZGVzOm1bMV09PT0iPHRhYmxlPiImJiFwP28uY2hpbGROb2RlczpbXTtmb3IoaT1xLmxlbmd0aC0xO2k+PTA7LS1pKWYubm9kZU5hbWUocVtpXSwidGJvZHkiKSYmIXFbaV0uY2hpbGROb2Rlcy5sZW5ndGgmJnFbaV0ucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChxW2ldKX0hZi5zdXBwb3J0LmxlYWRpbmdXaGl0ZXNwYWNlJiZaLnRlc3QoaykmJm8uaW5zZXJ0QmVmb3JlKGIuY3JlYXRlVGV4dE5vZGUoWi5leGVjKGspWzBdKSxvLmZpcnN0Q2hpbGQpLGs9by5jaGlsZE5vZGVzfXZhciByO2lmKCFmLnN1cHBvcnQuYXBwZW5kQ2hlY2tlZClpZihrWzBdJiZ0eXBlb2YgKHI9ay5sZW5ndGgpPT0ibnVtYmVyIilmb3IoaT0wO2k8cjtpKyspYm0oa1tpXSk7ZWxzZSBibShrKTtrLm5vZGVUeXBlP2gucHVzaChrKTpoPWYubWVyZ2UoaCxrKX1pZihkKXtnPWZ1bmN0aW9uKGEpe3JldHVybiFhLnR5cGV8fGJlLnRlc3QoYS50eXBlKX07Zm9yKGo9MDtoW2pdO2orKylpZihlJiZmLm5vZGVOYW1lKGhbal0sInNjcmlwdCIpJiYoIWhbal0udHlwZXx8aFtqXS50eXBlLnRvTG93ZXJDYXNlKCk9PT0idGV4dC9qYXZhc2NyaXB0IikpZS5wdXNoKGhbal0ucGFyZW50Tm9kZT9oW2pdLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoaFtqXSk6aFtqXSk7ZWxzZXtpZihoW2pdLm5vZGVUeXBlPT09MSl7dmFyIHM9Zi5ncmVwKGhbal0uZ2V0RWxlbWVudHNCeVRhZ05hbWUoInNjcmlwdCIpLGcpO2guc3BsaWNlLmFwcGx5KGgsW2orMSwwXS5jb25jYXQocykpfWQuYXBwZW5kQ2hpbGQoaFtqXSl9fXJldHVybiBofSxjbGVhbkRhdGE6ZnVuY3Rpb24oYSl7dmFyIGIsYyxkPWYuY2FjaGUsZT1mLmV4cGFuZG8sZz1mLmV2ZW50LnNwZWNpYWwsaD1mLnN1cHBvcnQuZGVsZXRlRXhwYW5kbztmb3IodmFyIGk9MCxqOyhqPWFbaV0pIT1udWxsO2krKyl7aWYoai5ub2RlTmFtZSYmZi5ub0RhdGFbai5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpXSljb250aW51ZTtjPWpbZi5leHBhbmRvXTtpZihjKXtiPWRbY10mJmRbY11bZV07aWYoYiYmYi5ldmVudHMpe2Zvcih2YXIgayBpbiBiLmV2ZW50cylnW2tdP2YuZXZlbnQucmVtb3ZlKGosayk6Zi5yZW1vdmVFdmVudChqLGssYi5oYW5kbGUpO2IuaGFuZGxlJiYoYi5oYW5kbGUuZWxlbT1udWxsKX1oP2RlbGV0ZSBqW2YuZXhwYW5kb106ai5yZW1vdmVBdHRyaWJ1dGUmJmoucmVtb3ZlQXR0cmlidXRlKGYuZXhwYW5kbyksZGVsZXRlIGRbY119fX19KTt2YXIgYm89L2FscGhhXChbXildKlwpL2ksYnA9L29wYWNpdHk9KFteKV0qKS8sYnE9Ly0oW2Etel0pL2lnLGJyPS8oW0EtWl18Xm1zKS9nLGJzPS9eLT9cZCsoPzpweCk/JC9pLGJ0PS9eLT9cZC8sYnU9L15bK1wtXT0vLGJ2PS9bXitcLVwuXGRlXSsvZyxidz17cG9zaXRpb246ImFic29sdXRlIix2aXNpYmlsaXR5OiJoaWRkZW4iLGRpc3BsYXk6ImJsb2NrIn0sYng9WyJMZWZ0IiwiUmlnaHQiXSxieT1bIlRvcCIsIkJvdHRvbSJdLGJ6LGJBLGJCLGJDPWZ1bmN0aW9uKGEsYil7cmV0dXJuIGIudG9VcHBlckNhc2UoKX07Zi5mbi5jc3M9ZnVuY3Rpb24oYSxjKXtpZihhcmd1bWVudHMubGVuZ3RoPT09MiYmYz09PWIpcmV0dXJuIHRoaXM7cmV0dXJuIGYuYWNjZXNzKHRoaXMsYSxjLCEwLGZ1bmN0aW9uKGEsYyxkKXtyZXR1cm4gZCE9PWI/Zi5zdHlsZShhLGMsZCk6Zi5jc3MoYSxjKX0pfSxmLmV4dGVuZCh7Y3NzSG9va3M6e29wYWNpdHk6e2dldDpmdW5jdGlvbihhLGIpe2lmKGIpe3ZhciBjPWJ6KGEsIm9wYWNpdHkiLCJvcGFjaXR5Iik7cmV0dXJuIGM9PT0iIj8iMSI6Y31yZXR1cm4gYS5zdHlsZS5vcGFjaXR5fX19LGNzc051bWJlcjp7ekluZGV4OiEwLGZvbnRXZWlnaHQ6ITAsb3BhY2l0eTohMCx6b29tOiEwLGxpbmVIZWlnaHQ6ITAsd2lkb3dzOiEwLG9ycGhhbnM6ITB9LGNzc1Byb3BzOnsiZmxvYXQiOmYuc3VwcG9ydC5jc3NGbG9hdD8iY3NzRmxvYXQiOiJzdHlsZUZsb2F0In0sc3R5bGU6ZnVuY3Rpb24oYSxjLGQsZSl7aWYoISFhJiZhLm5vZGVUeXBlIT09MyYmYS5ub2RlVHlwZSE9PTgmJiEhYS5zdHlsZSl7dmFyIGcsaCxpPWYuY2FtZWxDYXNlKGMpLGo9YS5zdHlsZSxrPWYuY3NzSG9va3NbaV07Yz1mLmNzc1Byb3BzW2ldfHxpO2lmKGQ9PT1iKXtpZihrJiYiZ2V0ImluIGsmJihnPWsuZ2V0KGEsITEsZSkpIT09YilyZXR1cm4gZztyZXR1cm4galtjXX1oPXR5cGVvZiBkO2lmKGg9PT0ibnVtYmVyIiYmaXNOYU4oZCl8fGQ9PW51bGwpcmV0dXJuO2g9PT0ic3RyaW5nIiYmYnUudGVzdChkKSYmKGQ9K2QucmVwbGFjZShidiwiIikrcGFyc2VGbG9hdChmLmNzcyhhLGMpKSksaD09PSJudW1iZXIiJiYhZi5jc3NOdW1iZXJbaV0mJihkKz0icHgiKTtpZigha3x8ISgic2V0ImluIGspfHwoZD1rLnNldChhLGQpKSE9PWIpdHJ5e2pbY109ZH1jYXRjaChsKXt9fX0sY3NzOmZ1bmN0aW9uKGEsYyxkKXt2YXIgZSxnO2M9Zi5jYW1lbENhc2UoYyksZz1mLmNzc0hvb2tzW2NdLGM9Zi5jc3NQcm9wc1tjXXx8YyxjPT09ImNzc0Zsb2F0IiYmKGM9ImZsb2F0Iik7aWYoZyYmImdldCJpbiBnJiYoZT1nLmdldChhLCEwLGQpKSE9PWIpcmV0dXJuIGU7aWYoYnopcmV0dXJuIGJ6KGEsYyl9LHN3YXA6ZnVuY3Rpb24oYSxiLGMpe3ZhciBkPXt9O2Zvcih2YXIgZSBpbiBiKWRbZV09YS5zdHlsZVtlXSxhLnN0eWxlW2VdPWJbZV07Yy5jYWxsKGEpO2ZvcihlIGluIGIpYS5zdHlsZVtlXT1kW2VdfSxjYW1lbENhc2U6ZnVuY3Rpb24oYSl7cmV0dXJuIGEucmVwbGFjZShicSxiQyl9fSksZi5jdXJDU1M9Zi5jc3MsZi5lYWNoKFsiaGVpZ2h0Iiwid2lkdGgiXSxmdW5jdGlvbihhLGIpe2YuY3NzSG9va3NbYl09e2dldDpmdW5jdGlvbihhLGMsZCl7dmFyIGU7aWYoYyl7YS5vZmZzZXRXaWR0aCE9PTA/ZT1iRChhLGIsZCk6Zi5zd2FwKGEsYncsZnVuY3Rpb24oKXtlPWJEKGEsYixkKX0pO2lmKGU8PTApe2U9YnooYSxiLGIpLGU9PT0iMHB4IiYmYkImJihlPWJCKGEsYixiKSk7aWYoZSE9bnVsbClyZXR1cm4gZT09PSIifHxlPT09ImF1dG8iPyIwcHgiOmV9aWYoZTwwfHxlPT1udWxsKXtlPWEuc3R5bGVbYl07cmV0dXJuIGU9PT0iInx8ZT09PSJhdXRvIj8iMHB4IjplfXJldHVybiB0eXBlb2YgZT09InN0cmluZyI/ZTplKyJweCJ9fSxzZXQ6ZnVuY3Rpb24oYSxiKXtpZighYnMudGVzdChiKSlyZXR1cm4gYjtiPXBhcnNlRmxvYXQoYik7aWYoYj49MClyZXR1cm4gYisicHgifX19KSxmLnN1cHBvcnQub3BhY2l0eXx8KGYuY3NzSG9va3Mub3BhY2l0eT17Z2V0OmZ1bmN0aW9uKGEsYil7cmV0dXJuIGJwLnRlc3QoKGImJmEuY3VycmVudFN0eWxlP2EuY3VycmVudFN0eWxlLmZpbHRlcjphLnN0eWxlLmZpbHRlcil8fCIiKT9wYXJzZUZsb2F0KFJlZ0V4cC4kMSkvMTAwKyIiOmI/IjEiOiIifSxzZXQ6ZnVuY3Rpb24oYSxiKXt2YXIgYz1hLnN0eWxlLGQ9YS5jdXJyZW50U3R5bGU7Yy56b29tPTE7dmFyIGU9Zi5pc05hTihiKT8iIjoiYWxwaGEob3BhY2l0eT0iK2IqMTAwKyIpIixnPWQmJmQuZmlsdGVyfHxjLmZpbHRlcnx8IiI7Yy5maWx0ZXI9Ym8udGVzdChnKT9nLnJlcGxhY2UoYm8sZSk6ZysiICIrZX19KSxmKGZ1bmN0aW9uKCl7Zi5zdXBwb3J0LnJlbGlhYmxlTWFyZ2luUmlnaHR8fChmLmNzc0hvb2tzLm1hcmdpblJpZ2h0PXtnZXQ6ZnVuY3Rpb24oYSxiKXt2YXIgYztmLnN3YXAoYSx7ZGlzcGxheToiaW5saW5lLWJsb2NrIn0sZnVuY3Rpb24oKXtiP2M9YnooYSwibWFyZ2luLXJpZ2h0IiwibWFyZ2luUmlnaHQiKTpjPWEuc3R5bGUubWFyZ2luUmlnaHR9KTtyZXR1cm4gY319KX0pLGMuZGVmYXVsdFZpZXcmJmMuZGVmYXVsdFZpZXcuZ2V0Q29tcHV0ZWRTdHlsZSYmKGJBPWZ1bmN0aW9uKGEsYyl7dmFyIGQsZSxnO2M9Yy5yZXBsYWNlKGJyLCItJDEiKS50b0xvd2VyQ2FzZSgpO2lmKCEoZT1hLm93bmVyRG9jdW1lbnQuZGVmYXVsdFZpZXcpKXJldHVybiBiO2lmKGc9ZS5nZXRDb21wdXRlZFN0eWxlKGEsbnVsbCkpZD1nLmdldFByb3BlcnR5VmFsdWUoYyksZD09PSIiJiYhZi5jb250YWlucyhhLm93bmVyRG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LGEpJiYoZD1mLnN0eWxlKGEsYykpO3JldHVybiBkfSksYy5kb2N1bWVudEVsZW1lbnQuY3VycmVudFN0eWxlJiYoYkI9ZnVuY3Rpb24oYSxiKXt2YXIgYyxkPWEuY3VycmVudFN0eWxlJiZhLmN1cnJlbnRTdHlsZVtiXSxlPWEucnVudGltZVN0eWxlJiZhLnJ1bnRpbWVTdHlsZVtiXSxmPWEuc3R5bGU7IWJzLnRlc3QoZCkmJmJ0LnRlc3QoZCkmJihjPWYubGVmdCxlJiYoYS5ydW50aW1lU3R5bGUubGVmdD1hLmN1cnJlbnRTdHlsZS5sZWZ0KSxmLmxlZnQ9Yj09PSJmb250U2l6ZSI/IjFlbSI6ZHx8MCxkPWYucGl4ZWxMZWZ0KyJweCIsZi5sZWZ0PWMsZSYmKGEucnVudGltZVN0eWxlLmxlZnQ9ZSkpO3JldHVybiBkPT09IiI/ImF1dG8iOmR9KSxiej1iQXx8YkIsZi5leHByJiZmLmV4cHIuZmlsdGVycyYmKGYuZXhwci5maWx0ZXJzLmhpZGRlbj1mdW5jdGlvbihhKXt2YXIgYj1hLm9mZnNldFdpZHRoLGM9YS5vZmZzZXRIZWlnaHQ7cmV0dXJuIGI9PT0wJiZjPT09MHx8IWYuc3VwcG9ydC5yZWxpYWJsZUhpZGRlbk9mZnNldHMmJihhLnN0eWxlLmRpc3BsYXl8fGYuY3NzKGEsImRpc3BsYXkiKSk9PT0ibm9uZSJ9LGYuZXhwci5maWx0ZXJzLnZpc2libGU9ZnVuY3Rpb24oYSl7cmV0dXJuIWYuZXhwci5maWx0ZXJzLmhpZGRlbihhKX0pO3ZhciBiRT0vJTIwL2csYkY9L1xbXF0kLyxiRz0vXHI/XG4vZyxiSD0vIy4qJC8sYkk9L14oLio/KTpbIFx0XSooW15cclxuXSopXHI/JC9tZyxiSj0vXig/OmNvbG9yfGRhdGV8ZGF0ZXRpbWV8ZW1haWx8aGlkZGVufG1vbnRofG51bWJlcnxwYXNzd29yZHxyYW5nZXxzZWFyY2h8dGVsfHRleHR8dGltZXx1cmx8d2VlaykkL2ksYks9L14oPzphYm91dHxhcHB8YXBwXC1zdG9yYWdlfC4rXC1leHRlbnNpb258ZmlsZXx3aWRnZXQpOiQvLGJMPS9eKD86R0VUfEhFQUQpJC8sYk09L15cL1wvLyxiTj0vXD8vLGJPPS88c2NyaXB0XGJbXjxdKig/Oig/ITxcL3NjcmlwdD4pPFtePF0qKSo8XC9zY3JpcHQ+L2dpLGJQPS9eKD86c2VsZWN0fHRleHRhcmVhKS9pLGJRPS9ccysvLGJSPS8oWz8mXSlfPVteJl0qLyxiUz0vXihbXHdcK1wuXC1dKzopKD86XC9cLyhbXlwvPyM6XSopKD86OihcZCspKT8pPy8sYlQ9Zi5mbi5sb2FkLGJVPXt9LGJWPXt9LGJXLGJYO3RyeXtiVz1lLmhyZWZ9Y2F0Y2goYlkpe2JXPWMuY3JlYXRlRWxlbWVudCgiYSIpLGJXLmhyZWY9IiIsYlc9YlcuaHJlZn1iWD1iUy5leGVjKGJXLnRvTG93ZXJDYXNlKCkpfHxbXSxmLmZuLmV4dGVuZCh7bG9hZDpmdW5jdGlvbihhLGMsZCl7aWYodHlwZW9mIGEhPSJzdHJpbmciJiZiVClyZXR1cm4gYlQuYXBwbHkodGhpcyxhcmd1bWVudHMpO2lmKCF0aGlzLmxlbmd0aClyZXR1cm4gdGhpczt2YXIgZT1hLmluZGV4T2YoIiAiKTtpZihlPj0wKXt2YXIgZz1hLnNsaWNlKGUsYS5sZW5ndGgpO2E9YS5zbGljZSgwLGUpfXZhciBoPSJHRVQiO2MmJihmLmlzRnVuY3Rpb24oYyk/KGQ9YyxjPWIpOnR5cGVvZiBjPT0ib2JqZWN0IiYmKGM9Zi5wYXJhbShjLGYuYWpheFNldHRpbmdzLnRyYWRpdGlvbmFsKSxoPSJQT1NUIikpO3ZhciBpPXRoaXM7Zi5hamF4KHt1cmw6YSx0eXBlOmgsZGF0YVR5cGU6Imh0bWwiLGRhdGE6Yyxjb21wbGV0ZTpmdW5jdGlvbihhLGIsYyl7Yz1hLnJlc3BvbnNlVGV4dCxhLmlzUmVzb2x2ZWQoKSYmKGEuZG9uZShmdW5jdGlvbihhKXtjPWF9KSxpLmh0bWwoZz9mKCI8ZGl2PiIpLmFwcGVuZChjLnJlcGxhY2UoYk8sIiIpKS5maW5kKGcpOmMpKSxkJiZpLmVhY2goZCxbYyxiLGFdKX19KTtyZXR1cm4gdGhpc30sc2VyaWFsaXplOmZ1bmN0aW9uKCl7cmV0dXJuIGYucGFyYW0odGhpcy5zZXJpYWxpemVBcnJheSgpKX0sc2VyaWFsaXplQXJyYXk6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5tYXAoZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5lbGVtZW50cz9mLm1ha2VBcnJheSh0aGlzLmVsZW1lbnRzKTp0aGlzfSkuZmlsdGVyKGZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubmFtZSYmIXRoaXMuZGlzYWJsZWQmJih0aGlzLmNoZWNrZWR8fGJQLnRlc3QodGhpcy5ub2RlTmFtZSl8fGJKLnRlc3QodGhpcy50eXBlKSl9KS5tYXAoZnVuY3Rpb24oYSxiKXt2YXIgYz1mKHRoaXMpLnZhbCgpO3JldHVybiBjPT1udWxsP251bGw6Zi5pc0FycmF5KGMpP2YubWFwKGMsZnVuY3Rpb24oYSxjKXtyZXR1cm57bmFtZTpiLm5hbWUsdmFsdWU6YS5yZXBsYWNlKGJHLCJcclxuIil9fSk6e25hbWU6Yi5uYW1lLHZhbHVlOmMucmVwbGFjZShiRywiXHJcbiIpfX0pLmdldCgpfX0pLGYuZWFjaCgiYWpheFN0YXJ0IGFqYXhTdG9wIGFqYXhDb21wbGV0ZSBhamF4RXJyb3IgYWpheFN1Y2Nlc3MgYWpheFNlbmQiLnNwbGl0KCIgIiksZnVuY3Rpb24oYSxiKXtmLmZuW2JdPWZ1bmN0aW9uKGEpe3JldHVybiB0aGlzLmJpbmQoYixhKX19KSxmLmVhY2goWyJnZXQiLCJwb3N0Il0sZnVuY3Rpb24oYSxjKXtmW2NdPWZ1bmN0aW9uKGEsZCxlLGcpe2YuaXNGdW5jdGlvbihkKSYmKGc9Z3x8ZSxlPWQsZD1iKTtyZXR1cm4gZi5hamF4KHt0eXBlOmMsdXJsOmEsZGF0YTpkLHN1Y2Nlc3M6ZSxkYXRhVHlwZTpnfSl9fSksZi5leHRlbmQoe2dldFNjcmlwdDpmdW5jdGlvbihhLGMpe3JldHVybiBmLmdldChhLGIsYywic2NyaXB0Iil9LGdldEpTT046ZnVuY3Rpb24oYSxiLGMpe3JldHVybiBmLmdldChhLGIsYywianNvbiIpfSxhamF4U2V0dXA6ZnVuY3Rpb24oYSxiKXtiP2YuZXh0ZW5kKCEwLGEsZi5hamF4U2V0dGluZ3MsYik6KGI9YSxhPWYuZXh0ZW5kKCEwLGYuYWpheFNldHRpbmdzLGIpKTtmb3IodmFyIGMgaW57Y29udGV4dDoxLHVybDoxfSljIGluIGI/YVtjXT1iW2NdOmMgaW4gZi5hamF4U2V0dGluZ3MmJihhW2NdPWYuYWpheFNldHRpbmdzW2NdKTtyZXR1cm4gYX0sYWpheFNldHRpbmdzOnt1cmw6YlcsaXNMb2NhbDpiSy50ZXN0KGJYWzFdKSxnbG9iYWw6ITAsdHlwZToiR0VUIixjb250ZW50VHlwZToiYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkIixwcm9jZXNzRGF0YTohMCxhc3luYzohMCxhY2NlcHRzOnt4bWw6ImFwcGxpY2F0aW9uL3htbCwgdGV4dC94bWwiLGh0bWw6InRleHQvaHRtbCIsdGV4dDoidGV4dC9wbGFpbiIsanNvbjoiYXBwbGljYXRpb24vanNvbiwgdGV4dC9qYXZhc2NyaXB0IiwiKiI6IiovKiJ9LGNvbnRlbnRzOnt4bWw6L3htbC8saHRtbDovaHRtbC8sanNvbjovanNvbi99LHJlc3BvbnNlRmllbGRzOnt4bWw6InJlc3BvbnNlWE1MIix0ZXh0OiJyZXNwb25zZVRleHQifSxjb252ZXJ0ZXJzOnsiKiB0ZXh0IjphLlN0cmluZywidGV4dCBodG1sIjohMCwidGV4dCBqc29uIjpmLnBhcnNlSlNPTiwidGV4dCB4bWwiOmYucGFyc2VYTUx9fSxhamF4UHJlZmlsdGVyOmJaKGJVKSxhamF4VHJhbnNwb3J0OmJaKGJWKSxhamF4OmZ1bmN0aW9uKGEsYyl7ZnVuY3Rpb24gdyhhLGMsbCxtKXtpZihzIT09Mil7cz0yLHEmJmNsZWFyVGltZW91dChxKSxwPWIsbj1tfHwiIix2LnJlYWR5U3RhdGU9YT80OjA7dmFyIG8scix1LHc9bD9jYShkLHYsbCk6Yix4LHk7aWYoYT49MjAwJiZhPDMwMHx8YT09PTMwNCl7aWYoZC5pZk1vZGlmaWVkKXtpZih4PXYuZ2V0UmVzcG9uc2VIZWFkZXIoIkxhc3QtTW9kaWZpZWQiKSlmLmxhc3RNb2RpZmllZFtrXT14O2lmKHk9di5nZXRSZXNwb25zZUhlYWRlcigiRXRhZyIpKWYuZXRhZ1trXT15fWlmKGE9PT0zMDQpYz0ibm90bW9kaWZpZWQiLG89ITA7ZWxzZSB0cnl7cj1jYihkLHcpLGM9InN1Y2Nlc3MiLG89ITB9Y2F0Y2goeil7Yz0icGFyc2VyZXJyb3IiLHU9en19ZWxzZXt1PWM7aWYoIWN8fGEpYz0iZXJyb3IiLGE8MCYmKGE9MCl9di5zdGF0dXM9YSx2LnN0YXR1c1RleHQ9YyxvP2gucmVzb2x2ZVdpdGgoZSxbcixjLHZdKTpoLnJlamVjdFdpdGgoZSxbdixjLHVdKSx2LnN0YXR1c0NvZGUoaiksaj1iLHQmJmcudHJpZ2dlcigiYWpheCIrKG8/IlN1Y2Nlc3MiOiJFcnJvciIpLFt2LGQsbz9yOnVdKSxpLnJlc29sdmVXaXRoKGUsW3YsY10pLHQmJihnLnRyaWdnZXIoImFqYXhDb21wbGV0ZSIsW3YsZF0pLC0tZi5hY3RpdmV8fGYuZXZlbnQudHJpZ2dlcigiYWpheFN0b3AiKSl9fXR5cGVvZiBhPT0ib2JqZWN0IiYmKGM9YSxhPWIpLGM9Y3x8e307dmFyIGQ9Zi5hamF4U2V0dXAoe30sYyksZT1kLmNvbnRleHR8fGQsZz1lIT09ZCYmKGUubm9kZVR5cGV8fGUgaW5zdGFuY2VvZiBmKT9mKGUpOmYuZXZlbnQsaD1mLkRlZmVycmVkKCksaT1mLl9EZWZlcnJlZCgpLGo9ZC5zdGF0dXNDb2RlfHx7fSxrLGw9e30sbT17fSxuLG8scCxxLHIscz0wLHQsdSx2PXtyZWFkeVN0YXRlOjAsc2V0UmVxdWVzdEhlYWRlcjpmdW5jdGlvbihhLGIpe2lmKCFzKXt2YXIgYz1hLnRvTG93ZXJDYXNlKCk7YT1tW2NdPW1bY118fGEsbFthXT1ifXJldHVybiB0aGlzfSxnZXRBbGxSZXNwb25zZUhlYWRlcnM6ZnVuY3Rpb24oKXtyZXR1cm4gcz09PTI/bjpudWxsfSxnZXRSZXNwb25zZUhlYWRlcjpmdW5jdGlvbihhKXt2YXIgYztpZihzPT09Mil7aWYoIW8pe289e307d2hpbGUoYz1iSS5leGVjKG4pKW9bY1sxXS50b0xvd2VyQ2FzZSgpXT1jWzJdfWM9b1thLnRvTG93ZXJDYXNlKCldfXJldHVybiBjPT09Yj9udWxsOmN9LG92ZXJyaWRlTWltZVR5cGU6ZnVuY3Rpb24oYSl7c3x8KGQubWltZVR5cGU9YSk7cmV0dXJuIHRoaXN9LGFib3J0OmZ1bmN0aW9uKGEpe2E9YXx8ImFib3J0IixwJiZwLmFib3J0KGEpLHcoMCxhKTtyZXR1cm4gdGhpc319O2gucHJvbWlzZSh2KSx2LnN1Y2Nlc3M9di5kb25lLHYuZXJyb3I9di5mYWlsLHYuY29tcGxldGU9aS5kb25lLHYuc3RhdHVzQ29kZT1mdW5jdGlvbihhKXtpZihhKXt2YXIgYjtpZihzPDIpZm9yKGIgaW4gYSlqW2JdPVtqW2JdLGFbYl1dO2Vsc2UgYj1hW3Yuc3RhdHVzXSx2LnRoZW4oYixiKX1yZXR1cm4gdGhpc30sZC51cmw9KChhfHxkLnVybCkrIiIpLnJlcGxhY2UoYkgsIiIpLnJlcGxhY2UoYk0sYlhbMV0rIi8vIiksZC5kYXRhVHlwZXM9Zi50cmltKGQuZGF0YVR5cGV8fCIqIikudG9Mb3dlckNhc2UoKS5zcGxpdChiUSksZC5jcm9zc0RvbWFpbj09bnVsbCYmKHI9YlMuZXhlYyhkLnVybC50b0xvd2VyQ2FzZSgpKSxkLmNyb3NzRG9tYWluPSEoIXJ8fHJbMV09PWJYWzFdJiZyWzJdPT1iWFsyXSYmKHJbM118fChyWzFdPT09Imh0dHA6Ij84MDo0NDMpKT09KGJYWzNdfHwoYlhbMV09PT0iaHR0cDoiPzgwOjQ0MykpKSksZC5kYXRhJiZkLnByb2Nlc3NEYXRhJiZ0eXBlb2YgZC5kYXRhIT0ic3RyaW5nIiYmKGQuZGF0YT1mLnBhcmFtKGQuZGF0YSxkLnRyYWRpdGlvbmFsKSksYiQoYlUsZCxjLHYpO2lmKHM9PT0yKXJldHVybiExO3Q9ZC5nbG9iYWwsZC50eXBlPWQudHlwZS50b1VwcGVyQ2FzZSgpLGQuaGFzQ29udGVudD0hYkwudGVzdChkLnR5cGUpLHQmJmYuYWN0aXZlKys9PT0wJiZmLmV2ZW50LnRyaWdnZXIoImFqYXhTdGFydCIpO2lmKCFkLmhhc0NvbnRlbnQpe2QuZGF0YSYmKGQudXJsKz0oYk4udGVzdChkLnVybCk/IiYiOiI/IikrZC5kYXRhKSxrPWQudXJsO2lmKGQuY2FjaGU9PT0hMSl7dmFyIHg9Zi5ub3coKSx5PWQudXJsLnJlcGxhY2UoYlIsIiQxXz0iK3gpO2QudXJsPXkrKHk9PT1kLnVybD8oYk4udGVzdChkLnVybCk/IiYiOiI/IikrIl89Iit4OiIiKX19KGQuZGF0YSYmZC5oYXNDb250ZW50JiZkLmNvbnRlbnRUeXBlIT09ITF8fGMuY29udGVudFR5cGUpJiZ2LnNldFJlcXVlc3RIZWFkZXIoIkNvbnRlbnQtVHlwZSIsZC5jb250ZW50VHlwZSksZC5pZk1vZGlmaWVkJiYoaz1rfHxkLnVybCxmLmxhc3RNb2RpZmllZFtrXSYmdi5zZXRSZXF1ZXN0SGVhZGVyKCJJZi1Nb2RpZmllZC1TaW5jZSIsZi5sYXN0TW9kaWZpZWRba10pLGYuZXRhZ1trXSYmdi5zZXRSZXF1ZXN0SGVhZGVyKCJJZi1Ob25lLU1hdGNoIixmLmV0YWdba10pKSx2LnNldFJlcXVlc3RIZWFkZXIoIkFjY2VwdCIsZC5kYXRhVHlwZXNbMF0mJmQuYWNjZXB0c1tkLmRhdGFUeXBlc1swXV0/ZC5hY2NlcHRzW2QuZGF0YVR5cGVzWzBdXSsoZC5kYXRhVHlwZXNbMF0hPT0iKiI/IiwgKi8qOyBxPTAuMDEiOiIiKTpkLmFjY2VwdHNbIioiXSk7Zm9yKHUgaW4gZC5oZWFkZXJzKXYuc2V0UmVxdWVzdEhlYWRlcih1LGQuaGVhZGVyc1t1XSk7aWYoZC5iZWZvcmVTZW5kJiYoZC5iZWZvcmVTZW5kLmNhbGwoZSx2LGQpPT09ITF8fHM9PT0yKSl7di5hYm9ydCgpO3JldHVybiExfWZvcih1IGlue3N1Y2Nlc3M6MSxlcnJvcjoxLGNvbXBsZXRlOjF9KXZbdV0oZFt1XSk7cD1iJChiVixkLGMsdik7aWYoIXApdygtMSwiTm8gVHJhbnNwb3J0Iik7ZWxzZXt2LnJlYWR5U3RhdGU9MSx0JiZnLnRyaWdnZXIoImFqYXhTZW5kIixbdixkXSksZC5hc3luYyYmZC50aW1lb3V0PjAmJihxPXNldFRpbWVvdXQoZnVuY3Rpb24oKXt2LmFib3J0KCJ0aW1lb3V0Iil9LGQudGltZW91dCkpO3RyeXtzPTEscC5zZW5kKGwsdyl9Y2F0Y2goeil7c3RhdHVzPDI/dygtMSx6KTpmLmVycm9yKHopfX1yZXR1cm4gdn0scGFyYW06ZnVuY3Rpb24oYSxjKXt2YXIgZD1bXSxlPWZ1bmN0aW9uKGEsYil7Yj1mLmlzRnVuY3Rpb24oYik/YigpOmIsZFtkLmxlbmd0aF09ZW5jb2RlVVJJQ29tcG9uZW50KGEpKyI9IitlbmNvZGVVUklDb21wb25lbnQoYil9O2M9PT1iJiYoYz1mLmFqYXhTZXR0aW5ncy50cmFkaXRpb25hbCk7aWYoZi5pc0FycmF5KGEpfHxhLmpxdWVyeSYmIWYuaXNQbGFpbk9iamVjdChhKSlmLmVhY2goYSxmdW5jdGlvbigpe2UodGhpcy5uYW1lLHRoaXMudmFsdWUpfSk7ZWxzZSBmb3IodmFyIGcgaW4gYSliXyhnLGFbZ10sYyxlKTtyZXR1cm4gZC5qb2luKCImIikucmVwbGFjZShiRSwiKyIpfX0pLGYuZXh0ZW5kKHthY3RpdmU6MCxsYXN0TW9kaWZpZWQ6e30sZXRhZzp7fX0pO3ZhciBjYz1mLm5vdygpLGNkPS8oXD0pXD8oJnwkKXxcP1w/L2k7Zi5hamF4U2V0dXAoe2pzb25wOiJjYWxsYmFjayIsanNvbnBDYWxsYmFjazpmdW5jdGlvbigpe3JldHVybiBmLmV4cGFuZG8rIl8iK2NjKyt9fSksZi5hamF4UHJlZmlsdGVyKCJqc29uIGpzb25wIixmdW5jdGlvbihiLGMsZCl7dmFyIGU9Yi5jb250ZW50VHlwZT09PSJhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQiJiZ0eXBlb2YgYi5kYXRhPT0ic3RyaW5nIjtpZihiLmRhdGFUeXBlc1swXT09PSJqc29ucCJ8fGIuanNvbnAhPT0hMSYmKGNkLnRlc3QoYi51cmwpfHxlJiZjZC50ZXN0KGIuZGF0YSkpKXt2YXIgZyxoPWIuanNvbnBDYWxsYmFjaz1mLmlzRnVuY3Rpb24oYi5qc29ucENhbGxiYWNrKT9iLmpzb25wQ2FsbGJhY2soKTpiLmpzb25wQ2FsbGJhY2ssaT1hW2hdLGo9Yi51cmwsaz1iLmRhdGEsbD0iJDEiK2grIiQyIjtiLmpzb25wIT09ITEmJihqPWoucmVwbGFjZShjZCxsKSxiLnVybD09PWomJihlJiYoaz1rLnJlcGxhY2UoY2QsbCkpLGIuZGF0YT09PWsmJihqKz0oL1w/Ly50ZXN0KGopPyImIjoiPyIpK2IuanNvbnArIj0iK2gpKSksYi51cmw9aixiLmRhdGE9ayxhW2hdPWZ1bmN0aW9uKGEpe2c9W2FdfSxkLmFsd2F5cyhmdW5jdGlvbigpe2FbaF09aSxnJiZmLmlzRnVuY3Rpb24oaSkmJmFbaF0oZ1swXSl9KSxiLmNvbnZlcnRlcnNbInNjcmlwdCBqc29uIl09ZnVuY3Rpb24oKXtnfHxmLmVycm9yKGgrIiB3YXMgbm90IGNhbGxlZCIpO3JldHVybiBnWzBdfSxiLmRhdGFUeXBlc1swXT0ianNvbiI7cmV0dXJuInNjcmlwdCJ9fSksZi5hamF4U2V0dXAoe2FjY2VwdHM6e3NjcmlwdDoidGV4dC9qYXZhc2NyaXB0LCBhcHBsaWNhdGlvbi9qYXZhc2NyaXB0LCBhcHBsaWNhdGlvbi9lY21hc2NyaXB0LCBhcHBsaWNhdGlvbi94LWVjbWFzY3JpcHQifSxjb250ZW50czp7c2NyaXB0Oi9qYXZhc2NyaXB0fGVjbWFzY3JpcHQvfSxjb252ZXJ0ZXJzOnsidGV4dCBzY3JpcHQiOmZ1bmN0aW9uKGEpe2YuZ2xvYmFsRXZhbChhKTtyZXR1cm4gYX19fSksZi5hamF4UHJlZmlsdGVyKCJzY3JpcHQiLGZ1bmN0aW9uKGEpe2EuY2FjaGU9PT1iJiYoYS5jYWNoZT0hMSksYS5jcm9zc0RvbWFpbiYmKGEudHlwZT0iR0VUIixhLmdsb2JhbD0hMSl9KSxmLmFqYXhUcmFuc3BvcnQoInNjcmlwdCIsZnVuY3Rpb24oYSl7aWYoYS5jcm9zc0RvbWFpbil7dmFyIGQsZT1jLmhlYWR8fGMuZ2V0RWxlbWVudHNCeVRhZ05hbWUoImhlYWQiKVswXXx8Yy5kb2N1bWVudEVsZW1lbnQ7cmV0dXJue3NlbmQ6ZnVuY3Rpb24oZixnKXtkPWMuY3JlYXRlRWxlbWVudCgic2NyaXB0IiksZC5hc3luYz0iYXN5bmMiLGEuc2NyaXB0Q2hhcnNldCYmKGQuY2hhcnNldD1hLnNjcmlwdENoYXJzZXQpLGQuc3JjPWEudXJsLGQub25sb2FkPWQub25yZWFkeXN0YXRlY2hhbmdlPWZ1bmN0aW9uKGEsYyl7aWYoY3x8IWQucmVhZHlTdGF0ZXx8L2xvYWRlZHxjb21wbGV0ZS8udGVzdChkLnJlYWR5U3RhdGUpKWQub25sb2FkPWQub25yZWFkeXN0YXRlY2hhbmdlPW51bGwsZSYmZC5wYXJlbnROb2RlJiZlLnJlbW92ZUNoaWxkKGQpLGQ9YixjfHxnKDIwMCwic3VjY2VzcyIpfSxlLmluc2VydEJlZm9yZShkLGUuZmlyc3RDaGlsZCl9LGFib3J0OmZ1bmN0aW9uKCl7ZCYmZC5vbmxvYWQoMCwxKX19fX0pO3ZhciBjZT1hLkFjdGl2ZVhPYmplY3Q/ZnVuY3Rpb24oKXtmb3IodmFyIGEgaW4gY2cpY2dbYV0oMCwxKX06ITEsY2Y9MCxjZztmLmFqYXhTZXR0aW5ncy54aHI9YS5BY3RpdmVYT2JqZWN0P2Z1bmN0aW9uKCl7cmV0dXJuIXRoaXMuaXNMb2NhbCYmY2goKXx8Y2koKX06Y2gsZnVuY3Rpb24oYSl7Zi5leHRlbmQoZi5zdXBwb3J0LHthamF4OiEhYSxjb3JzOiEhYSYmIndpdGhDcmVkZW50aWFscyJpbiBhfSl9KGYuYWpheFNldHRpbmdzLnhocigpKSxmLnN1cHBvcnQuYWpheCYmZi5hamF4VHJhbnNwb3J0KGZ1bmN0aW9uKGMpe2lmKCFjLmNyb3NzRG9tYWlufHxmLnN1cHBvcnQuY29ycyl7dmFyIGQ7cmV0dXJue3NlbmQ6ZnVuY3Rpb24oZSxnKXt2YXIgaD1jLnhocigpLGksajtjLnVzZXJuYW1lP2gub3BlbihjLnR5cGUsYy51cmwsYy5hc3luYyxjLnVzZXJuYW1lLGMucGFzc3dvcmQpOmgub3BlbihjLnR5cGUsYy51cmwsYy5hc3luYyk7aWYoYy54aHJGaWVsZHMpZm9yKGogaW4gYy54aHJGaWVsZHMpaFtqXT1jLnhockZpZWxkc1tqXTtjLm1pbWVUeXBlJiZoLm92ZXJyaWRlTWltZVR5cGUmJmgub3ZlcnJpZGVNaW1lVHlwZShjLm1pbWVUeXBlKSwhYy5jcm9zc0RvbWFpbiYmIWVbIlgtUmVxdWVzdGVkLVdpdGgiXSYmKGVbIlgtUmVxdWVzdGVkLVdpdGgiXT0iWE1MSHR0cFJlcXVlc3QiKTt0cnl7Zm9yKGogaW4gZSloLnNldFJlcXVlc3RIZWFkZXIoaixlW2pdKX1jYXRjaChrKXt9aC5zZW5kKGMuaGFzQ29udGVudCYmYy5kYXRhfHxudWxsKSxkPWZ1bmN0aW9uKGEsZSl7dmFyIGosayxsLG0sbjt0cnl7aWYoZCYmKGV8fGgucmVhZHlTdGF0ZT09PTQpKXtkPWIsaSYmKGgub25yZWFkeXN0YXRlY2hhbmdlPWYubm9vcCxjZSYmZGVsZXRlIGNnW2ldKTtpZihlKWgucmVhZHlTdGF0ZSE9PTQmJmguYWJvcnQoKTtlbHNle2o9aC5zdGF0dXMsbD1oLmdldEFsbFJlc3BvbnNlSGVhZGVycygpLG09e30sbj1oLnJlc3BvbnNlWE1MLG4mJm4uZG9jdW1lbnRFbGVtZW50JiYobS54bWw9biksbS50ZXh0PWgucmVzcG9uc2VUZXh0O3RyeXtrPWguc3RhdHVzVGV4dH1jYXRjaChvKXtrPSIifSFqJiZjLmlzTG9jYWwmJiFjLmNyb3NzRG9tYWluP2o9bS50ZXh0PzIwMDo0MDQ6aj09PTEyMjMmJihqPTIwNCl9fX1jYXRjaChwKXtlfHxnKC0xLHApfW0mJmcoaixrLG0sbCl9LCFjLmFzeW5jfHxoLnJlYWR5U3RhdGU9PT00P2QoKTooaT0rK2NmLGNlJiYoY2d8fChjZz17fSxmKGEpLnVubG9hZChjZSkpLGNnW2ldPWQpLGgub25yZWFkeXN0YXRlY2hhbmdlPWQpfSxhYm9ydDpmdW5jdGlvbigpe2QmJmQoMCwxKX19fX0pO3ZhciBjaj17fSxjayxjbCxjbT0vXig/OnRvZ2dsZXxzaG93fGhpZGUpJC8sY249L14oWytcLV09KT8oW1xkKy5cLV0rKShbYS16JV0qKSQvaSxjbyxjcD1bWyJoZWlnaHQiLCJtYXJnaW5Ub3AiLCJtYXJnaW5Cb3R0b20iLCJwYWRkaW5nVG9wIiwicGFkZGluZ0JvdHRvbSJdLFsid2lkdGgiLCJtYXJnaW5MZWZ0IiwibWFyZ2luUmlnaHQiLCJwYWRkaW5nTGVmdCIsInBhZGRpbmdSaWdodCJdLFsib3BhY2l0eSJdXSxjcSxjcj1hLndlYmtpdFJlcXVlc3RBbmltYXRpb25GcmFtZXx8YS5tb3pSZXF1ZXN0QW5pbWF0aW9uRnJhbWV8fGEub1JlcXVlc3RBbmltYXRpb25GcmFtZTtmLmZuLmV4dGVuZCh7c2hvdzpmdW5jdGlvbihhLGIsYyl7dmFyIGQsZTtpZihhfHxhPT09MClyZXR1cm4gdGhpcy5hbmltYXRlKGN1KCJzaG93IiwzKSxhLGIsYyk7Zm9yKHZhciBnPTAsaD10aGlzLmxlbmd0aDtnPGg7ZysrKWQ9dGhpc1tnXSxkLnN0eWxlJiYoZT1kLnN0eWxlLmRpc3BsYXksIWYuX2RhdGEoZCwib2xkZGlzcGxheSIpJiZlPT09Im5vbmUiJiYoZT1kLnN0eWxlLmRpc3BsYXk9IiIpLGU9PT0iIiYmZi5jc3MoZCwiZGlzcGxheSIpPT09Im5vbmUiJiZmLl9kYXRhKGQsIm9sZGRpc3BsYXkiLGN2KGQubm9kZU5hbWUpKSk7Zm9yKGc9MDtnPGg7ZysrKXtkPXRoaXNbZ107aWYoZC5zdHlsZSl7ZT1kLnN0eWxlLmRpc3BsYXk7aWYoZT09PSIifHxlPT09Im5vbmUiKWQuc3R5bGUuZGlzcGxheT1mLl9kYXRhKGQsIm9sZGRpc3BsYXkiKXx8IiJ9fXJldHVybiB0aGlzfSxoaWRlOmZ1bmN0aW9uKGEsYixjKXtpZihhfHxhPT09MClyZXR1cm4gdGhpcy5hbmltYXRlKGN1KCJoaWRlIiwzKSxhLGIsYyk7Zm9yKHZhciBkPTAsZT10aGlzLmxlbmd0aDtkPGU7ZCsrKWlmKHRoaXNbZF0uc3R5bGUpe3ZhciBnPWYuY3NzKHRoaXNbZF0sImRpc3BsYXkiKTtnIT09Im5vbmUiJiYhZi5fZGF0YSh0aGlzW2RdLCJvbGRkaXNwbGF5IikmJmYuX2RhdGEodGhpc1tkXSwib2xkZGlzcGxheSIsZyl9Zm9yKGQ9MDtkPGU7ZCsrKXRoaXNbZF0uc3R5bGUmJih0aGlzW2RdLnN0eWxlLmRpc3BsYXk9Im5vbmUiKTtyZXR1cm4gdGhpc30sX3RvZ2dsZTpmLmZuLnRvZ2dsZSx0b2dnbGU6ZnVuY3Rpb24oYSxiLGMpe3ZhciBkPXR5cGVvZiBhPT0iYm9vbGVhbiI7Zi5pc0Z1bmN0aW9uKGEpJiZmLmlzRnVuY3Rpb24oYik/dGhpcy5fdG9nZ2xlLmFwcGx5KHRoaXMsYXJndW1lbnRzKTphPT1udWxsfHxkP3RoaXMuZWFjaChmdW5jdGlvbigpe3ZhciBiPWQ/YTpmKHRoaXMpLmlzKCI6aGlkZGVuIik7Zih0aGlzKVtiPyJzaG93IjoiaGlkZSJdKCl9KTp0aGlzLmFuaW1hdGUoY3UoInRvZ2dsZSIsMyksYSxiLGMpO3JldHVybiB0aGlzfSxmYWRlVG86ZnVuY3Rpb24oYSxiLGMsZCl7cmV0dXJuIHRoaXMuZmlsdGVyKCI6aGlkZGVuIikuY3NzKCJvcGFjaXR5IiwwKS5zaG93KCkuZW5kKCkuYW5pbWF0ZSh7b3BhY2l0eTpifSxhLGMsZCl9LGFuaW1hdGU6ZnVuY3Rpb24oYSxiLGMsZCl7dmFyIGU9Zi5zcGVlZChiLGMsZCk7aWYoZi5pc0VtcHR5T2JqZWN0KGEpKXJldHVybiB0aGlzLmVhY2goZS5jb21wbGV0ZSxbITFdKTthPWYuZXh0ZW5kKHt9LGEpO3JldHVybiB0aGlzW2UucXVldWU9PT0hMT8iZWFjaCI6InF1ZXVlIl0oZnVuY3Rpb24oKXtlLnF1ZXVlPT09ITEmJmYuX21hcmsodGhpcyk7dmFyIGI9Zi5leHRlbmQoe30sZSksYz10aGlzLm5vZGVUeXBlPT09MSxkPWMmJmYodGhpcykuaXMoIjpoaWRkZW4iKSxnLGgsaSxqLGssbCxtLG4sbztiLmFuaW1hdGVkUHJvcGVydGllcz17fTtmb3IoaSBpbiBhKXtnPWYuY2FtZWxDYXNlKGkpLGkhPT1nJiYoYVtnXT1hW2ldLGRlbGV0ZSBhW2ldKSxoPWFbZ10sZi5pc0FycmF5KGgpPyhiLmFuaW1hdGVkUHJvcGVydGllc1tnXT1oWzFdLGg9YVtnXT1oWzBdKTpiLmFuaW1hdGVkUHJvcGVydGllc1tnXT1iLnNwZWNpYWxFYXNpbmcmJmIuc3BlY2lhbEVhc2luZ1tnXXx8Yi5lYXNpbmd8fCJzd2luZyI7aWYoaD09PSJoaWRlIiYmZHx8aD09PSJzaG93IiYmIWQpcmV0dXJuIGIuY29tcGxldGUuY2FsbCh0aGlzKTtjJiYoZz09PSJoZWlnaHQifHxnPT09IndpZHRoIikmJihiLm92ZXJmbG93PVt0aGlzLnN0eWxlLm92ZXJmbG93LHRoaXMuc3R5bGUub3ZlcmZsb3dYLHRoaXMuc3R5bGUub3ZlcmZsb3dZXSxmLmNzcyh0aGlzLCJkaXNwbGF5Iik9PT0iaW5saW5lIiYmZi5jc3ModGhpcywiZmxvYXQiKT09PSJub25lIiYmKGYuc3VwcG9ydC5pbmxpbmVCbG9ja05lZWRzTGF5b3V0PyhqPWN2KHRoaXMubm9kZU5hbWUpLGo9PT0iaW5saW5lIj90aGlzLnN0eWxlLmRpc3BsYXk9ImlubGluZS1ibG9jayI6KHRoaXMuc3R5bGUuZGlzcGxheT0iaW5saW5lIix0aGlzLnN0eWxlLnpvb209MSkpOnRoaXMuc3R5bGUuZGlzcGxheT0iaW5saW5lLWJsb2NrIikpfWIub3ZlcmZsb3chPW51bGwmJih0aGlzLnN0eWxlLm92ZXJmbG93PSJoaWRkZW4iKTtmb3IoaSBpbiBhKWs9bmV3IGYuZngodGhpcyxiLGkpLGg9YVtpXSxjbS50ZXN0KGgpP2tbaD09PSJ0b2dnbGUiP2Q/InNob3ciOiJoaWRlIjpoXSgpOihsPWNuLmV4ZWMoaCksbT1rLmN1cigpLGw/KG49cGFyc2VGbG9hdChsWzJdKSxvPWxbM118fChmLmNzc051bWJlcltpXT8iIjoicHgiKSxvIT09InB4IiYmKGYuc3R5bGUodGhpcyxpLChufHwxKStvKSxtPShufHwxKS9rLmN1cigpKm0sZi5zdHlsZSh0aGlzLGksbStvKSksbFsxXSYmKG49KGxbMV09PT0iLT0iPy0xOjEpKm4rbSksay5jdXN0b20obSxuLG8pKTprLmN1c3RvbShtLGgsIiIpKTtyZXR1cm4hMH0pfSxzdG9wOmZ1bmN0aW9uKGEsYil7YSYmdGhpcy5xdWV1ZShbXSksdGhpcy5lYWNoKGZ1bmN0aW9uKCl7dmFyIGE9Zi50aW1lcnMsYz1hLmxlbmd0aDtifHxmLl91bm1hcmsoITAsdGhpcyk7d2hpbGUoYy0tKWFbY10uZWxlbT09PXRoaXMmJihiJiZhW2NdKCEwKSxhLnNwbGljZShjLDEpKX0pLGJ8fHRoaXMuZGVxdWV1ZSgpO3JldHVybiB0aGlzfX0pLGYuZWFjaCh7c2xpZGVEb3duOmN1KCJzaG93IiwxKSxzbGlkZVVwOmN1KCJoaWRlIiwxKSxzbGlkZVRvZ2dsZTpjdSgidG9nZ2xlIiwxKSxmYWRlSW46e29wYWNpdHk6InNob3cifSxmYWRlT3V0OntvcGFjaXR5OiJoaWRlIn0sZmFkZVRvZ2dsZTp7b3BhY2l0eToidG9nZ2xlIn19LGZ1bmN0aW9uKGEsYil7Zi5mblthXT1mdW5jdGlvbihhLGMsZCl7cmV0dXJuIHRoaXMuYW5pbWF0ZShiLGEsYyxkKX19KSxmLmV4dGVuZCh7c3BlZWQ6ZnVuY3Rpb24oYSxiLGMpe3ZhciBkPWEmJnR5cGVvZiBhPT0ib2JqZWN0Ij9mLmV4dGVuZCh7fSxhKTp7Y29tcGxldGU6Y3x8IWMmJmJ8fGYuaXNGdW5jdGlvbihhKSYmYSxkdXJhdGlvbjphLGVhc2luZzpjJiZifHxiJiYhZi5pc0Z1bmN0aW9uKGIpJiZifTtkLmR1cmF0aW9uPWYuZngub2ZmPzA6dHlwZW9mIGQuZHVyYXRpb249PSJudW1iZXIiP2QuZHVyYXRpb246ZC5kdXJhdGlvbiBpbiBmLmZ4LnNwZWVkcz9mLmZ4LnNwZWVkc1tkLmR1cmF0aW9uXTpmLmZ4LnNwZWVkcy5fZGVmYXVsdCxkLm9sZD1kLmNvbXBsZXRlLGQuY29tcGxldGU9ZnVuY3Rpb24oYSl7ZC5xdWV1ZSE9PSExP2YuZGVxdWV1ZSh0aGlzKTphIT09ITEmJmYuX3VubWFyayh0aGlzKSxmLmlzRnVuY3Rpb24oZC5vbGQpJiZkLm9sZC5jYWxsKHRoaXMpfTtyZXR1cm4gZH0sZWFzaW5nOntsaW5lYXI6ZnVuY3Rpb24oYSxiLGMsZCl7cmV0dXJuIGMrZCphfSxzd2luZzpmdW5jdGlvbihhLGIsYyxkKXtyZXR1cm4oLU1hdGguY29zKGEqTWF0aC5QSSkvMisuNSkqZCtjfX0sdGltZXJzOltdLGZ4OmZ1bmN0aW9uKGEsYixjKXt0aGlzLm9wdGlvbnM9Yix0aGlzLmVsZW09YSx0aGlzLnByb3A9YyxiLm9yaWc9Yi5vcmlnfHx7fX19KSxmLmZ4LnByb3RvdHlwZT17dXBkYXRlOmZ1bmN0aW9uKCl7dGhpcy5vcHRpb25zLnN0ZXAmJnRoaXMub3B0aW9ucy5zdGVwLmNhbGwodGhpcy5lbGVtLHRoaXMubm93LHRoaXMpLChmLmZ4LnN0ZXBbdGhpcy5wcm9wXXx8Zi5meC5zdGVwLl9kZWZhdWx0KSh0aGlzKX0sY3VyOmZ1bmN0aW9uKCl7aWYodGhpcy5lbGVtW3RoaXMucHJvcF0hPW51bGwmJighdGhpcy5lbGVtLnN0eWxlfHx0aGlzLmVsZW0uc3R5bGVbdGhpcy5wcm9wXT09bnVsbCkpcmV0dXJuIHRoaXMuZWxlbVt0aGlzLnByb3BdO3ZhciBhLGI9Zi5jc3ModGhpcy5lbGVtLHRoaXMucHJvcCk7cmV0dXJuIGlzTmFOKGE9cGFyc2VGbG9hdChiKSk/IWJ8fGI9PT0iYXV0byI/MDpiOmF9LGN1c3RvbTpmdW5jdGlvbihhLGIsYyl7ZnVuY3Rpb24gaChhKXtyZXR1cm4gZC5zdGVwKGEpfXZhciBkPXRoaXMsZT1mLmZ4LGc7dGhpcy5zdGFydFRpbWU9Y3F8fGNzKCksdGhpcy5zdGFydD1hLHRoaXMuZW5kPWIsdGhpcy51bml0PWN8fHRoaXMudW5pdHx8KGYuY3NzTnVtYmVyW3RoaXMucHJvcF0/IiI6InB4IiksdGhpcy5ub3c9dGhpcy5zdGFydCx0aGlzLnBvcz10aGlzLnN0YXRlPTAsaC5lbGVtPXRoaXMuZWxlbSxoKCkmJmYudGltZXJzLnB1c2goaCkmJiFjbyYmKGNyPyhjbz0xLGc9ZnVuY3Rpb24oKXtjbyYmKGNyKGcpLGUudGljaygpKX0sY3IoZykpOmNvPXNldEludGVydmFsKGUudGljayxlLmludGVydmFsKSl9LHNob3c6ZnVuY3Rpb24oKXt0aGlzLm9wdGlvbnMub3JpZ1t0aGlzLnByb3BdPWYuc3R5bGUodGhpcy5lbGVtLHRoaXMucHJvcCksdGhpcy5vcHRpb25zLnNob3c9ITAsdGhpcy5jdXN0b20odGhpcy5wcm9wPT09IndpZHRoInx8dGhpcy5wcm9wPT09ImhlaWdodCI/MTowLHRoaXMuY3VyKCkpLGYodGhpcy5lbGVtKS5zaG93KCl9LGhpZGU6ZnVuY3Rpb24oKXt0aGlzLm9wdGlvbnMub3JpZ1t0aGlzLnByb3BdPWYuc3R5bGUodGhpcy5lbGVtLHRoaXMucHJvcCksdGhpcy5vcHRpb25zLmhpZGU9ITAsdGhpcy5jdXN0b20odGhpcy5jdXIoKSwwKX0sc3RlcDpmdW5jdGlvbihhKXt2YXIgYj1jcXx8Y3MoKSxjPSEwLGQ9dGhpcy5lbGVtLGU9dGhpcy5vcHRpb25zLGcsaDtpZihhfHxiPj1lLmR1cmF0aW9uK3RoaXMuc3RhcnRUaW1lKXt0aGlzLm5vdz10aGlzLmVuZCx0aGlzLnBvcz10aGlzLnN0YXRlPTEsdGhpcy51cGRhdGUoKSxlLmFuaW1hdGVkUHJvcGVydGllc1t0aGlzLnByb3BdPSEwO2ZvcihnIGluIGUuYW5pbWF0ZWRQcm9wZXJ0aWVzKWUuYW5pbWF0ZWRQcm9wZXJ0aWVzW2ddIT09ITAmJihjPSExKTtpZihjKXtlLm92ZXJmbG93IT1udWxsJiYhZi5zdXBwb3J0LnNocmlua1dyYXBCbG9ja3MmJmYuZWFjaChbIiIsIlgiLCJZIl0sZnVuY3Rpb24oYSxiKXtkLnN0eWxlWyJvdmVyZmxvdyIrYl09ZS5vdmVyZmxvd1thXX0pLGUuaGlkZSYmZihkKS5oaWRlKCk7aWYoZS5oaWRlfHxlLnNob3cpZm9yKHZhciBpIGluIGUuYW5pbWF0ZWRQcm9wZXJ0aWVzKWYuc3R5bGUoZCxpLGUub3JpZ1tpXSk7ZS5jb21wbGV0ZS5jYWxsKGQpfXJldHVybiExfWUuZHVyYXRpb249PUluZmluaXR5P3RoaXMubm93PWI6KGg9Yi10aGlzLnN0YXJ0VGltZSx0aGlzLnN0YXRlPWgvZS5kdXJhdGlvbix0aGlzLnBvcz1mLmVhc2luZ1tlLmFuaW1hdGVkUHJvcGVydGllc1t0aGlzLnByb3BdXSh0aGlzLnN0YXRlLGgsMCwxLGUuZHVyYXRpb24pLHRoaXMubm93PXRoaXMuc3RhcnQrKHRoaXMuZW5kLXRoaXMuc3RhcnQpKnRoaXMucG9zKSx0aGlzLnVwZGF0ZSgpO3JldHVybiEwfX0sZi5leHRlbmQoZi5meCx7dGljazpmdW5jdGlvbigpe2Zvcih2YXIgYT1mLnRpbWVycyxiPTA7YjxhLmxlbmd0aDsrK2IpYVtiXSgpfHxhLnNwbGljZShiLS0sMSk7YS5sZW5ndGh8fGYuZnguc3RvcCgpfSxpbnRlcnZhbDoxMyxzdG9wOmZ1bmN0aW9uKCl7Y2xlYXJJbnRlcnZhbChjbyksY289bnVsbH0sc3BlZWRzOntzbG93OjYwMCxmYXN0OjIwMCxfZGVmYXVsdDo0MDB9LHN0ZXA6e29wYWNpdHk6ZnVuY3Rpb24oYSl7Zi5zdHlsZShhLmVsZW0sIm9wYWNpdHkiLGEubm93KX0sX2RlZmF1bHQ6ZnVuY3Rpb24oYSl7YS5lbGVtLnN0eWxlJiZhLmVsZW0uc3R5bGVbYS5wcm9wXSE9bnVsbD9hLmVsZW0uc3R5bGVbYS5wcm9wXT0oYS5wcm9wPT09IndpZHRoInx8YS5wcm9wPT09ImhlaWdodCI/TWF0aC5tYXgoMCxhLm5vdyk6YS5ub3cpK2EudW5pdDphLmVsZW1bYS5wcm9wXT1hLm5vd319fSksZi5leHByJiZmLmV4cHIuZmlsdGVycyYmKGYuZXhwci5maWx0ZXJzLmFuaW1hdGVkPWZ1bmN0aW9uKGEpe3JldHVybiBmLmdyZXAoZi50aW1lcnMsZnVuY3Rpb24oYil7cmV0dXJuIGE9PT1iLmVsZW19KS5sZW5ndGh9KTt2YXIgY3c9L150KD86YWJsZXxkfGgpJC9pLGN4PS9eKD86Ym9keXxodG1sKSQvaTsiZ2V0Qm91bmRpbmdDbGllbnRSZWN0ImluIGMuZG9jdW1lbnRFbGVtZW50P2YuZm4ub2Zmc2V0PWZ1bmN0aW9uKGEpe3ZhciBiPXRoaXNbMF0sYztpZihhKXJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oYil7Zi5vZmZzZXQuc2V0T2Zmc2V0KHRoaXMsYSxiKX0pO2lmKCFifHwhYi5vd25lckRvY3VtZW50KXJldHVybiBudWxsO2lmKGI9PT1iLm93bmVyRG9jdW1lbnQuYm9keSlyZXR1cm4gZi5vZmZzZXQuYm9keU9mZnNldChiKTt0cnl7Yz1iLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpfWNhdGNoKGQpe312YXIgZT1iLm93bmVyRG9jdW1lbnQsZz1lLmRvY3VtZW50RWxlbWVudDtpZighY3x8IWYuY29udGFpbnMoZyxiKSlyZXR1cm4gYz97dG9wOmMudG9wLGxlZnQ6Yy5sZWZ0fTp7dG9wOjAsbGVmdDowfTt2YXIgaD1lLmJvZHksaT1jeShlKSxqPWcuY2xpZW50VG9wfHxoLmNsaWVudFRvcHx8MCxrPWcuY2xpZW50TGVmdHx8aC5jbGllbnRMZWZ0fHwwLGw9aS5wYWdlWU9mZnNldHx8Zi5zdXBwb3J0LmJveE1vZGVsJiZnLnNjcm9sbFRvcHx8aC5zY3JvbGxUb3AsbT1pLnBhZ2VYT2Zmc2V0fHxmLnN1cHBvcnQuYm94TW9kZWwmJmcuc2Nyb2xsTGVmdHx8aC5zY3JvbGxMZWZ0LG49Yy50b3ArbC1qLG89Yy5sZWZ0K20taztyZXR1cm57dG9wOm4sbGVmdDpvfX06Zi5mbi5vZmZzZXQ9ZnVuY3Rpb24oYSl7dmFyIGI9dGhpc1swXTtpZihhKXJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oYil7Zi5vZmZzZXQuc2V0T2Zmc2V0KHRoaXMsYSxiKX0pO2lmKCFifHwhYi5vd25lckRvY3VtZW50KXJldHVybiBudWxsO2lmKGI9PT1iLm93bmVyRG9jdW1lbnQuYm9keSlyZXR1cm4gZi5vZmZzZXQuYm9keU9mZnNldChiKTtmLm9mZnNldC5pbml0aWFsaXplKCk7dmFyIGMsZD1iLm9mZnNldFBhcmVudCxlPWIsZz1iLm93bmVyRG9jdW1lbnQsaD1nLmRvY3VtZW50RWxlbWVudCxpPWcuYm9keSxqPWcuZGVmYXVsdFZpZXcsaz1qP2ouZ2V0Q29tcHV0ZWRTdHlsZShiLG51bGwpOmIuY3VycmVudFN0eWxlLGw9Yi5vZmZzZXRUb3AsbT1iLm9mZnNldExlZnQ7d2hpbGUoKGI9Yi5wYXJlbnROb2RlKSYmYiE9PWkmJmIhPT1oKXtpZihmLm9mZnNldC5zdXBwb3J0c0ZpeGVkUG9zaXRpb24mJmsucG9zaXRpb249PT0iZml4ZWQiKWJyZWFrO2M9aj9qLmdldENvbXB1dGVkU3R5bGUoYixudWxsKTpiLmN1cnJlbnRTdHlsZSxsLT1iLnNjcm9sbFRvcCxtLT1iLnNjcm9sbExlZnQsYj09PWQmJihsKz1iLm9mZnNldFRvcCxtKz1iLm9mZnNldExlZnQsZi5vZmZzZXQuZG9lc05vdEFkZEJvcmRlciYmKCFmLm9mZnNldC5kb2VzQWRkQm9yZGVyRm9yVGFibGVBbmRDZWxsc3x8IWN3LnRlc3QoYi5ub2RlTmFtZSkpJiYobCs9cGFyc2VGbG9hdChjLmJvcmRlclRvcFdpZHRoKXx8MCxtKz1wYXJzZUZsb2F0KGMuYm9yZGVyTGVmdFdpZHRoKXx8MCksZT1kLGQ9Yi5vZmZzZXRQYXJlbnQpLGYub2Zmc2V0LnN1YnRyYWN0c0JvcmRlckZvck92ZXJmbG93Tm90VmlzaWJsZSYmYy5vdmVyZmxvdyE9PSJ2aXNpYmxlIiYmKGwrPXBhcnNlRmxvYXQoYy5ib3JkZXJUb3BXaWR0aCl8fDAsbSs9cGFyc2VGbG9hdChjLmJvcmRlckxlZnRXaWR0aCl8fDApLGs9Y31pZihrLnBvc2l0aW9uPT09InJlbGF0aXZlInx8ay5wb3NpdGlvbj09PSJzdGF0aWMiKWwrPWkub2Zmc2V0VG9wLG0rPWkub2Zmc2V0TGVmdDtmLm9mZnNldC5zdXBwb3J0c0ZpeGVkUG9zaXRpb24mJmsucG9zaXRpb249PT0iZml4ZWQiJiYobCs9TWF0aC5tYXgoaC5zY3JvbGxUb3AsaS5zY3JvbGxUb3ApLG0rPU1hdGgubWF4KGguc2Nyb2xsTGVmdCxpLnNjcm9sbExlZnQpKTtyZXR1cm57dG9wOmwsbGVmdDptfX0sZi5vZmZzZXQ9e2luaXRpYWxpemU6ZnVuY3Rpb24oKXt2YXIgYT1jLmJvZHksYj1jLmNyZWF0ZUVsZW1lbnQoImRpdiIpLGQsZSxnLGgsaT1wYXJzZUZsb2F0KGYuY3NzKGEsIm1hcmdpblRvcCIpKXx8MCxqPSI8ZGl2IHN0eWxlPSdwb3NpdGlvbjphYnNvbHV0ZTt0b3A6MDtsZWZ0OjA7bWFyZ2luOjA7Ym9yZGVyOjVweCBzb2xpZCAjMDAwO3BhZGRpbmc6MDt3aWR0aDoxcHg7aGVpZ2h0OjFweDsnPjxkaXY+PC9kaXY+PC9kaXY+PHRhYmxlIHN0eWxlPSdwb3NpdGlvbjphYnNvbHV0ZTt0b3A6MDtsZWZ0OjA7bWFyZ2luOjA7Ym9yZGVyOjVweCBzb2xpZCAjMDAwO3BhZGRpbmc6MDt3aWR0aDoxcHg7aGVpZ2h0OjFweDsnIGNlbGxwYWRkaW5nPScwJyBjZWxsc3BhY2luZz0nMCc+PHRyPjx0ZD48L3RkPjwvdHI+PC90YWJsZT4iO2YuZXh0ZW5kKGIuc3R5bGUse3Bvc2l0aW9uOiJhYnNvbHV0ZSIsdG9wOjAsbGVmdDowLG1hcmdpbjowLGJvcmRlcjowLHdpZHRoOiIxcHgiLGhlaWdodDoiMXB4Iix2aXNpYmlsaXR5OiJoaWRkZW4ifSksYi5pbm5lckhUTUw9aixhLmluc2VydEJlZm9yZShiLGEuZmlyc3RDaGlsZCksZD1iLmZpcnN0Q2hpbGQsZT1kLmZpcnN0Q2hpbGQsaD1kLm5leHRTaWJsaW5nLmZpcnN0Q2hpbGQuZmlyc3RDaGlsZCx0aGlzLmRvZXNOb3RBZGRCb3JkZXI9ZS5vZmZzZXRUb3AhPT01LHRoaXMuZG9lc0FkZEJvcmRlckZvclRhYmxlQW5kQ2VsbHM9aC5vZmZzZXRUb3A9PT01LGUuc3R5bGUucG9zaXRpb249ImZpeGVkIixlLnN0eWxlLnRvcD0iMjBweCIsdGhpcy5zdXBwb3J0c0ZpeGVkUG9zaXRpb249ZS5vZmZzZXRUb3A9PT0yMHx8ZS5vZmZzZXRUb3A9PT0xNSxlLnN0eWxlLnBvc2l0aW9uPWUuc3R5bGUudG9wPSIiLGQuc3R5bGUub3ZlcmZsb3c9ImhpZGRlbiIsZC5zdHlsZS5wb3NpdGlvbj0icmVsYXRpdmUiLHRoaXMuc3VidHJhY3RzQm9yZGVyRm9yT3ZlcmZsb3dOb3RWaXNpYmxlPWUub2Zmc2V0VG9wPT09LTUsdGhpcy5kb2VzTm90SW5jbHVkZU1hcmdpbkluQm9keU9mZnNldD1hLm9mZnNldFRvcCE9PWksYS5yZW1vdmVDaGlsZChiKSxmLm9mZnNldC5pbml0aWFsaXplPWYubm9vcH0sYm9keU9mZnNldDpmdW5jdGlvbihhKXt2YXIgYj1hLm9mZnNldFRvcCxjPWEub2Zmc2V0TGVmdDtmLm9mZnNldC5pbml0aWFsaXplKCksZi5vZmZzZXQuZG9lc05vdEluY2x1ZGVNYXJnaW5JbkJvZHlPZmZzZXQmJihiKz1wYXJzZUZsb2F0KGYuY3NzKGEsIm1hcmdpblRvcCIpKXx8MCxjKz1wYXJzZUZsb2F0KGYuY3NzKGEsIm1hcmdpbkxlZnQiKSl8fDApO3JldHVybnt0b3A6YixsZWZ0OmN9fSxzZXRPZmZzZXQ6ZnVuY3Rpb24oYSxiLGMpe3ZhciBkPWYuY3NzKGEsInBvc2l0aW9uIik7ZD09PSJzdGF0aWMiJiYoYS5zdHlsZS5wb3NpdGlvbj0icmVsYXRpdmUiKTt2YXIgZT1mKGEpLGc9ZS5vZmZzZXQoKSxoPWYuY3NzKGEsInRvcCIpLGk9Zi5jc3MoYSwibGVmdCIpLGo9KGQ9PT0iYWJzb2x1dGUifHxkPT09ImZpeGVkIikmJmYuaW5BcnJheSgiYXV0byIsW2gsaV0pPi0xLGs9e30sbD17fSxtLG47aj8obD1lLnBvc2l0aW9uKCksbT1sLnRvcCxuPWwubGVmdCk6KG09cGFyc2VGbG9hdChoKXx8MCxuPXBhcnNlRmxvYXQoaSl8fDApLGYuaXNGdW5jdGlvbihiKSYmKGI9Yi5jYWxsKGEsYyxnKSksYi50b3AhPW51bGwmJihrLnRvcD1iLnRvcC1nLnRvcCttKSxiLmxlZnQhPW51bGwmJihrLmxlZnQ9Yi5sZWZ0LWcubGVmdCtuKSwidXNpbmciaW4gYj9iLnVzaW5nLmNhbGwoYSxrKTplLmNzcyhrKX19LGYuZm4uZXh0ZW5kKHtwb3NpdGlvbjpmdW5jdGlvbigpe2lmKCF0aGlzWzBdKXJldHVybiBudWxsO3ZhciBhPXRoaXNbMF0sYj10aGlzLm9mZnNldFBhcmVudCgpLGM9dGhpcy5vZmZzZXQoKSxkPWN4LnRlc3QoYlswXS5ub2RlTmFtZSk/e3RvcDowLGxlZnQ6MH06Yi5vZmZzZXQoKTtjLnRvcC09cGFyc2VGbG9hdChmLmNzcyhhLCJtYXJnaW5Ub3AiKSl8fDAsYy5sZWZ0LT1wYXJzZUZsb2F0KGYuY3NzKGEsIm1hcmdpbkxlZnQiKSl8fDAsZC50b3ArPXBhcnNlRmxvYXQoZi5jc3MoYlswXSwiYm9yZGVyVG9wV2lkdGgiKSl8fDAsZC5sZWZ0Kz1wYXJzZUZsb2F0KGYuY3NzKGJbMF0sImJvcmRlckxlZnRXaWR0aCIpKXx8MDtyZXR1cm57dG9wOmMudG9wLWQudG9wLGxlZnQ6Yy5sZWZ0LWQubGVmdH19LG9mZnNldFBhcmVudDpmdW5jdGlvbigpe3JldHVybiB0aGlzLm1hcChmdW5jdGlvbigpe3ZhciBhPXRoaXMub2Zmc2V0UGFyZW50fHxjLmJvZHk7d2hpbGUoYSYmIWN4LnRlc3QoYS5ub2RlTmFtZSkmJmYuY3NzKGEsInBvc2l0aW9uIik9PT0ic3RhdGljIilhPWEub2Zmc2V0UGFyZW50O3JldHVybiBhfSl9fSksZi5lYWNoKFsiTGVmdCIsIlRvcCJdLGZ1bmN0aW9uKGEsYyl7dmFyIGQ9InNjcm9sbCIrYztmLmZuW2RdPWZ1bmN0aW9uKGMpe3ZhciBlLGc7aWYoYz09PWIpe2U9dGhpc1swXTtpZighZSlyZXR1cm4gbnVsbDtnPWN5KGUpO3JldHVybiBnPyJwYWdlWE9mZnNldCJpbiBnP2dbYT8icGFnZVlPZmZzZXQiOiJwYWdlWE9mZnNldCJdOmYuc3VwcG9ydC5ib3hNb2RlbCYmZy5kb2N1bWVudC5kb2N1bWVudEVsZW1lbnRbZF18fGcuZG9jdW1lbnQuYm9keVtkXTplW2RdfXJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oKXtnPWN5KHRoaXMpLGc/Zy5zY3JvbGxUbyhhP2YoZykuc2Nyb2xsTGVmdCgpOmMsYT9jOmYoZykuc2Nyb2xsVG9wKCkpOnRoaXNbZF09Y30pfX0pLGYuZWFjaChbIkhlaWdodCIsIldpZHRoIl0sZnVuY3Rpb24oYSxjKXt2YXIgZD1jLnRvTG93ZXJDYXNlKCk7Zi5mblsiaW5uZXIiK2NdPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXNbMF0/cGFyc2VGbG9hdChmLmNzcyh0aGlzWzBdLGQsInBhZGRpbmciKSk6bnVsbH0sZi5mblsib3V0ZXIiK2NdPWZ1bmN0aW9uKGEpe3JldHVybiB0aGlzWzBdP3BhcnNlRmxvYXQoZi5jc3ModGhpc1swXSxkLGE/Im1hcmdpbiI6ImJvcmRlciIpKTpudWxsfSxmLmZuW2RdPWZ1bmN0aW9uKGEpe3ZhciBlPXRoaXNbMF07aWYoIWUpcmV0dXJuIGE9PW51bGw/bnVsbDp0aGlzO2lmKGYuaXNGdW5jdGlvbihhKSlyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKGIpe3ZhciBjPWYodGhpcyk7Y1tkXShhLmNhbGwodGhpcyxiLGNbZF0oKSkpfSk7aWYoZi5pc1dpbmRvdyhlKSl7dmFyIGc9ZS5kb2N1bWVudC5kb2N1bWVudEVsZW1lbnRbImNsaWVudCIrY107cmV0dXJuIGUuZG9jdW1lbnQuY29tcGF0TW9kZT09PSJDU1MxQ29tcGF0IiYmZ3x8ZS5kb2N1bWVudC5ib2R5WyJjbGllbnQiK2NdfHxnfWlmKGUubm9kZVR5cGU9PT05KXJldHVybiBNYXRoLm1heChlLmRvY3VtZW50RWxlbWVudFsiY2xpZW50IitjXSxlLmJvZHlbInNjcm9sbCIrY10sZS5kb2N1bWVudEVsZW1lbnRbInNjcm9sbCIrY10sZS5ib2R5WyJvZmZzZXQiK2NdLGUuZG9jdW1lbnRFbGVtZW50WyJvZmZzZXQiK2NdKTtpZihhPT09Yil7dmFyIGg9Zi5jc3MoZSxkKSxpPXBhcnNlRmxvYXQoaCk7cmV0dXJuIGYuaXNOYU4oaSk/aDppfXJldHVybiB0aGlzLmNzcyhkLHR5cGVvZiBhPT0ic3RyaW5nIj9hOmErInB4Iil9fSksYS5qUXVlcnk9YS4kPWZ9KSh3aW5kb3cpOw==","content_type":"application/javascript","revpos":42},"js/phonegap.0.9.5.1.min.js":{"data":"dmFyIF9hbm9tRnVua01hcD17fTt2YXIgX2Fub21GdW5rTWFwTmV4dElkPTA7ZnVuY3Rpb24gYW5vbVRvTmFtZUZ1bmsoZnVuKXt2YXIgZnVua0lkPSJmIitfYW5vbUZ1bmtNYXBOZXh0SWQrKzt2YXIgZnVuaz1mdW5jdGlvbigpe2Z1bi5hcHBseSh0aGlzLGFyZ3VtZW50cyk7X2Fub21GdW5rTWFwW2Z1bmtJZF09bnVsbDtkZWxldGUgX2Fub21GdW5rTWFwW2Z1bmtJZF19O19hbm9tRnVua01hcFtmdW5rSWRdPWZ1bms7cmV0dXJuIl9hbm9tRnVua01hcC4iK2Z1bmtJZH1mdW5jdGlvbiBHZXRGdW5jdGlvbk5hbWUoZm4pe2lmKHR5cGVvZiBmbj09PSJmdW5jdGlvbiIpe3ZhciBuYW1lPWZuLm5hbWU7aWYoIW5hbWUpe3ZhciBtPWZuLnRvU3RyaW5nKCkubWF0Y2goL15ccypmdW5jdGlvblxzKyhbXlxzXChdKykvKTtuYW1lPW0mJm1bMV19aWYobmFtZSYmKHdpbmRvd1tuYW1lXT09PWZuKSl7cmV0dXJuIG5hbWV9ZWxzZXtyZXR1cm4gYW5vbVRvTmFtZUZ1bmsoZm4pfX1lbHNle3JldHVybiBudWxsfX1pZih0eXBlb2YgUGhvbmVHYXA9PT0idW5kZWZpbmVkIil7aWYodHlwZW9mKERldmljZUluZm8pIT09Im9iamVjdCIpe0RldmljZUluZm89e319UGhvbmVHYXA9e3F1ZXVlOntyZWFkeTp0cnVlLGNvbW1hbmRzOltdLHRpbWVyOm51bGx9LF9jb25zdHJ1Y3RvcnM6W119O1Bob25lR2FwLnJlc291cmNlcz17YmFzZTp0cnVlfTtQaG9uZUdhcC5oYXNSZXNvdXJjZT1mdW5jdGlvbihuYW1lKXtyZXR1cm4gUGhvbmVHYXAucmVzb3VyY2VzW25hbWVdfTtQaG9uZUdhcC5hZGRSZXNvdXJjZT1mdW5jdGlvbihuYW1lKXtQaG9uZUdhcC5yZXNvdXJjZXNbbmFtZV09dHJ1ZX07UGhvbmVHYXAuYXZhaWxhYmxlPURldmljZUluZm8udXVpZCE9dW5kZWZpbmVkO1Bob25lR2FwLmFkZENvbnN0cnVjdG9yPWZ1bmN0aW9uKGZ1bmMpe3ZhciBzdGF0ZT1kb2N1bWVudC5yZWFkeVN0YXRlO2lmKChzdGF0ZT09ImxvYWRlZCJ8fHN0YXRlPT0iY29tcGxldGUiKSYmRGV2aWNlSW5mby51dWlkIT1udWxsKXtmdW5jKCl9ZWxzZXtQaG9uZUdhcC5fY29uc3RydWN0b3JzLnB1c2goZnVuYyl9fTsoZnVuY3Rpb24oKXt2YXIgdGltZXI9c2V0SW50ZXJ2YWwoZnVuY3Rpb24oKXt2YXIgc3RhdGU9ZG9jdW1lbnQucmVhZHlTdGF0ZTtpZigoc3RhdGU9PSJsb2FkZWQifHxzdGF0ZT09ImNvbXBsZXRlIikmJkRldmljZUluZm8udXVpZCE9bnVsbCl7Y2xlYXJJbnRlcnZhbCh0aW1lcik7d2hpbGUoUGhvbmVHYXAuX2NvbnN0cnVjdG9ycy5sZW5ndGg+MCl7dmFyIGNvbnN0cnVjdG9yPVBob25lR2FwLl9jb25zdHJ1Y3RvcnMuc2hpZnQoKTt0cnl7Y29uc3RydWN0b3IoKX1jYXRjaChlKXtpZih0eXBlb2YoZGVidWcubG9nKT09ImZ1bmN0aW9uIil7ZGVidWcubG9nKCJGYWlsZWQgdG8gcnVuIGNvbnN0cnVjdG9yOiAiK2RlYnVnLnByb2Nlc3NNZXNzYWdlKGUpKX1lbHNle2FsZXJ0KCJGYWlsZWQgdG8gcnVuIGNvbnN0cnVjdG9yOiAiK2UubWVzc2FnZSl9fX12YXIgZT1kb2N1bWVudC5jcmVhdGVFdmVudCgiRXZlbnRzIik7ZS5pbml0RXZlbnQoImRldmljZXJlYWR5Iik7ZG9jdW1lbnQuZGlzcGF0Y2hFdmVudChlKX19LDEpfSkoKTtQaG9uZUdhcC5jYWxsYmFja0lkPTA7UGhvbmVHYXAuY2FsbGJhY2tzPXt9O1Bob25lR2FwLmNhbGxiYWNrU3RhdHVzPXtOT19SRVNVTFQ6MCxPSzoxLENMQVNTX05PVF9GT1VORF9FWENFUFRJT046MixJTExFR0FMX0FDQ0VTU19FWENFUFRJT046MyxJTlNUQU5USUFUSU9OX0VYQ0VQVElPTjo0LE1BTEZPUk1FRF9VUkxfRVhDRVBUSU9OOjUsSU9fRVhDRVBUSU9OOjYsSU5WQUxJRF9BQ1RJT046NyxKU09OX0VYQ0VQVElPTjo4LEVSUk9SOjl9O1Bob25lR2FwLmV4ZWM9ZnVuY3Rpb24oKXtQaG9uZUdhcC5xdWV1ZS5jb21tYW5kcy5wdXNoKGFyZ3VtZW50cyk7aWYoUGhvbmVHYXAucXVldWUudGltZXI9PW51bGwpe1Bob25lR2FwLnF1ZXVlLnRpbWVyPXNldEludGVydmFsKFBob25lR2FwLnJ1bl9jb21tYW5kLDEwKX19O1Bob25lR2FwLnJ1bl9jb21tYW5kPWZ1bmN0aW9uKCl7aWYoIVBob25lR2FwLmF2YWlsYWJsZXx8IVBob25lR2FwLnF1ZXVlLnJlYWR5KXtyZXR1cm59UGhvbmVHYXAucXVldWUucmVhZHk9ZmFsc2U7aWYoIXRoaXMuZ2FwQnJpZGdlKXt0aGlzLmdhcEJyaWRnZT1kb2N1bWVudC5jcmVhdGVFbGVtZW50KCJJRlJBTUUiKTt0aGlzLmdhcEJyaWRnZS5zZXRBdHRyaWJ1dGUoImhlaWdodCIsIjBweCIpO3RoaXMuZ2FwQnJpZGdlLnNldEF0dHJpYnV0ZSgid2lkdGgiLCIwcHgiKTt0aGlzLmdhcEJyaWRnZS5zZXRBdHRyaWJ1dGUoImZyYW1lYm9yZGVyIiwiMCIpO2RvY3VtZW50LmRvY3VtZW50RWxlbWVudC5hcHBlbmRDaGlsZCh0aGlzLmdhcEJyaWRnZSl9dmFyIGFyZ3M9UGhvbmVHYXAucXVldWUuY29tbWFuZHMuc2hpZnQoKTtpZihQaG9uZUdhcC5xdWV1ZS5jb21tYW5kcy5sZW5ndGg9PTApe2NsZWFySW50ZXJ2YWwoUGhvbmVHYXAucXVldWUudGltZXIpO1Bob25lR2FwLnF1ZXVlLnRpbWVyPW51bGx9dmFyIHNlcnZpY2U7dmFyIGNhbGxiYWNrSWQ9bnVsbDt2YXIgc3RhcnQ9MDt0cnl7aWYoYXJnc1swXT09bnVsbHx8dHlwZW9mIGFyZ3NbMF09PT0iZnVuY3Rpb24iKXt2YXIgc3VjY2Vzcz1hcmdzWzBdO3ZhciBmYWlsPWFyZ3NbMV07c2VydmljZT1hcmdzWzJdKyIuIithcmdzWzNdO2FyZ3M9YXJnc1s0XTtjYWxsYmFja0lkPXNlcnZpY2UrUGhvbmVHYXAuY2FsbGJhY2tJZCsrO2lmKHN1Y2Nlc3N8fGZhaWwpe1Bob25lR2FwLmNhbGxiYWNrc1tjYWxsYmFja0lkXT17c3VjY2VzczpzdWNjZXNzLGZhaWw6ZmFpbH19fWVsc2V7c2VydmljZT1hcmdzWzBdO3N0YXJ0PTF9dmFyIHVyaT1bXTt2YXIgZGljdD1udWxsO2Zvcih2YXIgaT1zdGFydDtpPGFyZ3MubGVuZ3RoO2krKyl7dmFyIGFyZz1hcmdzW2ldO2lmKGFyZz09dW5kZWZpbmVkfHxhcmc9PW51bGwpe2NvbnRpbnVlfWlmKHR5cGVvZihhcmcpPT0ib2JqZWN0Iil7ZGljdD1hcmd9ZWxzZXt1cmkucHVzaChlbmNvZGVVUklDb21wb25lbnQoYXJnKSl9fXZhciBuZXh0PWNhbGxiYWNrSWQhPW51bGw/KCIvIitjYWxsYmFja0lkKyIvIik6Ii8iO3ZhciB1cmw9ImdhcDovLyIrc2VydmljZStuZXh0K3VyaS5qb2luKCIvIik7aWYoZGljdCE9bnVsbCl7dXJsKz0iPyIrZW5jb2RlVVJJQ29tcG9uZW50KEpTT04uc3RyaW5naWZ5KGRpY3QpKX10aGlzLmdhcEJyaWRnZS5zcmM9dXJsfWNhdGNoKGUpe2NvbnNvbGUubG9nKCJQaG9uZUdhcEV4ZWMgRXJyb3I6ICIrZSl9fTtQaG9uZUdhcC5jYWxsYmFja1N1Y2Nlc3M9ZnVuY3Rpb24oY2FsbGJhY2tJZCxhcmdzKXtpZihQaG9uZUdhcC5jYWxsYmFja3NbY2FsbGJhY2tJZF0pe2lmKGFyZ3Muc3RhdHVzPT1QaG9uZUdhcC5jYWxsYmFja1N0YXR1cy5PSyl7dHJ5e2lmKFBob25lR2FwLmNhbGxiYWNrc1tjYWxsYmFja0lkXS5zdWNjZXNzKXtQaG9uZUdhcC5jYWxsYmFja3NbY2FsbGJhY2tJZF0uc3VjY2VzcyhhcmdzLm1lc3NhZ2UpfX1jYXRjaChlKXtjb25zb2xlLmxvZygiRXJyb3IgaW4gc3VjY2VzcyBjYWxsYmFjazogIitjYWxsYmFja0lkKyIgPSAiK2UpfX1pZighYXJncy5rZWVwQ2FsbGJhY2spe2RlbGV0ZSBQaG9uZUdhcC5jYWxsYmFja3NbY2FsbGJhY2tJZF19fX07UGhvbmVHYXAuY2FsbGJhY2tFcnJvcj1mdW5jdGlvbihjYWxsYmFja0lkLGFyZ3Mpe2lmKFBob25lR2FwLmNhbGxiYWNrc1tjYWxsYmFja0lkXSl7dHJ5e2lmKFBob25lR2FwLmNhbGxiYWNrc1tjYWxsYmFja0lkXS5mYWlsKXtQaG9uZUdhcC5jYWxsYmFja3NbY2FsbGJhY2tJZF0uZmFpbChhcmdzLm1lc3NhZ2UpfX1jYXRjaChlKXtjb25zb2xlLmxvZygiRXJyb3IgaW4gZXJyb3IgY2FsbGJhY2s6ICIrY2FsbGJhY2tJZCsiID0gIitlKX1pZighYXJncy5rZWVwQ2FsbGJhY2spe2RlbGV0ZSBQaG9uZUdhcC5jYWxsYmFja3NbY2FsbGJhY2tJZF19fX07UGhvbmVHYXAuY2xvbmU9ZnVuY3Rpb24ob2JqKXtpZighb2JqKXtyZXR1cm4gb2JqfWlmKG9iaiBpbnN0YW5jZW9mIEFycmF5KXt2YXIgcmV0VmFsPW5ldyBBcnJheSgpO2Zvcih2YXIgaT0wO2k8b2JqLmxlbmd0aDsrK2kpe3JldFZhbC5wdXNoKFBob25lR2FwLmNsb25lKG9ialtpXSkpfXJldHVybiByZXRWYWx9aWYob2JqIGluc3RhbmNlb2YgRnVuY3Rpb24pe3JldHVybiBvYmp9aWYoIShvYmogaW5zdGFuY2VvZiBPYmplY3QpKXtyZXR1cm4gb2JqfWlmKG9iaiBpbnN0YW5jZW9mIERhdGUpe3JldHVybiBvYmp9cmV0VmFsPW5ldyBPYmplY3QoKTtmb3IoaSBpbiBvYmope2lmKCEoaSBpbiByZXRWYWwpfHxyZXRWYWxbaV0hPW9ialtpXSl7cmV0VmFsW2ldPVBob25lR2FwLmNsb25lKG9ialtpXSl9fXJldHVybiByZXRWYWx9O1Bob25lR2FwLm1fZG9jdW1lbnRfYWRkRXZlbnRMaXN0ZW5lcj1kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyO2RvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXI9ZnVuY3Rpb24oZXZ0LGhhbmRsZXIsY2FwdHVyZSl7dmFyIGU9ZXZ0LnRvTG93ZXJDYXNlKCk7aWYoZT09PSJ1bmxvYWQiKXtQaG9uZUdhcC5vblVubG9hZD1mdW5jdGlvbihlKXtyZXR1cm4gaGFuZGxlcihlKX19ZWxzZXtQaG9uZUdhcC5tX2RvY3VtZW50X2FkZEV2ZW50TGlzdGVuZXIuY2FsbChkb2N1bWVudCxldnQsaGFuZGxlcixjYXB0dXJlKX19O1Bob25lR2FwLm1fZG9jdW1lbnRfcmVtb3ZlRXZlbnRMaXN0ZW5lcj1kb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyO2RvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXI9ZnVuY3Rpb24oZXZ0LGhhbmRsZXIsY2FwdHVyZSl7dmFyIGU9ZXZ0LnRvTG93ZXJDYXNlKCk7aWYoZT09PSJ1bmxvYWQiKXtQaG9uZUdhcC5vblVubG9hZD1udWxsfVBob25lR2FwLm1fZG9jdW1lbnRfcmVtb3ZlRXZlbnRMaXN0ZW5lci5jYWxsKGRvY3VtZW50LGV2dCxoYW5kbGVyLGNhcHR1cmUpfTtQaG9uZUdhcC5maXJlRXZlbnQ9ZnVuY3Rpb24odHlwZSl7dmFyIGU9ZG9jdW1lbnQuY3JlYXRlRXZlbnQoIkV2ZW50cyIpO2UuaW5pdEV2ZW50KHR5cGUpO2RvY3VtZW50LmRpc3BhdGNoRXZlbnQoZSl9fWlmKCFQaG9uZUdhcC5oYXNSZXNvdXJjZSgiZGVidWdjb25zb2xlIikpe1Bob25lR2FwLmFkZFJlc291cmNlKCJkZWJ1Z2NvbnNvbGUiKTtEZWJ1Z0NvbnNvbGU9ZnVuY3Rpb24oaXNEZXByZWNhdGVkKXt0aGlzLmxvZ0xldmVsPURlYnVnQ29uc29sZS5JTkZPX0xFVkVMO3RoaXMuaXNEZXByZWNhdGVkPWlzRGVwcmVjYXRlZD90cnVlOmZhbHNlfTtEZWJ1Z0NvbnNvbGUuQUxMX0xFVkVMPTE7RGVidWdDb25zb2xlLklORk9fTEVWRUw9MTtEZWJ1Z0NvbnNvbGUuV0FSTl9MRVZFTD0yO0RlYnVnQ29uc29sZS5FUlJPUl9MRVZFTD00O0RlYnVnQ29uc29sZS5OT05FX0xFVkVMPTg7RGVidWdDb25zb2xlLnByb3RvdHlwZS5zZXRMZXZlbD1mdW5jdGlvbihsZXZlbCl7dGhpcy5sb2dMZXZlbD1sZXZlbH07RGVidWdDb25zb2xlLnByb3RvdHlwZS5wcm9jZXNzTWVzc2FnZT1mdW5jdGlvbihtZXNzYWdlLG1heERlcHRoKXtpZihtYXhEZXB0aD09PXVuZGVmaW5lZCl7bWF4RGVwdGg9MH1pZih0eXBlb2YobWVzc2FnZSkhPSJvYmplY3QiKXtyZXR1cm4odGhpcy5pc0RlcHJlY2F0ZWQ/IldBUk5JTkc6IGRlYnVnIG9iamVjdCBpcyBkZXByZWNhdGVkLCBwbGVhc2UgdXNlIGNvbnNvbGUgb2JqZWN0IFxuIittZXNzYWdlOm1lc3NhZ2UpfWVsc2V7ZnVuY3Rpb24gaW5kZW50KHN0cil7cmV0dXJuIHN0ci5yZXBsYWNlKC9eL21nLCIgICAgIil9ZnVuY3Rpb24gbWFrZVN0cnVjdHVyZWQob2JqLGRlcHRoKXt2YXIgc3RyPSIiO2Zvcih2YXIgaSBpbiBvYmope3RyeXtpZih0eXBlb2Yob2JqW2ldKT09Im9iamVjdCImJmRlcHRoPG1heERlcHRoKXtzdHIrPWkrIjpcbiIraW5kZW50KG1ha2VTdHJ1Y3R1cmVkKG9ialtpXSkpKyJcbiJ9ZWxzZXtzdHIrPWkrIiA9ICIraW5kZW50KFN0cmluZyhvYmpbaV0pKS5yZXBsYWNlKC9eICAgIC8sIiIpKyJcbiJ9fWNhdGNoKGUpe3N0cis9aSsiID0gRVhDRVBUSU9OOiAiK2UubWVzc2FnZSsiXG4ifX1yZXR1cm4gc3RyfXJldHVybigodGhpcy5pc0RlcHJlY2F0ZWQ/IldBUk5JTkc6IGRlYnVnIG9iamVjdCBpcyBkZXByZWNhdGVkLCBwbGVhc2UgdXNlIGNvbnNvbGUgb2JqZWN0XG4iOiIiKSsiT2JqZWN0OlxuIittYWtlU3RydWN0dXJlZChtZXNzYWdlLG1heERlcHRoKSl9fTtEZWJ1Z0NvbnNvbGUucHJvdG90eXBlLmxvZz1mdW5jdGlvbihtZXNzYWdlLG1heERlcHRoKXtpZihQaG9uZUdhcC5hdmFpbGFibGUmJnRoaXMubG9nTGV2ZWw8PURlYnVnQ29uc29sZS5JTkZPX0xFVkVMKXtQaG9uZUdhcC5leGVjKCJEZWJ1Z0NvbnNvbGUubG9nIix0aGlzLnByb2Nlc3NNZXNzYWdlKG1lc3NhZ2UsbWF4RGVwdGgpLHtsb2dMZXZlbDoiSU5GTyJ9KX1lbHNle2NvbnNvbGUubG9nKG1lc3NhZ2UpfX07RGVidWdDb25zb2xlLnByb3RvdHlwZS53YXJuPWZ1bmN0aW9uKG1lc3NhZ2UsbWF4RGVwdGgpe2lmKFBob25lR2FwLmF2YWlsYWJsZSYmdGhpcy5sb2dMZXZlbDw9RGVidWdDb25zb2xlLldBUk5fTEVWRUwpe1Bob25lR2FwLmV4ZWMoIkRlYnVnQ29uc29sZS5sb2ciLHRoaXMucHJvY2Vzc01lc3NhZ2UobWVzc2FnZSxtYXhEZXB0aCkse2xvZ0xldmVsOiJXQVJOIn0pfWVsc2V7Y29uc29sZS5lcnJvcihtZXNzYWdlKX19O0RlYnVnQ29uc29sZS5wcm90b3R5cGUuZXJyb3I9ZnVuY3Rpb24obWVzc2FnZSxtYXhEZXB0aCl7aWYoUGhvbmVHYXAuYXZhaWxhYmxlJiZ0aGlzLmxvZ0xldmVsPD1EZWJ1Z0NvbnNvbGUuRVJST1JfTEVWRUwpe1Bob25lR2FwLmV4ZWMoIkRlYnVnQ29uc29sZS5sb2ciLHRoaXMucHJvY2Vzc01lc3NhZ2UobWVzc2FnZSxtYXhEZXB0aCkse2xvZ0xldmVsOiJFUlJPUiJ9KX1lbHNle2NvbnNvbGUuZXJyb3IobWVzc2FnZSl9fTtQaG9uZUdhcC5hZGRDb25zdHJ1Y3RvcihmdW5jdGlvbigpe3dpbmRvdy5jb25zb2xlPW5ldyBEZWJ1Z0NvbnNvbGUoKTt3aW5kb3cuZGVidWc9bmV3IERlYnVnQ29uc29sZSh0cnVlKX0pfWlmKCFQaG9uZUdhcC5oYXNSZXNvdXJjZSgicG9zaXRpb24iKSl7UGhvbmVHYXAuYWRkUmVzb3VyY2UoInBvc2l0aW9uIik7UG9zaXRpb249ZnVuY3Rpb24oY29vcmRzLHRpbWVzdGFtcCl7dGhpcy5jb29yZHM9Q29vcmRpbmF0ZXMuY2xvbmVGcm9tKGNvb3Jkcyk7dGhpcy50aW1lc3RhbXA9dGltZXN0YW1wfHxuZXcgRGF0ZSgpLmdldFRpbWUoKX07UG9zaXRpb24ucHJvdG90eXBlLmVxdWFscz1mdW5jdGlvbihvdGhlcil7cmV0dXJuKHRoaXMuY29vcmRzJiZvdGhlciYmb3RoZXIuY29vcmRzJiZ0aGlzLmNvb3Jkcy5sYXRpdHVkZT09b3RoZXIuY29vcmRzLmxhdGl0dWRlJiZ0aGlzLmNvb3Jkcy5sb25naXR1ZGU9PW90aGVyLmNvb3Jkcy5sb25naXR1ZGUpfTtQb3NpdGlvbi5wcm90b3R5cGUuY2xvbmU9ZnVuY3Rpb24oKXtyZXR1cm4gbmV3IFBvc2l0aW9uKHRoaXMuY29vcmRzP3RoaXMuY29vcmRzLmNsb25lKCk6bnVsbCx0aGlzLnRpbWVzdGFtcD90aGlzLnRpbWVzdGFtcDpuZXcgRGF0ZSgpLmdldFRpbWUoKSl9O0Nvb3JkaW5hdGVzPWZ1bmN0aW9uKGxhdCxsbmcsYWx0LGFjYyxoZWFkLHZlbCxhbHRBY2Mpe3RoaXMubGF0aXR1ZGU9bGF0O3RoaXMubG9uZ2l0dWRlPWxuZzt0aGlzLmFsdGl0dWRlPWFsdDt0aGlzLmFjY3VyYWN5PWFjYzt0aGlzLmhlYWRpbmc9aGVhZDt0aGlzLnNwZWVkPXZlbDt0aGlzLmFsdGl0dWRlQWNjdXJhY3k9KGFsdEFjYyE9InVuZGVmaW5lZCIpP2FsdEFjYzpudWxsfTtDb29yZGluYXRlcy5wcm90b3R5cGUuY2xvbmU9ZnVuY3Rpb24oKXtyZXR1cm4gbmV3IENvb3JkaW5hdGVzKHRoaXMubGF0aXR1ZGUsdGhpcy5sb25naXR1ZGUsdGhpcy5hbHRpdHVkZSx0aGlzLmFjY3VyYWN5LHRoaXMuaGVhZGluZyx0aGlzLnNwZWVkLHRoaXMuYWx0aXR1ZGVBY2N1cmFjeSl9O0Nvb3JkaW5hdGVzLmNsb25lRnJvbT1mdW5jdGlvbihvYmope3JldHVybiBuZXcgQ29vcmRpbmF0ZXMob2JqLmxhdGl0dWRlLG9iai5sb25naXR1ZGUsb2JqLmFsdGl0dWRlLG9iai5hY2N1cmFjeSxvYmouaGVhZGluZyxvYmouc3BlZWQsb2JqLmFsdGl0dWRlQWNjdXJhY3kpfTtQb3NpdGlvbk9wdGlvbnM9ZnVuY3Rpb24oZW5hYmxlSGlnaEFjY3VyYWN5LHRpbWVvdXQsbWF4aW11bUFnZSl7dGhpcy5lbmFibGVIaWdoQWNjdXJhY3k9ZW5hYmxlSGlnaEFjY3VyYWN5fHxmYWxzZTt0aGlzLnRpbWVvdXQ9dGltZW91dHx8MTAwMDA7dGhpcy5tYXhpbXVtQWdlPW1heGltdW1BZ2V8fDB9O1Bvc2l0aW9uRXJyb3I9ZnVuY3Rpb24oY29kZSxtZXNzYWdlKXt0aGlzLmNvZGU9Y29kZXx8MDt0aGlzLm1lc3NhZ2U9bWVzc2FnZXx8IiJ9O1Bvc2l0aW9uRXJyb3IuVU5LTk9XTl9FUlJPUj0wO1Bvc2l0aW9uRXJyb3IuUEVSTUlTU0lPTl9ERU5JRUQ9MTtQb3NpdGlvbkVycm9yLlBPU0lUSU9OX1VOQVZBSUxBQkxFPTI7UG9zaXRpb25FcnJvci5USU1FT1VUPTN9aWYoIVBob25lR2FwLmhhc1Jlc291cmNlKCJhY2NlbGVyYXRpb24iKSl7UGhvbmVHYXAuYWRkUmVzb3VyY2UoImFjY2VsZXJhdGlvbiIpO0FjY2VsZXJhdGlvbj1mdW5jdGlvbih4LHkseil7dGhpcy54PXg7dGhpcy55PXk7dGhpcy56PXo7dGhpcy50aW1lc3RhbXA9bmV3IERhdGUoKS5nZXRUaW1lKCl9O0FjY2VsZXJhdGlvbk9wdGlvbnM9ZnVuY3Rpb24oKXt0aGlzLnRpbWVvdXQ9MTAwMDB9fWlmKCFQaG9uZUdhcC5oYXNSZXNvdXJjZSgiYWNjZWxlcm9tZXRlciIpKXtQaG9uZUdhcC5hZGRSZXNvdXJjZSgiYWNjZWxlcm9tZXRlciIpO0FjY2VsZXJvbWV0ZXI9ZnVuY3Rpb24oKXt0aGlzLmxhc3RBY2NlbGVyYXRpb249bmV3IEFjY2VsZXJhdGlvbigwLDAsMCl9O0FjY2VsZXJvbWV0ZXIucHJvdG90eXBlLmdldEN1cnJlbnRBY2NlbGVyYXRpb249ZnVuY3Rpb24oc3VjY2Vzc0NhbGxiYWNrLGVycm9yQ2FsbGJhY2ssb3B0aW9ucyl7aWYodHlwZW9mIHN1Y2Nlc3NDYWxsYmFjaz09ImZ1bmN0aW9uIil7c3VjY2Vzc0NhbGxiYWNrKHRoaXMubGFzdEFjY2VsZXJhdGlvbil9fTtBY2NlbGVyb21ldGVyLnByb3RvdHlwZS5fb25BY2NlbFVwZGF0ZT1mdW5jdGlvbih4LHkseil7dGhpcy5sYXN0QWNjZWxlcmF0aW9uPW5ldyBBY2NlbGVyYXRpb24oeCx5LHopfTtBY2NlbGVyb21ldGVyLnByb3RvdHlwZS53YXRjaEFjY2VsZXJhdGlvbj1mdW5jdGlvbihzdWNjZXNzQ2FsbGJhY2ssZXJyb3JDYWxsYmFjayxvcHRpb25zKXt2YXIgZnJlcXVlbmN5PShvcHRpb25zIT11bmRlZmluZWQmJm9wdGlvbnMuZnJlcXVlbmN5IT11bmRlZmluZWQpP29wdGlvbnMuZnJlcXVlbmN5OjEwMDAwO3ZhciB1cGRhdGVkT3B0aW9ucz17ZGVzaXJlZEZyZXF1ZW5jeTpmcmVxdWVuY3l9O1Bob25lR2FwLmV4ZWMoIkFjY2VsZXJvbWV0ZXIuc3RhcnQiLG9wdGlvbnMpO3JldHVybiBzZXRJbnRlcnZhbChmdW5jdGlvbigpe25hdmlnYXRvci5hY2NlbGVyb21ldGVyLmdldEN1cnJlbnRBY2NlbGVyYXRpb24oc3VjY2Vzc0NhbGxiYWNrLGVycm9yQ2FsbGJhY2ssb3B0aW9ucyl9LGZyZXF1ZW5jeSl9O0FjY2VsZXJvbWV0ZXIucHJvdG90eXBlLmNsZWFyV2F0Y2g9ZnVuY3Rpb24od2F0Y2hJZCl7UGhvbmVHYXAuZXhlYygiQWNjZWxlcm9tZXRlci5zdG9wIik7Y2xlYXJJbnRlcnZhbCh3YXRjaElkKX07UGhvbmVHYXAuYWRkQ29uc3RydWN0b3IoZnVuY3Rpb24oKXtpZih0eXBlb2YgbmF2aWdhdG9yLmFjY2VsZXJvbWV0ZXI9PSJ1bmRlZmluZWQiKXtuYXZpZ2F0b3IuYWNjZWxlcm9tZXRlcj1uZXcgQWNjZWxlcm9tZXRlcigpfX0pfWlmKCFQaG9uZUdhcC5oYXNSZXNvdXJjZSgiY2FtZXJhIikpe1Bob25lR2FwLmFkZFJlc291cmNlKCJjYW1lcmEiKTtDYXB0dXJlRXJyb3I9ZnVuY3Rpb24oKXt0aGlzLmNvZGU9bnVsbH07Q2FwdHVyZUVycm9yLkNBUFRVUkVfSU5URVJOQUxfRVJSPTA7Q2FwdHVyZUVycm9yLkNBUFRVUkVfQVBQTElDQVRJT05fQlVTWT0xO0NhcHR1cmVFcnJvci5DQVBUVVJFX0lOVkFMSURfQVJHVU1FTlQ9MjtDYXB0dXJlRXJyb3IuQ0FQVFVSRV9OT19NRURJQV9GSUxFUz0zO0NhbWVyYT1mdW5jdGlvbigpe307Q2FtZXJhLkRlc3RpbmF0aW9uVHlwZT17REFUQV9VUkw6MCxGSUxFX1VSSToxfTtDYW1lcmEucHJvdG90eXBlLkRlc3RpbmF0aW9uVHlwZT1DYW1lcmEuRGVzdGluYXRpb25UeXBlO0NhbWVyYS5QaWN0dXJlU291cmNlVHlwZT17UEhPVE9MSUJSQVJZOjAsQ0FNRVJBOjEsU0FWRURQSE9UT0FMQlVNOjJ9O0NhbWVyYS5wcm90b3R5cGUuUGljdHVyZVNvdXJjZVR5cGU9Q2FtZXJhLlBpY3R1cmVTb3VyY2VUeXBlO0NhbWVyYS5wcm90b3R5cGUuZ2V0UGljdHVyZT1mdW5jdGlvbihzdWNjZXNzQ2FsbGJhY2ssZXJyb3JDYWxsYmFjayxvcHRpb25zKXtpZih0eXBlb2Ygc3VjY2Vzc0NhbGxiYWNrIT0iZnVuY3Rpb24iKXtjb25zb2xlLmxvZygiQ2FtZXJhIEVycm9yOiBzdWNjZXNzQ2FsbGJhY2sgaXMgbm90IGEgZnVuY3Rpb24iKTtyZXR1cm59aWYoZXJyb3JDYWxsYmFjayYmKHR5cGVvZiBlcnJvckNhbGxiYWNrIT0iZnVuY3Rpb24iKSl7Y29uc29sZS5sb2coIkNhbWVyYSBFcnJvcjogZXJyb3JDYWxsYmFjayBpcyBub3QgYSBmdW5jdGlvbiIpO3JldHVybn1QaG9uZUdhcC5leGVjKHN1Y2Nlc3NDYWxsYmFjayxlcnJvckNhbGxiYWNrLCJDYW1lcmEiLCJnZXRQaWN0dXJlIixbb3B0aW9uc10pfTtQaG9uZUdhcC5hZGRDb25zdHJ1Y3RvcihmdW5jdGlvbigpe2lmKHR5cGVvZiBuYXZpZ2F0b3IuY2FtZXJhPT0idW5kZWZpbmVkIil7bmF2aWdhdG9yLmNhbWVyYT1uZXcgQ2FtZXJhKCl9fSl9aWYoIVBob25lR2FwLmhhc1Jlc291cmNlKCJjb250YWN0Iikpe1Bob25lR2FwLmFkZFJlc291cmNlKCJjb250YWN0Iik7dmFyIENvbnRhY3Q9ZnVuY3Rpb24oaWQsZGlzcGxheU5hbWUsbmFtZSxuaWNrbmFtZSxwaG9uZU51bWJlcnMsZW1haWxzLGFkZHJlc3NlcyxpbXMsb3JnYW5pemF0aW9ucyxyZXZpc2lvbixiaXJ0aGRheSxnZW5kZXIsbm90ZSxwaG90b3MsY2F0ZWdvcmllcyx1cmxzLHRpbWV6b25lKXt0aGlzLmlkPWlkfHxudWxsO3RoaXMuZGlzcGxheU5hbWU9ZGlzcGxheU5hbWV8fG51bGw7dGhpcy5uYW1lPW5hbWV8fG51bGw7dGhpcy5uaWNrbmFtZT1uaWNrbmFtZXx8bnVsbDt0aGlzLnBob25lTnVtYmVycz1waG9uZU51bWJlcnN8fG51bGw7dGhpcy5lbWFpbHM9ZW1haWxzfHxudWxsO3RoaXMuYWRkcmVzc2VzPWFkZHJlc3Nlc3x8bnVsbDt0aGlzLmltcz1pbXN8fG51bGw7dGhpcy5vcmdhbml6YXRpb25zPW9yZ2FuaXphdGlvbnN8fG51bGw7dGhpcy5yZXZpc2lvbj1yZXZpc2lvbnx8bnVsbDt0aGlzLmJpcnRoZGF5PWJpcnRoZGF5fHxudWxsO3RoaXMuZ2VuZGVyPWdlbmRlcnx8bnVsbDt0aGlzLm5vdGU9bm90ZXx8bnVsbDt0aGlzLnBob3Rvcz1waG90b3N8fG51bGw7dGhpcy5jYXRlZ29yaWVzPWNhdGVnb3JpZXN8fG51bGw7dGhpcy51cmxzPXVybHN8fG51bGw7dGhpcy50aW1lem9uZT10aW1lem9uZXx8bnVsbH07Q29udGFjdC5wcm90b3R5cGUuY29udmVydERhdGVzT3V0PWZ1bmN0aW9uKCl7dmFyIGRhdGVzPW5ldyBBcnJheSgicmV2aXNpb24iLCJiaXJ0aGRheSIpO2Zvcih2YXIgaT0wO2k8ZGF0ZXMubGVuZ3RoO2krKyl7dmFyIHZhbHVlPXRoaXNbZGF0ZXNbaV1dO2lmKHZhbHVlKXtpZighdmFsdWUgaW5zdGFuY2VvZiBEYXRlKXt0cnl7dmFsdWU9bmV3IERhdGUodmFsdWUpfWNhdGNoKGV4Y2VwdGlvbil7dmFsdWU9bnVsbH19aWYodmFsdWUgaW5zdGFuY2VvZiBEYXRlKXt2YWx1ZT12YWx1ZS52YWx1ZU9mKCl9dGhpc1tkYXRlc1tpXV09dmFsdWV9fX07Q29udGFjdC5wcm90b3R5cGUuY29udmVydERhdGVzSW49ZnVuY3Rpb24oKXt2YXIgZGF0ZXM9bmV3IEFycmF5KCJyZXZpc2lvbiIsImJpcnRoZGF5Iik7Zm9yKHZhciBpPTA7aTxkYXRlcy5sZW5ndGg7aSsrKXt2YXIgdmFsdWU9dGhpc1tkYXRlc1tpXV07aWYodmFsdWUpe3RyeXt0aGlzW2RhdGVzW2ldXT1uZXcgRGF0ZShwYXJzZUZsb2F0KHZhbHVlKSl9Y2F0Y2goZXhjZXB0aW9uKXtjb25zb2xlLmxvZygiZXhjZXB0aW9uIGNyZWF0aW5nIGRhdGUiKX19fX07Q29udGFjdC5wcm90b3R5cGUucmVtb3ZlPWZ1bmN0aW9uKHN1Y2Nlc3NDQixlcnJvckNCKXtpZih0aGlzLmlkPT1udWxsKXt2YXIgZXJyb3JPYmo9bmV3IENvbnRhY3RFcnJvcigpO2Vycm9yT2JqLmNvZGU9Q29udGFjdEVycm9yLk5PVF9GT1VORF9FUlJPUjtlcnJvckNCKGVycm9yT2JqKX1lbHNle1Bob25lR2FwLmV4ZWMoc3VjY2Vzc0NCLGVycm9yQ0IsIkNvbnRhY3RzIiwicmVtb3ZlIixbe2NvbnRhY3Q6dGhpc31dKX19O0NvbnRhY3QucHJvdG90eXBlLmRpc3BsYXk9ZnVuY3Rpb24oc3VjY2Vzc0NCLGVycm9yQ0Isb3B0aW9ucyl7aWYodGhpcy5pZD09bnVsbCl7dmFyIGVycm9yT2JqPW5ldyBDb250YWN0RXJyb3IoKTtlcnJvck9iai5jb2RlPUNvbnRhY3RFcnJvci5OT1RfRk9VTkRfRVJST1I7ZXJyb3JDQihlcnJvck9iail9ZWxzZXtQaG9uZUdhcC5leGVjKHN1Y2Nlc3NDQixlcnJvckNCLCJDb250YWN0cyIsImRpc3BsYXlDb250YWN0IixbdGhpcy5pZCxvcHRpb25zXSl9fTtDb250YWN0LnByb3RvdHlwZS5jbG9uZT1mdW5jdGlvbigpe3ZhciBjbG9uZWRDb250YWN0PVBob25lR2FwLmNsb25lKHRoaXMpO2Nsb25lZENvbnRhY3QuaWQ9bnVsbDtpZihjbG9uZWRDb250YWN0LnBob25lTnVtYmVycyl7Zm9yKGk9MDtpPGNsb25lZENvbnRhY3QucGhvbmVOdW1iZXJzLmxlbmd0aDtpKyspe2Nsb25lZENvbnRhY3QucGhvbmVOdW1iZXJzW2ldLmlkPW51bGx9fWlmKGNsb25lZENvbnRhY3QuZW1haWxzKXtmb3IoaT0wO2k8Y2xvbmVkQ29udGFjdC5lbWFpbHMubGVuZ3RoO2krKyl7Y2xvbmVkQ29udGFjdC5lbWFpbHNbaV0uaWQ9bnVsbH19aWYoY2xvbmVkQ29udGFjdC5hZGRyZXNzZXMpe2ZvcihpPTA7aTxjbG9uZWRDb250YWN0LmFkZHJlc3Nlcy5sZW5ndGg7aSsrKXtjbG9uZWRDb250YWN0LmFkZHJlc3Nlc1tpXS5pZD1udWxsfX1pZihjbG9uZWRDb250YWN0Lmltcyl7Zm9yKGk9MDtpPGNsb25lZENvbnRhY3QuaW1zLmxlbmd0aDtpKyspe2Nsb25lZENvbnRhY3QuaW1zW2ldLmlkPW51bGx9fWlmKGNsb25lZENvbnRhY3Qub3JnYW5pemF0aW9ucyl7Zm9yKGk9MDtpPGNsb25lZENvbnRhY3Qub3JnYW5pemF0aW9ucy5sZW5ndGg7aSsrKXtjbG9uZWRDb250YWN0Lm9yZ2FuaXphdGlvbnNbaV0uaWQ9bnVsbH19aWYoY2xvbmVkQ29udGFjdC5waG90b3Mpe2ZvcihpPTA7aTxjbG9uZWRDb250YWN0LnBob3Rvcy5sZW5ndGg7aSsrKXtjbG9uZWRDb250YWN0LnBob3Rvc1tpXS5pZD1udWxsfX1pZihjbG9uZWRDb250YWN0LnVybHMpe2ZvcihpPTA7aTxjbG9uZWRDb250YWN0LnVybHMubGVuZ3RoO2krKyl7Y2xvbmVkQ29udGFjdC51cmxzW2ldLmlkPW51bGx9fXJldHVybiBjbG9uZWRDb250YWN0fTtDb250YWN0LnByb3RvdHlwZS5zYXZlPWZ1bmN0aW9uKHN1Y2Nlc3NDQixlcnJvckNCKXt2YXIgY2xvbmVkPVBob25lR2FwLmNsb25lKHRoaXMpO2Nsb25lZC5jb252ZXJ0RGF0ZXNPdXQoKTtQaG9uZUdhcC5leGVjKHN1Y2Nlc3NDQixlcnJvckNCLCJDb250YWN0cyIsInNhdmUiLFt7Y29udGFjdDpjbG9uZWR9XSl9O3ZhciBDb250YWN0TmFtZT1mdW5jdGlvbihmb3JtYXR0ZWQsZmFtaWx5TmFtZSxnaXZlbk5hbWUsbWlkZGxlLHByZWZpeCxzdWZmaXgpe3RoaXMuZm9ybWF0dGVkPWZvcm1hdHRlZCE9InVuZGVmaW5lZCI/Zm9ybWF0dGVkOm51bGw7dGhpcy5mYW1pbHlOYW1lPWZhbWlseU5hbWUhPSJ1bmRlZmluZWQiP2ZhbWlseU5hbWU6bnVsbDt0aGlzLmdpdmVuTmFtZT1naXZlbk5hbWUhPSJ1bmRlZmluZWQiP2dpdmVuTmFtZTpudWxsO3RoaXMubWlkZGxlTmFtZT1taWRkbGUhPSJ1bmRlZmluZWQiP21pZGRsZTpudWxsO3RoaXMuaG9ub3JpZmljUHJlZml4PXByZWZpeCE9InVuZGVmaW5lZCI/cHJlZml4Om51bGw7dGhpcy5ob25vcmlmaWNTdWZmaXg9c3VmZml4IT0idW5kZWZpbmVkIj9zdWZmaXg6bnVsbH07dmFyIENvbnRhY3RGaWVsZD1mdW5jdGlvbih0eXBlLHZhbHVlLHByZWYsaWQpe3RoaXMudHlwZT10eXBlIT0idW5kZWZpbmVkIj90eXBlOm51bGw7dGhpcy52YWx1ZT12YWx1ZSE9InVuZGVmaW5lZCI/dmFsdWU6bnVsbDt0aGlzLnByZWY9cHJlZiE9InVuZGVmaW5lZCI/cHJlZjpudWxsO3RoaXMuaWQ9aWQhPSJ1bmRlZmluZWQiP2lkOm51bGx9O3ZhciBDb250YWN0QWRkcmVzcz1mdW5jdGlvbihmb3JtYXR0ZWQsc3RyZWV0QWRkcmVzcyxsb2NhbGl0eSxyZWdpb24scG9zdGFsQ29kZSxjb3VudHJ5LGlkKXt0aGlzLmZvcm1hdHRlZD1mb3JtYXR0ZWQhPSJ1bmRlZmluZWQiP2Zvcm1hdHRlZDpudWxsO3RoaXMuc3RyZWV0QWRkcmVzcz1zdHJlZXRBZGRyZXNzIT0idW5kZWZpbmVkIj9zdHJlZXRBZGRyZXNzOm51bGw7dGhpcy5sb2NhbGl0eT1sb2NhbGl0eSE9InVuZGVmaW5lZCI/bG9jYWxpdHk6bnVsbDt0aGlzLnJlZ2lvbj1yZWdpb24hPSJ1bmRlZmluZWQiP3JlZ2lvbjpudWxsO3RoaXMucG9zdGFsQ29kZT1wb3N0YWxDb2RlIT0idW5kZWZpbmVkIj9wb3N0YWxDb2RlOm51bGw7dGhpcy5jb3VudHJ5PWNvdW50cnkhPSJ1bmRlZmluZWQiP2NvdW50cnk6bnVsbDt0aGlzLmlkPWlkIT0idW5kZWZpbmVkIj9pZDpudWxsfTt2YXIgQ29udGFjdE9yZ2FuaXphdGlvbj1mdW5jdGlvbihuYW1lLGRlcHQsdGl0bGUsc3RhcnREYXRlLGVuZERhdGUsbG9jYXRpb24sZGVzYyl7dGhpcy5uYW1lPW5hbWUhPSJ1bmRlZmluZWQiP25hbWU6bnVsbDt0aGlzLmRlcGFydG1lbnQ9ZGVwdCE9InVuZGVmaW5lZCI/ZGVwdDpudWxsO3RoaXMudGl0bGU9dGl0bGUhPSJ1bmRlZmluZWQiP3RpdGxlOm51bGw7dGhpcy5zdGFydERhdGU9c3RhcnREYXRlIT0idW5kZWZpbmVkIj9zdGFydERhdGU6bnVsbDt0aGlzLmVuZERhdGU9ZW5kRGF0ZSE9InVuZGVmaW5lZCI/ZW5kRGF0ZTpudWxsO3RoaXMubG9jYXRpb249bG9jYXRpb24hPSJ1bmRlZmluZWQiP2xvY2F0aW9uOm51bGw7dGhpcy5kZXNjcmlwdGlvbj1kZXNjIT0idW5kZWZpbmVkIj9kZXNjOm51bGx9O3ZhciBDb250YWN0QWNjb3VudD1mdW5jdGlvbihkb21haW4sdXNlcm5hbWUsdXNlcmlkKXt0aGlzLmRvbWFpbj1kb21haW4hPSJ1bmRlZmluZWQiP2RvbWFpbjpudWxsO3RoaXMudXNlcm5hbWU9dXNlcm5hbWUhPSJ1bmRlZmluZWQiP3VzZXJuYW1lOm51bGw7dGhpcy51c2VyaWQ9dXNlcmlkIT0idW5kZWZpbmVkIj91c2VyaWQ6bnVsbH07dmFyIENvbnRhY3RzPWZ1bmN0aW9uKCl7dGhpcy5pblByb2dyZXNzPWZhbHNlO3RoaXMucmVjb3Jkcz1uZXcgQXJyYXkoKTt0aGlzLnJlc3VsdHNDYWxsYmFjaz1udWxsO3RoaXMuZXJyb3JDYWxsYmFjaz1udWxsfTtDb250YWN0cy5wcm90b3R5cGUuZmluZD1mdW5jdGlvbihmaWVsZHMsc3VjY2Vzc0NCLGVycm9yQ0Isb3B0aW9ucyl7dmFyIHRoZU9wdGlvbnM9b3B0aW9uc3x8bnVsbDtpZih0aGVPcHRpb25zIT1udWxsKXt2YXIgdmFsdWU9dGhlT3B0aW9ucy51cGRhdGVkU2luY2U7aWYodmFsdWUhPSIiKXtpZighdmFsdWUgaW5zdGFuY2VvZiBEYXRlKXt0cnl7dmFsdWU9bmV3IERhdGUodmFsdWUpfWNhdGNoKGV4Y2VwdGlvbil7dmFsdWU9bnVsbH19aWYodmFsdWUgaW5zdGFuY2VvZiBEYXRlKXt0aGVPcHRpb25zLnVwZGF0ZWRTaW5jZT12YWx1ZS52YWx1ZU9mKCl9fX1QaG9uZUdhcC5leGVjKHN1Y2Nlc3NDQixlcnJvckNCLCJDb250YWN0cyIsInNlYXJjaCIsW3tmaWVsZHM6ZmllbGRzLGZpbmRPcHRpb25zOnRoZU9wdGlvbnN9XSl9O0NvbnRhY3RzLnByb3RvdHlwZS5fZmluZENhbGxiYWNrPWZ1bmN0aW9uKHBsdWdpblJlc3VsdCl7dmFyIGNvbnRhY3RzPW5ldyBBcnJheSgpO3RyeXtmb3IodmFyIGk9MDtpPHBsdWdpblJlc3VsdC5tZXNzYWdlLmxlbmd0aDtpKyspe3ZhciBuZXdDb250YWN0PW5hdmlnYXRvci5zZXJ2aWNlLmNvbnRhY3RzLmNyZWF0ZShwbHVnaW5SZXN1bHQubWVzc2FnZVtpXSk7bmV3Q29udGFjdC5jb252ZXJ0RGF0ZXNJbigpO2NvbnRhY3RzLnB1c2gobmV3Q29udGFjdCl9cGx1Z2luUmVzdWx0Lm1lc3NhZ2U9Y29udGFjdHN9Y2F0Y2goZSl7Y29uc29sZS5sb2coIkVycm9yIHBhcnNpbmcgY29udGFjdHM6ICIrZSl9cmV0dXJuIHBsdWdpblJlc3VsdH07Q29udGFjdHMucHJvdG90eXBlLl9jb250YWN0Q2FsbGJhY2s9ZnVuY3Rpb24ocGx1Z2luUmVzdWx0KXt2YXIgbmV3Q29udGFjdD1udWxsO2lmKHBsdWdpblJlc3VsdC5tZXNzYWdlKXt0cnl7bmV3Q29udGFjdD1uYXZpZ2F0b3Iuc2VydmljZS5jb250YWN0cy5jcmVhdGUocGx1Z2luUmVzdWx0Lm1lc3NhZ2UpO25ld0NvbnRhY3QuY29udmVydERhdGVzSW4oKX1jYXRjaChlKXtjb25zb2xlLmxvZygiRXJyb3IgcGFyc2luZyBjb250YWN0Iil9fXBsdWdpblJlc3VsdC5tZXNzYWdlPW5ld0NvbnRhY3Q7cmV0dXJuIHBsdWdpblJlc3VsdH07Q29udGFjdHMucHJvdG90eXBlLl9lcnJDYWxsYmFjaz1mdW5jdGlvbihwbHVnaW5SZXN1bHQpe3ZhciBlcnJvck9iaj1uZXcgQ29udGFjdEVycm9yKCk7ZXJyb3JPYmouY29kZT1wbHVnaW5SZXN1bHQubWVzc2FnZTtwbHVnaW5SZXN1bHQubWVzc2FnZT1lcnJvck9iajtyZXR1cm4gcGx1Z2luUmVzdWx0fTtDb250YWN0cy5wcm90b3R5cGUubmV3Q29udGFjdFVJPWZ1bmN0aW9uKHN1Y2Nlc3NDYWxsYmFjayl7UGhvbmVHYXAuZXhlYyhzdWNjZXNzQ2FsbGJhY2ssbnVsbCwiQ29udGFjdHMiLCJuZXdDb250YWN0IixbXSl9O0NvbnRhY3RzLnByb3RvdHlwZS5jaG9vc2VDb250YWN0PWZ1bmN0aW9uKHN1Y2Nlc3NDYWxsYmFjayxvcHRpb25zKXtQaG9uZUdhcC5leGVjKHN1Y2Nlc3NDYWxsYmFjayxudWxsLCJDb250YWN0cyIsImNob29zZUNvbnRhY3QiLG9wdGlvbnMpfTtDb250YWN0cy5wcm90b3R5cGUuY3JlYXRlPWZ1bmN0aW9uKHByb3BlcnRpZXMpe3ZhciBjb250YWN0PW5ldyBDb250YWN0KCk7Zm9yKGkgaW4gcHJvcGVydGllcyl7aWYoY29udGFjdFtpXSE9InVuZGVmaW5lZCIpe2NvbnRhY3RbaV09cHJvcGVydGllc1tpXX19cmV0dXJuIGNvbnRhY3R9O3ZhciBDb250YWN0RmluZE9wdGlvbnM9ZnVuY3Rpb24oZmlsdGVyLG11bHRpcGxlLHVwZGF0ZWRTaW5jZSl7dGhpcy5maWx0ZXI9ZmlsdGVyfHwiIjt0aGlzLm11bHRpcGxlPW11bHRpcGxlfHx0cnVlO3RoaXMudXBkYXRlZFNpbmNlPXVwZGF0ZWRTaW5jZXx8IiJ9O3ZhciBDb250YWN0RXJyb3I9ZnVuY3Rpb24oKXt0aGlzLmNvZGU9bnVsbH07Q29udGFjdEVycm9yLlVOS05PV05fRVJST1I9MDtDb250YWN0RXJyb3IuSU5WQUxJRF9BUkdVTUVOVF9FUlJPUj0xO0NvbnRhY3RFcnJvci5OT1RfRk9VTkRfRVJST1I9MjtDb250YWN0RXJyb3IuVElNRU9VVF9FUlJPUj0zO0NvbnRhY3RFcnJvci5QRU5ESU5HX09QRVJBVElPTl9FUlJPUj00O0NvbnRhY3RFcnJvci5JT19FUlJPUj01O0NvbnRhY3RFcnJvci5OT1RfU1VQUE9SVEVEX0VSUk9SPTY7Q29udGFjdEVycm9yLlBFUk1JU1NJT05fREVOSUVEX0VSUk9SPTIwO1Bob25lR2FwLmFkZENvbnN0cnVjdG9yKGZ1bmN0aW9uKCl7aWYodHlwZW9mIG5hdmlnYXRvci5zZXJ2aWNlPT0idW5kZWZpbmVkIil7bmF2aWdhdG9yLnNlcnZpY2U9bmV3IE9iamVjdCgpfWlmKHR5cGVvZiBuYXZpZ2F0b3Iuc2VydmljZS5jb250YWN0cz09InVuZGVmaW5lZCIpe25hdmlnYXRvci5zZXJ2aWNlLmNvbnRhY3RzPW5ldyBDb250YWN0cygpfX0pfWlmKCFQaG9uZUdhcC5oYXNSZXNvdXJjZSgiZGV2aWNlIikpe1Bob25lR2FwLmFkZFJlc291cmNlKCJkZXZpY2UiKTtEZXZpY2U9ZnVuY3Rpb24oKXt0aGlzLnBsYXRmb3JtPW51bGw7dGhpcy52ZXJzaW9uPW51bGw7dGhpcy5uYW1lPW51bGw7dGhpcy5waG9uZWdhcD1udWxsO3RoaXMudXVpZD1udWxsO3RyeXt0aGlzLnBsYXRmb3JtPURldmljZUluZm8ucGxhdGZvcm07dGhpcy52ZXJzaW9uPURldmljZUluZm8udmVyc2lvbjt0aGlzLm5hbWU9RGV2aWNlSW5mby5uYW1lO3RoaXMucGhvbmVnYXA9RGV2aWNlSW5mby5nYXA7dGhpcy51dWlkPURldmljZUluZm8udXVpZH1jYXRjaChlKXt9dGhpcy5hdmFpbGFibGU9UGhvbmVHYXAuYXZhaWxhYmxlPXRoaXMudXVpZCE9bnVsbH07UGhvbmVHYXAuYWRkQ29uc3RydWN0b3IoZnVuY3Rpb24oKXtuYXZpZ2F0b3IuZGV2aWNlPXdpbmRvdy5kZXZpY2U9bmV3IERldmljZSgpfSl9aWYoIVBob25lR2FwLmhhc1Jlc291cmNlKCJmaWxlIikpe1Bob25lR2FwLmFkZFJlc291cmNlKCJmaWxlIik7RmlsZVByb3BlcnRpZXM9ZnVuY3Rpb24oZmlsZVBhdGgpe3RoaXMuZmlsZVBhdGg9ZmlsZVBhdGg7dGhpcy5zaXplPTA7dGhpcy5sYXN0TW9kaWZpZWREYXRlPW51bGx9O0ZpbGU9ZnVuY3Rpb24obmFtZSxmdWxsUGF0aCx0eXBlLGxhc3RNb2RpZmllZERhdGUsc2l6ZSl7dGhpcy5uYW1lPW5hbWV8fG51bGw7dGhpcy5mdWxsUGF0aD1mdWxsUGF0aHx8bnVsbDt0aGlzLnR5cGU9dHlwZXx8bnVsbDt0aGlzLmxhc3RNb2RpZmllZERhdGU9bGFzdE1vZGlmaWVkRGF0ZXx8bnVsbDt0aGlzLnNpemU9c2l6ZXx8MH07RmlsZS5fY3JlYXRlRXZlbnQ9ZnVuY3Rpb24odHlwZSx0YXJnZXQpe3ZhciBldnQ9e3R5cGU6dHlwZX07ZXZ0LnRhcmdldD10YXJnZXQ7cmV0dXJuIGV2dH07RmlsZUVycm9yPWZ1bmN0aW9uKCl7dGhpcy5jb2RlPW51bGx9O0ZpbGVFcnJvci5OT1RfRk9VTkRfRVJSPTE7RmlsZUVycm9yLlNFQ1VSSVRZX0VSUj0yO0ZpbGVFcnJvci5BQk9SVF9FUlI9MztGaWxlRXJyb3IuTk9UX1JFQURBQkxFX0VSUj00O0ZpbGVFcnJvci5FTkNPRElOR19FUlI9NTtGaWxlRXJyb3IuTk9fTU9ESUZJQ0FUSU9OX0FMTE9XRURfRVJSPTY7RmlsZUVycm9yLklOVkFMSURfU1RBVEVfRVJSPTc7RmlsZUVycm9yLlNZTlRBWF9FUlI9ODtGaWxlRXJyb3IuSU5WQUxJRF9NT0RJRklDQVRJT05fRVJSPTk7RmlsZUVycm9yLlFVT1RBX0VYQ0VFREVEX0VSUj0xMDtGaWxlRXJyb3IuVFlQRV9NSVNNQVRDSF9FUlI9MTE7RmlsZUVycm9yLlBBVEhfRVhJU1RTX0VSUj0xMjtGaWxlTWdyPWZ1bmN0aW9uKCl7fTtGaWxlTWdyLnByb3RvdHlwZS50ZXN0RmlsZUV4aXN0cz1mdW5jdGlvbihmaWxlTmFtZSxzdWNjZXNzQ2FsbGJhY2ssZXJyb3JDYWxsYmFjayl7UGhvbmVHYXAuZXhlYyhzdWNjZXNzQ2FsbGJhY2ssZXJyb3JDYWxsYmFjaywiRmlsZSIsInRlc3RGaWxlRXhpc3RzIixbZmlsZU5hbWVdKX07RmlsZU1nci5wcm90b3R5cGUudGVzdERpcmVjdG9yeUV4aXN0cz1mdW5jdGlvbihkaXJOYW1lLHN1Y2Nlc3NDYWxsYmFjayxlcnJvckNhbGxiYWNrKXtQaG9uZUdhcC5leGVjKHN1Y2Nlc3NDYWxsYmFjayxlcnJvckNhbGxiYWNrLCJGaWxlIiwidGVzdERpcmVjdG9yeUV4aXN0cyIsW2Rpck5hbWVdKX07RmlsZU1nci5wcm90b3R5cGUuZ2V0RnJlZURpc2tTcGFjZT1mdW5jdGlvbihzdWNjZXNzQ2FsbGJhY2ssZXJyb3JDYWxsYmFjayl7UGhvbmVHYXAuZXhlYyhzdWNjZXNzQ2FsbGJhY2ssZXJyb3JDYWxsYmFjaywiRmlsZSIsImdldEZyZWVEaXNrU3BhY2UiLFtdKX07RmlsZU1nci5wcm90b3R5cGUud3JpdGVBc1RleHQ9ZnVuY3Rpb24oZmlsZU5hbWUsZGF0YSxiQXBwZW5kLHN1Y2Nlc3NDYWxsYmFjayxlcnJvckNhbGxiYWNrKXtQaG9uZUdhcC5leGVjKHN1Y2Nlc3NDYWxsYmFjayxlcnJvckNhbGxiYWNrLCJGaWxlIiwid3JpdGUiLFtmaWxlTmFtZSxkYXRhLGJBcHBlbmQ/MTowXSl9O0ZpbGVNZ3IucHJvdG90eXBlLndyaXRlPWZ1bmN0aW9uKGZpbGVOYW1lLGRhdGEscG9zaXRpb24sc3VjY2Vzc0NhbGxiYWNrLGVycm9yQ2FsbGJhY2spe1Bob25lR2FwLmV4ZWMoc3VjY2Vzc0NhbGxiYWNrLGVycm9yQ2FsbGJhY2ssIkZpbGUiLCJ3cml0ZSIsW2ZpbGVOYW1lLGRhdGEscG9zaXRpb25dKX07RmlsZU1nci5wcm90b3R5cGUudHJ1bmNhdGU9ZnVuY3Rpb24oZmlsZU5hbWUsc2l6ZSxzdWNjZXNzQ2FsbGJhY2ssZXJyb3JDYWxsYmFjayl7UGhvbmVHYXAuZXhlYyhzdWNjZXNzQ2FsbGJhY2ssZXJyb3JDYWxsYmFjaywiRmlsZSIsInRydW5jYXRlRmlsZSIsW2ZpbGVOYW1lLHNpemVdKX07RmlsZU1nci5wcm90b3R5cGUucmVhZEFzVGV4dD1mdW5jdGlvbihmaWxlTmFtZSxlbmNvZGluZyxzdWNjZXNzQ2FsbGJhY2ssZXJyb3JDYWxsYmFjayl7UGhvbmVHYXAuZXhlYyhzdWNjZXNzQ2FsbGJhY2ssZXJyb3JDYWxsYmFjaywiRmlsZSIsInJlYWRGaWxlIixbZmlsZU5hbWUsZW5jb2RpbmddKX07RmlsZU1nci5wcm90b3R5cGUucmVhZEFzRGF0YVVSTD1mdW5jdGlvbihmaWxlTmFtZSxzdWNjZXNzQ2FsbGJhY2ssZXJyb3JDYWxsYmFjayl7UGhvbmVHYXAuZXhlYyhzdWNjZXNzQ2FsbGJhY2ssZXJyb3JDYWxsYmFjaywiRmlsZSIsInJlYWRBc0RhdGFVUkwiLFtmaWxlTmFtZV0pfTtQaG9uZUdhcC5hZGRDb25zdHJ1Y3RvcihmdW5jdGlvbigpe2lmKHR5cGVvZiBuYXZpZ2F0b3IuZmlsZU1ncj09PSJ1bmRlZmluZWQiKXtuYXZpZ2F0b3IuZmlsZU1ncj1uZXcgRmlsZU1ncigpfX0pO0ZpbGVSZWFkZXI9ZnVuY3Rpb24oKXt0aGlzLmZpbGVOYW1lPSIiO3RoaXMucmVhZHlTdGF0ZT0wO3RoaXMucmVzdWx0PW51bGw7dGhpcy5lcnJvcj1udWxsO3RoaXMub25sb2Fkc3RhcnQ9bnVsbDt0aGlzLm9ucHJvZ3Jlc3M9bnVsbDt0aGlzLm9ubG9hZD1udWxsO3RoaXMub25lcnJvcj1udWxsO3RoaXMub25sb2FkZW5kPW51bGw7dGhpcy5vbmFib3J0PW51bGx9O0ZpbGVSZWFkZXIuRU1QVFk9MDtGaWxlUmVhZGVyLkxPQURJTkc9MTtGaWxlUmVhZGVyLkRPTkU9MjtGaWxlUmVhZGVyLnByb3RvdHlwZS5hYm9ydD1mdW5jdGlvbigpe3ZhciBldnQ7dGhpcy5yZWFkeVN0YXRlPUZpbGVSZWFkZXIuRE9ORTt0aGlzLnJlc3VsdD1udWxsO3ZhciBlcnJvcj1uZXcgRmlsZUVycm9yKCk7ZXJyb3IuY29kZT1lcnJvci5BQk9SVF9FUlI7dGhpcy5lcnJvcj1lcnJvcjtpZih0eXBlb2YgdGhpcy5vbmVycm9yPT09ImZ1bmN0aW9uIil7ZXZ0PUZpbGUuX2NyZWF0ZUV2ZW50KCJlcnJvciIsdGhpcyk7dGhpcy5vbmVycm9yKGV2dCl9aWYodHlwZW9mIHRoaXMub25hYm9ydD09PSJmdW5jdGlvbiIpe2V2dD1GaWxlLl9jcmVhdGVFdmVudCgiYWJvcnQiLHRoaXMpO3RoaXMub25hYm9ydChldnQpfWlmKHR5cGVvZiB0aGlzLm9ubG9hZGVuZD09PSJmdW5jdGlvbiIpe2V2dD1GaWxlLl9jcmVhdGVFdmVudCgibG9hZGVuZCIsdGhpcyk7dGhpcy5vbmxvYWRlbmQoZXZ0KX19O0ZpbGVSZWFkZXIucHJvdG90eXBlLnJlYWRBc1RleHQ9ZnVuY3Rpb24oZmlsZSxlbmNvZGluZyl7dGhpcy5maWxlTmFtZT0iIjtpZih0eXBlb2YgZmlsZS5mdWxsUGF0aD09PSJ1bmRlZmluZWQiKXt0aGlzLmZpbGVOYW1lPWZpbGV9ZWxzZXt0aGlzLmZpbGVOYW1lPWZpbGUuZnVsbFBhdGh9dGhpcy5yZWFkeVN0YXRlPUZpbGVSZWFkZXIuTE9BRElORztpZih0eXBlb2YgdGhpcy5vbmxvYWRzdGFydD09PSJmdW5jdGlvbiIpe3ZhciBldnQ9RmlsZS5fY3JlYXRlRXZlbnQoImxvYWRzdGFydCIsdGhpcyk7dGhpcy5vbmxvYWRzdGFydChldnQpfXZhciBlbmM9ZW5jb2Rpbmc/ZW5jb2Rpbmc6IlVURi04Ijt2YXIgbWU9dGhpcztuYXZpZ2F0b3IuZmlsZU1nci5yZWFkQXNUZXh0KHRoaXMuZmlsZU5hbWUsZW5jLGZ1bmN0aW9uKHIpe3ZhciBldnQ7aWYobWUucmVhZHlTdGF0ZT09PUZpbGVSZWFkZXIuRE9ORSl7cmV0dXJufW1lLnJlc3VsdD1kZWNvZGVVUklDb21wb25lbnQocik7aWYodHlwZW9mIG1lLm9ubG9hZD09PSJmdW5jdGlvbiIpe2V2dD1GaWxlLl9jcmVhdGVFdmVudCgibG9hZCIsbWUpO21lLm9ubG9hZChldnQpfW1lLnJlYWR5U3RhdGU9RmlsZVJlYWRlci5ET05FO2lmKHR5cGVvZiBtZS5vbmxvYWRlbmQ9PT0iZnVuY3Rpb24iKXtldnQ9RmlsZS5fY3JlYXRlRXZlbnQoImxvYWRlbmQiLG1lKTttZS5vbmxvYWRlbmQoZXZ0KX19LGZ1bmN0aW9uKGUpe3ZhciBldnQ7aWYobWUucmVhZHlTdGF0ZT09PUZpbGVSZWFkZXIuRE9ORSl7cmV0dXJufW1lLmVycm9yPWU7aWYodHlwZW9mIG1lLm9uZXJyb3I9PT0iZnVuY3Rpb24iKXtldnQ9RmlsZS5fY3JlYXRlRXZlbnQoImVycm9yIixtZSk7bWUub25lcnJvcihldnQpfW1lLnJlYWR5U3RhdGU9RmlsZVJlYWRlci5ET05FO2lmKHR5cGVvZiBtZS5vbmxvYWRlbmQ9PT0iZnVuY3Rpb24iKXtldnQ9RmlsZS5fY3JlYXRlRXZlbnQoImxvYWRlbmQiLG1lKTttZS5vbmxvYWRlbmQoZXZ0KX19KX07RmlsZVJlYWRlci5wcm90b3R5cGUucmVhZEFzRGF0YVVSTD1mdW5jdGlvbihmaWxlKXt0aGlzLmZpbGVOYW1lPSIiO2lmKHR5cGVvZiBmaWxlLmZ1bGxQYXRoPT09InVuZGVmaW5lZCIpe3RoaXMuZmlsZU5hbWU9ZmlsZX1lbHNle3RoaXMuZmlsZU5hbWU9ZmlsZS5mdWxsUGF0aH10aGlzLnJlYWR5U3RhdGU9RmlsZVJlYWRlci5MT0FESU5HO2lmKHR5cGVvZiB0aGlzLm9ubG9hZHN0YXJ0PT09ImZ1bmN0aW9uIil7dmFyIGV2dD1GaWxlLl9jcmVhdGVFdmVudCgibG9hZHN0YXJ0Iix0aGlzKTt0aGlzLm9ubG9hZHN0YXJ0KGV2dCl9dmFyIG1lPXRoaXM7bmF2aWdhdG9yLmZpbGVNZ3IucmVhZEFzRGF0YVVSTCh0aGlzLmZpbGVOYW1lLGZ1bmN0aW9uKHIpe3ZhciBldnQ7aWYobWUucmVhZHlTdGF0ZT09PUZpbGVSZWFkZXIuRE9ORSl7cmV0dXJufW1lLnJlc3VsdD1yO2lmKHR5cGVvZiBtZS5vbmxvYWQ9PT0iZnVuY3Rpb24iKXtldnQ9RmlsZS5fY3JlYXRlRXZlbnQoImxvYWQiLG1lKTttZS5vbmxvYWQoZXZ0KX1tZS5yZWFkeVN0YXRlPUZpbGVSZWFkZXIuRE9ORTtpZih0eXBlb2YgbWUub25sb2FkZW5kPT09ImZ1bmN0aW9uIil7ZXZ0PUZpbGUuX2NyZWF0ZUV2ZW50KCJsb2FkZW5kIixtZSk7bWUub25sb2FkZW5kKGV2dCl9fSxmdW5jdGlvbihlKXt2YXIgZXZ0O2lmKG1lLnJlYWR5U3RhdGU9PT1GaWxlUmVhZGVyLkRPTkUpe3JldHVybn1tZS5lcnJvcj1lO2lmKHR5cGVvZiBtZS5vbmVycm9yPT09ImZ1bmN0aW9uIil7ZXZ0PUZpbGUuX2NyZWF0ZUV2ZW50KCJlcnJvciIsbWUpO21lLm9uZXJyb3IoZXZ0KX1tZS5yZWFkeVN0YXRlPUZpbGVSZWFkZXIuRE9ORTtpZih0eXBlb2YgbWUub25sb2FkZW5kPT09ImZ1bmN0aW9uIil7ZXZ0PUZpbGUuX2NyZWF0ZUV2ZW50KCJsb2FkZW5kIixtZSk7bWUub25sb2FkZW5kKGV2dCl9fSl9O0ZpbGVSZWFkZXIucHJvdG90eXBlLnJlYWRBc0JpbmFyeVN0cmluZz1mdW5jdGlvbihmaWxlKXt0aGlzLmZpbGVOYW1lPWZpbGV9O0ZpbGVSZWFkZXIucHJvdG90eXBlLnJlYWRBc0FycmF5QnVmZmVyPWZ1bmN0aW9uKGZpbGUpe3RoaXMuZmlsZU5hbWU9ZmlsZX07RmlsZVdyaXRlcj1mdW5jdGlvbihmaWxlKXt0aGlzLmZpbGVOYW1lPSIiO3RoaXMubGVuZ3RoPTA7aWYoZmlsZSl7dGhpcy5maWxlTmFtZT1maWxlLmZ1bGxQYXRofHxmaWxlO3RoaXMubGVuZ3RoPWZpbGUuc2l6ZXx8MH10aGlzLnBvc2l0aW9uPTA7dGhpcy5yZWFkeVN0YXRlPTA7dGhpcy5yZXN1bHQ9bnVsbDt0aGlzLmVycm9yPW51bGw7dGhpcy5vbndyaXRlc3RhcnQ9bnVsbDt0aGlzLm9ucHJvZ3Jlc3M9bnVsbDt0aGlzLm9ud3JpdGU9bnVsbDt0aGlzLm9ud3JpdGVlbmQ9bnVsbDt0aGlzLm9uYWJvcnQ9bnVsbDt0aGlzLm9uZXJyb3I9bnVsbH07RmlsZVdyaXRlci5JTklUPTA7RmlsZVdyaXRlci5XUklUSU5HPTE7RmlsZVdyaXRlci5ET05FPTI7RmlsZVdyaXRlci5wcm90b3R5cGUuYWJvcnQ9ZnVuY3Rpb24oKXtpZih0aGlzLnJlYWR5U3RhdGU9PT1GaWxlV3JpdGVyLkRPTkV8fHRoaXMucmVhZHlTdGF0ZT09PUZpbGVXcml0ZXIuSU5JVCl7dGhyb3cgRmlsZUVycm9yLklOVkFMSURfU1RBVEVfRVJSfXZhciBlcnJvcj1uZXcgRmlsZUVycm9yKCksZXZ0O2Vycm9yLmNvZGU9ZXJyb3IuQUJPUlRfRVJSO3RoaXMuZXJyb3I9ZXJyb3I7aWYodHlwZW9mIHRoaXMub25lcnJvcj09PSJmdW5jdGlvbiIpe2V2dD1GaWxlLl9jcmVhdGVFdmVudCgiZXJyb3IiLHRoaXMpO3RoaXMub25lcnJvcihldnQpfWlmKHR5cGVvZiB0aGlzLm9uYWJvcnQ9PT0iZnVuY3Rpb24iKXtldnQ9RmlsZS5fY3JlYXRlRXZlbnQoImFib3J0Iix0aGlzKTt0aGlzLm9uYWJvcnQoZXZ0KX10aGlzLnJlYWR5U3RhdGU9RmlsZVdyaXRlci5ET05FO2lmKHR5cGVvZiB0aGlzLm9ud3JpdGVlbmQ9PSJmdW5jdGlvbiIpe2V2dD1GaWxlLl9jcmVhdGVFdmVudCgid3JpdGVlbmQiLHRoaXMpO3RoaXMub253cml0ZWVuZChldnQpfX07RmlsZVdyaXRlci5wcm90b3R5cGUud3JpdGVBc1RleHQ9ZnVuY3Rpb24oZmlsZSx0ZXh0LGJBcHBlbmQpe2lmKHRoaXMucmVhZHlTdGF0ZT09PUZpbGVXcml0ZXIuV1JJVElORyl7dGhyb3cgRmlsZUVycm9yLklOVkFMSURfU1RBVEVfRVJSfWlmKGJBcHBlbmQhPT10cnVlKXtiQXBwZW5kPWZhbHNlfXRoaXMuZmlsZU5hbWU9ZmlsZTt0aGlzLnJlYWR5U3RhdGU9RmlsZVdyaXRlci5XUklUSU5HO3ZhciBtZT10aGlzO2lmKHR5cGVvZiBtZS5vbndyaXRlc3RhcnQ9PT0iZnVuY3Rpb24iKXt2YXIgZXZ0PUZpbGUuX2NyZWF0ZUV2ZW50KCJ3cml0ZXN0YXJ0IixtZSk7bWUub253cml0ZXN0YXJ0KGV2dCl9bmF2aWdhdG9yLmZpbGVNZ3Iud3JpdGVBc1RleHQoZmlsZSx0ZXh0LGJBcHBlbmQsZnVuY3Rpb24ocil7dmFyIGV2dDtpZihtZS5yZWFkeVN0YXRlPT09RmlsZVdyaXRlci5ET05FKXtyZXR1cm59bWUucmVzdWx0PXI7aWYodHlwZW9mIG1lLm9ud3JpdGU9PT0iZnVuY3Rpb24iKXtldnQ9RmlsZS5fY3JlYXRlRXZlbnQoIndyaXRlIixtZSk7bWUub253cml0ZShldnQpfW1lLnJlYWR5U3RhdGU9RmlsZVdyaXRlci5ET05FO2lmKHR5cGVvZiBtZS5vbndyaXRlZW5kPT09ImZ1bmN0aW9uIil7ZXZ0PUZpbGUuX2NyZWF0ZUV2ZW50KCJ3cml0ZWVuZCIsbWUpO21lLm9ud3JpdGVlbmQoZXZ0KX19LGZ1bmN0aW9uKGUpe3ZhciBldnQ7aWYobWUucmVhZHlTdGF0ZT09PUZpbGVXcml0ZXIuRE9ORSl7cmV0dXJufW1lLmVycm9yPWU7aWYodHlwZW9mIG1lLm9uZXJyb3I9PT0iZnVuY3Rpb24iKXtldnQ9RmlsZS5fY3JlYXRlRXZlbnQoImVycm9yIixtZSk7bWUub25lcnJvcihldnQpfW1lLnJlYWR5U3RhdGU9RmlsZVdyaXRlci5ET05FO2lmKHR5cGVvZiBtZS5vbndyaXRlZW5kPT09ImZ1bmN0aW9uIil7ZXZ0PUZpbGUuX2NyZWF0ZUV2ZW50KCJ3cml0ZWVuZCIsbWUpO21lLm9ud3JpdGVlbmQoZXZ0KX19KX07RmlsZVdyaXRlci5wcm90b3R5cGUud3JpdGU9ZnVuY3Rpb24odGV4dCl7aWYodGhpcy5yZWFkeVN0YXRlPT09RmlsZVdyaXRlci5XUklUSU5HKXt0aHJvdyBGaWxlRXJyb3IuSU5WQUxJRF9TVEFURV9FUlJ9dGhpcy5yZWFkeVN0YXRlPUZpbGVXcml0ZXIuV1JJVElORzt2YXIgbWU9dGhpcztpZih0eXBlb2YgbWUub253cml0ZXN0YXJ0PT09ImZ1bmN0aW9uIil7dmFyIGV2dD1GaWxlLl9jcmVhdGVFdmVudCgid3JpdGVzdGFydCIsbWUpO21lLm9ud3JpdGVzdGFydChldnQpfW5hdmlnYXRvci5maWxlTWdyLndyaXRlKHRoaXMuZmlsZU5hbWUsdGV4dCx0aGlzLnBvc2l0aW9uLGZ1bmN0aW9uKHIpe3ZhciBldnQ7aWYobWUucmVhZHlTdGF0ZT09PUZpbGVXcml0ZXIuRE9ORSl7cmV0dXJufW1lLnBvc2l0aW9uKz1yO21lLmxlbmd0aD1tZS5wb3NpdGlvbjtpZih0eXBlb2YgbWUub253cml0ZT09PSJmdW5jdGlvbiIpe2V2dD1GaWxlLl9jcmVhdGVFdmVudCgid3JpdGUiLG1lKTttZS5vbndyaXRlKGV2dCl9bWUucmVhZHlTdGF0ZT1GaWxlV3JpdGVyLkRPTkU7aWYodHlwZW9mIG1lLm9ud3JpdGVlbmQ9PT0iZnVuY3Rpb24iKXtldnQ9RmlsZS5fY3JlYXRlRXZlbnQoIndyaXRlZW5kIixtZSk7bWUub253cml0ZWVuZChldnQpfX0sZnVuY3Rpb24oZSl7dmFyIGV2dDtpZihtZS5yZWFkeVN0YXRlPT09RmlsZVdyaXRlci5ET05FKXtyZXR1cm59bWUuZXJyb3I9ZTtpZih0eXBlb2YgbWUub25lcnJvcj09PSJmdW5jdGlvbiIpe2V2dD1GaWxlLl9jcmVhdGVFdmVudCgiZXJyb3IiLG1lKTttZS5vbmVycm9yKGV2dCl9bWUucmVhZHlTdGF0ZT1GaWxlV3JpdGVyLkRPTkU7aWYodHlwZW9mIG1lLm9ud3JpdGVlbmQ9PT0iZnVuY3Rpb24iKXtldnQ9RmlsZS5fY3JlYXRlRXZlbnQoIndyaXRlZW5kIixtZSk7bWUub253cml0ZWVuZChldnQpfX0pfTtGaWxlV3JpdGVyLnByb3RvdHlwZS5zZWVrPWZ1bmN0aW9uKG9mZnNldCl7aWYodGhpcy5yZWFkeVN0YXRlPT09RmlsZVdyaXRlci5XUklUSU5HKXt0aHJvdyBGaWxlRXJyb3IuSU5WQUxJRF9TVEFURV9FUlJ9aWYoIW9mZnNldCl7cmV0dXJufWlmKG9mZnNldDwwKXt0aGlzLnBvc2l0aW9uPU1hdGgubWF4KG9mZnNldCt0aGlzLmxlbmd0aCwwKX1lbHNle2lmKG9mZnNldD50aGlzLmxlbmd0aCl7dGhpcy5wb3NpdGlvbj10aGlzLmxlbmd0aH1lbHNle3RoaXMucG9zaXRpb249b2Zmc2V0fX19O0ZpbGVXcml0ZXIucHJvdG90eXBlLnRydW5jYXRlPWZ1bmN0aW9uKHNpemUpe2lmKHRoaXMucmVhZHlTdGF0ZT09PUZpbGVXcml0ZXIuV1JJVElORyl7dGhyb3cgRmlsZUVycm9yLklOVkFMSURfU1RBVEVfRVJSfXRoaXMucmVhZHlTdGF0ZT1GaWxlV3JpdGVyLldSSVRJTkc7dmFyIG1lPXRoaXM7aWYodHlwZW9mIG1lLm9ud3JpdGVzdGFydD09PSJmdW5jdGlvbiIpe3ZhciBldnQ9RmlsZS5fY3JlYXRlRXZlbnQoIndyaXRlc3RhcnQiLG1lKTttZS5vbndyaXRlc3RhcnQoZXZ0KX1uYXZpZ2F0b3IuZmlsZU1nci50cnVuY2F0ZSh0aGlzLmZpbGVOYW1lLHNpemUsZnVuY3Rpb24ocil7dmFyIGV2dDtpZihtZS5yZWFkeVN0YXRlPT09RmlsZVdyaXRlci5ET05FKXtyZXR1cm59bWUubGVuZ3RoPXI7bWUucG9zaXRpb249TWF0aC5taW4obWUucG9zaXRpb24scik7aWYodHlwZW9mIG1lLm9ud3JpdGU9PT0iZnVuY3Rpb24iKXtldnQ9RmlsZS5fY3JlYXRlRXZlbnQoIndyaXRlIixtZSk7bWUub253cml0ZShldnQpfW1lLnJlYWR5U3RhdGU9RmlsZVdyaXRlci5ET05FO2lmKHR5cGVvZiBtZS5vbndyaXRlZW5kPT09ImZ1bmN0aW9uIil7ZXZ0PUZpbGUuX2NyZWF0ZUV2ZW50KCJ3cml0ZWVuZCIsbWUpO21lLm9ud3JpdGVlbmQoZXZ0KX19LGZ1bmN0aW9uKGUpe3ZhciBldnQ7aWYobWUucmVhZHlTdGF0ZT09PUZpbGVXcml0ZXIuRE9ORSl7cmV0dXJufW1lLmVycm9yPWU7aWYodHlwZW9mIG1lLm9uZXJyb3I9PT0iZnVuY3Rpb24iKXtldnQ9RmlsZS5fY3JlYXRlRXZlbnQoImVycm9yIixtZSk7bWUub25lcnJvcihldnQpfW1lLnJlYWR5U3RhdGU9RmlsZVdyaXRlci5ET05FO2lmKHR5cGVvZiBtZS5vbndyaXRlZW5kPT09ImZ1bmN0aW9uIil7ZXZ0PUZpbGUuX2NyZWF0ZUV2ZW50KCJ3cml0ZWVuZCIsbWUpO21lLm9ud3JpdGVlbmQoZXZ0KX19KX07TG9jYWxGaWxlU3lzdGVtPWZ1bmN0aW9uKCl7fTtMb2NhbEZpbGVTeXN0ZW0uVEVNUE9SQVJZPTA7TG9jYWxGaWxlU3lzdGVtLlBFUlNJU1RFTlQ9MTtMb2NhbEZpbGVTeXN0ZW0uUkVTT1VSQ0U9MjtMb2NhbEZpbGVTeXN0ZW0uQVBQTElDQVRJT049MztMb2NhbEZpbGVTeXN0ZW0ucHJvdG90eXBlLnJlcXVlc3RGaWxlU3lzdGVtPWZ1bmN0aW9uKHR5cGUsc2l6ZSxzdWNjZXNzQ2FsbGJhY2ssZXJyb3JDYWxsYmFjayl7aWYodHlwZTwwfHx0eXBlPjMpe2lmKHR5cGVvZiBlcnJvckNhbGxiYWNrPT0iZnVuY3Rpb24iKXtlcnJvckNhbGxiYWNrKHtjb2RlOkZpbGVFcnJvci5TWU5UQVhfRVJSfSl9fWVsc2V7UGhvbmVHYXAuZXhlYyhzdWNjZXNzQ2FsbGJhY2ssZXJyb3JDYWxsYmFjaywiRmlsZSIsInJlcXVlc3RGaWxlU3lzdGVtIixbdHlwZSxzaXplXSl9fTtMb2NhbEZpbGVTeXN0ZW0ucHJvdG90eXBlLnJlc29sdmVMb2NhbEZpbGVTeXN0ZW1VUkk9ZnVuY3Rpb24odXJpLHN1Y2Nlc3NDYWxsYmFjayxlcnJvckNhbGxiYWNrKXtQaG9uZUdhcC5leGVjKHN1Y2Nlc3NDYWxsYmFjayxlcnJvckNhbGxiYWNrLCJGaWxlIiwicmVzb2x2ZUxvY2FsRmlsZVN5c3RlbVVSSSIsW3VyaV0pfTtMb2NhbEZpbGVTeXN0ZW0ucHJvdG90eXBlLl9jYXN0RlM9ZnVuY3Rpb24ocGx1Z2luUmVzdWx0KXt2YXIgZW50cnk9bnVsbDtlbnRyeT1uZXcgRGlyZWN0b3J5RW50cnkoKTtlbnRyeS5pc0RpcmVjdG9yeT1wbHVnaW5SZXN1bHQubWVzc2FnZS5yb290LmlzRGlyZWN0b3J5O2VudHJ5LmlzRmlsZT1wbHVnaW5SZXN1bHQubWVzc2FnZS5yb290LmlzRmlsZTtlbnRyeS5uYW1lPXBsdWdpblJlc3VsdC5tZXNzYWdlLnJvb3QubmFtZTtlbnRyeS5mdWxsUGF0aD1wbHVnaW5SZXN1bHQubWVzc2FnZS5yb290LmZ1bGxQYXRoO3BsdWdpblJlc3VsdC5tZXNzYWdlLnJvb3Q9ZW50cnk7cmV0dXJuIHBsdWdpblJlc3VsdH07TG9jYWxGaWxlU3lzdGVtLnByb3RvdHlwZS5fY2FzdEVudHJ5PWZ1bmN0aW9uKHBsdWdpblJlc3VsdCl7dmFyIGVudHJ5PW51bGw7aWYocGx1Z2luUmVzdWx0Lm1lc3NhZ2UuaXNEaXJlY3Rvcnkpe2VudHJ5PW5ldyBEaXJlY3RvcnlFbnRyeSgpfWVsc2V7aWYocGx1Z2luUmVzdWx0Lm1lc3NhZ2UuaXNGaWxlKXtlbnRyeT1uZXcgRmlsZUVudHJ5KCl9fWVudHJ5LmlzRGlyZWN0b3J5PXBsdWdpblJlc3VsdC5tZXNzYWdlLmlzRGlyZWN0b3J5O2VudHJ5LmlzRmlsZT1wbHVnaW5SZXN1bHQubWVzc2FnZS5pc0ZpbGU7ZW50cnkubmFtZT1wbHVnaW5SZXN1bHQubWVzc2FnZS5uYW1lO2VudHJ5LmZ1bGxQYXRoPXBsdWdpblJlc3VsdC5tZXNzYWdlLmZ1bGxQYXRoO3BsdWdpblJlc3VsdC5tZXNzYWdlPWVudHJ5O3JldHVybiBwbHVnaW5SZXN1bHR9O0xvY2FsRmlsZVN5c3RlbS5wcm90b3R5cGUuX2Nhc3RFbnRyaWVzPWZ1bmN0aW9uKHBsdWdpblJlc3VsdCl7dmFyIGVudHJpZXM9cGx1Z2luUmVzdWx0Lm1lc3NhZ2U7dmFyIHJldFZhbD1bXTtmb3IoaT0wO2k8ZW50cmllcy5sZW5ndGg7aSsrKXtyZXRWYWwucHVzaCh3aW5kb3cubG9jYWxGaWxlU3lzdGVtLl9jcmVhdGVFbnRyeShlbnRyaWVzW2ldKSl9cGx1Z2luUmVzdWx0Lm1lc3NhZ2U9cmV0VmFsO3JldHVybiBwbHVnaW5SZXN1bHR9O0xvY2FsRmlsZVN5c3RlbS5wcm90b3R5cGUuX2NyZWF0ZUVudHJ5PWZ1bmN0aW9uKGNhc3RNZSl7dmFyIGVudHJ5PW51bGw7aWYoY2FzdE1lLmlzRGlyZWN0b3J5KXtlbnRyeT1uZXcgRGlyZWN0b3J5RW50cnkoKX1lbHNle2lmKGNhc3RNZS5pc0ZpbGUpe2VudHJ5PW5ldyBGaWxlRW50cnkoKX19ZW50cnkuaXNEaXJlY3Rvcnk9Y2FzdE1lLmlzRGlyZWN0b3J5O2VudHJ5LmlzRmlsZT1jYXN0TWUuaXNGaWxlO2VudHJ5Lm5hbWU9Y2FzdE1lLm5hbWU7ZW50cnkuZnVsbFBhdGg9Y2FzdE1lLmZ1bGxQYXRoO3JldHVybiBlbnRyeX07TG9jYWxGaWxlU3lzdGVtLnByb3RvdHlwZS5fY2FzdERhdGU9ZnVuY3Rpb24ocGx1Z2luUmVzdWx0KXtpZihwbHVnaW5SZXN1bHQubWVzc2FnZS5tb2RpZmljYXRpb25UaW1lKXt2YXIgbWV0YWRhdGFPYmo9bmV3IE1ldGFkYXRhKCk7bWV0YWRhdGFPYmoubW9kaWZpY2F0aW9uVGltZT1uZXcgRGF0ZShwbHVnaW5SZXN1bHQubWVzc2FnZS5tb2RpZmljYXRpb25UaW1lKTtwbHVnaW5SZXN1bHQubWVzc2FnZT1tZXRhZGF0YU9ian1lbHNle2lmKHBsdWdpblJlc3VsdC5tZXNzYWdlLmxhc3RNb2RpZmllZERhdGUpe3ZhciBmaWxlPW5ldyBGaWxlKCk7ZmlsZS5zaXplPXBsdWdpblJlc3VsdC5tZXNzYWdlLnNpemU7ZmlsZS50eXBlPXBsdWdpblJlc3VsdC5tZXNzYWdlLnR5cGU7ZmlsZS5uYW1lPXBsdWdpblJlc3VsdC5tZXNzYWdlLm5hbWU7ZmlsZS5mdWxsUGF0aD1wbHVnaW5SZXN1bHQubWVzc2FnZS5mdWxsUGF0aDtmaWxlLmxhc3RNb2RpZmVkRGF0ZT1uZXcgRGF0ZShwbHVnaW5SZXN1bHQubWVzc2FnZS5sYXN0TW9kaWZpZWREYXRlKTtwbHVnaW5SZXN1bHQubWVzc2FnZT1maWxlfX1yZXR1cm4gcGx1Z2luUmVzdWx0fTtMb2NhbEZpbGVTeXN0ZW0ucHJvdG90eXBlLl9jYXN0RXJyb3I9ZnVuY3Rpb24ocGx1Z2luUmVzdWx0KXt2YXIgZmlsZUVycm9yPW5ldyBGaWxlRXJyb3IoKTtmaWxlRXJyb3IuY29kZT1wbHVnaW5SZXN1bHQubWVzc2FnZTtwbHVnaW5SZXN1bHQubWVzc2FnZT1maWxlRXJyb3I7cmV0dXJuIHBsdWdpblJlc3VsdH07TWV0YWRhdGE9ZnVuY3Rpb24oKXt0aGlzLm1vZGlmaWNhdGlvblRpbWU9bnVsbH07RmxhZ3M9ZnVuY3Rpb24oY3JlYXRlLGV4Y2x1c2l2ZSl7dGhpcy5jcmVhdGU9Y3JlYXRlfHxmYWxzZTt0aGlzLmV4Y2x1c2l2ZT1leGNsdXNpdmV8fGZhbHNlfTtGaWxlU3lzdGVtPWZ1bmN0aW9uKCl7dGhpcy5uYW1lPW51bGw7dGhpcy5yb290PW51bGx9O0RpcmVjdG9yeUVudHJ5PWZ1bmN0aW9uKCl7dGhpcy5pc0ZpbGU9ZmFsc2U7dGhpcy5pc0RpcmVjdG9yeT10cnVlO3RoaXMubmFtZT1udWxsO3RoaXMuZnVsbFBhdGg9bnVsbDt0aGlzLmZpbGVzeXN0ZW09bnVsbH07RGlyZWN0b3J5RW50cnkucHJvdG90eXBlLmNvcHlUbz1mdW5jdGlvbihwYXJlbnQsbmV3TmFtZSxzdWNjZXNzQ2FsbGJhY2ssZXJyb3JDYWxsYmFjayl7UGhvbmVHYXAuZXhlYyhzdWNjZXNzQ2FsbGJhY2ssZXJyb3JDYWxsYmFjaywiRmlsZSIsImNvcHlUbyIsW3RoaXMuZnVsbFBhdGgscGFyZW50LG5ld05hbWVdKX07RGlyZWN0b3J5RW50cnkucHJvdG90eXBlLmdldE1ldGFkYXRhPWZ1bmN0aW9uKHN1Y2Nlc3NDYWxsYmFjayxlcnJvckNhbGxiYWNrKXtQaG9uZUdhcC5leGVjKHN1Y2Nlc3NDYWxsYmFjayxlcnJvckNhbGxiYWNrLCJGaWxlIiwiZ2V0TWV0YWRhdGEiLFt0aGlzLmZ1bGxQYXRoXSl9O0RpcmVjdG9yeUVudHJ5LnByb3RvdHlwZS5nZXRQYXJlbnQ9ZnVuY3Rpb24oc3VjY2Vzc0NhbGxiYWNrLGVycm9yQ2FsbGJhY2spe1Bob25lR2FwLmV4ZWMoc3VjY2Vzc0NhbGxiYWNrLGVycm9yQ2FsbGJhY2ssIkZpbGUiLCJnZXRQYXJlbnQiLFt0aGlzLmZ1bGxQYXRoXSl9O0RpcmVjdG9yeUVudHJ5LnByb3RvdHlwZS5tb3ZlVG89ZnVuY3Rpb24ocGFyZW50LG5ld05hbWUsc3VjY2Vzc0NhbGxiYWNrLGVycm9yQ2FsbGJhY2spe1Bob25lR2FwLmV4ZWMoc3VjY2Vzc0NhbGxiYWNrLGVycm9yQ2FsbGJhY2ssIkZpbGUiLCJtb3ZlVG8iLFt0aGlzLmZ1bGxQYXRoLHBhcmVudCxuZXdOYW1lXSl9O0RpcmVjdG9yeUVudHJ5LnByb3RvdHlwZS5yZW1vdmU9ZnVuY3Rpb24oc3VjY2Vzc0NhbGxiYWNrLGVycm9yQ2FsbGJhY2spe1Bob25lR2FwLmV4ZWMoc3VjY2Vzc0NhbGxiYWNrLGVycm9yQ2FsbGJhY2ssIkZpbGUiLCJyZW1vdmUiLFt0aGlzLmZ1bGxQYXRoXSl9O0RpcmVjdG9yeUVudHJ5LnByb3RvdHlwZS50b1VSST1mdW5jdGlvbihtaW1lVHlwZSxzdWNjZXNzQ2FsbGJhY2ssZXJyb3JDYWxsYmFjayl7cmV0dXJuImZpbGU6Ly9sb2NhbGhvc3QiK3RoaXMuZnVsbFBhdGh9O0RpcmVjdG9yeUVudHJ5LnByb3RvdHlwZS5jcmVhdGVSZWFkZXI9ZnVuY3Rpb24oc3VjY2Vzc0NhbGxiYWNrLGVycm9yQ2FsbGJhY2spe3JldHVybiBuZXcgRGlyZWN0b3J5UmVhZGVyKHRoaXMuZnVsbFBhdGgpfTtEaXJlY3RvcnlFbnRyeS5wcm90b3R5cGUuZ2V0RGlyZWN0b3J5PWZ1bmN0aW9uKHBhdGgsb3B0aW9ucyxzdWNjZXNzQ2FsbGJhY2ssZXJyb3JDYWxsYmFjayl7UGhvbmVHYXAuZXhlYyhzdWNjZXNzQ2FsbGJhY2ssZXJyb3JDYWxsYmFjaywiRmlsZSIsImdldERpcmVjdG9yeSIsW3RoaXMuZnVsbFBhdGgscGF0aCxvcHRpb25zXSl9O0RpcmVjdG9yeUVudHJ5LnByb3RvdHlwZS5nZXRGaWxlPWZ1bmN0aW9uKHBhdGgsb3B0aW9ucyxzdWNjZXNzQ2FsbGJhY2ssZXJyb3JDYWxsYmFjayl7UGhvbmVHYXAuZXhlYyhzdWNjZXNzQ2FsbGJhY2ssZXJyb3JDYWxsYmFjaywiRmlsZSIsImdldEZpbGUiLFt0aGlzLmZ1bGxQYXRoLHBhdGgsb3B0aW9uc10pfTtEaXJlY3RvcnlFbnRyeS5wcm90b3R5cGUucmVtb3ZlUmVjdXJzaXZlbHk9ZnVuY3Rpb24oc3VjY2Vzc0NhbGxiYWNrLGVycm9yQ2FsbGJhY2spe1Bob25lR2FwLmV4ZWMoc3VjY2Vzc0NhbGxiYWNrLGVycm9yQ2FsbGJhY2ssIkZpbGUiLCJyZW1vdmVSZWN1cnNpdmVseSIsW3RoaXMuZnVsbFBhdGhdKX07RGlyZWN0b3J5UmVhZGVyPWZ1bmN0aW9uKGZ1bGxQYXRoKXt0aGlzLmZ1bGxQYXRoPWZ1bGxQYXRofHxudWxsfTtEaXJlY3RvcnlSZWFkZXIucHJvdG90eXBlLnJlYWRFbnRyaWVzPWZ1bmN0aW9uKHN1Y2Nlc3NDYWxsYmFjayxlcnJvckNhbGxiYWNrKXtQaG9uZUdhcC5leGVjKHN1Y2Nlc3NDYWxsYmFjayxlcnJvckNhbGxiYWNrLCJGaWxlIiwicmVhZEVudHJpZXMiLFt0aGlzLmZ1bGxQYXRoXSl9O0ZpbGVFbnRyeT1mdW5jdGlvbigpe3RoaXMuaXNGaWxlPXRydWU7dGhpcy5pc0RpcmVjdG9yeT1mYWxzZTt0aGlzLm5hbWU9bnVsbDt0aGlzLmZ1bGxQYXRoPW51bGw7dGhpcy5maWxlc3lzdGVtPW51bGx9O0ZpbGVFbnRyeS5wcm90b3R5cGUuY29weVRvPWZ1bmN0aW9uKHBhcmVudCxuZXdOYW1lLHN1Y2Nlc3NDYWxsYmFjayxlcnJvckNhbGxiYWNrKXtQaG9uZUdhcC5leGVjKHN1Y2Nlc3NDYWxsYmFjayxlcnJvckNhbGxiYWNrLCJGaWxlIiwiY29weVRvIixbdGhpcy5mdWxsUGF0aCxwYXJlbnQsbmV3TmFtZV0pfTtGaWxlRW50cnkucHJvdG90eXBlLmdldE1ldGFkYXRhPWZ1bmN0aW9uKHN1Y2Nlc3NDYWxsYmFjayxlcnJvckNhbGxiYWNrKXtQaG9uZUdhcC5leGVjKHN1Y2Nlc3NDYWxsYmFjayxlcnJvckNhbGxiYWNrLCJGaWxlIiwiZ2V0TWV0YWRhdGEiLFt0aGlzLmZ1bGxQYXRoXSl9O0ZpbGVFbnRyeS5wcm90b3R5cGUuZ2V0UGFyZW50PWZ1bmN0aW9uKHN1Y2Nlc3NDYWxsYmFjayxlcnJvckNhbGxiYWNrKXtQaG9uZUdhcC5leGVjKHN1Y2Nlc3NDYWxsYmFjayxlcnJvckNhbGxiYWNrLCJGaWxlIiwiZ2V0UGFyZW50IixbdGhpcy5mdWxsUGF0aF0pfTtGaWxlRW50cnkucHJvdG90eXBlLm1vdmVUbz1mdW5jdGlvbihwYXJlbnQsbmV3TmFtZSxzdWNjZXNzQ2FsbGJhY2ssZXJyb3JDYWxsYmFjayl7UGhvbmVHYXAuZXhlYyhzdWNjZXNzQ2FsbGJhY2ssZXJyb3JDYWxsYmFjaywiRmlsZSIsIm1vdmVUbyIsW3RoaXMuZnVsbFBhdGgscGFyZW50LG5ld05hbWVdKX07RmlsZUVudHJ5LnByb3RvdHlwZS5yZW1vdmU9ZnVuY3Rpb24oc3VjY2Vzc0NhbGxiYWNrLGVycm9yQ2FsbGJhY2spe1Bob25lR2FwLmV4ZWMoc3VjY2Vzc0NhbGxiYWNrLGVycm9yQ2FsbGJhY2ssIkZpbGUiLCJyZW1vdmUiLFt0aGlzLmZ1bGxQYXRoXSl9O0ZpbGVFbnRyeS5wcm90b3R5cGUudG9VUkk9ZnVuY3Rpb24obWltZVR5cGUsc3VjY2Vzc0NhbGxiYWNrLGVycm9yQ2FsbGJhY2spe3JldHVybiJmaWxlOi8vbG9jYWxob3N0Iit0aGlzLmZ1bGxQYXRofTtGaWxlRW50cnkucHJvdG90eXBlLmNyZWF0ZVdyaXRlcj1mdW5jdGlvbihzdWNjZXNzQ2FsbGJhY2ssZXJyb3JDYWxsYmFjayl7dGhpcy5maWxlKGZ1bmN0aW9uKGZpbGVQb2ludGVyKXt2YXIgd3JpdGVyPW5ldyBGaWxlV3JpdGVyKGZpbGVQb2ludGVyKTtpZih3cml0ZXIuZmlsZU5hbWU9PW51bGx8fHdyaXRlci5maWxlTmFtZT09IiIpe2lmKHR5cGVvZiBlcnJvckNhbGxiYWNrPT0iZnVuY3Rpb24iKXtlcnJvckNhbGxiYWNrKHtjb2RlOkZpbGVFcnJvci5JTlZBTElEX1NUQVRFX0VSUn0pfX1pZih0eXBlb2Ygc3VjY2Vzc0NhbGxiYWNrPT0iZnVuY3Rpb24iKXtzdWNjZXNzQ2FsbGJhY2sod3JpdGVyKX19LGVycm9yQ2FsbGJhY2spfTtGaWxlRW50cnkucHJvdG90eXBlLmZpbGU9ZnVuY3Rpb24oc3VjY2Vzc0NhbGxiYWNrLGVycm9yQ2FsbGJhY2spe1Bob25lR2FwLmV4ZWMoc3VjY2Vzc0NhbGxiYWNrLGVycm9yQ2FsbGJhY2ssIkZpbGUiLCJnZXRGaWxlTWV0YWRhdGEiLFt0aGlzLmZ1bGxQYXRoXSl9O1Bob25lR2FwLmFkZENvbnN0cnVjdG9yKGZ1bmN0aW9uKCl7dmFyIHBnTG9jYWxGaWxlU3lzdGVtPW5ldyBMb2NhbEZpbGVTeXN0ZW0oKTtpZih0eXBlb2Ygd2luZG93LmxvY2FsRmlsZVN5c3RlbT09InVuZGVmaW5lZCIpe3dpbmRvdy5sb2NhbEZpbGVTeXN0ZW09cGdMb2NhbEZpbGVTeXN0ZW19aWYodHlwZW9mIHdpbmRvdy5yZXF1ZXN0RmlsZVN5c3RlbT09InVuZGVmaW5lZCIpe3dpbmRvdy5yZXF1ZXN0RmlsZVN5c3RlbT1wZ0xvY2FsRmlsZVN5c3RlbS5yZXF1ZXN0RmlsZVN5c3RlbX1pZih0eXBlb2Ygd2luZG93LnJlc29sdmVMb2NhbEZpbGVTeXN0ZW1VUkk9PSJ1bmRlZmluZWQiKXt3aW5kb3cucmVzb2x2ZUxvY2FsRmlsZVN5c3RlbVVSST1wZ0xvY2FsRmlsZVN5c3RlbS5yZXNvbHZlTG9jYWxGaWxlU3lzdGVtVVJJfX0pfWlmKCFQaG9uZUdhcC5oYXNSZXNvdXJjZSgiZmlsZXRyYW5zZmVyIikpe1Bob25lR2FwLmFkZFJlc291cmNlKCJmaWxldHJhbnNmZXIiKTtGaWxlVHJhbnNmZXI9ZnVuY3Rpb24oKXt9O0ZpbGVVcGxvYWRSZXN1bHQ9ZnVuY3Rpb24oKXt0aGlzLmJ5dGVzU2VudD0wO3RoaXMucmVzcG9uc2VDb2RlPW51bGw7dGhpcy5yZXNwb25zZT1udWxsfTtGaWxlVHJhbnNmZXJFcnJvcj1mdW5jdGlvbihlcnJvckNvZGUpe3RoaXMuY29kZT1lcnJvckNvZGV8fG51bGx9O0ZpbGVUcmFuc2ZlckVycm9yLkZJTEVfTk9UX0ZPVU5EX0VSUj0xO0ZpbGVUcmFuc2ZlckVycm9yLklOVkFMSURfVVJMX0VSUj0yO0ZpbGVUcmFuc2ZlckVycm9yLkNPTk5FQ1RJT05fRVJSPTM7RmlsZVRyYW5zZmVyLnByb3RvdHlwZS51cGxvYWQ9ZnVuY3Rpb24oZmlsZVBhdGgsc2VydmVyLHN1Y2Nlc3NDYWxsYmFjayxlcnJvckNhbGxiYWNrLG9wdGlvbnMpe2lmKCFvcHRpb25zLnBhcmFtcyl7b3B0aW9ucy5wYXJhbXM9e319b3B0aW9ucy5maWxlUGF0aD1maWxlUGF0aDtvcHRpb25zLnNlcnZlcj1zZXJ2ZXI7aWYoIW9wdGlvbnMuZmlsZUtleSl7b3B0aW9ucy5maWxlS2V5PSJmaWxlIn1pZighb3B0aW9ucy5maWxlTmFtZSl7b3B0aW9ucy5maWxlTmFtZT0iaW1hZ2UuanBnIn1pZighb3B0aW9ucy5taW1lVHlwZSl7b3B0aW9ucy5taW1lVHlwZT0iaW1hZ2UvanBlZyJ9aWYodHlwZW9mIHN1Y2Nlc3NDYWxsYmFjayE9ImZ1bmN0aW9uIil7Y29uc29sZS5sb2coIkZpbGVUcmFuc2ZlciBFcnJvcjogc3VjY2Vzc0NhbGxiYWNrIGlzIG5vdCBhIGZ1bmN0aW9uIik7cmV0dXJufWlmKGVycm9yQ2FsbGJhY2smJih0eXBlb2YgZXJyb3JDYWxsYmFjayE9ImZ1bmN0aW9uIikpe2NvbnNvbGUubG9nKCJGaWxlVHJhbnNmZXIgRXJyb3I6IGVycm9yQ2FsbGJhY2sgaXMgbm90IGEgZnVuY3Rpb24iKTtyZXR1cm59UGhvbmVHYXAuZXhlYyhzdWNjZXNzQ2FsbGJhY2ssZXJyb3JDYWxsYmFjaywiRmlsZVRyYW5zZmVyIiwidXBsb2FkIixbb3B0aW9uc10pfTtGaWxlVHJhbnNmZXIucHJvdG90eXBlLl9jYXN0VHJhbnNmZXJFcnJvcj1mdW5jdGlvbihwbHVnaW5SZXN1bHQpe3ZhciBmaWxlRXJyb3I9bmV3IEZpbGVUcmFuc2ZlckVycm9yKHBsdWdpblJlc3VsdC5tZXNzYWdlKTtwbHVnaW5SZXN1bHQubWVzc2FnZT1maWxlRXJyb3I7cmV0dXJuIHBsdWdpblJlc3VsdH07RmlsZVRyYW5zZmVyLnByb3RvdHlwZS5fY2FzdFVwbG9hZFJlc3VsdD1mdW5jdGlvbihwbHVnaW5SZXN1bHQpe3ZhciByZXN1bHQ9bmV3IEZpbGVVcGxvYWRSZXN1bHQoKTtyZXN1bHQuYnl0ZXNTZW50PXBsdWdpblJlc3VsdC5tZXNzYWdlLmJ5dGVzU2VudDtyZXN1bHQucmVzcG9uc2VDb2RlPXBsdWdpblJlc3VsdC5tZXNzYWdlLnJlc3BvbnNlQ29kZTtyZXN1bHQucmVzcG9uc2U9ZGVjb2RlVVJJQ29tcG9uZW50KHBsdWdpblJlc3VsdC5tZXNzYWdlLnJlc3BvbnNlKTtwbHVnaW5SZXN1bHQubWVzc2FnZT1yZXN1bHQ7cmV0dXJuIHBsdWdpblJlc3VsdH07RmlsZVVwbG9hZE9wdGlvbnM9ZnVuY3Rpb24oZmlsZUtleSxmaWxlTmFtZSxtaW1lVHlwZSxwYXJhbXMpe3RoaXMuZmlsZUtleT1maWxlS2V5fHxudWxsO3RoaXMuZmlsZU5hbWU9ZmlsZU5hbWV8fG51bGw7dGhpcy5taW1lVHlwZT1taW1lVHlwZXx8bnVsbDt0aGlzLnBhcmFtcz1wYXJhbXN8fG51bGx9O1Bob25lR2FwLmFkZENvbnN0cnVjdG9yKGZ1bmN0aW9uKCl7aWYodHlwZW9mIG5hdmlnYXRvci5maWxlVHJhbnNmZXI9PSJ1bmRlZmluZWQiKXtuYXZpZ2F0b3IuZmlsZVRyYW5zZmVyPW5ldyBGaWxlVHJhbnNmZXIoKX19KX1pZighUGhvbmVHYXAuaGFzUmVzb3VyY2UoImdlb2xvY2F0aW9uIikpe1Bob25lR2FwLmFkZFJlc291cmNlKCJnZW9sb2NhdGlvbiIpO0dlb2xvY2F0aW9uPWZ1bmN0aW9uKCl7dGhpcy5sYXN0UG9zaXRpb249bnVsbDt0aGlzLmxpc3RlbmVyPW51bGw7dGhpcy50aW1lb3V0VGltZXJJZD0wfTtHZW9sb2NhdGlvbi5wcm90b3R5cGUuZ2V0Q3VycmVudFBvc2l0aW9uPWZ1bmN0aW9uKHN1Y2Nlc3NDYWxsYmFjayxlcnJvckNhbGxiYWNrLG9wdGlvbnMpe3ZhciB3aW49c3VjY2Vzc0NhbGxiYWNrO2lmKCF3aW58fHR5cGVvZih3aW4pIT0iZnVuY3Rpb24iKXt3aW49ZnVuY3Rpb24ocG9zaXRpb24pe319dmFyIGZhaWw9ZXJyb3JDYWxsYmFjaztpZighZmFpbHx8dHlwZW9mKGZhaWwpIT0iZnVuY3Rpb24iKXtmYWlsPWZ1bmN0aW9uKHBvc2l0aW9uRXJyb3Ipe319dmFyIHNlbGY9dGhpczt2YXIgdG90YWxUaW1lPTA7dmFyIHRpbWVvdXRUaW1lcklkO3ZhciBwYXJhbXM9bmV3IFBvc2l0aW9uT3B0aW9ucygpO2lmKG9wdGlvbnMpe2lmKG9wdGlvbnMubWF4aW11bUFnZSl7aWYodGhpcy5sYXN0UG9zaXRpb24pe3ZhciBub3c9bmV3IERhdGUoKS5nZXRUaW1lKCk7aWYobm93LXRoaXMubGFzdFBvc2l0aW9uLnRpbWVzdGFtcDxvcHRpb25zLm1heGltdW1BZ2Upe3dpbih0aGlzLmxhc3RQb3NpdGlvbik7cmV0dXJufX1wYXJhbXMubWF4aW11bUFnZT1vcHRpb25zLm1heGltdW1BZ2V9aWYob3B0aW9ucy5lbmFibGVIaWdoQWNjdXJhY3kpe3BhcmFtcy5lbmFibGVIaWdoQWNjdXJhY3k9KG9wdGlvbnMuZW5hYmxlSGlnaEFjY3VyYWN5PT10cnVlKX1pZihvcHRpb25zLnRpbWVvdXQpe3BhcmFtcy50aW1lb3V0PW9wdGlvbnMudGltZW91dH19dGhpcy5saXN0ZW5lcj17c3VjY2Vzczp3aW4sZmFpbDpmYWlsfTt0aGlzLnN0YXJ0KHBhcmFtcyk7dmFyIG9uVGltZW91dD1mdW5jdGlvbigpe3NlbGYuc2V0RXJyb3IobmV3IFBvc2l0aW9uRXJyb3IoUG9zaXRpb25FcnJvci5USU1FT1VULCJHZW9sb2NhdGlvbiBFcnJvcjogVGltZW91dC4iKSl9O3RoaXMudGltZW91dFRpbWVySWQ9c2V0VGltZW91dChvblRpbWVvdXQscGFyYW1zLnRpbWVvdXQpfTtHZW9sb2NhdGlvbi5wcm90b3R5cGUud2F0Y2hQb3NpdGlvbj1mdW5jdGlvbihzdWNjZXNzQ2FsbGJhY2ssZXJyb3JDYWxsYmFjayxvcHRpb25zKXt2YXIgc2VsZj10aGlzO3ZhciBwYXJhbXM9bmV3IFBvc2l0aW9uT3B0aW9ucygpO2lmKG9wdGlvbnMpe2lmKG9wdGlvbnMubWF4aW11bUFnZSl7cGFyYW1zLm1heGltdW1BZ2U9b3B0aW9ucy5tYXhpbXVtQWdlfWlmKG9wdGlvbnMuZW5hYmxlSGlnaEFjY3VyYWN5KXtwYXJhbXMuZW5hYmxlSGlnaEFjY3VyYWN5PW9wdGlvbnMuZW5hYmxlSGlnaEFjY3VyYWN5fWlmKG9wdGlvbnMudGltZW91dCl7cGFyYW1zLnRpbWVvdXQ9b3B0aW9ucy50aW1lb3V0fX12YXIgdGhhdD10aGlzO3ZhciBsYXN0UG9zPXRoYXQubGFzdFBvc2l0aW9uP3RoYXQubGFzdFBvc2l0aW9uLmNsb25lKCk6bnVsbDtyZXR1cm4gc2V0SW50ZXJ2YWwoZnVuY3Rpb24oKXt2YXIgZmlsdGVyRnVuPWZ1bmN0aW9uKHBvc2l0aW9uKXtpZihsYXN0UG9zPT1udWxsfHwhcG9zaXRpb24uZXF1YWxzKGxhc3RQb3MpKXtzdWNjZXNzQ2FsbGJhY2socG9zaXRpb24pfWxhc3RQb3M9cG9zaXRpb24uY2xvbmUoKX07dGhhdC5nZXRDdXJyZW50UG9zaXRpb24oZmlsdGVyRnVuLGVycm9yQ2FsbGJhY2sscGFyYW1zKX0scGFyYW1zLnRpbWVvdXQpfTtHZW9sb2NhdGlvbi5wcm90b3R5cGUuY2xlYXJXYXRjaD1mdW5jdGlvbih3YXRjaElkKXtjbGVhckludGVydmFsKHdhdGNoSWQpfTtHZW9sb2NhdGlvbi5wcm90b3R5cGUuc2V0TG9jYXRpb249ZnVuY3Rpb24ocG9zaXRpb24pe3ZhciBfcG9zaXRpb249bmV3IFBvc2l0aW9uKHBvc2l0aW9uLmNvb3Jkcyxwb3NpdGlvbi50aW1lc3RhbXApO2lmKHRoaXMudGltZW91dFRpbWVySWQpe2NsZWFyVGltZW91dCh0aGlzLnRpbWVvdXRUaW1lcklkKTt0aGlzLnRpbWVvdXRUaW1lcklkPTB9dGhpcy5sYXN0RXJyb3I9bnVsbDt0aGlzLmxhc3RQb3NpdGlvbj1fcG9zaXRpb247aWYodGhpcy5saXN0ZW5lciYmdHlwZW9mKHRoaXMubGlzdGVuZXIuc3VjY2Vzcyk9PSJmdW5jdGlvbiIpe3RoaXMubGlzdGVuZXIuc3VjY2VzcyhfcG9zaXRpb24pfXRoaXMubGlzdGVuZXI9bnVsbH07R2VvbG9jYXRpb24ucHJvdG90eXBlLnNldEVycm9yPWZ1bmN0aW9uKGVycm9yKXt2YXIgX2Vycm9yPW5ldyBQb3NpdGlvbkVycm9yKGVycm9yLmNvZGUsZXJyb3IubWVzc2FnZSk7aWYodGhpcy50aW1lb3V0VGltZXJJZCl7Y2xlYXJUaW1lb3V0KHRoaXMudGltZW91dFRpbWVySWQpO3RoaXMudGltZW91dFRpbWVySWQ9MH10aGlzLmxhc3RFcnJvcj1fZXJyb3I7aWYodGhpcy5saXN0ZW5lciYmdHlwZW9mKHRoaXMubGlzdGVuZXIuZmFpbCk9PSJmdW5jdGlvbiIpe3RoaXMubGlzdGVuZXIuZmFpbChfZXJyb3IpfXRoaXMubGlzdGVuZXI9bnVsbH07R2VvbG9jYXRpb24ucHJvdG90eXBlLnN0YXJ0PWZ1bmN0aW9uKGFyZ3Mpe1Bob25lR2FwLmV4ZWMoIkxvY2F0aW9uLnN0YXJ0TG9jYXRpb24iLGFyZ3MpfTtHZW9sb2NhdGlvbi5wcm90b3R5cGUuc3RvcD1mdW5jdGlvbigpe1Bob25lR2FwLmV4ZWMoIkxvY2F0aW9uLnN0b3BMb2NhdGlvbiIpfTtQaG9uZUdhcC5hZGRDb25zdHJ1Y3RvcihmdW5jdGlvbigpe2lmKHR5cGVvZiBuYXZpZ2F0b3IuX2dlbz09InVuZGVmaW5lZCIpe3ZhciBfX3Byb3h5T2JqPWZ1bmN0aW9uKG9yaWdPYmoscHJveHlPYmosZnVua0xpc3Qpe3ZhciByZXBsYWNlRnVuaz1mdW5jdGlvbihvcmcscHJveHksZk5hbWUpe29yZ1tmTmFtZV09ZnVuY3Rpb24oKXtyZXR1cm4gcHJveHlbZk5hbWVdLmFwcGx5KHByb3h5LGFyZ3VtZW50cyl9fTtmb3IodmFyIHYgaW4gZnVua0xpc3Qpe3JlcGxhY2VGdW5rKG9yaWdPYmoscHJveHlPYmosZnVua0xpc3Rbdl0pfX07bmF2aWdhdG9yLl9nZW89bmV3IEdlb2xvY2F0aW9uKCk7X19wcm94eU9iaihuYXZpZ2F0b3IuZ2VvbG9jYXRpb24sbmF2aWdhdG9yLl9nZW8sWyJzZXRMb2NhdGlvbiIsImdldEN1cnJlbnRQb3NpdGlvbiIsIndhdGNoUG9zaXRpb24iLCJjbGVhcldhdGNoIiwic2V0RXJyb3IiLCJzdGFydCIsInN0b3AiXSl9fSl9aWYoIVBob25lR2FwLmhhc1Jlc291cmNlKCJjb21wYXNzIikpe1Bob25lR2FwLmFkZFJlc291cmNlKCJjb21wYXNzIik7Q29tcGFzcz1mdW5jdGlvbigpe3RoaXMubGFzdEhlYWRpbmc9bnVsbDt0aGlzLmxhc3RFcnJvcj1udWxsO3RoaXMuY2FsbGJhY2tzPXtvbkhlYWRpbmdDaGFuZ2VkOltdLG9uRXJyb3I6W119fTtDb21wYXNzLnByb3RvdHlwZS5nZXRDdXJyZW50SGVhZGluZz1mdW5jdGlvbihzdWNjZXNzQ2FsbGJhY2ssZXJyb3JDYWxsYmFjayxvcHRpb25zKXtpZih0aGlzLmxhc3RIZWFkaW5nPT1udWxsKXt0aGlzLmNhbGxiYWNrcy5vbkhlYWRpbmdDaGFuZ2VkLnB1c2goc3VjY2Vzc0NhbGxiYWNrKTt0aGlzLmNhbGxiYWNrcy5vbkVycm9yLnB1c2goZXJyb3JDYWxsYmFjayk7dGhpcy5zdGFydChvcHRpb25zKX1lbHNle2lmKG9wdGlvbnMubWF4aW11bUFnZSl7dmFyIG5vdz1uZXcgRGF0ZSgpLmdldFRpbWUoKTtpZihub3ctdGhpcy5sYXN0SGVhZGluZy50aW1lc3RhbXA+b3B0aW9ucy5tYXhpbXVtQWdlKXt0aGlzLmNhbGxiYWNrcy5vbkhlYWRpbmdDaGFuZ2VkLnB1c2goc3VjY2Vzc0NhbGxiYWNrKTt0aGlzLmNhbGxiYWNrcy5vbkVycm9yLnB1c2goZXJyb3JDYWxsYmFjayk7dGhpcy5zdGFydChvcHRpb25zKTtyZXR1cm59fWlmKHR5cGVvZiBzdWNjZXNzQ2FsbGJhY2s9PSJmdW5jdGlvbiIpe3ZhciByZXR1cm5IZWFkaW5nPS0xO2lmKHRoaXMubGFzdEhlYWRpbmcudHJ1ZUhlYWRpbmc+LTEpe3JldHVybkhlYWRpbmc9dGhpcy5sYXN0SGVhZGluZy50cnVlSGVhZGluZ31lbHNle2lmKHRoaXMubGFzdEhlYWRpbmcubWFnbmV0aWNIZWFkaW5nKXtyZXR1cm5IZWFkaW5nPXRoaXMubGFzdEhlYWRpbmcubWFnbmV0aWNIZWFkaW5nfX1zdWNjZXNzQ2FsbGJhY2socmV0dXJuSGVhZGluZyl9fX07Q29tcGFzcy5wcm90b3R5cGUud2F0Y2hIZWFkaW5nPWZ1bmN0aW9uKHN1Y2Nlc3NDYWxsYmFjayxlcnJvckNhbGxiYWNrLG9wdGlvbnMpe3ZhciBmcmVxdWVuY3k9KG9wdGlvbnMmJm9wdGlvbnMuZnJlcXVlbmN5KT9vcHRpb25zLmZyZXF1ZW5jeToxMDAwO3ZhciBzZWxmPXRoaXM7dmFyIGZ1bms9ZnVuY3Rpb24oKXtzZWxmLmdldEN1cnJlbnRIZWFkaW5nKHN1Y2Nlc3NDYWxsYmFjayxlcnJvckNhbGxiYWNrLG9wdGlvbnMpfTtmdW5rKCk7cmV0dXJuIHNldEludGVydmFsKGZ1bmssZnJlcXVlbmN5KX07Q29tcGFzcy5wcm90b3R5cGUuY2xlYXJXYXRjaD1mdW5jdGlvbih3YXRjaElkKXtjbGVhckludGVydmFsKHdhdGNoSWQpfTtDb21wYXNzLnByb3RvdHlwZS5zZXRIZWFkaW5nPWZ1bmN0aW9uKGhlYWRpbmcpe3RoaXMubGFzdEhlYWRpbmc9aGVhZGluZzt2YXIgcmV0dXJuSGVhZGluZz0tMTtpZih0aGlzLmxhc3RIZWFkaW5nLnRydWVIZWFkaW5nPi0xKXtyZXR1cm5IZWFkaW5nPXRoaXMubGFzdEhlYWRpbmcudHJ1ZUhlYWRpbmd9ZWxzZXtpZih0aGlzLmxhc3RIZWFkaW5nLm1hZ25ldGljSGVhZGluZyl7cmV0dXJuSGVhZGluZz10aGlzLmxhc3RIZWFkaW5nLm1hZ25ldGljSGVhZGluZ319dmFyIGFycj10aGlzLmNhbGxiYWNrcy5vbkhlYWRpbmdDaGFuZ2VkO2Zvcih2YXIgaT0wLGxlbj1hcnIubGVuZ3RoO2k8bGVuO2krKyl7YXJyW2ldKHJldHVybkhlYWRpbmcpfXRoaXMuY2FsbGJhY2tzLm9uSGVhZGluZ0NoYW5nZWQ9W107dGhpcy5jYWxsYmFja3Mub25FcnJvcj1bXX07Q29tcGFzcy5wcm90b3R5cGUuc2V0RXJyb3I9ZnVuY3Rpb24obWVzc2FnZSl7dGhpcy5sYXN0RXJyb3I9bWVzc2FnZTt2YXIgYXJyPXRoaXMuY2FsbGJhY2tzLm9uRXJyb3I7Zm9yKHZhciBpPTAsbGVuPWFyci5sZW5ndGg7aTxsZW47aSsrKXthcnJbaV0obWVzc2FnZSl9dGhpcy5jYWxsYmFja3Mub25IZWFkaW5nQ2hhbmdlZD1bXTt0aGlzLmNhbGxiYWNrcy5vbkVycm9yPVtdO3RoaXMuc3RvcCgpfTtDb21wYXNzLnByb3RvdHlwZS5zdGFydD1mdW5jdGlvbihhcmdzKXtQaG9uZUdhcC5leGVjKCJMb2NhdGlvbi5zdGFydEhlYWRpbmciLGFyZ3MpfTtDb21wYXNzLnByb3RvdHlwZS5zdG9wPWZ1bmN0aW9uKCl7UGhvbmVHYXAuZXhlYygiTG9jYXRpb24uc3RvcEhlYWRpbmciKX07UGhvbmVHYXAuYWRkQ29uc3RydWN0b3IoZnVuY3Rpb24oKXtpZih0eXBlb2YgbmF2aWdhdG9yLmNvbXBhc3M9PSJ1bmRlZmluZWQiKXtuYXZpZ2F0b3IuY29tcGFzcz1uZXcgQ29tcGFzcygpfX0pfWlmKCFQaG9uZUdhcC5oYXNSZXNvdXJjZSgibWVkaWEiKSl7UGhvbmVHYXAuYWRkUmVzb3VyY2UoIm1lZGlhIik7TWVkaWE9ZnVuY3Rpb24oc3JjLHN1Y2Nlc3NDYWxsYmFjayxlcnJvckNhbGxiYWNrLGRvd25sb2FkQ29tcGxldGVDYWxsYmFjayl7aWYoIXNyYyl7c3JjPSJkb2N1bWVudHM6Ly8iK1N0cmluZygobmV3IERhdGUoKSkuZ2V0VGltZSgpKS5yZXBsYWNlKC9cRC9naSwiIil9dGhpcy5zcmM9c3JjO3ZhciBzdWNjZXNzQ0I9KHN1Y2Nlc3NDYWxsYmFjaz09dW5kZWZpbmVkfHxzdWNjZXNzQ2FsbGJhY2s9PW51bGwpP251bGw6R2V0RnVuY3Rpb25OYW1lKHN1Y2Nlc3NDYWxsYmFjayk7dmFyIGVycm9yQ0I9KGVycm9yQ2FsbGJhY2s9PXVuZGVmaW5lZHx8ZXJyb3JDYWxsYmFjaz09bnVsbCk/bnVsbDpHZXRGdW5jdGlvbk5hbWUoZXJyb3JDYWxsYmFjayk7dmFyIGRvd25sb2FkQ0I9KGRvd25sb2FkQ29tcGxldGVDYWxsYmFjaz09dW5kZWZpbmVkfHxkb3dubG9hZENvbXBsZXRlQ2FsbGJhY2s9PW51bGwpP251bGw6R2V0RnVuY3Rpb25OYW1lKGRvd25sb2FkQ29tcGxldGVDYWxsYmFjayk7dGhpcy5zdWNjZXNzQ2FsbGJhY2s9c3VjY2Vzc0NhbGxiYWNrfHxudWxsO3RoaXMuZXJyb3JDYWxsYmFjaz1lcnJvckNhbGxiYWNrfHxudWxsO3RoaXMuZG93bmxvYWRDb21wbGV0ZUNhbGxiYWNrPWRvd25sb2FkQ29tcGxldGVDYWxsYmFja3x8bnVsbDtpZih0aGlzLnNyYyE9bnVsbCl7UGhvbmVHYXAuZXhlYygiU291bmQucHJlcGFyZSIsdGhpcy5zcmMsc3VjY2Vzc0NCLGVycm9yQ0IsZG93bmxvYWRDQil9fTtNZWRpYS5wcm90b3R5cGUucGxheT1mdW5jdGlvbihvcHRpb25zKXtpZih0aGlzLnNyYyE9bnVsbCl7UGhvbmVHYXAuZXhlYygiU291bmQucGxheSIsdGhpcy5zcmMsb3B0aW9ucyl9fTtNZWRpYS5wcm90b3R5cGUucGF1c2U9ZnVuY3Rpb24oKXtpZih0aGlzLnNyYyE9bnVsbCl7UGhvbmVHYXAuZXhlYygiU291bmQucGF1c2UiLHRoaXMuc3JjKX19O01lZGlhLnByb3RvdHlwZS5zdG9wPWZ1bmN0aW9uKCl7aWYodGhpcy5zcmMhPW51bGwpe1Bob25lR2FwLmV4ZWMoIlNvdW5kLnN0b3AiLHRoaXMuc3JjKX19O01lZGlhLnByb3RvdHlwZS5zdGFydEF1ZGlvUmVjb3JkPWZ1bmN0aW9uKG9wdGlvbnMpe2lmKHRoaXMuc3JjIT1udWxsKXtQaG9uZUdhcC5leGVjKCJTb3VuZC5zdGFydEF1ZGlvUmVjb3JkIix0aGlzLnNyYyxvcHRpb25zKX19O01lZGlhLnByb3RvdHlwZS5zdG9wQXVkaW9SZWNvcmQ9ZnVuY3Rpb24oKXtpZih0aGlzLnNyYyE9bnVsbCl7UGhvbmVHYXAuZXhlYygiU291bmQuc3RvcEF1ZGlvUmVjb3JkIix0aGlzLnNyYyl9fTtNZWRpYUVycm9yPWZ1bmN0aW9uKCl7dGhpcy5jb2RlPW51bGwsdGhpcy5tZXNzYWdlPSIifTtNZWRpYUVycm9yLk1FRElBX0VSUl9BQk9SVEVEPTE7TWVkaWFFcnJvci5NRURJQV9FUlJfTkVUV09SSz0yO01lZGlhRXJyb3IuTUVESUFfRVJSX0RFQ09ERT0zO01lZGlhRXJyb3IuTUVESUFfRVJSX05PTkVfU1VQUE9SVEVEPTR9aWYoIVBob25lR2FwLmhhc1Jlc291cmNlKCJub3RpZmljYXRpb24iKSl7UGhvbmVHYXAuYWRkUmVzb3VyY2UoIm5vdGlmaWNhdGlvbiIpO05vdGlmaWNhdGlvbj1mdW5jdGlvbigpe307Tm90aWZpY2F0aW9uLnByb3RvdHlwZS5hbGVydD1mdW5jdGlvbihtZXNzYWdlLGNvbXBsZXRlQ2FsbGJhY2ssdGl0bGUsYnV0dG9uTGFiZWwpe3ZhciBfdGl0bGU9KHRpdGxlfHwiQWxlcnQiKTt2YXIgX2J1dHRvbkxhYmVsPShidXR0b25MYWJlbHx8Ik9LIik7UGhvbmVHYXAuZXhlYyhjb21wbGV0ZUNhbGxiYWNrLG51bGwsIk5vdGlmaWNhdGlvbiIsImFsZXJ0IixbbWVzc2FnZSx7dGl0bGU6X3RpdGxlLGJ1dHRvbkxhYmVsOl9idXR0b25MYWJlbH1dKX07Tm90aWZpY2F0aW9uLnByb3RvdHlwZS5jb25maXJtPWZ1bmN0aW9uKG1lc3NhZ2UscmVzdWx0Q2FsbGJhY2ssdGl0bGUsYnV0dG9uTGFiZWxzKXt2YXIgX3RpdGxlPSh0aXRsZXx8IkNvbmZpcm0iKTt2YXIgX2J1dHRvbkxhYmVscz0oYnV0dG9uTGFiZWxzfHwiT0ssQ2FuY2VsIik7dGhpcy5hbGVydChtZXNzYWdlLHJlc3VsdENhbGxiYWNrLF90aXRsZSxfYnV0dG9uTGFiZWxzKX07Tm90aWZpY2F0aW9uLnByb3RvdHlwZS5hY3Rpdml0eVN0YXJ0PWZ1bmN0aW9uKCl7UGhvbmVHYXAuZXhlYyhudWxsLG51bGwsIk5vdGlmaWNhdGlvbiIsImFjdGl2aXR5U3RhcnQiLFtdKX07Tm90aWZpY2F0aW9uLnByb3RvdHlwZS5hY3Rpdml0eVN0b3A9ZnVuY3Rpb24oKXtQaG9uZUdhcC5leGVjKG51bGwsbnVsbCwiTm90aWZpY2F0aW9uIiwiYWN0aXZpdHlTdG9wIixbXSl9O05vdGlmaWNhdGlvbi5wcm90b3R5cGUubG9hZGluZ1N0YXJ0PWZ1bmN0aW9uKG9wdGlvbnMpe1Bob25lR2FwLmV4ZWMobnVsbCxudWxsLCJOb3RpZmljYXRpb24iLCJsb2FkaW5nU3RhcnQiLFtvcHRpb25zXSl9O05vdGlmaWNhdGlvbi5wcm90b3R5cGUubG9hZGluZ1N0b3A9ZnVuY3Rpb24oKXtQaG9uZUdhcC5leGVjKG51bGwsbnVsbCwiTm90aWZpY2F0aW9uIiwibG9hZGluZ1N0b3AiLFtdKX07Tm90aWZpY2F0aW9uLnByb3RvdHlwZS5ibGluaz1mdW5jdGlvbihjb3VudCxjb2xvdXIpe307Tm90aWZpY2F0aW9uLnByb3RvdHlwZS52aWJyYXRlPWZ1bmN0aW9uKG1pbGxzKXtQaG9uZUdhcC5leGVjKG51bGwsbnVsbCwiTm90aWZpY2F0aW9uIiwidmlicmF0ZSIsW10pfTtOb3RpZmljYXRpb24ucHJvdG90eXBlLmJlZXA9ZnVuY3Rpb24oY291bnQsdm9sdW1lKXtuZXcgTWVkaWEoImJlZXAud2F2IikucGxheSgpfTtQaG9uZUdhcC5hZGRDb25zdHJ1Y3RvcihmdW5jdGlvbigpe2lmKHR5cGVvZiBuYXZpZ2F0b3Iubm90aWZpY2F0aW9uPT0idW5kZWZpbmVkIil7bmF2aWdhdG9yLm5vdGlmaWNhdGlvbj1uZXcgTm90aWZpY2F0aW9uKCl9fSl9aWYoIVBob25lR2FwLmhhc1Jlc291cmNlKCJvcmllbnRhdGlvbiIpKXtQaG9uZUdhcC5hZGRSZXNvdXJjZSgib3JpZW50YXRpb24iKTtPcmllbnRhdGlvbj1mdW5jdGlvbigpe3RoaXMuY3VycmVudE9yaWVudGF0aW9uPW51bGx9O09yaWVudGF0aW9uLnByb3RvdHlwZS5zZXRPcmllbnRhdGlvbj1mdW5jdGlvbihvcmllbnRhdGlvbil7T3JpZW50YXRpb24uY3VycmVudE9yaWVudGF0aW9uPW9yaWVudGF0aW9uO3ZhciBlPWRvY3VtZW50LmNyZWF0ZUV2ZW50KCJFdmVudHMiKTtlLmluaXRFdmVudCgib3JpZW50YXRpb25DaGFuZ2VkIiwiZmFsc2UiLCJmYWxzZSIpO2Uub3JpZW50YXRpb249b3JpZW50YXRpb247ZG9jdW1lbnQuZGlzcGF0Y2hFdmVudChlKX07T3JpZW50YXRpb24ucHJvdG90eXBlLmdldEN1cnJlbnRPcmllbnRhdGlvbj1mdW5jdGlvbihzdWNjZXNzQ2FsbGJhY2ssZXJyb3JDYWxsYmFjayl7fTtPcmllbnRhdGlvbi5wcm90b3R5cGUud2F0Y2hPcmllbnRhdGlvbj1mdW5jdGlvbihzdWNjZXNzQ2FsbGJhY2ssZXJyb3JDYWxsYmFjayl7dGhpcy5nZXRDdXJyZW50UG9zaXRpb24oc3VjY2Vzc0NhbGxiYWNrLGVycm9yQ2FsbGJhY2spO3JldHVybiBzZXRJbnRlcnZhbChmdW5jdGlvbigpe25hdmlnYXRvci5vcmllbnRhdGlvbi5nZXRDdXJyZW50T3JpZW50YXRpb24oc3VjY2Vzc0NhbGxiYWNrLGVycm9yQ2FsbGJhY2spfSwxMDAwMCl9O09yaWVudGF0aW9uLnByb3RvdHlwZS5jbGVhcldhdGNoPWZ1bmN0aW9uKHdhdGNoSWQpe2NsZWFySW50ZXJ2YWwod2F0Y2hJZCl9O1Bob25lR2FwLmFkZENvbnN0cnVjdG9yKGZ1bmN0aW9uKCl7aWYodHlwZW9mIG5hdmlnYXRvci5vcmllbnRhdGlvbj09InVuZGVmaW5lZCIpe25hdmlnYXRvci5vcmllbnRhdGlvbj1uZXcgT3JpZW50YXRpb24oKX19KX1pZighUGhvbmVHYXAuaGFzUmVzb3VyY2UoInNtcyIpKXtQaG9uZUdhcC5hZGRSZXNvdXJjZSgic21zIik7U21zPWZ1bmN0aW9uKCl7fTtTbXMucHJvdG90eXBlLnNlbmQ9ZnVuY3Rpb24obnVtYmVyLG1lc3NhZ2Usc3VjY2Vzc0NhbGxiYWNrLGVycm9yQ2FsbGJhY2ssb3B0aW9ucyl7fTtQaG9uZUdhcC5hZGRDb25zdHJ1Y3RvcihmdW5jdGlvbigpe2lmKHR5cGVvZiBuYXZpZ2F0b3Iuc21zPT0idW5kZWZpbmVkIil7bmF2aWdhdG9yLnNtcz1uZXcgU21zKCl9fSl9aWYoIVBob25lR2FwLmhhc1Jlc291cmNlKCJ0ZWxlcGhvbnkiKSl7UGhvbmVHYXAuYWRkUmVzb3VyY2UoInRlbGVwaG9ueSIpO1RlbGVwaG9ueT1mdW5jdGlvbigpe307VGVsZXBob255LnByb3RvdHlwZS5jYWxsPWZ1bmN0aW9uKG51bWJlcil7fTtQaG9uZUdhcC5hZGRDb25zdHJ1Y3RvcihmdW5jdGlvbigpe2lmKHR5cGVvZiBuYXZpZ2F0b3IudGVsZXBob255PT0idW5kZWZpbmVkIil7bmF2aWdhdG9yLnRlbGVwaG9ueT1uZXcgVGVsZXBob255KCl9fSl9aWYoIVBob25lR2FwLmhhc1Jlc291cmNlKCJuZXR3b3JrIikpe1Bob25lR2FwLmFkZFJlc291cmNlKCJuZXR3b3JrIik7Q29ubmVjdGlvbj1mdW5jdGlvbih0eXBlLGhvbWVOVyxjdXJyZW50Tlcpe3RoaXMudHlwZT10eXBlfHwwO3RoaXMuaG9tZU5XPWhvbWVOV3x8bnVsbDt0aGlzLmN1cnJlbnROVz1jdXJyZW50Tld8fG51bGx9O0Nvbm5lY3Rpb24uVU5LTk9XTj0wO0Nvbm5lY3Rpb24uRVRIRVJORVQ9MTtDb25uZWN0aW9uLldJRkk9MjtDb25uZWN0aW9uLkNFTExfMkc9MztDb25uZWN0aW9uLkNFTExfM0c9NDtDb25uZWN0aW9uLkNFTExfNEc9NTtDb25uZWN0aW9uLk5PTkU9MjA7TmV0d29ya1N0YXR1cz1mdW5jdGlvbigpe3RoaXMuY29kZT1udWxsO3RoaXMubWVzc2FnZT0iIn07TmV0d29ya1N0YXR1cy5OT1RfUkVBQ0hBQkxFPTA7TmV0d29ya1N0YXR1cy5SRUFDSEFCTEVfVklBX0NBUlJJRVJfREFUQV9ORVRXT1JLPTE7TmV0d29ya1N0YXR1cy5SRUFDSEFCTEVfVklBX1dJRklfTkVUV09SSz0yO05ldHdvcms9ZnVuY3Rpb24oKXt9O05ldHdvcmsucHJvdG90eXBlLmlzUmVhY2hhYmxlPWZ1bmN0aW9uKGhvc3ROYW1lLHN1Y2Nlc3NDYWxsYmFjayxvcHRpb25zKXtQaG9uZUdhcC5leGVjKCJOZXR3b3JrLmlzUmVhY2hhYmxlIixob3N0TmFtZSxHZXRGdW5jdGlvbk5hbWUoc3VjY2Vzc0NhbGxiYWNrKSxvcHRpb25zKX07UGhvbmVHYXAuYWRkQ29uc3RydWN0b3IoZnVuY3Rpb24oKXtpZih0eXBlb2YgbmF2aWdhdG9yLm5ldHdvcms9PSJ1bmRlZmluZWQiKXtuYXZpZ2F0b3IubmV0d29yaz1uZXcgTmV0d29yaygpfWlmKHR5cGVvZiBuYXZpZ2F0b3IuY29ubmVjdGlvbj09InVuZGVmaW5lZCIpe25hdmlnYXRvci5jb25uZWN0aW9uPW5ldyBDb25uZWN0aW9uKCl9fSl9Ow==","content_type":"application/javascript","revpos":42},"js/underscore-1.1.6.js":{"data":"Ly8gICAgIFVuZGVyc2NvcmUuanMgMS4xLjYKLy8gICAgIChjKSAyMDExIEplcmVteSBBc2hrZW5hcywgRG9jdW1lbnRDbG91ZCBJbmMuCi8vICAgICBVbmRlcnNjb3JlIGlzIGZyZWVseSBkaXN0cmlidXRhYmxlIHVuZGVyIHRoZSBNSVQgbGljZW5zZS4KLy8gICAgIFBvcnRpb25zIG9mIFVuZGVyc2NvcmUgYXJlIGluc3BpcmVkIG9yIGJvcnJvd2VkIGZyb20gUHJvdG90eXBlLAovLyAgICAgT2xpdmVyIFN0ZWVsZSdzIEZ1bmN0aW9uYWwsIGFuZCBKb2huIFJlc2lnJ3MgTWljcm8tVGVtcGxhdGluZy4KLy8gICAgIEZvciBhbGwgZGV0YWlscyBhbmQgZG9jdW1lbnRhdGlvbjoKLy8gICAgIGh0dHA6Ly9kb2N1bWVudGNsb3VkLmdpdGh1Yi5jb20vdW5kZXJzY29yZQoKKGZ1bmN0aW9uKCkgewoKICAvLyBCYXNlbGluZSBzZXR1cAogIC8vIC0tLS0tLS0tLS0tLS0tCgogIC8vIEVzdGFibGlzaCB0aGUgcm9vdCBvYmplY3QsIGB3aW5kb3dgIGluIHRoZSBicm93c2VyLCBvciBgZ2xvYmFsYCBvbiB0aGUgc2VydmVyLgogIHZhciByb290ID0gdGhpczsKCiAgLy8gU2F2ZSB0aGUgcHJldmlvdXMgdmFsdWUgb2YgdGhlIGBfYCB2YXJpYWJsZS4KICB2YXIgcHJldmlvdXNVbmRlcnNjb3JlID0gcm9vdC5fOwoKICAvLyBFc3RhYmxpc2ggdGhlIG9iamVjdCB0aGF0IGdldHMgcmV0dXJuZWQgdG8gYnJlYWsgb3V0IG9mIGEgbG9vcCBpdGVyYXRpb24uCiAgdmFyIGJyZWFrZXIgPSB7fTsKCiAgLy8gU2F2ZSBieXRlcyBpbiB0aGUgbWluaWZpZWQgKGJ1dCBub3QgZ3ppcHBlZCkgdmVyc2lvbjoKICB2YXIgQXJyYXlQcm90byA9IEFycmF5LnByb3RvdHlwZSwgT2JqUHJvdG8gPSBPYmplY3QucHJvdG90eXBlLCBGdW5jUHJvdG8gPSBGdW5jdGlvbi5wcm90b3R5cGU7CgogIC8vIENyZWF0ZSBxdWljayByZWZlcmVuY2UgdmFyaWFibGVzIGZvciBzcGVlZCBhY2Nlc3MgdG8gY29yZSBwcm90b3R5cGVzLgogIHZhciBzbGljZSAgICAgICAgICAgID0gQXJyYXlQcm90by5zbGljZSwKICAgICAgdW5zaGlmdCAgICAgICAgICA9IEFycmF5UHJvdG8udW5zaGlmdCwKICAgICAgdG9TdHJpbmcgICAgICAgICA9IE9ialByb3RvLnRvU3RyaW5nLAogICAgICBoYXNPd25Qcm9wZXJ0eSAgID0gT2JqUHJvdG8uaGFzT3duUHJvcGVydHk7CgogIC8vIEFsbCAqKkVDTUFTY3JpcHQgNSoqIG5hdGl2ZSBmdW5jdGlvbiBpbXBsZW1lbnRhdGlvbnMgdGhhdCB3ZSBob3BlIHRvIHVzZQogIC8vIGFyZSBkZWNsYXJlZCBoZXJlLgogIHZhcgogICAgbmF0aXZlRm9yRWFjaCAgICAgID0gQXJyYXlQcm90by5mb3JFYWNoLAogICAgbmF0aXZlTWFwICAgICAgICAgID0gQXJyYXlQcm90by5tYXAsCiAgICBuYXRpdmVSZWR1Y2UgICAgICAgPSBBcnJheVByb3RvLnJlZHVjZSwKICAgIG5hdGl2ZVJlZHVjZVJpZ2h0ICA9IEFycmF5UHJvdG8ucmVkdWNlUmlnaHQsCiAgICBuYXRpdmVGaWx0ZXIgICAgICAgPSBBcnJheVByb3RvLmZpbHRlciwKICAgIG5hdGl2ZUV2ZXJ5ICAgICAgICA9IEFycmF5UHJvdG8uZXZlcnksCiAgICBuYXRpdmVTb21lICAgICAgICAgPSBBcnJheVByb3RvLnNvbWUsCiAgICBuYXRpdmVJbmRleE9mICAgICAgPSBBcnJheVByb3RvLmluZGV4T2YsCiAgICBuYXRpdmVMYXN0SW5kZXhPZiAgPSBBcnJheVByb3RvLmxhc3RJbmRleE9mLAogICAgbmF0aXZlSXNBcnJheSAgICAgID0gQXJyYXkuaXNBcnJheSwKICAgIG5hdGl2ZUtleXMgICAgICAgICA9IE9iamVjdC5rZXlzLAogICAgbmF0aXZlQmluZCAgICAgICAgID0gRnVuY1Byb3RvLmJpbmQ7CgogIC8vIENyZWF0ZSBhIHNhZmUgcmVmZXJlbmNlIHRvIHRoZSBVbmRlcnNjb3JlIG9iamVjdCBmb3IgdXNlIGJlbG93LgogIHZhciBfID0gZnVuY3Rpb24ob2JqKSB7IHJldHVybiBuZXcgd3JhcHBlcihvYmopOyB9OwoKICAvLyBFeHBvcnQgdGhlIFVuZGVyc2NvcmUgb2JqZWN0IGZvciAqKkNvbW1vbkpTKiosIHdpdGggYmFja3dhcmRzLWNvbXBhdGliaWxpdHkKICAvLyBmb3IgdGhlIG9sZCBgcmVxdWlyZSgpYCBBUEkuIElmIHdlJ3JlIG5vdCBpbiBDb21tb25KUywgYWRkIGBfYCB0byB0aGUKICAvLyBnbG9iYWwgb2JqZWN0LgogIGlmICh0eXBlb2YgbW9kdWxlICE9PSAndW5kZWZpbmVkJyAmJiBtb2R1bGUuZXhwb3J0cykgewogICAgbW9kdWxlLmV4cG9ydHMgPSBfOwogICAgXy5fID0gXzsKICB9IGVsc2UgewogICAgcm9vdC5fID0gXzsKICB9CgogIC8vIEN1cnJlbnQgdmVyc2lvbi4KICBfLlZFUlNJT04gPSAnMS4xLjYnOwoKICAvLyBDb2xsZWN0aW9uIEZ1bmN0aW9ucwogIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tCgogIC8vIFRoZSBjb3JuZXJzdG9uZSwgYW4gYGVhY2hgIGltcGxlbWVudGF0aW9uLCBha2EgYGZvckVhY2hgLgogIC8vIEhhbmRsZXMgb2JqZWN0cyBpbXBsZW1lbnRpbmcgYGZvckVhY2hgLCBhcnJheXMsIGFuZCByYXcgb2JqZWN0cy4KICAvLyBEZWxlZ2F0ZXMgdG8gKipFQ01BU2NyaXB0IDUqKidzIG5hdGl2ZSBgZm9yRWFjaGAgaWYgYXZhaWxhYmxlLgogIHZhciBlYWNoID0gXy5lYWNoID0gXy5mb3JFYWNoID0gZnVuY3Rpb24ob2JqLCBpdGVyYXRvciwgY29udGV4dCkgewogICAgaWYgKG9iaiA9PSBudWxsKSByZXR1cm47CiAgICBpZiAobmF0aXZlRm9yRWFjaCAmJiBvYmouZm9yRWFjaCA9PT0gbmF0aXZlRm9yRWFjaCkgewogICAgICBvYmouZm9yRWFjaChpdGVyYXRvciwgY29udGV4dCk7CiAgICB9IGVsc2UgaWYgKF8uaXNOdW1iZXIob2JqLmxlbmd0aCkpIHsKICAgICAgZm9yICh2YXIgaSA9IDAsIGwgPSBvYmoubGVuZ3RoOyBpIDwgbDsgaSsrKSB7CiAgICAgICAgaWYgKGl0ZXJhdG9yLmNhbGwoY29udGV4dCwgb2JqW2ldLCBpLCBvYmopID09PSBicmVha2VyKSByZXR1cm47CiAgICAgIH0KICAgIH0gZWxzZSB7CiAgICAgIGZvciAodmFyIGtleSBpbiBvYmopIHsKICAgICAgICBpZiAoaGFzT3duUHJvcGVydHkuY2FsbChvYmosIGtleSkpIHsKICAgICAgICAgIGlmIChpdGVyYXRvci5jYWxsKGNvbnRleHQsIG9ialtrZXldLCBrZXksIG9iaikgPT09IGJyZWFrZXIpIHJldHVybjsKICAgICAgICB9CiAgICAgIH0KICAgIH0KICB9OwoKICAvLyBSZXR1cm4gdGhlIHJlc3VsdHMgb2YgYXBwbHlpbmcgdGhlIGl0ZXJhdG9yIHRvIGVhY2ggZWxlbWVudC4KICAvLyBEZWxlZ2F0ZXMgdG8gKipFQ01BU2NyaXB0IDUqKidzIG5hdGl2ZSBgbWFwYCBpZiBhdmFpbGFibGUuCiAgXy5tYXAgPSBmdW5jdGlvbihvYmosIGl0ZXJhdG9yLCBjb250ZXh0KSB7CiAgICB2YXIgcmVzdWx0cyA9IFtdOwogICAgaWYgKG9iaiA9PSBudWxsKSByZXR1cm4gcmVzdWx0czsKICAgIGlmIChuYXRpdmVNYXAgJiYgb2JqLm1hcCA9PT0gbmF0aXZlTWFwKSByZXR1cm4gb2JqLm1hcChpdGVyYXRvciwgY29udGV4dCk7CiAgICBlYWNoKG9iaiwgZnVuY3Rpb24odmFsdWUsIGluZGV4LCBsaXN0KSB7CiAgICAgIHJlc3VsdHNbcmVzdWx0cy5sZW5ndGhdID0gaXRlcmF0b3IuY2FsbChjb250ZXh0LCB2YWx1ZSwgaW5kZXgsIGxpc3QpOwogICAgfSk7CiAgICByZXR1cm4gcmVzdWx0czsKICB9OwoKICAvLyAqKlJlZHVjZSoqIGJ1aWxkcyB1cCBhIHNpbmdsZSByZXN1bHQgZnJvbSBhIGxpc3Qgb2YgdmFsdWVzLCBha2EgYGluamVjdGAsCiAgLy8gb3IgYGZvbGRsYC4gRGVsZWdhdGVzIHRvICoqRUNNQVNjcmlwdCA1KioncyBuYXRpdmUgYHJlZHVjZWAgaWYgYXZhaWxhYmxlLgogIF8ucmVkdWNlID0gXy5mb2xkbCA9IF8uaW5qZWN0ID0gZnVuY3Rpb24ob2JqLCBpdGVyYXRvciwgbWVtbywgY29udGV4dCkgewogICAgdmFyIGluaXRpYWwgPSBtZW1vICE9PSB2b2lkIDA7CiAgICBpZiAob2JqID09IG51bGwpIG9iaiA9IFtdOwogICAgaWYgKG5hdGl2ZVJlZHVjZSAmJiBvYmoucmVkdWNlID09PSBuYXRpdmVSZWR1Y2UpIHsKICAgICAgaWYgKGNvbnRleHQpIGl0ZXJhdG9yID0gXy5iaW5kKGl0ZXJhdG9yLCBjb250ZXh0KTsKICAgICAgcmV0dXJuIGluaXRpYWwgPyBvYmoucmVkdWNlKGl0ZXJhdG9yLCBtZW1vKSA6IG9iai5yZWR1Y2UoaXRlcmF0b3IpOwogICAgfQogICAgZWFjaChvYmosIGZ1bmN0aW9uKHZhbHVlLCBpbmRleCwgbGlzdCkgewogICAgICBpZiAoIWluaXRpYWwgJiYgaW5kZXggPT09IDApIHsKICAgICAgICBtZW1vID0gdmFsdWU7CiAgICAgICAgaW5pdGlhbCA9IHRydWU7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgbWVtbyA9IGl0ZXJhdG9yLmNhbGwoY29udGV4dCwgbWVtbywgdmFsdWUsIGluZGV4LCBsaXN0KTsKICAgICAgfQogICAgfSk7CiAgICBpZiAoIWluaXRpYWwpIHRocm93IG5ldyBUeXBlRXJyb3IoIlJlZHVjZSBvZiBlbXB0eSBhcnJheSB3aXRoIG5vIGluaXRpYWwgdmFsdWUiKTsKICAgIHJldHVybiBtZW1vOwogIH07CgogIC8vIFRoZSByaWdodC1hc3NvY2lhdGl2ZSB2ZXJzaW9uIG9mIHJlZHVjZSwgYWxzbyBrbm93biBhcyBgZm9sZHJgLgogIC8vIERlbGVnYXRlcyB0byAqKkVDTUFTY3JpcHQgNSoqJ3MgbmF0aXZlIGByZWR1Y2VSaWdodGAgaWYgYXZhaWxhYmxlLgogIF8ucmVkdWNlUmlnaHQgPSBfLmZvbGRyID0gZnVuY3Rpb24ob2JqLCBpdGVyYXRvciwgbWVtbywgY29udGV4dCkgewogICAgaWYgKG9iaiA9PSBudWxsKSBvYmogPSBbXTsKICAgIGlmIChuYXRpdmVSZWR1Y2VSaWdodCAmJiBvYmoucmVkdWNlUmlnaHQgPT09IG5hdGl2ZVJlZHVjZVJpZ2h0KSB7CiAgICAgIGlmIChjb250ZXh0KSBpdGVyYXRvciA9IF8uYmluZChpdGVyYXRvciwgY29udGV4dCk7CiAgICAgIHJldHVybiBtZW1vICE9PSB2b2lkIDAgPyBvYmoucmVkdWNlUmlnaHQoaXRlcmF0b3IsIG1lbW8pIDogb2JqLnJlZHVjZVJpZ2h0KGl0ZXJhdG9yKTsKICAgIH0KICAgIHZhciByZXZlcnNlZCA9IChfLmlzQXJyYXkob2JqKSA/IG9iai5zbGljZSgpIDogXy50b0FycmF5KG9iaikpLnJldmVyc2UoKTsKICAgIHJldHVybiBfLnJlZHVjZShyZXZlcnNlZCwgaXRlcmF0b3IsIG1lbW8sIGNvbnRleHQpOwogIH07CgogIC8vIFJldHVybiB0aGUgZmlyc3QgdmFsdWUgd2hpY2ggcGFzc2VzIGEgdHJ1dGggdGVzdC4gQWxpYXNlZCBhcyBgZGV0ZWN0YC4KICBfLmZpbmQgPSBfLmRldGVjdCA9IGZ1bmN0aW9uKG9iaiwgaXRlcmF0b3IsIGNvbnRleHQpIHsKICAgIHZhciByZXN1bHQ7CiAgICBhbnkob2JqLCBmdW5jdGlvbih2YWx1ZSwgaW5kZXgsIGxpc3QpIHsKICAgICAgaWYgKGl0ZXJhdG9yLmNhbGwoY29udGV4dCwgdmFsdWUsIGluZGV4LCBsaXN0KSkgewogICAgICAgIHJlc3VsdCA9IHZhbHVlOwogICAgICAgIHJldHVybiB0cnVlOwogICAgICB9CiAgICB9KTsKICAgIHJldHVybiByZXN1bHQ7CiAgfTsKCiAgLy8gUmV0dXJuIGFsbCB0aGUgZWxlbWVudHMgdGhhdCBwYXNzIGEgdHJ1dGggdGVzdC4KICAvLyBEZWxlZ2F0ZXMgdG8gKipFQ01BU2NyaXB0IDUqKidzIG5hdGl2ZSBgZmlsdGVyYCBpZiBhdmFpbGFibGUuCiAgLy8gQWxpYXNlZCBhcyBgc2VsZWN0YC4KICBfLmZpbHRlciA9IF8uc2VsZWN0ID0gZnVuY3Rpb24ob2JqLCBpdGVyYXRvciwgY29udGV4dCkgewogICAgdmFyIHJlc3VsdHMgPSBbXTsKICAgIGlmIChvYmogPT0gbnVsbCkgcmV0dXJuIHJlc3VsdHM7CiAgICBpZiAobmF0aXZlRmlsdGVyICYmIG9iai5maWx0ZXIgPT09IG5hdGl2ZUZpbHRlcikgcmV0dXJuIG9iai5maWx0ZXIoaXRlcmF0b3IsIGNvbnRleHQpOwogICAgZWFjaChvYmosIGZ1bmN0aW9uKHZhbHVlLCBpbmRleCwgbGlzdCkgewogICAgICBpZiAoaXRlcmF0b3IuY2FsbChjb250ZXh0LCB2YWx1ZSwgaW5kZXgsIGxpc3QpKSByZXN1bHRzW3Jlc3VsdHMubGVuZ3RoXSA9IHZhbHVlOwogICAgfSk7CiAgICByZXR1cm4gcmVzdWx0czsKICB9OwoKICAvLyBSZXR1cm4gYWxsIHRoZSBlbGVtZW50cyBmb3Igd2hpY2ggYSB0cnV0aCB0ZXN0IGZhaWxzLgogIF8ucmVqZWN0ID0gZnVuY3Rpb24ob2JqLCBpdGVyYXRvciwgY29udGV4dCkgewogICAgdmFyIHJlc3VsdHMgPSBbXTsKICAgIGlmIChvYmogPT0gbnVsbCkgcmV0dXJuIHJlc3VsdHM7CiAgICBlYWNoKG9iaiwgZnVuY3Rpb24odmFsdWUsIGluZGV4LCBsaXN0KSB7CiAgICAgIGlmICghaXRlcmF0b3IuY2FsbChjb250ZXh0LCB2YWx1ZSwgaW5kZXgsIGxpc3QpKSByZXN1bHRzW3Jlc3VsdHMubGVuZ3RoXSA9IHZhbHVlOwogICAgfSk7CiAgICByZXR1cm4gcmVzdWx0czsKICB9OwoKICAvLyBEZXRlcm1pbmUgd2hldGhlciBhbGwgb2YgdGhlIGVsZW1lbnRzIG1hdGNoIGEgdHJ1dGggdGVzdC4KICAvLyBEZWxlZ2F0ZXMgdG8gKipFQ01BU2NyaXB0IDUqKidzIG5hdGl2ZSBgZXZlcnlgIGlmIGF2YWlsYWJsZS4KICAvLyBBbGlhc2VkIGFzIGBhbGxgLgogIF8uZXZlcnkgPSBfLmFsbCA9IGZ1bmN0aW9uKG9iaiwgaXRlcmF0b3IsIGNvbnRleHQpIHsKICAgIHZhciByZXN1bHQgPSB0cnVlOwogICAgaWYgKG9iaiA9PSBudWxsKSByZXR1cm4gcmVzdWx0OwogICAgaWYgKG5hdGl2ZUV2ZXJ5ICYmIG9iai5ldmVyeSA9PT0gbmF0aXZlRXZlcnkpIHJldHVybiBvYmouZXZlcnkoaXRlcmF0b3IsIGNvbnRleHQpOwogICAgZWFjaChvYmosIGZ1bmN0aW9uKHZhbHVlLCBpbmRleCwgbGlzdCkgewogICAgICBpZiAoIShyZXN1bHQgPSByZXN1bHQgJiYgaXRlcmF0b3IuY2FsbChjb250ZXh0LCB2YWx1ZSwgaW5kZXgsIGxpc3QpKSkgcmV0dXJuIGJyZWFrZXI7CiAgICB9KTsKICAgIHJldHVybiByZXN1bHQ7CiAgfTsKCiAgLy8gRGV0ZXJtaW5lIGlmIGF0IGxlYXN0IG9uZSBlbGVtZW50IGluIHRoZSBvYmplY3QgbWF0Y2hlcyBhIHRydXRoIHRlc3QuCiAgLy8gRGVsZWdhdGVzIHRvICoqRUNNQVNjcmlwdCA1KioncyBuYXRpdmUgYHNvbWVgIGlmIGF2YWlsYWJsZS4KICAvLyBBbGlhc2VkIGFzIGBhbnlgLgogIHZhciBhbnkgPSBfLnNvbWUgPSBfLmFueSA9IGZ1bmN0aW9uKG9iaiwgaXRlcmF0b3IsIGNvbnRleHQpIHsKICAgIGl0ZXJhdG9yIHx8IChpdGVyYXRvciA9IF8uaWRlbnRpdHkpOwogICAgdmFyIHJlc3VsdCA9IGZhbHNlOwogICAgaWYgKG9iaiA9PSBudWxsKSByZXR1cm4gcmVzdWx0OwogICAgaWYgKG5hdGl2ZVNvbWUgJiYgb2JqLnNvbWUgPT09IG5hdGl2ZVNvbWUpIHJldHVybiBvYmouc29tZShpdGVyYXRvciwgY29udGV4dCk7CiAgICBlYWNoKG9iaiwgZnVuY3Rpb24odmFsdWUsIGluZGV4LCBsaXN0KSB7CiAgICAgIGlmIChyZXN1bHQgPSBpdGVyYXRvci5jYWxsKGNvbnRleHQsIHZhbHVlLCBpbmRleCwgbGlzdCkpIHJldHVybiBicmVha2VyOwogICAgfSk7CiAgICByZXR1cm4gcmVzdWx0OwogIH07CgogIC8vIERldGVybWluZSBpZiBhIGdpdmVuIHZhbHVlIGlzIGluY2x1ZGVkIGluIHRoZSBhcnJheSBvciBvYmplY3QgdXNpbmcgYD09PWAuCiAgLy8gQWxpYXNlZCBhcyBgY29udGFpbnNgLgogIF8uaW5jbHVkZSA9IF8uY29udGFpbnMgPSBmdW5jdGlvbihvYmosIHRhcmdldCkgewogICAgdmFyIGZvdW5kID0gZmFsc2U7CiAgICBpZiAob2JqID09IG51bGwpIHJldHVybiBmb3VuZDsKICAgIGlmIChuYXRpdmVJbmRleE9mICYmIG9iai5pbmRleE9mID09PSBuYXRpdmVJbmRleE9mKSByZXR1cm4gb2JqLmluZGV4T2YodGFyZ2V0KSAhPSAtMTsKICAgIGFueShvYmosIGZ1bmN0aW9uKHZhbHVlKSB7CiAgICAgIGlmIChmb3VuZCA9IHZhbHVlID09PSB0YXJnZXQpIHJldHVybiB0cnVlOwogICAgfSk7CiAgICByZXR1cm4gZm91bmQ7CiAgfTsKCiAgLy8gSW52b2tlIGEgbWV0aG9kICh3aXRoIGFyZ3VtZW50cykgb24gZXZlcnkgaXRlbSBpbiBhIGNvbGxlY3Rpb24uCiAgXy5pbnZva2UgPSBmdW5jdGlvbihvYmosIG1ldGhvZCkgewogICAgdmFyIGFyZ3MgPSBzbGljZS5jYWxsKGFyZ3VtZW50cywgMik7CiAgICByZXR1cm4gXy5tYXAob2JqLCBmdW5jdGlvbih2YWx1ZSkgewogICAgICByZXR1cm4gKG1ldGhvZC5jYWxsID8gbWV0aG9kIHx8IHZhbHVlIDogdmFsdWVbbWV0aG9kXSkuYXBwbHkodmFsdWUsIGFyZ3MpOwogICAgfSk7CiAgfTsKCiAgLy8gQ29udmVuaWVuY2UgdmVyc2lvbiBvZiBhIGNvbW1vbiB1c2UgY2FzZSBvZiBgbWFwYDogZmV0Y2hpbmcgYSBwcm9wZXJ0eS4KICBfLnBsdWNrID0gZnVuY3Rpb24ob2JqLCBrZXkpIHsKICAgIHJldHVybiBfLm1hcChvYmosIGZ1bmN0aW9uKHZhbHVlKXsgcmV0dXJuIHZhbHVlW2tleV07IH0pOwogIH07CgogIC8vIFJldHVybiB0aGUgbWF4aW11bSBlbGVtZW50IG9yIChlbGVtZW50LWJhc2VkIGNvbXB1dGF0aW9uKS4KICBfLm1heCA9IGZ1bmN0aW9uKG9iaiwgaXRlcmF0b3IsIGNvbnRleHQpIHsKICAgIGlmICghaXRlcmF0b3IgJiYgXy5pc0FycmF5KG9iaikpIHJldHVybiBNYXRoLm1heC5hcHBseShNYXRoLCBvYmopOwogICAgdmFyIHJlc3VsdCA9IHtjb21wdXRlZCA6IC1JbmZpbml0eX07CiAgICBlYWNoKG9iaiwgZnVuY3Rpb24odmFsdWUsIGluZGV4LCBsaXN0KSB7CiAgICAgIHZhciBjb21wdXRlZCA9IGl0ZXJhdG9yID8gaXRlcmF0b3IuY2FsbChjb250ZXh0LCB2YWx1ZSwgaW5kZXgsIGxpc3QpIDogdmFsdWU7CiAgICAgIGNvbXB1dGVkID49IHJlc3VsdC5jb21wdXRlZCAmJiAocmVzdWx0ID0ge3ZhbHVlIDogdmFsdWUsIGNvbXB1dGVkIDogY29tcHV0ZWR9KTsKICAgIH0pOwogICAgcmV0dXJuIHJlc3VsdC52YWx1ZTsKICB9OwoKICAvLyBSZXR1cm4gdGhlIG1pbmltdW0gZWxlbWVudCAob3IgZWxlbWVudC1iYXNlZCBjb21wdXRhdGlvbikuCiAgXy5taW4gPSBmdW5jdGlvbihvYmosIGl0ZXJhdG9yLCBjb250ZXh0KSB7CiAgICBpZiAoIWl0ZXJhdG9yICYmIF8uaXNBcnJheShvYmopKSByZXR1cm4gTWF0aC5taW4uYXBwbHkoTWF0aCwgb2JqKTsKICAgIHZhciByZXN1bHQgPSB7Y29tcHV0ZWQgOiBJbmZpbml0eX07CiAgICBlYWNoKG9iaiwgZnVuY3Rpb24odmFsdWUsIGluZGV4LCBsaXN0KSB7CiAgICAgIHZhciBjb21wdXRlZCA9IGl0ZXJhdG9yID8gaXRlcmF0b3IuY2FsbChjb250ZXh0LCB2YWx1ZSwgaW5kZXgsIGxpc3QpIDogdmFsdWU7CiAgICAgIGNvbXB1dGVkIDwgcmVzdWx0LmNvbXB1dGVkICYmIChyZXN1bHQgPSB7dmFsdWUgOiB2YWx1ZSwgY29tcHV0ZWQgOiBjb21wdXRlZH0pOwogICAgfSk7CiAgICByZXR1cm4gcmVzdWx0LnZhbHVlOwogIH07CgogIC8vIFNvcnQgdGhlIG9iamVjdCdzIHZhbHVlcyBieSBhIGNyaXRlcmlvbiBwcm9kdWNlZCBieSBhbiBpdGVyYXRvci4KICBfLnNvcnRCeSA9IGZ1bmN0aW9uKG9iaiwgaXRlcmF0b3IsIGNvbnRleHQpIHsKICAgIHJldHVybiBfLnBsdWNrKF8ubWFwKG9iaiwgZnVuY3Rpb24odmFsdWUsIGluZGV4LCBsaXN0KSB7CiAgICAgIHJldHVybiB7CiAgICAgICAgdmFsdWUgOiB2YWx1ZSwKICAgICAgICBjcml0ZXJpYSA6IGl0ZXJhdG9yLmNhbGwoY29udGV4dCwgdmFsdWUsIGluZGV4LCBsaXN0KQogICAgICB9OwogICAgfSkuc29ydChmdW5jdGlvbihsZWZ0LCByaWdodCkgewogICAgICB2YXIgYSA9IGxlZnQuY3JpdGVyaWEsIGIgPSByaWdodC5jcml0ZXJpYTsKICAgICAgcmV0dXJuIGEgPCBiID8gLTEgOiBhID4gYiA/IDEgOiAwOwogICAgfSksICd2YWx1ZScpOwogIH07CgogIC8vIFVzZSBhIGNvbXBhcmF0b3IgZnVuY3Rpb24gdG8gZmlndXJlIG91dCBhdCB3aGF0IGluZGV4IGFuIG9iamVjdCBzaG91bGQKICAvLyBiZSBpbnNlcnRlZCBzbyBhcyB0byBtYWludGFpbiBvcmRlci4gVXNlcyBiaW5hcnkgc2VhcmNoLgogIF8uc29ydGVkSW5kZXggPSBmdW5jdGlvbihhcnJheSwgb2JqLCBpdGVyYXRvcikgewogICAgaXRlcmF0b3IgfHwgKGl0ZXJhdG9yID0gXy5pZGVudGl0eSk7CiAgICB2YXIgbG93ID0gMCwgaGlnaCA9IGFycmF5Lmxlbmd0aDsKICAgIHdoaWxlIChsb3cgPCBoaWdoKSB7CiAgICAgIHZhciBtaWQgPSAobG93ICsgaGlnaCkgPj4gMTsKICAgICAgaXRlcmF0b3IoYXJyYXlbbWlkXSkgPCBpdGVyYXRvcihvYmopID8gbG93ID0gbWlkICsgMSA6IGhpZ2ggPSBtaWQ7CiAgICB9CiAgICByZXR1cm4gbG93OwogIH07CgogIC8vIFNhZmVseSBjb252ZXJ0IGFueXRoaW5nIGl0ZXJhYmxlIGludG8gYSByZWFsLCBsaXZlIGFycmF5LgogIF8udG9BcnJheSA9IGZ1bmN0aW9uKGl0ZXJhYmxlKSB7CiAgICBpZiAoIWl0ZXJhYmxlKSAgICAgICAgICAgICAgICByZXR1cm4gW107CiAgICBpZiAoaXRlcmFibGUudG9BcnJheSkgICAgICAgICByZXR1cm4gaXRlcmFibGUudG9BcnJheSgpOwogICAgaWYgKF8uaXNBcnJheShpdGVyYWJsZSkpICAgICAgcmV0dXJuIGl0ZXJhYmxlOwogICAgaWYgKF8uaXNBcmd1bWVudHMoaXRlcmFibGUpKSAgcmV0dXJuIHNsaWNlLmNhbGwoaXRlcmFibGUpOwogICAgcmV0dXJuIF8udmFsdWVzKGl0ZXJhYmxlKTsKICB9OwoKICAvLyBSZXR1cm4gdGhlIG51bWJlciBvZiBlbGVtZW50cyBpbiBhbiBvYmplY3QuCiAgXy5zaXplID0gZnVuY3Rpb24ob2JqKSB7CiAgICByZXR1cm4gXy50b0FycmF5KG9iaikubGVuZ3RoOwogIH07CgogIC8vIEFycmF5IEZ1bmN0aW9ucwogIC8vIC0tLS0tLS0tLS0tLS0tLQoKICAvLyBHZXQgdGhlIGZpcnN0IGVsZW1lbnQgb2YgYW4gYXJyYXkuIFBhc3NpbmcgKipuKiogd2lsbCByZXR1cm4gdGhlIGZpcnN0IE4KICAvLyB2YWx1ZXMgaW4gdGhlIGFycmF5LiBBbGlhc2VkIGFzIGBoZWFkYC4gVGhlICoqZ3VhcmQqKiBjaGVjayBhbGxvd3MgaXQgdG8gd29yawogIC8vIHdpdGggYF8ubWFwYC4KICBfLmZpcnN0ID0gXy5oZWFkID0gZnVuY3Rpb24oYXJyYXksIG4sIGd1YXJkKSB7CiAgICByZXR1cm4gKG4gIT0gbnVsbCkgJiYgIWd1YXJkID8gc2xpY2UuY2FsbChhcnJheSwgMCwgbikgOiBhcnJheVswXTsKICB9OwoKICAvLyBSZXR1cm5zIGV2ZXJ5dGhpbmcgYnV0IHRoZSBmaXJzdCBlbnRyeSBvZiB0aGUgYXJyYXkuIEFsaWFzZWQgYXMgYHRhaWxgLgogIC8vIEVzcGVjaWFsbHkgdXNlZnVsIG9uIHRoZSBhcmd1bWVudHMgb2JqZWN0LiBQYXNzaW5nIGFuICoqaW5kZXgqKiB3aWxsIHJldHVybgogIC8vIHRoZSByZXN0IG9mIHRoZSB2YWx1ZXMgaW4gdGhlIGFycmF5IGZyb20gdGhhdCBpbmRleCBvbndhcmQuIFRoZSAqKmd1YXJkKioKICAvLyBjaGVjayBhbGxvd3MgaXQgdG8gd29yayB3aXRoIGBfLm1hcGAuCiAgXy5yZXN0ID0gXy50YWlsID0gZnVuY3Rpb24oYXJyYXksIGluZGV4LCBndWFyZCkgewogICAgcmV0dXJuIHNsaWNlLmNhbGwoYXJyYXksIChpbmRleCA9PSBudWxsKSB8fCBndWFyZCA/IDEgOiBpbmRleCk7CiAgfTsKCiAgLy8gR2V0IHRoZSBsYXN0IGVsZW1lbnQgb2YgYW4gYXJyYXkuCiAgXy5sYXN0ID0gZnVuY3Rpb24oYXJyYXkpIHsKICAgIHJldHVybiBhcnJheVthcnJheS5sZW5ndGggLSAxXTsKICB9OwoKICAvLyBUcmltIG91dCBhbGwgZmFsc3kgdmFsdWVzIGZyb20gYW4gYXJyYXkuCiAgXy5jb21wYWN0ID0gZnVuY3Rpb24oYXJyYXkpIHsKICAgIHJldHVybiBfLmZpbHRlcihhcnJheSwgZnVuY3Rpb24odmFsdWUpeyByZXR1cm4gISF2YWx1ZTsgfSk7CiAgfTsKCiAgLy8gUmV0dXJuIGEgY29tcGxldGVseSBmbGF0dGVuZWQgdmVyc2lvbiBvZiBhbiBhcnJheS4KICBfLmZsYXR0ZW4gPSBmdW5jdGlvbihhcnJheSkgewogICAgcmV0dXJuIF8ucmVkdWNlKGFycmF5LCBmdW5jdGlvbihtZW1vLCB2YWx1ZSkgewogICAgICBpZiAoXy5pc0FycmF5KHZhbHVlKSkgcmV0dXJuIG1lbW8uY29uY2F0KF8uZmxhdHRlbih2YWx1ZSkpOwogICAgICBtZW1vW21lbW8ubGVuZ3RoXSA9IHZhbHVlOwogICAgICByZXR1cm4gbWVtbzsKICAgIH0sIFtdKTsKICB9OwoKICAvLyBSZXR1cm4gYSB2ZXJzaW9uIG9mIHRoZSBhcnJheSB0aGF0IGRvZXMgbm90IGNvbnRhaW4gdGhlIHNwZWNpZmllZCB2YWx1ZShzKS4KICBfLndpdGhvdXQgPSBmdW5jdGlvbihhcnJheSkgewogICAgdmFyIHZhbHVlcyA9IHNsaWNlLmNhbGwoYXJndW1lbnRzLCAxKTsKICAgIHJldHVybiBfLmZpbHRlcihhcnJheSwgZnVuY3Rpb24odmFsdWUpeyByZXR1cm4gIV8uaW5jbHVkZSh2YWx1ZXMsIHZhbHVlKTsgfSk7CiAgfTsKCiAgLy8gUHJvZHVjZSBhIGR1cGxpY2F0ZS1mcmVlIHZlcnNpb24gb2YgdGhlIGFycmF5LiBJZiB0aGUgYXJyYXkgaGFzIGFscmVhZHkKICAvLyBiZWVuIHNvcnRlZCwgeW91IGhhdmUgdGhlIG9wdGlvbiBvZiB1c2luZyBhIGZhc3RlciBhbGdvcml0aG0uCiAgLy8gQWxpYXNlZCBhcyBgdW5pcXVlYC4KICBfLnVuaXEgPSBfLnVuaXF1ZSA9IGZ1bmN0aW9uKGFycmF5LCBpc1NvcnRlZCkgewogICAgcmV0dXJuIF8ucmVkdWNlKGFycmF5LCBmdW5jdGlvbihtZW1vLCBlbCwgaSkgewogICAgICBpZiAoMCA9PSBpIHx8IChpc1NvcnRlZCA9PT0gdHJ1ZSA/IF8ubGFzdChtZW1vKSAhPSBlbCA6ICFfLmluY2x1ZGUobWVtbywgZWwpKSkgbWVtb1ttZW1vLmxlbmd0aF0gPSBlbDsKICAgICAgcmV0dXJuIG1lbW87CiAgICB9LCBbXSk7CiAgfTsKCiAgLy8gUHJvZHVjZSBhbiBhcnJheSB0aGF0IGNvbnRhaW5zIGV2ZXJ5IGl0ZW0gc2hhcmVkIGJldHdlZW4gYWxsIHRoZQogIC8vIHBhc3NlZC1pbiBhcnJheXMuCiAgXy5pbnRlcnNlY3QgPSBmdW5jdGlvbihhcnJheSkgewogICAgdmFyIHJlc3QgPSBzbGljZS5jYWxsKGFyZ3VtZW50cywgMSk7CiAgICByZXR1cm4gXy5maWx0ZXIoXy51bmlxKGFycmF5KSwgZnVuY3Rpb24oaXRlbSkgewogICAgICByZXR1cm4gXy5ldmVyeShyZXN0LCBmdW5jdGlvbihvdGhlcikgewogICAgICAgIHJldHVybiBfLmluZGV4T2Yob3RoZXIsIGl0ZW0pID49IDA7CiAgICAgIH0pOwogICAgfSk7CiAgfTsKCiAgLy8gWmlwIHRvZ2V0aGVyIG11bHRpcGxlIGxpc3RzIGludG8gYSBzaW5nbGUgYXJyYXkgLS0gZWxlbWVudHMgdGhhdCBzaGFyZQogIC8vIGFuIGluZGV4IGdvIHRvZ2V0aGVyLgogIF8uemlwID0gZnVuY3Rpb24oKSB7CiAgICB2YXIgYXJncyA9IHNsaWNlLmNhbGwoYXJndW1lbnRzKTsKICAgIHZhciBsZW5ndGggPSBfLm1heChfLnBsdWNrKGFyZ3MsICdsZW5ndGgnKSk7CiAgICB2YXIgcmVzdWx0cyA9IG5ldyBBcnJheShsZW5ndGgpOwogICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykgcmVzdWx0c1tpXSA9IF8ucGx1Y2soYXJncywgIiIgKyBpKTsKICAgIHJldHVybiByZXN1bHRzOwogIH07CgogIC8vIElmIHRoZSBicm93c2VyIGRvZXNuJ3Qgc3VwcGx5IHVzIHdpdGggaW5kZXhPZiAoSSdtIGxvb2tpbmcgYXQgeW91LCAqKk1TSUUqKiksCiAgLy8gd2UgbmVlZCB0aGlzIGZ1bmN0aW9uLiBSZXR1cm4gdGhlIHBvc2l0aW9uIG9mIHRoZSBmaXJzdCBvY2N1cnJlbmNlIG9mIGFuCiAgLy8gaXRlbSBpbiBhbiBhcnJheSwgb3IgLTEgaWYgdGhlIGl0ZW0gaXMgbm90IGluY2x1ZGVkIGluIHRoZSBhcnJheS4KICAvLyBEZWxlZ2F0ZXMgdG8gKipFQ01BU2NyaXB0IDUqKidzIG5hdGl2ZSBgaW5kZXhPZmAgaWYgYXZhaWxhYmxlLgogIC8vIElmIHRoZSBhcnJheSBpcyBsYXJnZSBhbmQgYWxyZWFkeSBpbiBzb3J0IG9yZGVyLCBwYXNzIGB0cnVlYAogIC8vIGZvciAqKmlzU29ydGVkKiogdG8gdXNlIGJpbmFyeSBzZWFyY2guCiAgXy5pbmRleE9mID0gZnVuY3Rpb24oYXJyYXksIGl0ZW0sIGlzU29ydGVkKSB7CiAgICBpZiAoYXJyYXkgPT0gbnVsbCkgcmV0dXJuIC0xOwogICAgdmFyIGksIGw7CiAgICBpZiAoaXNTb3J0ZWQpIHsKICAgICAgaSA9IF8uc29ydGVkSW5kZXgoYXJyYXksIGl0ZW0pOwogICAgICByZXR1cm4gYXJyYXlbaV0gPT09IGl0ZW0gPyBpIDogLTE7CiAgICB9CiAgICBpZiAobmF0aXZlSW5kZXhPZiAmJiBhcnJheS5pbmRleE9mID09PSBuYXRpdmVJbmRleE9mKSByZXR1cm4gYXJyYXkuaW5kZXhPZihpdGVtKTsKICAgIGZvciAoaSA9IDAsIGwgPSBhcnJheS5sZW5ndGg7IGkgPCBsOyBpKyspIGlmIChhcnJheVtpXSA9PT0gaXRlbSkgcmV0dXJuIGk7CiAgICByZXR1cm4gLTE7CiAgfTsKCgogIC8vIERlbGVnYXRlcyB0byAqKkVDTUFTY3JpcHQgNSoqJ3MgbmF0aXZlIGBsYXN0SW5kZXhPZmAgaWYgYXZhaWxhYmxlLgogIF8ubGFzdEluZGV4T2YgPSBmdW5jdGlvbihhcnJheSwgaXRlbSkgewogICAgaWYgKGFycmF5ID09IG51bGwpIHJldHVybiAtMTsKICAgIGlmIChuYXRpdmVMYXN0SW5kZXhPZiAmJiBhcnJheS5sYXN0SW5kZXhPZiA9PT0gbmF0aXZlTGFzdEluZGV4T2YpIHJldHVybiBhcnJheS5sYXN0SW5kZXhPZihpdGVtKTsKICAgIHZhciBpID0gYXJyYXkubGVuZ3RoOwogICAgd2hpbGUgKGktLSkgaWYgKGFycmF5W2ldID09PSBpdGVtKSByZXR1cm4gaTsKICAgIHJldHVybiAtMTsKICB9OwoKICAvLyBHZW5lcmF0ZSBhbiBpbnRlZ2VyIEFycmF5IGNvbnRhaW5pbmcgYW4gYXJpdGhtZXRpYyBwcm9ncmVzc2lvbi4gQSBwb3J0IG9mCiAgLy8gdGhlIG5hdGl2ZSBQeXRob24gYHJhbmdlKClgIGZ1bmN0aW9uLiBTZWUKICAvLyBbdGhlIFB5dGhvbiBkb2N1bWVudGF0aW9uXShodHRwOi8vZG9jcy5weXRob24ub3JnL2xpYnJhcnkvZnVuY3Rpb25zLmh0bWwjcmFuZ2UpLgogIF8ucmFuZ2UgPSBmdW5jdGlvbihzdGFydCwgc3RvcCwgc3RlcCkgewogICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPD0gMSkgewogICAgICBzdG9wID0gc3RhcnQgfHwgMDsKICAgICAgc3RhcnQgPSAwOwogICAgfQogICAgc3RlcCA9IGFyZ3VtZW50c1syXSB8fCAxOwoKICAgIHZhciBsZW4gPSBNYXRoLm1heChNYXRoLmNlaWwoKHN0b3AgLSBzdGFydCkgLyBzdGVwKSwgMCk7CiAgICB2YXIgaWR4ID0gMDsKICAgIHZhciByYW5nZSA9IG5ldyBBcnJheShsZW4pOwoKICAgIHdoaWxlKGlkeCA8IGxlbikgewogICAgICByYW5nZVtpZHgrK10gPSBzdGFydDsKICAgICAgc3RhcnQgKz0gc3RlcDsKICAgIH0KCiAgICByZXR1cm4gcmFuZ2U7CiAgfTsKCiAgLy8gRnVuY3Rpb24gKGFoZW0pIEZ1bmN0aW9ucwogIC8vIC0tLS0tLS0tLS0tLS0tLS0tLQoKICAvLyBDcmVhdGUgYSBmdW5jdGlvbiBib3VuZCB0byBhIGdpdmVuIG9iamVjdCAoYXNzaWduaW5nIGB0aGlzYCwgYW5kIGFyZ3VtZW50cywKICAvLyBvcHRpb25hbGx5KS4gQmluZGluZyB3aXRoIGFyZ3VtZW50cyBpcyBhbHNvIGtub3duIGFzIGBjdXJyeWAuCiAgLy8gRGVsZWdhdGVzIHRvICoqRUNNQVNjcmlwdCA1KioncyBuYXRpdmUgYEZ1bmN0aW9uLmJpbmRgIGlmIGF2YWlsYWJsZS4KICAvLyBXZSBjaGVjayBmb3IgYGZ1bmMuYmluZGAgZmlyc3QsIHRvIGZhaWwgZmFzdCB3aGVuIGBmdW5jYCBpcyB1bmRlZmluZWQuCiAgXy5iaW5kID0gZnVuY3Rpb24oZnVuYywgb2JqKSB7CiAgICBpZiAoZnVuYy5iaW5kID09PSBuYXRpdmVCaW5kICYmIG5hdGl2ZUJpbmQpIHJldHVybiBuYXRpdmVCaW5kLmFwcGx5KGZ1bmMsIHNsaWNlLmNhbGwoYXJndW1lbnRzLCAxKSk7CiAgICB2YXIgYXJncyA9IHNsaWNlLmNhbGwoYXJndW1lbnRzLCAyKTsKICAgIHJldHVybiBmdW5jdGlvbigpIHsKICAgICAgcmV0dXJuIGZ1bmMuYXBwbHkob2JqLCBhcmdzLmNvbmNhdChzbGljZS5jYWxsKGFyZ3VtZW50cykpKTsKICAgIH07CiAgfTsKCiAgLy8gQmluZCBhbGwgb2YgYW4gb2JqZWN0J3MgbWV0aG9kcyB0byB0aGF0IG9iamVjdC4gVXNlZnVsIGZvciBlbnN1cmluZyB0aGF0CiAgLy8gYWxsIGNhbGxiYWNrcyBkZWZpbmVkIG9uIGFuIG9iamVjdCBiZWxvbmcgdG8gaXQuCiAgXy5iaW5kQWxsID0gZnVuY3Rpb24ob2JqKSB7CiAgICB2YXIgZnVuY3MgPSBzbGljZS5jYWxsKGFyZ3VtZW50cywgMSk7CiAgICBpZiAoZnVuY3MubGVuZ3RoID09IDApIGZ1bmNzID0gXy5mdW5jdGlvbnMob2JqKTsKICAgIGVhY2goZnVuY3MsIGZ1bmN0aW9uKGYpIHsgb2JqW2ZdID0gXy5iaW5kKG9ialtmXSwgb2JqKTsgfSk7CiAgICByZXR1cm4gb2JqOwogIH07CgogIC8vIE1lbW9pemUgYW4gZXhwZW5zaXZlIGZ1bmN0aW9uIGJ5IHN0b3JpbmcgaXRzIHJlc3VsdHMuCiAgXy5tZW1vaXplID0gZnVuY3Rpb24oZnVuYywgaGFzaGVyKSB7CiAgICB2YXIgbWVtbyA9IHt9OwogICAgaGFzaGVyIHx8IChoYXNoZXIgPSBfLmlkZW50aXR5KTsKICAgIHJldHVybiBmdW5jdGlvbigpIHsKICAgICAgdmFyIGtleSA9IGhhc2hlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICByZXR1cm4gaGFzT3duUHJvcGVydHkuY2FsbChtZW1vLCBrZXkpID8gbWVtb1trZXldIDogKG1lbW9ba2V5XSA9IGZ1bmMuYXBwbHkodGhpcywgYXJndW1lbnRzKSk7CiAgICB9OwogIH07CgogIC8vIERlbGF5cyBhIGZ1bmN0aW9uIGZvciB0aGUgZ2l2ZW4gbnVtYmVyIG9mIG1pbGxpc2Vjb25kcywgYW5kIHRoZW4gY2FsbHMKICAvLyBpdCB3aXRoIHRoZSBhcmd1bWVudHMgc3VwcGxpZWQuCiAgXy5kZWxheSA9IGZ1bmN0aW9uKGZ1bmMsIHdhaXQpIHsKICAgIHZhciBhcmdzID0gc2xpY2UuY2FsbChhcmd1bWVudHMsIDIpOwogICAgcmV0dXJuIHNldFRpbWVvdXQoZnVuY3Rpb24oKXsgcmV0dXJuIGZ1bmMuYXBwbHkoZnVuYywgYXJncyk7IH0sIHdhaXQpOwogIH07CgogIC8vIERlZmVycyBhIGZ1bmN0aW9uLCBzY2hlZHVsaW5nIGl0IHRvIHJ1biBhZnRlciB0aGUgY3VycmVudCBjYWxsIHN0YWNrIGhhcwogIC8vIGNsZWFyZWQuCiAgXy5kZWZlciA9IGZ1bmN0aW9uKGZ1bmMpIHsKICAgIHJldHVybiBfLmRlbGF5LmFwcGx5KF8sIFtmdW5jLCAxXS5jb25jYXQoc2xpY2UuY2FsbChhcmd1bWVudHMsIDEpKSk7CiAgfTsKCiAgLy8gSW50ZXJuYWwgZnVuY3Rpb24gdXNlZCB0byBpbXBsZW1lbnQgYF8udGhyb3R0bGVgIGFuZCBgXy5kZWJvdW5jZWAuCiAgdmFyIGxpbWl0ID0gZnVuY3Rpb24oZnVuYywgd2FpdCwgZGVib3VuY2UpIHsKICAgIHZhciB0aW1lb3V0OwogICAgcmV0dXJuIGZ1bmN0aW9uKCkgewogICAgICB2YXIgY29udGV4dCA9IHRoaXMsIGFyZ3MgPSBhcmd1bWVudHM7CiAgICAgIHZhciB0aHJvdHRsZXIgPSBmdW5jdGlvbigpIHsKICAgICAgICB0aW1lb3V0ID0gbnVsbDsKICAgICAgICBmdW5jLmFwcGx5KGNvbnRleHQsIGFyZ3MpOwogICAgICB9OwogICAgICBpZiAoZGVib3VuY2UpIGNsZWFyVGltZW91dCh0aW1lb3V0KTsKICAgICAgaWYgKGRlYm91bmNlIHx8ICF0aW1lb3V0KSB0aW1lb3V0ID0gc2V0VGltZW91dCh0aHJvdHRsZXIsIHdhaXQpOwogICAgfTsKICB9OwoKICAvLyBSZXR1cm5zIGEgZnVuY3Rpb24sIHRoYXQsIHdoZW4gaW52b2tlZCwgd2lsbCBvbmx5IGJlIHRyaWdnZXJlZCBhdCBtb3N0IG9uY2UKICAvLyBkdXJpbmcgYSBnaXZlbiB3aW5kb3cgb2YgdGltZS4KICBfLnRocm90dGxlID0gZnVuY3Rpb24oZnVuYywgd2FpdCkgewogICAgcmV0dXJuIGxpbWl0KGZ1bmMsIHdhaXQsIGZhbHNlKTsKICB9OwoKICAvLyBSZXR1cm5zIGEgZnVuY3Rpb24sIHRoYXQsIGFzIGxvbmcgYXMgaXQgY29udGludWVzIHRvIGJlIGludm9rZWQsIHdpbGwgbm90CiAgLy8gYmUgdHJpZ2dlcmVkLiBUaGUgZnVuY3Rpb24gd2lsbCBiZSBjYWxsZWQgYWZ0ZXIgaXQgc3RvcHMgYmVpbmcgY2FsbGVkIGZvcgogIC8vIE4gbWlsbGlzZWNvbmRzLgogIF8uZGVib3VuY2UgPSBmdW5jdGlvbihmdW5jLCB3YWl0KSB7CiAgICByZXR1cm4gbGltaXQoZnVuYywgd2FpdCwgdHJ1ZSk7CiAgfTsKCiAgLy8gUmV0dXJucyBhIGZ1bmN0aW9uIHRoYXQgd2lsbCBiZSBleGVjdXRlZCBhdCBtb3N0IG9uZSB0aW1lLCBubyBtYXR0ZXIgaG93CiAgLy8gb2Z0ZW4geW91IGNhbGwgaXQuIFVzZWZ1bCBmb3IgbGF6eSBpbml0aWFsaXphdGlvbi4KICBfLm9uY2UgPSBmdW5jdGlvbihmdW5jKSB7CiAgICB2YXIgcmFuID0gZmFsc2UsIG1lbW87CiAgICByZXR1cm4gZnVuY3Rpb24oKSB7CiAgICAgIGlmIChyYW4pIHJldHVybiBtZW1vOwogICAgICByYW4gPSB0cnVlOwogICAgICByZXR1cm4gbWVtbyA9IGZ1bmMuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgIH07CiAgfTsKCiAgLy8gUmV0dXJucyB0aGUgZmlyc3QgZnVuY3Rpb24gcGFzc2VkIGFzIGFuIGFyZ3VtZW50IHRvIHRoZSBzZWNvbmQsCiAgLy8gYWxsb3dpbmcgeW91IHRvIGFkanVzdCBhcmd1bWVudHMsIHJ1biBjb2RlIGJlZm9yZSBhbmQgYWZ0ZXIsIGFuZAogIC8vIGNvbmRpdGlvbmFsbHkgZXhlY3V0ZSB0aGUgb3JpZ2luYWwgZnVuY3Rpb24uCiAgXy53cmFwID0gZnVuY3Rpb24oZnVuYywgd3JhcHBlcikgewogICAgcmV0dXJuIGZ1bmN0aW9uKCkgewogICAgICB2YXIgYXJncyA9IFtmdW5jXS5jb25jYXQoc2xpY2UuY2FsbChhcmd1bWVudHMpKTsKICAgICAgcmV0dXJuIHdyYXBwZXIuYXBwbHkodGhpcywgYXJncyk7CiAgICB9OwogIH07CgogIC8vIFJldHVybnMgYSBmdW5jdGlvbiB0aGF0IGlzIHRoZSBjb21wb3NpdGlvbiBvZiBhIGxpc3Qgb2YgZnVuY3Rpb25zLCBlYWNoCiAgLy8gY29uc3VtaW5nIHRoZSByZXR1cm4gdmFsdWUgb2YgdGhlIGZ1bmN0aW9uIHRoYXQgZm9sbG93cy4KICBfLmNvbXBvc2UgPSBmdW5jdGlvbigpIHsKICAgIHZhciBmdW5jcyA9IHNsaWNlLmNhbGwoYXJndW1lbnRzKTsKICAgIHJldHVybiBmdW5jdGlvbigpIHsKICAgICAgdmFyIGFyZ3MgPSBzbGljZS5jYWxsKGFyZ3VtZW50cyk7CiAgICAgIGZvciAodmFyIGk9ZnVuY3MubGVuZ3RoLTE7IGkgPj0gMDsgaS0tKSB7CiAgICAgICAgYXJncyA9IFtmdW5jc1tpXS5hcHBseSh0aGlzLCBhcmdzKV07CiAgICAgIH0KICAgICAgcmV0dXJuIGFyZ3NbMF07CiAgICB9OwogIH07CgogIC8vIFJldHVybnMgYSBmdW5jdGlvbiB0aGF0IHdpbGwgb25seSBiZSBleGVjdXRlZCBhZnRlciBiZWluZyBjYWxsZWQgTiB0aW1lcy4KICBfLmFmdGVyID0gZnVuY3Rpb24odGltZXMsIGZ1bmMpIHsKICAgIHJldHVybiBmdW5jdGlvbigpIHsKICAgICAgaWYgKC0tdGltZXMgPCAxKSB7IHJldHVybiBmdW5jLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7IH0KICAgIH07CiAgfTsKCgogIC8vIE9iamVjdCBGdW5jdGlvbnMKICAvLyAtLS0tLS0tLS0tLS0tLS0tCgogIC8vIFJldHJpZXZlIHRoZSBuYW1lcyBvZiBhbiBvYmplY3QncyBwcm9wZXJ0aWVzLgogIC8vIERlbGVnYXRlcyB0byAqKkVDTUFTY3JpcHQgNSoqJ3MgbmF0aXZlIGBPYmplY3Qua2V5c2AKICBfLmtleXMgPSBuYXRpdmVLZXlzIHx8IGZ1bmN0aW9uKG9iaikgewogICAgaWYgKG9iaiAhPT0gT2JqZWN0KG9iaikpIHRocm93IG5ldyBUeXBlRXJyb3IoJ0ludmFsaWQgb2JqZWN0Jyk7CiAgICB2YXIga2V5cyA9IFtdOwogICAgZm9yICh2YXIga2V5IGluIG9iaikgaWYgKGhhc093blByb3BlcnR5LmNhbGwob2JqLCBrZXkpKSBrZXlzW2tleXMubGVuZ3RoXSA9IGtleTsKICAgIHJldHVybiBrZXlzOwogIH07CgogIC8vIFJldHJpZXZlIHRoZSB2YWx1ZXMgb2YgYW4gb2JqZWN0J3MgcHJvcGVydGllcy4KICBfLnZhbHVlcyA9IGZ1bmN0aW9uKG9iaikgewogICAgcmV0dXJuIF8ubWFwKG9iaiwgXy5pZGVudGl0eSk7CiAgfTsKCiAgLy8gUmV0dXJuIGEgc29ydGVkIGxpc3Qgb2YgdGhlIGZ1bmN0aW9uIG5hbWVzIGF2YWlsYWJsZSBvbiB0aGUgb2JqZWN0LgogIC8vIEFsaWFzZWQgYXMgYG1ldGhvZHNgCiAgXy5mdW5jdGlvbnMgPSBfLm1ldGhvZHMgPSBmdW5jdGlvbihvYmopIHsKICAgIHJldHVybiBfLmZpbHRlcihfLmtleXMob2JqKSwgZnVuY3Rpb24oa2V5KXsgcmV0dXJuIF8uaXNGdW5jdGlvbihvYmpba2V5XSk7IH0pLnNvcnQoKTsKICB9OwoKICAvLyBFeHRlbmQgYSBnaXZlbiBvYmplY3Qgd2l0aCBhbGwgdGhlIHByb3BlcnRpZXMgaW4gcGFzc2VkLWluIG9iamVjdChzKS4KICBfLmV4dGVuZCA9IGZ1bmN0aW9uKG9iaikgewogICAgZWFjaChzbGljZS5jYWxsKGFyZ3VtZW50cywgMSksIGZ1bmN0aW9uKHNvdXJjZSkgewogICAgICBmb3IgKHZhciBwcm9wIGluIHNvdXJjZSkgewogICAgICAgIGlmIChzb3VyY2VbcHJvcF0gIT09IHZvaWQgMCkgb2JqW3Byb3BdID0gc291cmNlW3Byb3BdOwogICAgICB9CiAgICB9KTsKICAgIHJldHVybiBvYmo7CiAgfTsKCiAgLy8gRmlsbCBpbiBhIGdpdmVuIG9iamVjdCB3aXRoIGRlZmF1bHQgcHJvcGVydGllcy4KICBfLmRlZmF1bHRzID0gZnVuY3Rpb24ob2JqKSB7CiAgICBlYWNoKHNsaWNlLmNhbGwoYXJndW1lbnRzLCAxKSwgZnVuY3Rpb24oc291cmNlKSB7CiAgICAgIGZvciAodmFyIHByb3AgaW4gc291cmNlKSB7CiAgICAgICAgaWYgKG9ialtwcm9wXSA9PSBudWxsKSBvYmpbcHJvcF0gPSBzb3VyY2VbcHJvcF07CiAgICAgIH0KICAgIH0pOwogICAgcmV0dXJuIG9iajsKICB9OwoKICAvLyBDcmVhdGUgYSAoc2hhbGxvdy1jbG9uZWQpIGR1cGxpY2F0ZSBvZiBhbiBvYmplY3QuCiAgXy5jbG9uZSA9IGZ1bmN0aW9uKG9iaikgewogICAgcmV0dXJuIF8uaXNBcnJheShvYmopID8gb2JqLnNsaWNlKCkgOiBfLmV4dGVuZCh7fSwgb2JqKTsKICB9OwoKICAvLyBJbnZva2VzIGludGVyY2VwdG9yIHdpdGggdGhlIG9iaiwgYW5kIHRoZW4gcmV0dXJucyBvYmouCiAgLy8gVGhlIHByaW1hcnkgcHVycG9zZSBvZiB0aGlzIG1ldGhvZCBpcyB0byAidGFwIGludG8iIGEgbWV0aG9kIGNoYWluLCBpbgogIC8vIG9yZGVyIHRvIHBlcmZvcm0gb3BlcmF0aW9ucyBvbiBpbnRlcm1lZGlhdGUgcmVzdWx0cyB3aXRoaW4gdGhlIGNoYWluLgogIF8udGFwID0gZnVuY3Rpb24ob2JqLCBpbnRlcmNlcHRvcikgewogICAgaW50ZXJjZXB0b3Iob2JqKTsKICAgIHJldHVybiBvYmo7CiAgfTsKCiAgLy8gUGVyZm9ybSBhIGRlZXAgY29tcGFyaXNvbiB0byBjaGVjayBpZiB0d28gb2JqZWN0cyBhcmUgZXF1YWwuCiAgXy5pc0VxdWFsID0gZnVuY3Rpb24oYSwgYikgewogICAgLy8gQ2hlY2sgb2JqZWN0IGlkZW50aXR5LgogICAgaWYgKGEgPT09IGIpIHJldHVybiB0cnVlOwogICAgLy8gRGlmZmVyZW50IHR5cGVzPwogICAgdmFyIGF0eXBlID0gdHlwZW9mKGEpLCBidHlwZSA9IHR5cGVvZihiKTsKICAgIGlmIChhdHlwZSAhPSBidHlwZSkgcmV0dXJuIGZhbHNlOwogICAgLy8gQmFzaWMgZXF1YWxpdHkgdGVzdCAod2F0Y2ggb3V0IGZvciBjb2VyY2lvbnMpLgogICAgaWYgKGEgPT0gYikgcmV0dXJuIHRydWU7CiAgICAvLyBPbmUgaXMgZmFsc3kgYW5kIHRoZSBvdGhlciB0cnV0aHkuCiAgICBpZiAoKCFhICYmIGIpIHx8IChhICYmICFiKSkgcmV0dXJuIGZhbHNlOwogICAgLy8gVW53cmFwIGFueSB3cmFwcGVkIG9iamVjdHMuCiAgICBpZiAoYS5fY2hhaW4pIGEgPSBhLl93cmFwcGVkOwogICAgaWYgKGIuX2NoYWluKSBiID0gYi5fd3JhcHBlZDsKICAgIC8vIE9uZSBvZiB0aGVtIGltcGxlbWVudHMgYW4gaXNFcXVhbCgpPwogICAgaWYgKGEuaXNFcXVhbCkgcmV0dXJuIGEuaXNFcXVhbChiKTsKICAgIC8vIENoZWNrIGRhdGVzJyBpbnRlZ2VyIHZhbHVlcy4KICAgIGlmIChfLmlzRGF0ZShhKSAmJiBfLmlzRGF0ZShiKSkgcmV0dXJuIGEuZ2V0VGltZSgpID09PSBiLmdldFRpbWUoKTsKICAgIC8vIEJvdGggYXJlIE5hTj8KICAgIGlmIChfLmlzTmFOKGEpICYmIF8uaXNOYU4oYikpIHJldHVybiBmYWxzZTsKICAgIC8vIENvbXBhcmUgcmVndWxhciBleHByZXNzaW9ucy4KICAgIGlmIChfLmlzUmVnRXhwKGEpICYmIF8uaXNSZWdFeHAoYikpCiAgICAgIHJldHVybiBhLnNvdXJjZSAgICAgPT09IGIuc291cmNlICYmCiAgICAgICAgICAgICBhLmdsb2JhbCAgICAgPT09IGIuZ2xvYmFsICYmCiAgICAgICAgICAgICBhLmlnbm9yZUNhc2UgPT09IGIuaWdub3JlQ2FzZSAmJgogICAgICAgICAgICAgYS5tdWx0aWxpbmUgID09PSBiLm11bHRpbGluZTsKICAgIC8vIElmIGEgaXMgbm90IGFuIG9iamVjdCBieSB0aGlzIHBvaW50LCB3ZSBjYW4ndCBoYW5kbGUgaXQuCiAgICBpZiAoYXR5cGUgIT09ICdvYmplY3QnKSByZXR1cm4gZmFsc2U7CiAgICAvLyBDaGVjayBmb3IgZGlmZmVyZW50IGFycmF5IGxlbmd0aHMgYmVmb3JlIGNvbXBhcmluZyBjb250ZW50cy4KICAgIGlmIChhLmxlbmd0aCAmJiAoYS5sZW5ndGggIT09IGIubGVuZ3RoKSkgcmV0dXJuIGZhbHNlOwogICAgLy8gTm90aGluZyBlbHNlIHdvcmtlZCwgZGVlcCBjb21wYXJlIHRoZSBjb250ZW50cy4KICAgIHZhciBhS2V5cyA9IF8ua2V5cyhhKSwgYktleXMgPSBfLmtleXMoYik7CiAgICAvLyBEaWZmZXJlbnQgb2JqZWN0IHNpemVzPwogICAgaWYgKGFLZXlzLmxlbmd0aCAhPSBiS2V5cy5sZW5ndGgpIHJldHVybiBmYWxzZTsKICAgIC8vIFJlY3Vyc2l2ZSBjb21wYXJpc29uIG9mIGNvbnRlbnRzLgogICAgZm9yICh2YXIga2V5IGluIGEpIGlmICghKGtleSBpbiBiKSB8fCAhXy5pc0VxdWFsKGFba2V5XSwgYltrZXldKSkgcmV0dXJuIGZhbHNlOwogICAgcmV0dXJuIHRydWU7CiAgfTsKCiAgLy8gSXMgYSBnaXZlbiBhcnJheSBvciBvYmplY3QgZW1wdHk/CiAgXy5pc0VtcHR5ID0gZnVuY3Rpb24ob2JqKSB7CiAgICBpZiAoXy5pc0FycmF5KG9iaikgfHwgXy5pc1N0cmluZyhvYmopKSByZXR1cm4gb2JqLmxlbmd0aCA9PT0gMDsKICAgIGZvciAodmFyIGtleSBpbiBvYmopIGlmIChoYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwga2V5KSkgcmV0dXJuIGZhbHNlOwogICAgcmV0dXJuIHRydWU7CiAgfTsKCiAgLy8gSXMgYSBnaXZlbiB2YWx1ZSBhIERPTSBlbGVtZW50PwogIF8uaXNFbGVtZW50ID0gZnVuY3Rpb24ob2JqKSB7CiAgICByZXR1cm4gISEob2JqICYmIG9iai5ub2RlVHlwZSA9PSAxKTsKICB9OwoKICAvLyBJcyBhIGdpdmVuIHZhbHVlIGFuIGFycmF5PwogIC8vIERlbGVnYXRlcyB0byBFQ01BNSdzIG5hdGl2ZSBBcnJheS5pc0FycmF5CiAgXy5pc0FycmF5ID0gbmF0aXZlSXNBcnJheSB8fCBmdW5jdGlvbihvYmopIHsKICAgIHJldHVybiB0b1N0cmluZy5jYWxsKG9iaikgPT09ICdbb2JqZWN0IEFycmF5XSc7CiAgfTsKCiAgLy8gSXMgYSBnaXZlbiB2YXJpYWJsZSBhbiBhcmd1bWVudHMgb2JqZWN0PwogIF8uaXNBcmd1bWVudHMgPSBmdW5jdGlvbihvYmopIHsKICAgIHJldHVybiAhIShvYmogJiYgaGFzT3duUHJvcGVydHkuY2FsbChvYmosICdjYWxsZWUnKSk7CiAgfTsKCiAgLy8gSXMgYSBnaXZlbiB2YWx1ZSBhIGZ1bmN0aW9uPwogIF8uaXNGdW5jdGlvbiA9IGZ1bmN0aW9uKG9iaikgewogICAgcmV0dXJuICEhKG9iaiAmJiBvYmouY29uc3RydWN0b3IgJiYgb2JqLmNhbGwgJiYgb2JqLmFwcGx5KTsKICB9OwoKICAvLyBJcyBhIGdpdmVuIHZhbHVlIGEgc3RyaW5nPwogIF8uaXNTdHJpbmcgPSBmdW5jdGlvbihvYmopIHsKICAgIHJldHVybiAhIShvYmogPT09ICcnIHx8IChvYmogJiYgb2JqLmNoYXJDb2RlQXQgJiYgb2JqLnN1YnN0cikpOwogIH07CgogIC8vIElzIGEgZ2l2ZW4gdmFsdWUgYSBudW1iZXI/CiAgXy5pc051bWJlciA9IGZ1bmN0aW9uKG9iaikgewogICAgcmV0dXJuICEhKG9iaiA9PT0gMCB8fCAob2JqICYmIG9iai50b0V4cG9uZW50aWFsICYmIG9iai50b0ZpeGVkKSk7CiAgfTsKCiAgLy8gSXMgdGhlIGdpdmVuIHZhbHVlIGBOYU5gPyBgTmFOYCBoYXBwZW5zIHRvIGJlIHRoZSBvbmx5IHZhbHVlIGluIEphdmFTY3JpcHQKICAvLyB0aGF0IGRvZXMgbm90IGVxdWFsIGl0c2VsZi4KICBfLmlzTmFOID0gZnVuY3Rpb24ob2JqKSB7CiAgICByZXR1cm4gb2JqICE9PSBvYmo7CiAgfTsKCiAgLy8gSXMgYSBnaXZlbiB2YWx1ZSBhIGJvb2xlYW4/CiAgXy5pc0Jvb2xlYW4gPSBmdW5jdGlvbihvYmopIHsKICAgIHJldHVybiBvYmogPT09IHRydWUgfHwgb2JqID09PSBmYWxzZTsKICB9OwoKICAvLyBJcyBhIGdpdmVuIHZhbHVlIGEgZGF0ZT8KICBfLmlzRGF0ZSA9IGZ1bmN0aW9uKG9iaikgewogICAgcmV0dXJuICEhKG9iaiAmJiBvYmouZ2V0VGltZXpvbmVPZmZzZXQgJiYgb2JqLnNldFVUQ0Z1bGxZZWFyKTsKICB9OwoKICAvLyBJcyB0aGUgZ2l2ZW4gdmFsdWUgYSByZWd1bGFyIGV4cHJlc3Npb24/CiAgXy5pc1JlZ0V4cCA9IGZ1bmN0aW9uKG9iaikgewogICAgcmV0dXJuICEhKG9iaiAmJiBvYmoudGVzdCAmJiBvYmouZXhlYyAmJiAob2JqLmlnbm9yZUNhc2UgfHwgb2JqLmlnbm9yZUNhc2UgPT09IGZhbHNlKSk7CiAgfTsKCiAgLy8gSXMgYSBnaXZlbiB2YWx1ZSBlcXVhbCB0byBudWxsPwogIF8uaXNOdWxsID0gZnVuY3Rpb24ob2JqKSB7CiAgICByZXR1cm4gb2JqID09PSBudWxsOwogIH07CgogIC8vIElzIGEgZ2l2ZW4gdmFyaWFibGUgdW5kZWZpbmVkPwogIF8uaXNVbmRlZmluZWQgPSBmdW5jdGlvbihvYmopIHsKICAgIHJldHVybiBvYmogPT09IHZvaWQgMDsKICB9OwoKICAvLyBVdGlsaXR5IEZ1bmN0aW9ucwogIC8vIC0tLS0tLS0tLS0tLS0tLS0tCgogIC8vIFJ1biBVbmRlcnNjb3JlLmpzIGluICpub0NvbmZsaWN0KiBtb2RlLCByZXR1cm5pbmcgdGhlIGBfYCB2YXJpYWJsZSB0byBpdHMKICAvLyBwcmV2aW91cyBvd25lci4gUmV0dXJucyBhIHJlZmVyZW5jZSB0byB0aGUgVW5kZXJzY29yZSBvYmplY3QuCiAgXy5ub0NvbmZsaWN0ID0gZnVuY3Rpb24oKSB7CiAgICByb290Ll8gPSBwcmV2aW91c1VuZGVyc2NvcmU7CiAgICByZXR1cm4gdGhpczsKICB9OwoKICAvLyBLZWVwIHRoZSBpZGVudGl0eSBmdW5jdGlvbiBhcm91bmQgZm9yIGRlZmF1bHQgaXRlcmF0b3JzLgogIF8uaWRlbnRpdHkgPSBmdW5jdGlvbih2YWx1ZSkgewogICAgcmV0dXJuIHZhbHVlOwogIH07CgogIC8vIFJ1biBhIGZ1bmN0aW9uICoqbioqIHRpbWVzLgogIF8udGltZXMgPSBmdW5jdGlvbiAobiwgaXRlcmF0b3IsIGNvbnRleHQpIHsKICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbjsgaSsrKSBpdGVyYXRvci5jYWxsKGNvbnRleHQsIGkpOwogIH07CgogIC8vIEFkZCB5b3VyIG93biBjdXN0b20gZnVuY3Rpb25zIHRvIHRoZSBVbmRlcnNjb3JlIG9iamVjdCwgZW5zdXJpbmcgdGhhdAogIC8vIHRoZXkncmUgY29ycmVjdGx5IGFkZGVkIHRvIHRoZSBPT1Agd3JhcHBlciBhcyB3ZWxsLgogIF8ubWl4aW4gPSBmdW5jdGlvbihvYmopIHsKICAgIGVhY2goXy5mdW5jdGlvbnMob2JqKSwgZnVuY3Rpb24obmFtZSl7CiAgICAgIGFkZFRvV3JhcHBlcihuYW1lLCBfW25hbWVdID0gb2JqW25hbWVdKTsKICAgIH0pOwogIH07CgogIC8vIEdlbmVyYXRlIGEgdW5pcXVlIGludGVnZXIgaWQgKHVuaXF1ZSB3aXRoaW4gdGhlIGVudGlyZSBjbGllbnQgc2Vzc2lvbikuCiAgLy8gVXNlZnVsIGZvciB0ZW1wb3JhcnkgRE9NIGlkcy4KICB2YXIgaWRDb3VudGVyID0gMDsKICBfLnVuaXF1ZUlkID0gZnVuY3Rpb24ocHJlZml4KSB7CiAgICB2YXIgaWQgPSBpZENvdW50ZXIrKzsKICAgIHJldHVybiBwcmVmaXggPyBwcmVmaXggKyBpZCA6IGlkOwogIH07CgogIC8vIEJ5IGRlZmF1bHQsIFVuZGVyc2NvcmUgdXNlcyBFUkItc3R5bGUgdGVtcGxhdGUgZGVsaW1pdGVycywgY2hhbmdlIHRoZQogIC8vIGZvbGxvd2luZyB0ZW1wbGF0ZSBzZXR0aW5ncyB0byB1c2UgYWx0ZXJuYXRpdmUgZGVsaW1pdGVycy4KICBfLnRlbXBsYXRlU2V0dGluZ3MgPSB7CiAgICBldmFsdWF0ZSAgICA6IC88JShbXHNcU10rPyklPi9nLAogICAgaW50ZXJwb2xhdGUgOiAvPCU9KFtcc1xTXSs/KSU+L2cKICB9OwoKICAvLyBKYXZhU2NyaXB0IG1pY3JvLXRlbXBsYXRpbmcsIHNpbWlsYXIgdG8gSm9obiBSZXNpZydzIGltcGxlbWVudGF0aW9uLgogIC8vIFVuZGVyc2NvcmUgdGVtcGxhdGluZyBoYW5kbGVzIGFyYml0cmFyeSBkZWxpbWl0ZXJzLCBwcmVzZXJ2ZXMgd2hpdGVzcGFjZSwKICAvLyBhbmQgY29ycmVjdGx5IGVzY2FwZXMgcXVvdGVzIHdpdGhpbiBpbnRlcnBvbGF0ZWQgY29kZS4KICBfLnRlbXBsYXRlID0gZnVuY3Rpb24oc3RyLCBkYXRhKSB7CiAgICB2YXIgYyAgPSBfLnRlbXBsYXRlU2V0dGluZ3M7CiAgICB2YXIgdG1wbCA9ICd2YXIgX19wPVtdLHByaW50PWZ1bmN0aW9uKCl7X19wLnB1c2guYXBwbHkoX19wLGFyZ3VtZW50cyk7fTsnICsKICAgICAgJ3dpdGgob2JqfHx7fSl7X19wLnB1c2goXCcnICsKICAgICAgc3RyLnJlcGxhY2UoL1xcL2csICdcXFxcJykKICAgICAgICAgLnJlcGxhY2UoLycvZywgIlxcJyIpCiAgICAgICAgIC5yZXBsYWNlKGMuaW50ZXJwb2xhdGUsIGZ1bmN0aW9uKG1hdGNoLCBjb2RlKSB7CiAgICAgICAgICAgcmV0dXJuICInLCIgKyBjb2RlLnJlcGxhY2UoL1xcJy9nLCAiJyIpICsgIiwnIjsKICAgICAgICAgfSkKICAgICAgICAgLnJlcGxhY2UoYy5ldmFsdWF0ZSB8fCBudWxsLCBmdW5jdGlvbihtYXRjaCwgY29kZSkgewogICAgICAgICAgIHJldHVybiAiJyk7IiArIGNvZGUucmVwbGFjZSgvXFwnL2csICInIikKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLnJlcGxhY2UoL1tcclxuXHRdL2csICcgJykgKyAiX19wLnB1c2goJyI7CiAgICAgICAgIH0pCiAgICAgICAgIC5yZXBsYWNlKC9cci9nLCAnXFxyJykKICAgICAgICAgLnJlcGxhY2UoL1xuL2csICdcXG4nKQogICAgICAgICAucmVwbGFjZSgvXHQvZywgJ1xcdCcpCiAgICAgICAgICsgIicpO31yZXR1cm4gX19wLmpvaW4oJycpOyI7CiAgICB2YXIgZnVuYyA9IG5ldyBGdW5jdGlvbignb2JqJywgdG1wbCk7CiAgICByZXR1cm4gZGF0YSA/IGZ1bmMoZGF0YSkgOiBmdW5jOwogIH07CgogIC8vIFRoZSBPT1AgV3JhcHBlcgogIC8vIC0tLS0tLS0tLS0tLS0tLQoKICAvLyBJZiBVbmRlcnNjb3JlIGlzIGNhbGxlZCBhcyBhIGZ1bmN0aW9uLCBpdCByZXR1cm5zIGEgd3JhcHBlZCBvYmplY3QgdGhhdAogIC8vIGNhbiBiZSB1c2VkIE9PLXN0eWxlLiBUaGlzIHdyYXBwZXIgaG9sZHMgYWx0ZXJlZCB2ZXJzaW9ucyBvZiBhbGwgdGhlCiAgLy8gdW5kZXJzY29yZSBmdW5jdGlvbnMuIFdyYXBwZWQgb2JqZWN0cyBtYXkgYmUgY2hhaW5lZC4KICB2YXIgd3JhcHBlciA9IGZ1bmN0aW9uKG9iaikgeyB0aGlzLl93cmFwcGVkID0gb2JqOyB9OwoKICAvLyBFeHBvc2UgYHdyYXBwZXIucHJvdG90eXBlYCBhcyBgXy5wcm90b3R5cGVgCiAgXy5wcm90b3R5cGUgPSB3cmFwcGVyLnByb3RvdHlwZTsKCiAgLy8gSGVscGVyIGZ1bmN0aW9uIHRvIGNvbnRpbnVlIGNoYWluaW5nIGludGVybWVkaWF0ZSByZXN1bHRzLgogIHZhciByZXN1bHQgPSBmdW5jdGlvbihvYmosIGNoYWluKSB7CiAgICByZXR1cm4gY2hhaW4gPyBfKG9iaikuY2hhaW4oKSA6IG9iajsKICB9OwoKICAvLyBBIG1ldGhvZCB0byBlYXNpbHkgYWRkIGZ1bmN0aW9ucyB0byB0aGUgT09QIHdyYXBwZXIuCiAgdmFyIGFkZFRvV3JhcHBlciA9IGZ1bmN0aW9uKG5hbWUsIGZ1bmMpIHsKICAgIHdyYXBwZXIucHJvdG90eXBlW25hbWVdID0gZnVuY3Rpb24oKSB7CiAgICAgIHZhciBhcmdzID0gc2xpY2UuY2FsbChhcmd1bWVudHMpOwogICAgICB1bnNoaWZ0LmNhbGwoYXJncywgdGhpcy5fd3JhcHBlZCk7CiAgICAgIHJldHVybiByZXN1bHQoZnVuYy5hcHBseShfLCBhcmdzKSwgdGhpcy5fY2hhaW4pOwogICAgfTsKICB9OwoKICAvLyBBZGQgYWxsIG9mIHRoZSBVbmRlcnNjb3JlIGZ1bmN0aW9ucyB0byB0aGUgd3JhcHBlciBvYmplY3QuCiAgXy5taXhpbihfKTsKCiAgLy8gQWRkIGFsbCBtdXRhdG9yIEFycmF5IGZ1bmN0aW9ucyB0byB0aGUgd3JhcHBlci4KICBlYWNoKFsncG9wJywgJ3B1c2gnLCAncmV2ZXJzZScsICdzaGlmdCcsICdzb3J0JywgJ3NwbGljZScsICd1bnNoaWZ0J10sIGZ1bmN0aW9uKG5hbWUpIHsKICAgIHZhciBtZXRob2QgPSBBcnJheVByb3RvW25hbWVdOwogICAgd3JhcHBlci5wcm90b3R5cGVbbmFtZV0gPSBmdW5jdGlvbigpIHsKICAgICAgbWV0aG9kLmFwcGx5KHRoaXMuX3dyYXBwZWQsIGFyZ3VtZW50cyk7CiAgICAgIHJldHVybiByZXN1bHQodGhpcy5fd3JhcHBlZCwgdGhpcy5fY2hhaW4pOwogICAgfTsKICB9KTsKCiAgLy8gQWRkIGFsbCBhY2Nlc3NvciBBcnJheSBmdW5jdGlvbnMgdG8gdGhlIHdyYXBwZXIuCiAgZWFjaChbJ2NvbmNhdCcsICdqb2luJywgJ3NsaWNlJ10sIGZ1bmN0aW9uKG5hbWUpIHsKICAgIHZhciBtZXRob2QgPSBBcnJheVByb3RvW25hbWVdOwogICAgd3JhcHBlci5wcm90b3R5cGVbbmFtZV0gPSBmdW5jdGlvbigpIHsKICAgICAgcmV0dXJuIHJlc3VsdChtZXRob2QuYXBwbHkodGhpcy5fd3JhcHBlZCwgYXJndW1lbnRzKSwgdGhpcy5fY2hhaW4pOwogICAgfTsKICB9KTsKCiAgLy8gU3RhcnQgY2hhaW5pbmcgYSB3cmFwcGVkIFVuZGVyc2NvcmUgb2JqZWN0LgogIHdyYXBwZXIucHJvdG90eXBlLmNoYWluID0gZnVuY3Rpb24oKSB7CiAgICB0aGlzLl9jaGFpbiA9IHRydWU7CiAgICByZXR1cm4gdGhpczsKICB9OwoKICAvLyBFeHRyYWN0cyB0aGUgcmVzdWx0IGZyb20gYSB3cmFwcGVkIGFuZCBjaGFpbmVkIG9iamVjdC4KICB3cmFwcGVyLnByb3RvdHlwZS52YWx1ZSA9IGZ1bmN0aW9uKCkgewogICAgcmV0dXJuIHRoaXMuX3dyYXBwZWQ7CiAgfTsKCn0pKCk7Cg==","content_type":"application/javascript","revpos":42},"index.html":{"data":"PCFET0NUWVBFIEhUTUwgUFVCTElDICItLy9XM0MvL0RURCBIVE1MIDQuMDEvL0VOIiAiaHR0cDovL3d3dy53My5vcmcvVFIvaHRtbDQvc3RyaWN0LmR0ZCI+CjxodG1sPgogIDxoZWFkPgogICAgPG1ldGEgbmFtZT0idmlld3BvcnQiIGNvbnRlbnQ9IndpZHRoPWRldmljZS13aWR0aCwgaW5pdGlhbC1zY2FsZT0xLjAsIG1heGltdW0tc2NhbGU9MS4wLCB1c2VyLXNjYWxhYmxlPW5vOyIgLz4KCiAgICA8bWV0YSBodHRwLWVxdWl2PSJDb250ZW50LXR5cGUiIGNvbnRlbnQ9InRleHQvaHRtbDsgY2hhcnNldD11dGYtOCI+CgoKCTwhLS0gaVBhZC9pUGhvbmUgc3BlY2lmaWMgY3NzIGJlbG93LCBhZGQgYWZ0ZXIgeW91ciBtYWluIGNzcyA+Cgk8bGluayByZWw9InN0eWxlc2hlZXQiIG1lZGlhPSJvbmx5IHNjcmVlbiBhbmQgKG1heC1kZXZpY2Utd2lkdGg6IDEwMjRweCkiIGhyZWY9ImlwYWQuY3NzIiB0eXBlPSJ0ZXh0L2NzcyIgLz4JCQoJPGxpbmsgcmVsPSJzdHlsZXNoZWV0IiBtZWRpYT0ib25seSBzY3JlZW4gYW5kIChtYXgtZGV2aWNlLXdpZHRoOiA0ODBweCkiIGhyZWY9ImlwaG9uZS5jc3MiIHR5cGU9InRleHQvY3NzIiAvPgkJCgktLT4KCTwhLS0gSWYgeW91IGFwcGxpY2F0aW9uIGlzIHRhcmdldGluZyBpT1MgQkVGT1JFIDQuMCB5b3UgTVVTVCBwdXQganNvbjIuanMgZnJvbSBodHRwOi8vd3d3LkpTT04ub3JnL2pzb24yLmpzIGludG8geW91ciB3d3cgZGlyZWN0b3J5IGFuZCBpbmNsdWRlIGl0IGhlcmUgLS0+Cgk8c2NyaXB0IHR5cGU9InRleHQvamF2YXNjcmlwdCIgY2hhcnNldD0idXRmLTgiIHNyYz0ianMvanF1ZXJ5LTEuNi4xLm1pbi5qcyI+PC9zY3JpcHQ+Cgk8c2NyaXB0IHR5cGU9InRleHQvamF2YXNjcmlwdCIgY2hhcnNldD0idXRmLTgiIHNyYz0ianMvanF1ZXJ5LmNvdWNoLmpzIj48L3NjcmlwdD4KCTxzY3JpcHQgdHlwZT0idGV4dC9qYXZhc2NyaXB0IiBjaGFyc2V0PSJ1dGYtOCIgc3JjPSJqcy9waG9uZWdhcC4wLjkuNS4xLm1pbi5qcyI+PC9zY3JpcHQ+Cgk8c2NyaXB0IHR5cGU9InRleHQvamF2YXNjcmlwdCIgY2hhcnNldD0idXRmLTgiIHNyYz0ianMvdW5kZXJzY29yZS0xLjEuNi5qcyI+PC9zY3JpcHQ+CiAgPHNjcmlwdCB0eXBlPSJ0ZXh0L2phdmFzY3JpcHQiIGNoYXJzZXQ9InV0Zi04Ij4KCgoJLy8gSWYgeW91IHdhbnQgdG8gcHJldmVudCBkcmFnZ2luZywgdW5jb21tZW50IHRoaXMgc2VjdGlvbgoJLyoKCWZ1bmN0aW9uIHByZXZlbnRCZWhhdmlvcihlKSAKCXsgCiAgICAgIGUucHJldmVudERlZmF1bHQoKTsgCiAgICB9OwoJZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigidG91Y2htb3ZlIiwgcHJldmVudEJlaGF2aW9yLCBmYWxzZSk7CgkqLwoJCgkvKiBJZiB5b3UgYXJlIHN1cHBvcnRpbmcgeW91ciBvd24gcHJvdG9jb2wsIHRoZSB2YXIgaW52b2tlU3RyaW5nIHdpbGwgY29udGFpbiBhbnkgYXJndW1lbnRzIHRvIHRoZSBhcHAgbGF1bmNoLgoJc2VlIGh0dHA6Ly9pcGhvbmVkZXZlbG9wZXJ0aXBzLmNvbS9jb2NvYS9sYXVuY2hpbmcteW91ci1vd24tYXBwbGljYXRpb24tdmlhLWEtY3VzdG9tLXVybC1zY2hlbWUuaHRtbAoJZm9yIG1vcmUgZGV0YWlscyAtam0gKi8KCS8qCglmdW5jdGlvbiBoYW5kbGVPcGVuVVJMKHVybCkKCXsKCQkvLyBUT0RPOiBkbyBzb21ldGhpbmcgd2l0aCB0aGUgdXJsIHBhc3NlZCBpbi4KCX0KCSovCgkKCQoJCglmdW5jdGlvbiBvbkJvZHlMb2FkKCkKCXsJCiAgICB2YXIgdmFsaWRhdGVEb2N1bWVudHNFeGlzdCA9IGZ1bmN0aW9uKGRhdGFiYXNlX25hbWUsIGRvY3VtZW50X25hbWVzKSB7CiAgICAgIHZhciBkYXRhYmFzZTsKICAgICAgZGF0YWJhc2UgPSAkLmNvdWNoLmRiKGRhdGFiYXNlX25hbWUpOwogICAgICByZXR1cm4gZGF0YWJhc2UuYWxsRG9jcyh7CiAgICAgICAga2V5czogZG9jdW1lbnRfbmFtZXMsCiAgICAgICAgc3VjY2VzczogZnVuY3Rpb24oZG9jcykgewogICAgICAgICAgdmFyIGFsbF9kYXRhYmFzZV9kb2N1bWVudF9uYW1lczsKICAgICAgICAgIGFsbF9kYXRhYmFzZV9kb2N1bWVudF9uYW1lcyA9IF8ubWFwKGRvY3Mucm93cywgZnVuY3Rpb24oZG9jdW1lbnQpIHsKICAgICAgICAgICAgcmV0dXJuIGRvY3VtZW50LmlkOwogICAgICAgICAgfSk7CiAgICAgICAgICByZXR1cm4gXy5lYWNoKGRvY3VtZW50X25hbWVzLCBmdW5jdGlvbihkb2N1bWVudF9uYW1lKSB7CiAgICAgICAgICAgIGlmICghXy5pbmNsdWRlKGFsbF9kYXRhYmFzZV9kb2N1bWVudF9uYW1lcywgZG9jdW1lbnRfbmFtZSkpIHsKICAgICAgICAgICAgICByZXR1cm4gYWxlcnQoIkZhaWxlZCB0byBmaW5kIHRoZSBkb2N1bWVudDogIiArIGRvY3VtZW50X25hbWUgKyAiIGluIGRhdGFiYXNlOiAiICsgZGF0YWJhc2VfbmFtZSk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0pOwogICAgICAgIH0sCiAgICAgICAgZXJyb3I6IGZ1bmN0aW9uKCkgewogICAgICAgICAgcmV0dXJuIGFsZXJ0KCJGYWlsZWQgdG8gZ2V0IHRoZSBkb2N1bWVudHMgZm9yIGRhdGFiYXNlOiAiICsgZGF0YWJhc2VfbmFtZSk7CiAgICAgICAgfQogICAgICB9KTsKICAgIH07CgogICAgLy8gTk9URTogcnVubmluZyBmcm9tIHRoZSBmaWxlc3lzdGVtIGdpdmVzIGFuICJBY2Nlc3MtQ29udHJvbC1BbGxvdy1PcmlnaW4iIGVycm9yIAoJICBpZih3aW5kb3cubG9jYXRpb24uaG9zdCl7CgoJICAgIC8vIGlmIHRoZSBkYXRhIGlzbid0IHJldHVybmVkIHNvb24sIGdpdmUgYSBtZXNzYWdlCgkgICAgdmFyIGRhdGFfcmV0cmlldmVkID0gZmFsc2U7CgkJCXNldFRpbWVvdXQoZnVuY3Rpb24oKSB7CgkJCSAgaWYoIWRhdGFfcmV0cmlldmVkKQogICAgCQkgICQoImgxI2xvYWRlZF9tZXNzYWdlIikuaHRtbCgiQ291Y2hBcHAgZmFpbGVkIHRvIGdldCBkYXRhIik7CgkJCX0sIDMwMDAgKTsKCiAgICAgICQuY291Y2gudXJsUHJlZml4ID0gd2luZG93LmxvY2F0aW9uLmhvc3Q/ICJodHRwOi8vIiArIHdpbmRvdy5sb2NhdGlvbi5ob3N0IDogImh0dHA6Ly8xMjcuMC4wLjE6NTk4NCI7CiAgICAgIAogICAgICAvLyBmb3IgZGVidWdnaW5nCgkgICAgdmFsaWRhdGVEb2N1bWVudHNFeGlzdCgibXljb3VjaGFwcF9kYiIsIFsiX2Rlc2lnbi9teWNvdWNoYXBwIiwgIm15ZGF0YSIsICJfZGVzaWduL215ZGF0YV92aWV3cyJdKTsKCiAgICAgIC8vIHRoaXMgZXhhbXBsZSBpcyBvdmVyLWVuZ2luZWVyZWQsIGJ1dCBpdCBpcyBtZWFudCB0byBzaG93IHRoYXQgZGF0YSBhbmQgdmlld3MgY2FuIGJlIGxvYWRlZCBpbnRvIGEgY291Y2hkYgogICAgICAkLmNvdWNoLmRiKCJteWNvdWNoYXBwX2RiIikudmlldygibXlkYXRhX3ZpZXdzL21lc3NhZ2U/a2V5PVwibXlkYXRhXCIiLCB7IHN1Y2Nlc3M6IGZ1bmN0aW9uKHZpZXdfZGF0YSkgeyAgCiAgICAgICAgZGF0YV9yZXRyaWV2ZWQgPSB0cnVlOwogICAgICAgICAgICAgJCgiaDEjbG9hZGVkX21lc3NhZ2UiKS5odG1sKHZpZXdfZGF0YS5yb3dzWzBdLnZhbHVlKTsKICAgICAgfX0pOwoJICB9CgoJICAvLyBpdCBpcyBydW5uaW5nIGZyb20gdGhlIGZpbGVzeXN0ZW0KCSAgZWxzZQogIAkJJCgiaDEjbG9hZGVkX21lc3NhZ2UiKS5odG1sKCJXYXJuaW5nOiBDb3VjaEFwcCBzYW1wbGUgcnVubmluZyBsb2NhbGx5IHNvIHdpbGwgcmVjZWl2ZSAnQWNjZXNzLUNvbnRyb2wtQWxsb3ctT3JpZ2luJyBlcnJvciIpOwoKCQlkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCJkZXZpY2VyZWFkeSIsb25EZXZpY2VSZWFkeSxmYWxzZSk7Cgl9CgkKCS8qIFdoZW4gdGhpcyBmdW5jdGlvbiBpcyBjYWxsZWQsIFBob25lR2FwIGhhcyBiZWVuIGluaXRpYWxpemVkIGFuZCBpcyByZWFkeSB0byByb2xsICovCgkvKiBJZiB5b3UgYXJlIHN1cHBvcnRpbmcgeW91ciBvd24gcHJvdG9jb2wsIHRoZSB2YXIgaW52b2tlU3RyaW5nIHdpbGwgY29udGFpbiBhbnkgYXJndW1lbnRzIHRvIHRoZSBhcHAgbGF1bmNoLgoJc2VlIGh0dHA6Ly9pcGhvbmVkZXZlbG9wZXJ0aXBzLmNvbS9jb2NvYS9sYXVuY2hpbmcteW91ci1vd24tYXBwbGljYXRpb24tdmlhLWEtY3VzdG9tLXVybC1zY2hlbWUuaHRtbAoJZm9yIG1vcmUgZGV0YWlscyAtam0gKi8KCWZ1bmN0aW9uIG9uRGV2aWNlUmVhZHkoKQoJewoJfQogICAgCiAgICA8L3NjcmlwdD4KICA8L2hlYWQ+CiAgPGJvZHkgb25sb2FkPSJvbkJvZHlMb2FkKCkiPgogIAkgIDxoMSBpZD0ibG9hZGVkX21lc3NhZ2UiPjwvaDE+CiAgPC9ib2R5Pgo8L2h0bWw+Cg==","content_type":"text/html","revpos":42}}}